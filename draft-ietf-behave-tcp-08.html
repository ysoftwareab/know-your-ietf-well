<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>NAT Behavioral
            Requirements for TCP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="NAT Behavioral
            Requirements for TCP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Guha, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cornell U.</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">K. Biswas</td></tr>
<tr><td class="header">Expires: March 10, 2009</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Ford</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M.I.T.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Sivakumar</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">P. Srisuresh</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Consultant</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 06, 2008</td></tr>
</table></td></tr></table>
<h1><br />NAT Behavioral
            Requirements for TCP<br />draft-ietf-behave-tcp-08.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 10, 2009.</p>

<h3>Abstract</h3>

<p>This document defines a set of requirements for NATs that handle
                TCP that would allow many applications, such as peer-to-peer
                applications and on-line games, to work consistently.
                Developing NATs that meet this set of requirements will greatly
                increase the likelihood that these applications will function
                properly.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Applicability Statement<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Terminology<br />
<a href="#anchor4">4.</a>&nbsp;
TCP Connection Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Address and Port Mapping Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Internally Initiated Connections<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-ef">4.3.</a>&nbsp;
Externally Initiated Connections<br />
<a href="#anchor7">5.</a>&nbsp;
NAT Session Refresh<br />
<a href="#anchor8">6.</a>&nbsp;
Application Level Gateways<br />
<a href="#anchor9">7.</a>&nbsp;
Other Requirements Applicable to TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.1.</a>&nbsp;
Port Assignment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.2.</a>&nbsp;
Hairpinning Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.3.</a>&nbsp;
ICMP Responses to TCP Packets<br />
<a href="#anchor13">8.</a>&nbsp;
Requirements<br />
<a href="#sec-security">9.</a>&nbsp;
Security considerations<br />
<a href="#anchor14">10.</a>&nbsp;
IANA considerations<br />
<a href="#anchor15">11.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informational References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Applicability Statement</h3>

<p>This document is adjunct to <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>, which
                defines many terms relating to NATs, lays out general
                requirements for all NATs, and sets requirements for NATs that
                handle IP and unicast UDP traffic. The purpose of this document
                is to set requirements for NATs that handle TCP traffic.
</p>
<p>The requirements of this specification apply to Traditional NATs
                as described in <a class='info' href='#RFC2663'>[RFC2663]<span> (</span><span class='info'>Srisuresh, P. and M. Holdrege, &ldquo;IP Network Address Translator (NAT) Terminology and Considerations,&rdquo; August&nbsp;1999.</span><span>)</span></a>.
</p>
<p>This document only covers the TCP aspects of NAT traversal.
                Middle-box behavior that is not necessary for network address
                translation of TCP is out-of-scope. Firewalls, and packet
                inspection above the TCP layer are out-of-scope except for
                Application Level Gateways (ALG) behavior that may interfere
                with NAT traversal. Application and OS aspects of TCP NAT
                traversal are out-of-scope. Signaling based approaches to NAT
                traversal such as MIDCOM and UPnP that directly control the NAT
                are out-of-scope. Finally, TCP connections intended for the NAT
                (e.g. an HTTP or SSH management interface) and TCP connections
                initiated by the NAT (e.g. reliable syslog client) are
                out-of-scope.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Network Address Translators (NATs) hinder connectivity in
                applications where sessions may be initiated to internal hosts.
                Readers may refer to <a class='info' href='#RFC3022'>[RFC3022]<span> (</span><span class='info'>Srisuresh, P. and K. Egevang, &ldquo;Traditional IP Network Address Translator (Traditional NAT),&rdquo; January&nbsp;2001.</span><span>)</span></a> for detailed
                information on traditional NATs.  <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>
                lays out the terminology and requirements for NATs in the
                context of IP and UDP. This document supplements these by
                setting requirements for NATs that handle TCP traffic. All
                definitions and requirements in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> are
                inherited here.
</p>
<p><a class='info' href='#RFC4614'>[RFC4614]<span> (</span><span class='info'>Duke, M., Braden, R., Eddy, W., and E. Blanton, &ldquo;A Roadmap for Transmission Control Protocol (TCP) Specification Documents,&rdquo; September&nbsp;2006.</span><span>)</span></a> chronicles the evolution of TCP
                from the original definition <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> to
                present day implementations. While much has changed in TCP with
                regards to congestion control and flow control, security, and
                support for high-bandwidth networks, the process of initiating
                a connection (i.e. the 3-way handshake or simultaneous-open)
                has changed little. It is the process of connection initiation
                that NATs affect the most. Experimental approaches such as
                T/TCP <a class='info' href='#RFC1644'>[RFC1644]<span> (</span><span class='info'>Braden, B., &ldquo;T/TCP -- TCP Extensions for Transactions Functional Specification,&rdquo; July&nbsp;1994.</span><span>)</span></a> have proposed alternate
                connection initiation approaches, but, have been found to be
                complex and susceptible to denial-of-service attacks. Modern
                operating systems and NATs consequently primarily support the
                3-way handshake and simultaneous-open modes of connection
                initiation as described in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>.
</p>
<p>Recently, many techniques have been devised to make peer-to-peer
                TCP applications work across NATs. <a class='info' href='#STUNT'>[STUNT]<span> (</span><span class='info'>Guha, S. and P. Francis, &ldquo;NUTSS: A SIP based approach to UDP and TCP connectivity,&rdquo; August&nbsp;2004.</span><span>)</span></a>,
                <a class='info' href='#NATBLASTER'>[NATBLASTER]<span> (</span><span class='info'>Biggadike, A., Ferullo, D., Wilson, G., and A. Perrig, &ldquo;NATBLASTER: Establishing TCP connections between hosts behind NATs,&rdquo; April&nbsp;2005.</span><span>)</span></a>, and <a class='info' href='#P2PNAT'>[P2PNAT]<span> (</span><span class='info'>Ford, B., Srisuresh, P., and D. Kegel, &ldquo;Peer-to-peer communication across network address translators,&rdquo; April&nbsp;2005.</span><span>)</span></a>
                describe Unilateral Self-Address Fixing (UNSAF) mechanisms
                that allow peer-to-peer applications to establish TCP through
                NATs. These approaches require only endpoint applications to be
                modified and work with standards compliant OS stacks. The
                approaches, however, depend on specific NAT behavior that is
                usually, but not always, supported by NATs (see <a class='info' href='#TCPTRAV'>[TCPTRAV]<span> (</span><span class='info'>Guha, S. and P. Francis, &ldquo;Characterization and Measurement of TCP Traversal through NATs and Firewalls,&rdquo; October&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#P2PNAT'>[P2PNAT]<span> (</span><span class='info'>Ford, B., Srisuresh, P., and D. Kegel, &ldquo;Peer-to-peer communication across network address translators,&rdquo; April&nbsp;2005.</span><span>)</span></a> for
                details). Consequently a complete TCP NAT traversal solution is
                sometimes forced to rely on public TCP relays to traverse NATs
                that do not cooperate. This document defines requirements that
                ensure that TCP NAT traversal approaches are not forced to use
                data relays.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
                NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
                "OPTIONAL" in this document are to be interpreted as
                described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>This document uses the term "NAT session" as defined in
                <a class='info' href='#RFC2663'>[RFC2663]<span> (</span><span class='info'>Srisuresh, P. and M. Holdrege, &ldquo;IP Network Address Translator (NAT) Terminology and Considerations,&rdquo; August&nbsp;1999.</span><span>)</span></a>. "NAT" in this specification includes
                both "Basic NAT" and "Network Address/Port Translator (NAPT)"
                <a class='info' href='#RFC2663'>[RFC2663]<span> (</span><span class='info'>Srisuresh, P. and M. Holdrege, &ldquo;IP Network Address Translator (NAT) Terminology and Considerations,&rdquo; August&nbsp;1999.</span><span>)</span></a>.
</p>
<p>This document uses the term "TCP connection" (or just
                "connection") to refer to individual TCP flows identified by
                the 4-tuple (source and destination IP address and TCP port)
                and the initial sequence numbers (ISN).
</p>
<p>This document uses the term "address and port mapping" (or just
                "mapping") as defined in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> to refer
                to state at the NAT necessary for network address and port
                translation of TCP connections. This document also uses the
                terms "endpoint independent mapping", "address dependent
                mapping", "address and port dependent mapping", "filtering
                behavior", "endpoint independent filtering", "address dependent
                filtering", "address and port dependent filtering", "port
                assignment", "port overloading", "hairpinning", and "external
                source IP address and port" as defined in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
TCP Connection Initiation</h3>

<p>This section describes various NAT behaviors applicable to TCP
                connection initiation.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Address and Port Mapping Behavior</h3>

<p>A NAT uses a mapping to translate packets for each TCP
                    connection. A mapping is dynamically allocated for
                    connections initiated from the internal side, and
                    potentially reused for certain subsequent connections. NAT
                    behavior regarding when a mapping can be reused differs for
                    different NATs as described in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Consider an internal IP address and TCP port (X:x) that
                    initiates a TCP connection to an external (Y1:y1) tuple.
                    Let the mapping allocated by the NAT for this connection be
                    (X1':x1'). Shortly thereafter, the endpoint initiates a
                    connection from the same (X:x) to an external address
                    (Y2:y2) and gets the mapping (X2':x2') on the NAT. As per
                    <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>, if (X1':x1') equals (X2':x2')
                    for all values of (Y2:y2) then the NAT is defined to have
                    "Endpoint Independent Mapping" behavior. If (X1':x1')
                    equals (X2':x2') only when Y2 equals Y1 then the NAT is
                    defined to have "Address Dependent Mapping" behavior. If
                    (X1':x1') equals (X2':x2') only when (Y2:y2) equals
                    (Y1:y1), possible only for consecutive connections to the
                    same external address shortly after the first is terminated
                    and if the NAT retains state for connections in TIME_WAIT
                    state, then the NAT is defined to have "Address and Port
                    Dependent Mapping" behavior. This document introduces one
                    additional behavior where (X1':x1') never equals (X2':x2'),
                    that is, for each connection a new mapping is allocated; in
                    such a case, the NAT is defined to have "Connection
                    Dependent Mapping" behavior. 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-1:</dt>
<dd>A NAT MUST have an "Endpoint
                            Independent Mapping" behavior for TCP.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>REQ-1 is necessary for
                            UNSAF methods to work. Endpoint independent mapping
                            behavior allows peer-to-peer applications to learn
                            and advertise the external IP address and port
                            allocated to an internal endpoint such that
                            external peers can contact it (subject to the NAT's
                            security policy). The security policy of a NAT is
                            independent of its mapping behavior and is
                            discussed later in <a class='info' href='#sec-ef'>Section&nbsp;4.3<span> (</span><span class='info'>Externally Initiated Connections</span><span>)</span></a>. Having
                            endpoint independent mapping behavior allows
                            peer-to-peer applications to work consistently
                            without compromising the security benefits of the
                            NAT.
</dd>
</dl></blockquote>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Internally Initiated Connections</h3>

<p>An internal endpoint initiates a TCP connection through a
                    NAT by sending a SYN packet. The NAT allocates (or reuses)
                    a mapping for the connection, as described in the previous
                    section. The mapping defines the external IP address and
                    port used for translation of all packets for that
                    connection. In particular, for client-server applications
                    where an internal client initiates the connection to an
                    external server, the mapping is used to translate the
                    outbound SYN, the resulting inbound SYN-ACK response, the
                    subsequent outbound ACK, and other packets for the
                    connection. This method of connection initiation
                    corresponds to the 3-way handshake (defined in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>) and is supported by all NATs.
</p>
<p>Peer-to-peer applications use an alternate method of
                    connection initiation termed simultaneous-open (Fig. 8,
                    <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>) to traverse NATs. In the
                    Simultaneous-Open mode of operation, both peers send SYN
                    packets for the same TCP connection. The SYN packets cross
                    in the network. Upon receiving the other end's SYN packet
                    each end responds with a SYN-ACK packet, which also cross in
                    the network. The connection is considered established once
                    the SYN-ACKs are received. From the perspective of the NAT,
                    the internal host's SYN packet is met by an inbound SYN
                    packet for the same connection (as opposed to a SYN-ACK
                    packet during a 3-way handshake). Subsequent to this
                    exchange, both an outbound and an inbound SYN-ACK are seen
                    for the connection. Some NATs erroneously block the inbound
                    SYN for the connection in progress. Some NATs block or
                    incorrectly translate the outbound SYN-ACK. Such behavior
                    breaks TCP simultaneous-open and prevents peer-to-peer
                    applications from functioning correctly behind a NAT.
</p>
<p>In order to provide network address translation service for
                    TCP, it is necessary for a NAT to correctly receive,
                    translate, and forward all packets for a connection that
                    conform to valid transitions of the TCP State-Machine (Fig.
                    6, <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>).
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-2:</dt>
<dd>A NAT MUST support all valid sequences
                        of TCP packets (defined in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>)
                        for connections initiated both internally as well as
                        externally when the connection is permitted by the NAT.
                        In particular:

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>In addition to handling the TCP
                                3-way handshake mode of connection initiation,
                                A NAT MUST handle the TCP simultaneous-open
                                mode of connection initiation.
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>The intent of this requirement
                        is to allow standards compliant TCP stacks to traverse
                        NATs no matter what path the stacks take through the
                        TCP state-machine and no matter which end initiates the
                        connection as long as the connection is permitted by
                        the filtering policy of the NAT (filtering policy is
                        described in the following section).

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>In addition to TCP packets for a
                                3-Way Handshake, A NAT must be prepared to
                                accept an inbound SYN and an outbound SYN-ACK
                                for an internally initiated connection in order
                                to support Simultaneous-Open.
</dd>
</dl></blockquote>

                    
</dd>
</dl></blockquote>

<a name="sec-ef"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Externally Initiated Connections</h3>

<p>The NAT allocates a mapping for the first connection
                    initiated by an internal endpoint to an external endpoint.
                    In some scenarios, the NAT's policy may allow this mapping
                    to be reused for connections initiated from the external
                    side to the internal endpoint. Consider as before an
                    internal IP address and port (X:x) that is assigned (or
                    reuses) a mapping (X1':x1') when it initiates a connection
                    to an external (Y1:y1). An external endpoint (Y2:y2)
                    attempts to initiate a connection with the internal
                    endpoint by sending a SYN to (X1':x1'). A NAT can choose to
                    either allow the connection to be established, or to
                    disallow the connection. If the NAT chooses to allow the
                    connection, it translates the inbound SYN and routes it to
                    (X:x) as per the existing mapping. It also translates the
                    SYN-ACK generated by (X:x) in response and routes it to
                    (Y2:y2) and so on. Alternately, the NAT can disallow the
                    connection by filtering the inbound SYN. 
</p>
<p>A NAT may allow an existing mapping to be reused by an
                    externally initiated connection if its security policy
                    permits. Several different policies are possible as
                    described in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>. If a NAT allows
                    the connection initiation from all (Y2:y2) then it is
                    defined to have "Endpoint Independent Filtering" behavior.
                    If the NAT allows connection initiations only when Y2
                    equals Y1 then the NAT is defined to have "Address
                    Dependent Filtering" behavior. If the NAT allows connection
                    initiations only when (Y2:y2) equals (Y1:y1), then the NAT
                    is defined to have "Address and Port Dependent Filtering"
                    behavior (possible only shortly after the first connection
                    has been terminated but the mapping is still active). One
                    additional filtering behavior defined in this document is
                    when the NAT does not allow any connection initiations from
                    the external side; in such cases, the NAT is defined to
                    have "Connection Dependent Filtering" behavior. The
                    difference between "Address and Port Dependent Filtering"
                    and "Connection Dependent Filtering" behavior is that the
                    former permits an inbound SYN during the TIME_WAIT state of
                    the first connection to initiate a new connection while the
                    latter does not.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-3:</dt>
<dd>
                            If application transparency is most important, it
                            is RECOMMENDED that a NAT have an "Endpoint
                            independent filtering" behavior for TCP. If a more
                            stringent filtering behavior is most important, it
                            is RECOMMENDED that a NAT have an "Address
                            dependent filtering" behavior.
                            
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The filtering behavior MAY be
                                    an option configurable by the administrator
                                    of the NAT.
</dd>
<dt>b)</dt>
<dd>The filtering behavior for TCP
                                    MAY be independent of the filtering
                                    behavior for UDP.
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>The intent of this
                            requirement is to allow peer-to-peer applications
                            that do not always initiate connections from the
                            internal side of the NAT to continue to work in the
                            presence of NATs. This behavior also allows
                            applications behind a BEHAVE compliant NAT to
                            inter-operate with remote endpoints that are behind
                            non-BEHAVE compliant (legacy) NATs. If the remote
                            endpoint's NAT does not have endpoint independent
                            mapping behavior but has only one external IP
                            address, then an application can still traverse the
                            combination of the two NATs if the local NAT has
                            address dependent filtering. <a class='info' href='#sec-security'>Section&nbsp;9<span> (</span><span class='info'>Security considerations</span><span>)</span></a> contains a detailed
                            discussion on the security implications of this
                            requirement. 
</dd>
</dl></blockquote>

<p>If the inbound SYN packet is filtered, either because a
                    corresponding mapping does not exist or because of the
                    NAT's filtering behavior, a NAT has two basic choices: to
                    ignore the packet silently, or to signal an error to the
                    sender. Signaling an error through ICMP messages allows the
                    sender to quickly detect that the SYN did not reach the
                    intended destination. Silently dropping the packet, on the
                    other hand, allows applications to perform
                    Simultaneous-Open more reliably.
</p>
<p>Silently dropping the SYN aids Simultaneous-Open as follows.
                    Consider that the application is attempting a
                    Simultaneous-Open and the outbound SYN from the internal
                    endpoint has not yet crossed the NAT (due to network
                    congestion or clock skew between the two endpoints); this
                    outbound SYN would otherwise have created the necessary
                    mapping at the NAT to allow translation of the inbound SYN.
                    Since the outbound SYN did not reach the NAT in time, the
                    inbound SYN cannot be processed. If a NAT responds to the
                    premature inbound SYN with an error message that forces the
                    external endpoint to abandon the connection attempt, it
                    hinders applications performing a TCP simultaneous-open. If
                    instead the NAT silently ignores the inbound SYN, the
                    external endpoint retransmits the SYN after a TCP timeout.
                    In the meantime, the NAT creates the mapping in response to
                    the (delayed) outbound SYN such that the retransmitted
                    inbound SYN can be routed and simultaneous-open can
                    succeed. The down-side to this behavior is that in the
                    event the inbound SYN is erroneous, the remote side does
                    not learn of the error until after several TCP timeouts.
                
</p>
<p>NAT support for simultaneous-open as well as quickly
                    signaling errors are both important for applications.
                    Unfortunately, there is no way for a NAT to signal an error
                    without forcing the endpoint to abort a potential
                    simultaneous-open: TCP RST and ICMP Port Unreachable
                    packets require the endpoint to abort the attempt while
                    ICMP Host and Network Unreachable errors may adversely
                    affect other connections to the same host or network <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>.
</p>
<p>In addition, when an unsolicited SYN is received by the NAT,
                    the NAT may not know whether the application is attempting a
                    simultaneous-open (and that it should therefore silently
                    drop the SYN) or whether the SYN is in error (and that it
                    should notify the sender).
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-4:</dt>
<dd>A NAT MUST NOT respond to an
                            unsolicited inbound SYN packet for at least 6 seconds
                            after the packet is received. If during this interval
                            the NAT receives and translates an outbound SYN for the
                            connection the NAT MUST silently drop the original
                            unsolicited inbound SYN packet. Otherwise the NAT
                            SHOULD send an ICMP Port Unreachable error (Type 3,
                            Code 3) for the original SYN, unless REQ-4a applies.
                            
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The NAT MUST silently drop the
                                    original SYN packet if sending a response
                                    violates the security policy of the NAT. 
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd> The intent of this
                            requirement is to allow simultaneous-open to work
                            reliably in the presence of NATs as well as to
                            quickly signal an error in case the unsolicited SYN
                            is in error. As of writing this memo, it is not
                            possible to achieve both; the requirement therefore
                            represents a compromise. The NAT should tolerate
                            some delay in the outbound SYN for a TCP
                            simultaneous-open, which may be due to network
                            congestion or loose synchronization between the
                            endpoints. If the unsolicited SYN is not part of a
                            simultaneous-open attempt and is in error, the NAT
                            should endeavor to signal the error in accordance
                            with <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>.

                            
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>There may, however, be reasons
                                    for the NAT to rate-limit or omit such
                                    error notifications, for example in the
                                    case of an attack. Silently dropping the
                                    SYN packet when under attack allows
                                    simultaneous-open to work without consuming
                                    any extra network bandwidth or revealing
                                    the presence of the NAT to attackers. <a class='info' href='#sec-security'>Section&nbsp;9<span> (</span><span class='info'>Security considerations</span><span>)</span></a> mentions the
                                    security considerations for this
                                    requirement. 
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<p>For NATs that combine NAT functionality with end-host
                    functionality (e.g. an end-host that also serves as a NAT
                    for other hosts behind it), REQ-4 above applies only to
                    SYNs intended for the NAT'ed hosts and not to SYNs intended
                    for the NAT itself. One way to determine whether the
                    inbound SYN is intended for a NAT'ed host is to allocate
                    NAT mappings from one port range, and allocate ports for
                    local endpoints from a different non-overlapping port
                    range. More dynamic implementations can be imagined.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
NAT Session Refresh</h3>

<p>A NAT maintains state associated with in-progress and
                established connections. Because of this, a NAT is susceptible
                to a resource-exhaustion attack whereby an attacker (or virus)
                on the internal side attempts to cause the NAT to create more
                state than it has resources for. To prevent such an attack, a
                NAT needs to abandon sessions in order to free the state
                resources.
</p>
<p>A common method that is applicable only to TCP is to
                preferentially abandon sessions for crashed endpoints, followed
                by closed TCP connections and partially-open connections. A NAT
                can check if an endpoint for a session has crashed by sending a
                TCP keep-alive packet and receiving a TCP RST packet in
                response. If the NAT cannot determine whether the endpoint is
                active, it should not abandon the session until the TCP
                connection has been idle for some time. Note that an
                established TCP connection can stay idle (but live)
                indefinitely; hence there is no fixed value for an idle-timeout
                that accommodates all applications. However, a large
                idle-timeout motivated by recommendations in <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> can reduce the chances of abandoning a
                live session.
</p>
<p>A TCP connection passes through three phases: partially-open,
                established, and closing. During the partially-open phase,
                endpoints synchronize initial sequence numbers. The phase is
                initiated by the first SYN for the connection and extends until
                both endpoints have sent a packet with the ACK flag set (TCP
                states: SYN_SENT and SYN_RCVD). ACKs in both directions mark
                the beginning of the established phase where application data
                can be exchanged indefinitely (TCP states: ESTABLISHED,
                FIN_WAIT_1, FIN_WAIT_2, and CLOSE_WAIT). The closing phase
                begins when both endpoint have terminated their half of the
                connection by sending a FIN packet. Once FIN packets are seen
                in both directions, application data can no longer be exchanged
                but the stacks still need to ensure that the FIN packets are
                received (TCP states: CLOSING and LAST_ACK).
</p>
<p>TCP connections can stay in established phase indefinitely
                without exchanging any packets. Some end-hosts can be
                configured to send keep-alive packets on such idle connections;
                by default, such keep-alive packets are sent every 2 hours if
                enabled <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>. Consequently, a NAT that
                waits for slightly over 2 hours can detect idle connections with
                keep-alive packets being sent at the default rate. TCP
                connections in the partially-open or closing phases, on the
                other hand, can stay idle for at most 4 minutes while waiting
                for in-flight packets to be delivered <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>.
            
</p>
<p>The "established connection idle-timeout" for a NAT is defined
                as the minimum time a TCP connection in the established phase
                must remain idle before the NAT considers the associated
                session a candidate for removal. The "transitory connection
                idle-timeout" for a NAT is defined as the minimum time a TCP
                connection in the partially-open or closing phases must remain
                idle before the NAT considers the associated session a
                candidate for removal. TCP connections in the TIME_WAIT state
                are not affected by the "transitory connection
                idle-timeout".
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-5:</dt>
<dd>If a NAT cannot determine whether the
                        endpoints of a TCP connection are active, it MAY
                        abandon the session if it has been idle for some time.
                        In such cases, the value of the "established connection
                        idle-timeout" MUST NOT be less than 2 hours 4 minutes.
                        The value of the "transitory connection idle-timeout"
                        MUST NOT be less than 4 minutes.

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The value of the NAT idle-timeouts
                                MAY be configurable.
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>The intent of this requirement
                        is to minimize the cases where a NAT abandons session
                        state for a live connection. While some NATs may choose
                        to abandon sessions reactively in response to new
                        connection initiations (allowing idle connections to
                        stay up indefinitely in the absence of new
                        initiations), other NATs may choose to proactively reap
                        idle sessions. In cases where the NAT cannot actively
                        determine if the connection is alive, this requirement
                        ensures that applications can send keep-alive packets
                        at the default rate (every 2 hours) such that the NAT
                        can passively determine that the connection is alive.
                        The additional 4 minutes allows time for in-flight
                        packets to cross the NAT. 
</dd>
</dl></blockquote>

<p>NAT behavior for handling RST packets, or connections in
                TIME_WAIT state is left unspecified. A NAT MAY hold state for a
                connection in TIME_WAIT state to accommodate retransmissions of
                the last ACK. However, since the TIME_WAIT state is commonly
                encountered by internal endpoints properly closing the TCP
                connection, holding state for a closed connection may limit the
                throughput of connections through a NAT with limited resources.
                <a class='info' href='#RFC1337'>[RFC1337]<span> (</span><span class='info'>Braden, B., &ldquo;TIME-WAIT Assassination Hazards in TCP,&rdquo; May&nbsp;1992.</span><span>)</span></a> describes hazards associated
                with TIME_WAIT assassination. 
</p>
<p>The handling of non-SYN packets for connections for which there
                is no active mapping is left unspecified. Such packets may be
                received if the NAT silently abandons a live connection, or
                abandons a connection in TIME_WAIT state before the 4 minute
                TIME_WAIT period expires. The decision to either silently drop
                such packets or to respond with a TCP RST packet is left up to
                the implementation.
</p>
<p>NAT behavior for notifying endpoints when abandoning live
                connections is left unspecified. When a NAT abandons a live
                connection, for example due to a timeout expiring, the NAT MAY
                either send TCP RST packets to the endpoints or MAY silently
                abandon the connection. Sending a RST notification allows
                endpoint applications to recover more quickly, however,
                notifying the endpoints may not always be possible if, for
                example, session state it lost due to a power failure.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Application Level Gateways</h3>

<p>Application Level Gateways (ALGs) in certain NATs modify IP
                addresses and TCP ports embedded inside application protocols.
                Such ALGs may interfere with UNSAF methods or protocols that
                try to be NAT-aware and must therefore be used with extreme
                caution.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-6:</dt>
<dd>If a NAT includes ALGs that affect
                        TCP, it is RECOMMENDED that all of those ALGs (except
                        for FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>) be disabled by
                        default. 
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>The intent of this requirement is
                    to prevents ALGs from interfering with UNSAF methods. The
                    default state of a FTP ALG is left unspecified because of
                    legacy concerns: as of writing this memo, a large fraction
                    of legacy FTP clients do not enable passive (PASV) mode by default
                    and require an ALG to traverse NATs.
</dd>
</dl></blockquote>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Other Requirements Applicable to TCP</h3>

<p>A list of general and UDP specific NAT behavioral requirements
                are described in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>. A list of ICMP
                specific NAT behavioral requirements are described in <a class='info' href='#BEHAVE-ICMP'>[BEHAVE&#8209;ICMP]<span> (</span><span class='info'>Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;NAT Behavioral Requirements for ICMP protocol,&rdquo; .</span><span>)</span></a>. The requirements listed below
                reiterate the requirements from these two documents that
                directly affect TCP. The following requirements do not relax
                any requirements in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> or <a class='info' href='#BEHAVE-ICMP'>[BEHAVE&#8209;ICMP]<span> (</span><span class='info'>Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;NAT Behavioral Requirements for ICMP protocol,&rdquo; .</span><span>)</span></a>. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Port Assignment</h3>

<p>NATs that allow different internal endpoints to
                    simultaneously use the same mapping are defined in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> to have a "Port assignment"
                    behavior of "Port overloading". Such behavior is
                    undesirable as it prevents two internal endpoints sharing
                    the same mapping from establishing simultaneous connections
                    to a common external endpoint.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-7</dt>
<dd>A NAT MUST NOT have a "Port
                            assignment" behavior of "Port overloading" for TCP.
                        
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>This requirement allows
                            two applications on the internal side of the NAT to
                            consistently communicate with the same destination.
                        
</dd>
</dl></blockquote>

<p>NAT behavior for preserving the source TCP port range for
                    connections is left unspecified. Some applications expect
                    the source TCP port to be in the well-known range (TCP
                    ports from 0 to 1023).  The "r" series of commands (rsh,
                    rcp, rlogin, etc.) are an example. NATs that preserve the
                    range from which the source port is picked allow such
                    applications to function properly through the NAT, however,
                    by doing so the NAT may compromise the security of the
                    application in certain situations; applications that depend
                    only on the IP address and source TCP port range for
                    security (the "r" commands for example) cannot distinguish
                    between an attacker and a legitimate user behind the same
                    NAT. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Hairpinning Behavior</h3>

<p>NATs that forward packets originating from an internal
                    address, destined for an external address that matches the
                    active mapping for an internal address, back to that
                    internal address are defined in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>
                    as supporting "hairpinning". If the NAT presents the
                    hairpinned packet with an external source IP address and
                    port (i.e. the mapped source address and port of the
                    originating internal endpoint), then it is defined to have
                    "External source IP address and port" for hairpinning.
                    Hairpinning is necessary to allow two internal endpoints
                    (known to each other only by their external mapped
                    addresses) to communicate with each other. "External source
                    IP address and port" behavior for hairpinning avoids
                    confusing implementations that expect the external source
                    address and port.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-8:</dt>
<dd> A NAT MUST support
                            "Hairpinning" for TCP.

                            
<blockquote class="text"><dl>
<dt>a)</dt>
<dd> A NAT's
                                    Hairpinning behavior MUST be of type
                                    "External source IP address and port".
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>This requirement allows
                            two applications behind the same NAT that are
                            trying to communicate with each other using their
                            external addresses.

                            
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>Using the
                                    external source address and port for the
                                    hairpinned packet is necessary for
                                    applications that do not expect to receive
                                    a packet from a different address than the
                                    external address they are trying to
                                    communicate with.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
ICMP Responses to TCP Packets</h3>

<p>Several TCP mechanisms depend on the reception of ICMP error
                    messages triggered by the transmission of TCP segments. One
                    such mechanism is path MTU discovery <a class='info' href='#RFC1191'>[RFC1191]<span> (</span><span class='info'>Mogul, J. and S. Deering, &ldquo;Path MTU discovery,&rdquo; November&nbsp;1990.</span><span>)</span></a>, which is required for the correct
                    operation of TCP. The current path MTU discovery mechanism
                    requires the sender of TCP segments to be notified of ICMP
                    "Datagram Too Big" responses.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-9:</dt>
<dd>If a NAT translates TCP, it SHOULD
                            translate ICMP Destination Unreachable (Type 3)
                            messages.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>Translating ICMP
                            Destination Unreachable messages, particularly the
                            "Fragmentation Needed and Don't Fragment was Set"
                            (Type 3, Code 4) message avoids communication
                            failures ("black holes" <a class='info' href='#RFC2923'>[RFC2923]<span> (</span><span class='info'>Lahey, K., &ldquo;TCP Problems with Path MTU Discovery,&rdquo; September&nbsp;2000.</span><span>)</span></a>).
                            Furthermore, TCP's connection establishment and
                            maintenance mechanisms also behave much more
                            efficiently when ICMP Destination Unreachable
                            messages arrive in response to outgoing TCP
                            segments.
</dd>
<dt></dt>
<dd>
</dd>
<dt>REQ-10:</dt>
<dd> Receipt of any sort of ICMP
                            message MUST NOT terminate the NAT mapping or TCP
                            connection for which the ICMP was generated. 
</dd>
<dt></dt>
<dd>
</dd>
<dt>Justification:</dt>
<dd>This is necessary for
                            reliably performing TCP simultaneous-open where a
                            remote NAT may temporarily signal an ICMP
                            error.
</dd>
</dl></blockquote>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Requirements</h3>

<p>A NAT that supports all of the mandatory requirements of this
                specification (i.e., the "MUST") and is compliant with <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>, is "compliant with this
                specification".  A NAT that supports all of the requirements of
                this specification (i.e., included the "RECOMMENDED") and is
                fully compliant with <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> is "fully
                compliant with all the mandatory and recommended requirements
                of this specification".
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-1:</dt>
<dd>A NAT MUST have an "Endpoint
                        Independent Mapping" behavior for TCP.
</dd>
<dt>REQ-2:</dt>
<dd>A NAT MUST support all valid sequences
                        of TCP packets (defined in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>)
                        for connections initiated both internally as well as
                        externally when the connection is permitted by the NAT.
                        In particular:

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>In addition to handling the TCP
                                3-way handshake mode of connection initiation,
                                A NAT MUST handle the TCP simultaneous-open
                                mode of connection initiation.
</dd>
</dl></blockquote>
</dd>
<dt>REQ-3:</dt>
<dd>
                        If application transparency is most important, it
                        is RECOMMENDED that a NAT have an "Endpoint
                        independent filtering" behavior for TCP. If a more
                        stringent filtering behavior is most important, it
                        is RECOMMENDED that a NAT have an "Address
                        dependent filtering" behavior.
                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The filtering behavior MAY be
                                an option configurable by the administrator
                                of the NAT.
</dd>
<dt>b)</dt>
<dd>The filtering behavior for TCP
                                MAY be independent of the filtering
                                behavior for UDP.
</dd>
</dl></blockquote>
</dd>
<dt>REQ-4:</dt>
<dd>A NAT MUST NOT respond to an
                        unsolicited inbound SYN packet for at least 6 seconds
                        after the packet is received. If during this interval
                        the NAT receives and translates an outbound SYN for the
                        connection the NAT MUST silently drop the original
                        unsolicited inbound SYN packet. Otherwise the NAT
                        SHOULD send an ICMP Port Unreachable error (Type 3,
                        Code 3) for the original SYN, unless REQ-4a applies.
                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The NAT MUST silently drop the
                                original SYN packet if sending a response
                                violates the security policy of the NAT. 
</dd>
</dl></blockquote>
</dd>
<dt>REQ-5:</dt>
<dd>If a NAT cannot determine whether the
                        endpoints of a TCP connection are active, it MAY
                        abandon the session if it has been idle for some time.
                        In such cases, the value of the "established connection
                        idle-timeout" MUST NOT be less than 2 hours 4 minutes.
                        The value of the "transitory connection idle-timeout"
                        MUST NOT be less than 4 minutes.

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd>The value of the NAT idle-timeouts
                                MAY be configurable.
</dd>
</dl></blockquote>
</dd>
<dt>REQ-6:</dt>
<dd>If a NAT includes ALGs that affect
                        TCP, it is RECOMMENDED that all of those ALGs (except
                        for FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>) be disabled by
                        default. 
</dd>
</dl></blockquote>

<p>The following requirements reiterate requirements
                from <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> or <a class='info' href='#BEHAVE-ICMP'>[BEHAVE&#8209;ICMP]<span> (</span><span class='info'>Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;NAT Behavioral Requirements for ICMP protocol,&rdquo; .</span><span>)</span></a> that directly affect TCP. This
                document does not relax any requirements in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> or <a class='info' href='#BEHAVE-ICMP'>[BEHAVE&#8209;ICMP]<span> (</span><span class='info'>Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;NAT Behavioral Requirements for ICMP protocol,&rdquo; .</span><span>)</span></a>.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-7</dt>
<dd>A NAT MUST NOT have a "Port assignment"
                        behavior of "Port overloading" for TCP. 
</dd>
<dt>REQ-8:</dt>
<dd> A NAT MUST support
                        "Hairpinning" for TCP.

                        
<blockquote class="text"><dl>
<dt>a)</dt>
<dd> A NAT's
                                Hairpinning behavior MUST be of type
                                    "External source IP address and port".
</dd>
</dl></blockquote>
</dd>
<dt>REQ-9:</dt>
<dd>If a NAT translates TCP, it
                        SHOULD translate ICMP Destination Unreachable
                        (Type 3) messages.
</dd>
<dt>REQ-10:</dt>
<dd> Receipt of any sort of ICMP message
                        MUST NOT terminate the NAT mapping or TCP connection
                        for which the ICMP was generated. 
</dd>
</dl></blockquote>

<a name="sec-security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security considerations</h3>

<p><a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> discusses security considerations
                for NATs that handle IP and unicast UDP traffic. Security
                concerns specific to handling TCP packets are discussed in this
                section.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Security considerations for REQ-1:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-2:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns. Simultaneous-open and other
                        transitions in the TCP state machine are by-design and
                        necessary for TCP to work correctly in all scenarios.
                        Further, this requirement only affects connections
                        already in progress as authorized by the NAT in
                        accordance with its policy.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-3:</dt>
<dd>The
                        security provided by the NAT is governed by its
                        filtering behavior as addressed in <a class='info' href='#BEHAVE-UDP'>[BEHAVE&#8209;UDP]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>. Connection dependent
                        filtering behavior is most secure from a firewall
                        perspective, but severely restricts connection
                        initiations through a NAT. Endpoint independent
                        filtering behavior, which is most transparent to
                        applications, requires an attacker to guess the IP
                        address and port of an active mapping in order to get
                        his packet to an internal host. Address dependent
                        filtering, on the other hand, is less transparent than
                        endpoint independent filtering but more transparent
                        than connection dependent filtering; it is more secure
                        than endpoint independent filtering as it requires an
                        attacker to additionally guess the address of the
                        external endpoint for a NAT session associated with the
                        mapping and be able to receive packets addressed to the
                        same. While this protects against most attackers on the
                        Internet, it does not necessarily protect against
                        attacks that originate from behind a remote NAT with a
                        single IP address that is also translating a legitimate
                        connection to the victim.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-4:</dt>
<dd>This
                        document recommends a NAT to respond to unsolicited
                        inbound SYN packets with an ICMP error delayed by a few
                        seconds. Doing so may reveal the presence of a NAT to
                        an external attacker. Silently dropping the SYN makes
                        it harder to diagnose network problems and forces
                        applications to wait for the TCP stack to finish
                        several retransmissions before reporting an error. An
                        implementer must therefore understand and carefully
                        weigh the effects of not sending an ICMP error or
                        rate-limiting such ICMP errors to a very small number.
                    
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-5:</dt>
<dd>This
                        document recommends that a NAT that passively monitors
                        TCP state keep idle sessions alive for at least 2 hours
                        4 minutes or 4 minutes depending on the state of the
                        connection. If a NAT is under attack, it may attempt to
                        actively determine the liveliness of a TCP connection or
                        let the NAT administrator configure more
                        conservative timeouts.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-6:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-7:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-8:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-9:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
<dt></dt>
<dd>
</dd>
<dt>Security considerations for REQ-10:</dt>
<dd>This
                        requirement does not introduce any TCP-specific
                        security concerns.
</dd>
</dl></blockquote>

<p>NAT implementations that modify TCP sequence numbers (e.g., for
                privacy reasons or for ALG support) must ensure that TCP
                packets with SACK notifications <a class='info' href='#RFC2018'>[RFC2018]<span> (</span><span class='info'>Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, &ldquo;TCP Selective Acknowledgment Options,&rdquo; October&nbsp;1996.</span><span>)</span></a> are
                properly handled.
</p>
<p>NAT implementations that modify local state based on TCP flags
                in packets must ensure that out-of-window TCP packets are
                properly handled. <a class='info' href='#RFC4953'>[RFC4953]<span> (</span><span class='info'>Touch, J., &ldquo;Defending TCP Against Spoofing Attacks,&rdquo; July&nbsp;2007.</span><span>)</span></a> summarizes and
                discusses a variety of solutions designed to prevent attackers
                from affecting TCP connections. 
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA considerations</h3>

<p>This document does not change or create any IANA-registered
                values.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgments</h3>

<p>Joe Touch contributed the mechanism for handling unsolicited
                inbound SYNs. Thanks to Mark Allman, Franois Audet, Lars
                Eggert, Paul Francis, Fernando Gont, Sam Hartman, Paul Hoffman,
                Dave Hudson, Cullen Jennings, Philip Matthews, Tom Petch,
                Magnus Westerlund, and Dan Wing for their many contributions,
                comments and suggestions.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BEHAVE-UDP">[BEHAVE-UDP]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4787.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0959">[RFC0959]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc959">File Transfer Protocol</a>,&rdquo; STD&nbsp;9, RFC&nbsp;959, October&nbsp;1985 (<a href="http://www.rfc-editor.org/rfc/rfc959.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1122">[RFC1122]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1122">Requirements for Internet Hosts - Communication Layers</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1122, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1191">[RFC1191]</a></td>
<td class="author-text"><a href="mailto:mogul@decwrl.dec.com">Mogul, J.</a> and <a href="mailto:deering@xerox.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1191">Path MTU discovery</a>,&rdquo; RFC&nbsp;1191, November&nbsp;1990 (<a href="http://www.rfc-editor.org/rfc/rfc1191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BEHAVE-ICMP">[BEHAVE-ICMP]</a></td>
<td class="author-text">Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-nat-icmp.txt">NAT Behavioral Requirements for ICMP protocol</a>,&rdquo; draft-ietf-behave-nat-icmp (work in progress).</td></tr>
<tr><td class="author-text" valign="top"><a name="NATBLASTER">[NATBLASTER]</a></td>
<td class="author-text">Biggadike, A., Ferullo, D., Wilson, G., and A. Perrig, &ldquo;NATBLASTER: Establishing TCP connections between hosts behind NATs,&rdquo; Proceedings of the ACM SIGCOMM Asia Workshop&nbsp;(Beijing, China), April&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="P2PNAT">[P2PNAT]</a></td>
<td class="author-text">Ford, B., Srisuresh, P., and D. Kegel, &ldquo;Peer-to-peer communication across network address translators,&rdquo; Proceedings of the USENIX Annual Technical Conference&nbsp;(Anaheim, CA), April&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1337">[RFC1337]</a></td>
<td class="author-text"><a href="mailto:EMail: Braden@ISI.EDU">Braden, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1337">TIME-WAIT Assassination Hazards in TCP</a>,&rdquo; RFC&nbsp;1337, May&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1337.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1644">[RFC1644]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1644">T/TCP -- TCP Extensions for Transactions Functional Specification</a>,&rdquo; RFC&nbsp;1644, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1644.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2018">[RFC2018]</a></td>
<td class="author-text"><a href="mailto:mathis@psc.edu">Mathis, M.</a>, <a href="mailto:mahdavi@psc.edu">Mahdavi, J.</a>, <a href="mailto:floyd@ee.lbl.gov">Floyd, S.</a>, and <a href="mailto:allyn@eng.sun.com">A. Romanow</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2018">TCP Selective Acknowledgment Options</a>,&rdquo; RFC&nbsp;2018, October&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2018.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2018.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2018.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2663">[RFC2663]</a></td>
<td class="author-text"><a href="mailto:srisuresh@lucent.com">Srisuresh, P.</a> and <a href="mailto:holdrege@lucent.com">M. Holdrege</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2663">IP Network Address Translator (NAT) Terminology and Considerations</a>,&rdquo; RFC&nbsp;2663, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2663.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2923">[RFC2923]</a></td>
<td class="author-text">Lahey, K., &ldquo;<a href="http://tools.ietf.org/html/rfc2923">TCP Problems with Path MTU Discovery</a>,&rdquo; RFC&nbsp;2923, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2923.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3022">[RFC3022]</a></td>
<td class="author-text">Srisuresh, P. and K. Egevang, &ldquo;<a href="http://tools.ietf.org/html/rfc3022">Traditional IP Network Address Translator (Traditional NAT)</a>,&rdquo; RFC&nbsp;3022, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3022.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4614">[RFC4614]</a></td>
<td class="author-text">Duke, M., Braden, R., Eddy, W., and E. Blanton, &ldquo;<a href="http://tools.ietf.org/html/rfc4614">A Roadmap for Transmission Control Protocol (TCP) Specification Documents</a>,&rdquo; RFC&nbsp;4614, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4614.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4953">[RFC4953]</a></td>
<td class="author-text">Touch, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4953">Defending TCP Against Spoofing Attacks</a>,&rdquo; RFC&nbsp;4953, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4953.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="STUNT">[STUNT]</a></td>
<td class="author-text">Guha, S. and P. Francis, &ldquo;NUTSS: A SIP based approach to UDP and TCP connectivity,&rdquo; Proceedings of the ACM SIGCOMM Workshop on Future Directions in Network Architecture&nbsp;(Portland, OR), August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="TCPTRAV">[TCPTRAV]</a></td>
<td class="author-text">Guha, S. and P. Francis, &ldquo;Characterization and Measurement of TCP Traversal through NATs and Firewalls,&rdquo; Proceedings of the Internet Measurement Conference&nbsp;(Berkeley, CA), October&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saikat Guha (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cornell University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">331 Upson Hall</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ithaca, NY  14853</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 607 255 1008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:saikat@cs.cornell.edu">saikat@cs.cornell.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kaushik Biswas</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 525 5134</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kbiswas@cisco.com">kbiswas@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bryan Ford</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">M.I.T.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Laboratory for Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">77 Massachusetts Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cambridge, MA  02139</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 617 253 5261</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:baford@mit.edu">baford@mit.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Senthil Sivakumar</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7100-8 Kit Creek Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box 14987</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Research Triangle Park, NC  27709-4987</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 919 392 5158</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ssenthil@cisco.com">ssenthil@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pyda Srisuresh</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Consultant</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">20072 Pacifica Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 836 4773</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:srisuresh@yahoo.com">srisuresh@yahoo.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
