<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The Lemonade Profile</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The Lemonade Profile">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">LEMONADE</td><td class="header">D. Cridland, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Melnikov, Ed.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Isode Limited</td></tr>
<tr><td class="header">Expires: April 3, 2009</td><td class="header">S. Maes, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Oracle</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 30, 2008</td></tr>
</table></td></tr></table>
<h1><br />The Lemonade Profile<br />draft-ietf-lemonade-profile-bis-11.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 3, 2009.</p>

<h3>Abstract</h3>

<p>This document describes a profile (a set of required extensions, restrictions and usage modes) of the IMAP and mail submission protocols. This profile allows clients 
		(especially those that are constrained in memory, bandwidth, processing power, or other areas) to efficiently use IMAP and Submission to access and submit mail. This includes the ability to forward received mail without needing to
		download and upload the mail, to optimize submission and to efficiently resynchronize in case of loss of connectivity with the server.
</p>
<p>The Lemonade profile relies upon several extensions to IMAP and Mail Submission protocols.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Conventions used in this document<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Summary of the required support<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Lemonade Submission Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Lemonade Message Stores<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lemonade-mda">3.3.</a>&nbsp;
Lemonade Message Delivery Agents<br />
<a href="#submit-gen">4.</a>&nbsp;
Lemonade Submission Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-fwd">4.1.</a>&nbsp;
Forward Without Download<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-pipelining">4.2.</a>&nbsp;
Pipelining<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-dsn">4.3.</a>&nbsp;
DSN Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-size">4.4.</a>&nbsp;
Message size declaration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-enhancedstatuscodes">4.5.</a>&nbsp;
Enhanced status code Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#esmtp-starttls">4.6.</a>&nbsp;
Encryption and Compression<br />
<a href="#store-gen">5.</a>&nbsp;
Lemonade Message Stores<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-condstore">5.1.</a>&nbsp;
Quick resynchronization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-bodypart">5.2.</a>&nbsp;
Message part handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-compression">5.3.</a>&nbsp;
Compression<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifications">5.4.</a>&nbsp;
Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-idle">5.4.1.</a>&nbsp;
IMAP Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#outband-notify">5.4.2.</a>&nbsp;
External Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-vfolder">5.5.</a>&nbsp;
Searching and View Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-mbox">5.6.</a>&nbsp;
Mailbox Handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-fwd">5.7.</a>&nbsp;
Forward Without Download<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#url-partial">5.7.1.</a>&nbsp;
Support for PARTIAL in CATENATE and URLAUTH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-other">5.8.</a>&nbsp;
Additional IMAP extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-fwd-keyword">5.9.</a>&nbsp;
Registration of $Forwarded IMAP keyword<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#imap-submission-keywords">5.10.</a>&nbsp;
Registration of $SubmitPending and $Submitted IMAP keywords<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.11.</a>&nbsp;
Related IMAP extensions<br />
<a href="#sieve-mda">6.</a>&nbsp;
Lemonade Message Delivery Agents<br />
<a href="#client-main">7.</a>&nbsp;
Lemonade Mail User Agents<br />
<a href="#fwd-main">8.</a>&nbsp;
Forward without download<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">8.1.</a>&nbsp;
Motivations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">8.2.</a>&nbsp;
Message Sending Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">8.3.</a>&nbsp;
Traditional Strategy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">8.4.</a>&nbsp;
Step by step description<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fwd-catenate">8.4.1.</a>&nbsp;
Message assembly using IMAP CATENATE extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fwd-chunking">8.4.2.</a>&nbsp;
Message assembly using SMTP CHUNKING and BURL extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">8.5.</a>&nbsp;
Security Considerations for pawn-tickets.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fcc-problem">8.6.</a>&nbsp;
Copies of Sent messages: The fcc problem<br />
<a href="#anchor12">9.</a>&nbsp;
Deployment Considerations<br />
<a href="#anchor13">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">10.1.</a>&nbsp;
Confidentiality Protection of Submitted Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">10.2.</a>&nbsp;
TLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">10.3.</a>&nbsp;
Additional extensions and deployment models<br />
<a href="#anchor17">11.</a>&nbsp;
IANA considerations<br />
<a href="#anchor18">12.</a>&nbsp;
Version history<br />
<a href="#anchor20">13.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Conventions used in this document</h3>

<p>In examples, "M:", "I:" and "S:" indicate lines sent by the client messaging user agent, IMAP e-mail server and SMTP submit server
		respectively.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
                NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
                described in <a class='info' href='#KEYWORDS'>[KEYWORDS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>. 
</p>
<p>Other capitalised words are typically names of extensions or commands - these are uppercased for clarity only, and are case-insensitive.
</p>
<p>All examples in this document are optimized for Lemonade use and
   might not represent examples of proper protocol usage for a general
   use Submit/IMAP client. In particular, examples assume that Submit and IMAP
   servers support all Lemonade extensions described in
   this document, so they do not demonstrate fallbacks in the absence of an
   extension.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>The Lemonade Profile, or simply Lemonade, provides enhancements to Internet email to support diverse
   service environments. Lemonade Mail Servers provide both a Lemonade Submission Server and a Lemonade Message Store, which are based on the existing <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> protocols respectively. They MAY also include a Lemonade Message Delivery Agent, which provides delivery-time filtering services based on <a class='info' href='#SIEVE'>[SIEVE]<span> (</span><span class='info'>Guenther, P. and T. Showalter, &ldquo;Sieve: An Email Filtering Language,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<p>This document describes the Lemonade profile that includes:
</p>
<ul class="text">
<li>General common enhancements to Internet Mail, described in <a class='info' href='#store-gen'>Section&nbsp;5<span> (</span><span class='info'>Lemonade Message Stores</span><span>)</span></a> and <a class='info' href='#submit-gen'>Section&nbsp;4<span> (</span><span class='info'>Lemonade Submission Servers</span><span>)</span></a>.
</li>
<li>"Forward without download" that describes exchanges between
           Lemonade clients and servers to allow to submit new email
           messages incorporating content which resides on locations
           external to the client, described in <a class='info' href='#fwd-main'>Section&nbsp;8<span> (</span><span class='info'>Forward without download</span><span>)</span></a>.
</li>
<li>Quick mailbox resynchronization, described in <a class='info' href='#imap-condstore'>Section&nbsp;5.1<span> (</span><span class='info'>Quick resynchronization</span><span>)</span></a>.
</li>
<li>Extensions to support more precise, and broader, notifications from the store in support of notifications and view filters, described in <a class='info' href='#imap-idle'>Section&nbsp;5.4.1<span> (</span><span class='info'>IMAP Notifications</span><span>)</span></a> and <a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a>.
</li>
<li>Delivery-time filtering in support of typical mail management use-cases, as described in <a class='info' href='#lemonade-mda'>Section&nbsp;3.3<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a>.
</li>
</ul>

<p>It is intended that the Lemonade profile support realizations of the OMA's mobile email enabler (MEM) (see <a class='info' href='#OMA-MEM-REQ'>[OMA&#8209;MEM&#8209;REQ]<span> (</span><span class='info'>Open Mobile Alliance, &ldquo;Mobile Email Requirements Document,&rdquo; Oct&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#OMA-MEM-ARCH'>[OMA&#8209;MEM&#8209;ARCH]<span> (</span><span class='info'>Open Mobile Alliance, &ldquo;Mobile Email Architecture Document,&rdquo; October&nbsp;2005.</span><span>)</span></a>) using Internet Mail protocols defined by the IETF.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Summary of the required support</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Lemonade Submission Servers</h3>

<p>Lemonade Submission Servers MUST provide a service as described in <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>, and MUST support the following. Note that the Lemonade Profile imposes further requirements for some cases, detailed in the sections cited.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">SMTP extension</th><th align="center">Reference</th><th align="center">Requirements</th></tr>
<tr>
<td align="center">PIPELINING</td>
<td align="center"><a class='info' href='#SMTP-PIPELINING'>[SMTP&#8209;PIPELINING]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Command Pipelining,&rdquo; September&nbsp;2000.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-pipelining'>Section&nbsp;4.2<span> (</span><span class='info'>Pipelining</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">DSN</td>
<td align="center"><a class='info' href='#SMTP-DSN'>[SMTP&#8209;DSN]<span> (</span><span class='info'>Moore, K., &ldquo;Simple Mail Transfer Protocol (SMTP) Service Extension for Delivery Status Notifications (DSNs),&rdquo; January&nbsp;2003.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-dsn'>Section&nbsp;4.3<span> (</span><span class='info'>DSN Support</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">SIZE</td>
<td align="center"><a class='info' href='#SMTP-SIZE'>[SMTP&#8209;SIZE]<span> (</span><span class='info'>Klensin, J., Freed, N., and K. Moore, &ldquo;SMTP Service Extension for Message Size Declaration,&rdquo; November&nbsp;1995.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-size'>Section&nbsp;4.4<span> (</span><span class='info'>Message size declaration</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ENHANCEDSTATUSCODES</td>
<td align="center"><a class='info' href='#SMTP-STATUSCODES'>[SMTP&#8209;STATUSCODES]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Returning Enhanced Error Codes,&rdquo; October&nbsp;1996.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-enhancedstatuscodes'>Section&nbsp;4.5<span> (</span><span class='info'>Enhanced status code Support</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">STARTTLS</td>
<td align="center"><a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-starttls'>Section&nbsp;4.6<span> (</span><span class='info'>Encryption and Compression</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">BURL imap</td>
<td align="center"><a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#fwd-main'>Section&nbsp;8<span> (</span><span class='info'>Forward without download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">BINARYMIME</td>
<td align="center"><a class='info' href='#SMTP-BINARYMIME'>[SMTP&#8209;BINARYMIME]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-fwd'>Section&nbsp;4.1<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CHUNKING</td>
<td align="center"><a class='info' href='#SMTP-BINARYMIME'>[SMTP&#8209;BINARYMIME]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#esmtp-fwd'>Section&nbsp;4.1<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">8BITMIME</td>
<td align="center"><a class='info' href='#SMTP-8BITMIME'>[SMTP&#8209;8BITMIME]<span> (</span><span class='info'>Klensin, J., Freed, N., Rose, M., Stefferud, E., and D. Crocker, &ldquo;SMTP Service Extension for 8bit-MIMEtransport,&rdquo; July&nbsp;1994.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">AUTH</td>
<td align="center"><a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />

<p>
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Lemonade Message Stores</h3>

<p>Lemonade Message Stores MUST provide a service as described in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>, and MUST support the following. Note that the Lemonade Profile imposes further requirements for some cases, detailed in the sections cited.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">IMAP extension</th><th align="center">Reference</th><th align="center">Requirements</th></tr>
<tr>
<td align="center">NAMESPACE</td>
<td align="center"><a class='info' href='#IMAP-NAMESPACE'>[IMAP&#8209;NAMESPACE]<span> (</span><span class='info'>Gahrns, M. and C. Newman, &ldquo;IMAP4 Namespace,&rdquo; May&nbsp;1998.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-mbox'>Section&nbsp;5.6<span> (</span><span class='info'>Mailbox Handling</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CONDSTORE</td>
<td align="center"><a class='info' href='#IMAP-CONDSTORE'>[IMAP&#8209;CONDSTORE]<span> (</span><span class='info'>Melnikov, A. and S. Hole, &ldquo;IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization,&rdquo; June&nbsp;2006.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-condstore'>Section&nbsp;5.1<span> (</span><span class='info'>Quick resynchronization</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">STARTTLS</td>
<td align="center"><a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a></td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">URLAUTH</td>
<td align="center"><a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-fwd'>Section&nbsp;5.7<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CATENATE</td>
<td align="center"><a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-fwd'>Section&nbsp;5.7<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">URL-PARTIAL</td>
<td align="center"><a class='info' href='#url-partial'>Section&nbsp;5.7.1<span> (</span><span class='info'>Support for PARTIAL in CATENATE and URLAUTH</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-fwd'>Section&nbsp;5.7<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">UIDPLUS</td>
<td align="center"><a class='info' href='#IMAP-UIDPLUS'>[IMAP&#8209;UIDPLUS]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - UIDPLUS extension,&rdquo; December&nbsp;2005.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-fwd'>Section&nbsp;5.7<span> (</span><span class='info'>Forward Without Download</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">LITERAL+</td>
<td align="center"><a class='info' href='#IMAP-LITERAL+'>[IMAP&#8209;LITERAL+]<span> (</span><span class='info'>Myers, J., &ldquo;IMAP4 non-synchronizing literals,&rdquo; January&nbsp;1997.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-other'>Section&nbsp;5.8<span> (</span><span class='info'>Additional IMAP extensions</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">IDLE</td>
<td align="center"><a class='info' href='#IMAP-IDLE'>[IMAP&#8209;IDLE]<span> (</span><span class='info'>Leiba, B., &ldquo;IMAP4 IDLE command,&rdquo; June&nbsp;1997.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-idle'>Section&nbsp;5.4.1<span> (</span><span class='info'>IMAP Notifications</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">NOTIFY</td>
<td align="center"><a class='info' href='#IMAP-NOTIFY'>[IMAP&#8209;NOTIFY]<span> (</span><span class='info'>Gulbrandsen, A., Melnikov, A., and C. King, &ldquo;The IMAP NOTIFY Extension,&rdquo; August&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-idle'>Section&nbsp;5.4.1<span> (</span><span class='info'>IMAP Notifications</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">$Forwarded keyword</td>
<td align="center">-</td>
<td align="center"><a class='info' href='#imap-fwd-keyword'>Section&nbsp;5.9<span> (</span><span class='info'>Registration of $Forwarded IMAP keyword</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">$SubmitPending keyword</td>
<td align="center">-</td>
<td align="center"><a class='info' href='#imap-submission-keywords'>Section&nbsp;5.10<span> (</span><span class='info'>Registration of $SubmitPending and $Submitted IMAP keywords</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">$Submitted keyword</td>
<td align="center">-</td>
<td align="center"><a class='info' href='#imap-submission-keywords'>Section&nbsp;5.10<span> (</span><span class='info'>Registration of $SubmitPending and $Submitted IMAP keywords</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">BINARY</td>
<td align="center"><a class='info' href='#IMAP-BINARY'>[IMAP&#8209;BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-bodypart'>Section&nbsp;5.2<span> (</span><span class='info'>Message part handling</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">QRESYNC</td>
<td align="center"><a class='info' href='#IMAP-QRESYNC'>[IMAP&#8209;QRESYNC]<span> (</span><span class='info'>Melnikov, A., Cridland, D., and C. Wilson, &ldquo;IMAP4 Extensions for Quick Mailbox Resynchronization,&rdquo; March&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-condstore'>Section&nbsp;5.1<span> (</span><span class='info'>Quick resynchronization</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ENABLE</td>
<td align="center"><a class='info' href='#IMAP-ENABLE'>[IMAP&#8209;ENABLE]<span> (</span><span class='info'>Gulbrandsen, A. and A. Melnikov, &ldquo;The IMAP ENABLE Extension,&rdquo; March&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-condstore'>Section&nbsp;5.1<span> (</span><span class='info'>Quick resynchronization</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ESEARCH</td>
<td align="center"><a class='info' href='#IMAP-ESEARCH'>[IMAP&#8209;ESEARCH]<span> (</span><span class='info'>Melnikov, A. and D. Cridland, &ldquo;IMAP4 Extension to SEARCH Command for Controlling What Kind of Information Is Returned,&rdquo; November&nbsp;2006.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CONTEXT=SEARCH</td>
<td align="center"><a class='info' href='#IMAP-CONTEXT'>[IMAP&#8209;CONTEXT]<span> (</span><span class='info'>Cridland, D. and C. King, &ldquo;Contexts for IMAP4,&rdquo; July&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">SORT</td>
<td align="center"><a class='info' href='#IMAP-SORT'>[IMAP&#8209;SORT]<span> (</span><span class='info'>Crispin, M. and K. Murchison, &ldquo;Internet Message Access Protocol - SORT and THREAD Extensions,&rdquo; June&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ESORT</td>
<td align="center"><a class='info' href='#IMAP-CONTEXT'>[IMAP&#8209;CONTEXT]<span> (</span><span class='info'>Cridland, D. and C. King, &ldquo;Contexts for IMAP4,&rdquo; July&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CONTEXT=SORT</td>
<td align="center"><a class='info' href='#IMAP-CONTEXT'>[IMAP&#8209;CONTEXT]<span> (</span><span class='info'>Cridland, D. and C. King, &ldquo;Contexts for IMAP4,&rdquo; July&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-vfolder'>Section&nbsp;5.5<span> (</span><span class='info'>Searching and View Filters</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">CONVERT</td>
<td align="center"><a class='info' href='#IMAP-CONVERT'>[IMAP&#8209;CONVERT]<span> (</span><span class='info'>Melnikov, A. and P. Coates, &ldquo;Internet Message Access Protocol - CONVERT Extension,&rdquo; July&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-bodypart'>Section&nbsp;5.2<span> (</span><span class='info'>Message part handling</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">COMPRESS=DEFLATE</td>
<td align="center"><a class='info' href='#IMAP-COMPRESS'>[IMAP&#8209;COMPRESS]<span> (</span><span class='info'>Gulbrandsen, A., &ldquo;The IMAP COMPRESS Extension,&rdquo; August&nbsp;2007.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-compression'>Section&nbsp;5.3<span> (</span><span class='info'>Compression</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">I18NLEVEL=1</td>
<td align="center"><a class='info' href='#IMAP-I18N'>[IMAP&#8209;I18N]<span> (</span><span class='info'>Newman, C., Gulbrandsen, A., and A. Melnikov, &ldquo;Internet Message Access Protocol Internationalization,&rdquo; June&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-other'>Section&nbsp;5.8<span> (</span><span class='info'>Additional IMAP extensions</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">SASL-IR</td>
<td align="center"><a class='info' href='#IMAP-SASL-IR'>[IMAP&#8209;SASL&#8209;IR]<span> (</span><span class='info'>Siemborski, R. and A. Gulbrandsen, &ldquo;IMAP Extension for Simple Authentication and Security Layer (SASL) Initial Client Response,&rdquo; September&nbsp;2007.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#imap-other'>Section&nbsp;5.8<span> (</span><span class='info'>Additional IMAP extensions</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />

<p>In addition to this list, any Lemonade Message Stores MUST send the CAPABILITY
response code (see Section 7.1 of <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>) in
the initial server greeting and after the LOGIN/AUTHENTICATE commands.
</p>
<p>
</p>
<a name="lemonade-mda"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Lemonade Message Delivery Agents</h3>

<p>Lemonade Message Delivery Agents MUST support Sieve mail filtering language as described
in <a class='info' href='#SIEVE'>[SIEVE]<span> (</span><span class='info'>Guenther, P. and T. Showalter, &ldquo;Sieve: An Email Filtering Language,&rdquo; January&nbsp;2008.</span><span>)</span></a>, and MUST support the following Sieve extensions.
Note that the Lemonade Profile imposes further requirements for some cases, detailed in the
sections cited.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Sieve extension</th><th align="center">Reference</th><th align="center">Requirements</th></tr>
<tr>
<td align="center">VACATION</td>
<td align="center"><a class='info' href='#SIEVE-VACATION'>[SIEVE&#8209;VACATION]<span> (</span><span class='info'>Showalter, T. and N. Freed, &ldquo;Sieve Email Filtering: Vacation Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ENOTIFY</td>
<td align="center"><a class='info' href='#SIEVE-NOTIFY'>[SIEVE&#8209;NOTIFY]<span> (</span><span class='info'>Melnikov, A., Leiba, B., Segmuller, W., and T. Martin, &ldquo;SIEVE Email Filtering: Extension for Notifications,&rdquo; December&nbsp;2007.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">VARIABLES</td>
<td align="center"><a class='info' href='#SIEVE-VARIABLES'>[SIEVE&#8209;VARIABLES]<span> (</span><span class='info'>Homme, K., &ldquo;Sieve Email Filtering: Variables Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">RELATIONAL</td>
<td align="center"><a class='info' href='#SIEVE-RELATIONAL'>[SIEVE&#8209;RELATIONAL]<span> (</span><span class='info'>Segmuller, W. and B. Leiba, &ldquo;Sieve Email Filtering: Relational Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">IMAP4FLAGS</td>
<td align="center"><a class='info' href='#SIEVE-IMAP4FLAGS'>[SIEVE&#8209;IMAP4FLAGS]<span> (</span><span class='info'>Melnikov, A., &ldquo;Sieve Email Filtering: Imap4flags Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">comparator-i;unicode-casemap</td>
<td align="center"><a class='info' href='#UNICODE-CASEMAP'>[UNICODE&#8209;CASEMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;i;unicode-casemap - Simple Unicode Collation Algorithm,&rdquo; October&nbsp;2007.</span><span>)</span></a></td>
<td align="center"><a class='info' href='#sieve-mda'>Section&nbsp;6<span> (</span><span class='info'>Lemonade Message Delivery Agents</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />

<p>Lemonade Message Delivery Agents should also consider supporting a Sieve script management protocol,
such as <a class='info' href='#MANAGESIEVE'>[MANAGESIEVE]<span> (</span><span class='info'>Melnikov, A. and T. Martin, &ldquo;A Protocol for Remotely Managing Sieve Scripts,&rdquo; September&nbsp;2008.</span><span>)</span></a>.
</p>
<p>
</p>
<a name="submit-gen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Lemonade Submission Servers</h3>

<p>All Lemonade Submission Servers implement the Mail Submission protocol described in <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>, which is in turn a specific profile of <a class='info' href='#ESMTP'>[ESMTP]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a>. Therefore any MUA designed to submit email via <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> or <a class='info' href='#ESMTP'>[ESMTP]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> will interoperate with Lemonade Submission Servers.
</p>
<p>In addition, Lemonade Submission Servers implement
   the following set of SMTP and Submission extensions to increase message
   submission
   efficiency.
</p>
<a name="esmtp-fwd"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Forward Without Download</h3>

<p>In order to optimize network usage for the typical case where message content is copied to, or sourced from, the IMAP store, Lemonade provides support for a suite of extensions collectively known as Forward Without Download, discussed in detail in <a class='info' href='#fwd-main'>Section&nbsp;8<span> (</span><span class='info'>Forward without download</span><span>)</span></a>.
</p>
<p>Lemonade Submission Servers MUST support the BURL <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>,
   8BITMIME <a class='info' href='#SMTP-8BITMIME'>[SMTP&#8209;8BITMIME]<span> (</span><span class='info'>Klensin, J., Freed, N., Rose, M., Stefferud, E., and D. Crocker, &ldquo;SMTP Service Extension for 8bit-MIMEtransport,&rdquo; July&nbsp;1994.</span><span>)</span></a>, BINARYMIME <a class='info' href='#SMTP-BINARYMIME'>[SMTP&#8209;BINARYMIME]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a> and CHUNKING <a class='info' href='#SMTP-BINARYMIME'>[SMTP&#8209;BINARYMIME]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a>.
</p>
<p>BURL MUST support
   URLAUTH type URLs <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, and thus MUST advertise the "imap"
   option following the BURL EHLO keyword (See <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for more details).
</p>
<a name="esmtp-pipelining"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Pipelining</h3>

<p>Some clients regularly use networks with a relatively high latency, such as Mobile or Satellite based networks.
   Avoidance of round-trips within a transaction has a great advantage
   for the reduction in both bandwidth and total transaction time. For
   this reason Lemonade compliant mail submission servers MUST support
   the SMTP Service Extensions for Command Pipelining <a class='info' href='#SMTP-PIPELINING'>[SMTP&#8209;PIPELINING]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Command Pipelining,&rdquo; September&nbsp;2000.</span><span>)</span></a>.
</p>
<a name="esmtp-dsn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
DSN Support</h3>

<p>Lemonade compliant mail submission servers MUST support SMTP service
   extensions for delivery status notifications <a class='info' href='#SMTP-DSN'>[SMTP&#8209;DSN]<span> (</span><span class='info'>Moore, K., &ldquo;Simple Mail Transfer Protocol (SMTP) Service Extension for Delivery Status Notifications (DSNs),&rdquo; January&nbsp;2003.</span><span>)</span></a>.
</p>
<a name="esmtp-size"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Message size declaration</h3>

<p>There is a distinct advantage in detecting failure cases as early as
   possible in many cases, such as where the user is charged per-octet, or
   where bandwidth is low. This is especially true of large message sizes.
</p>
<p>Lemonade Submission Servers MUST support the SMTP
   Service Extension for Message Size Declaration <a class='info' href='#SMTP-SIZE'>[SMTP&#8209;SIZE]<span> (</span><span class='info'>Klensin, J., Freed, N., and K. Moore, &ldquo;SMTP Service Extension for Message Size Declaration,&rdquo; November&nbsp;1995.</span><span>)</span></a>.
</p>
<p>Lemonade Submission Servers MUST NOT consider a supplied message size to be acceptable without expanding all BURL parts.
</p>
<p>A Lemonade capable client SHOULD use message size declaration. In
   particular the client MUST NOT send a message to a mail submission server,
   if it knows that the message exceeds the maximal message size
   advertised by the submission server.
   When including a message size in the MAIL FROM command, the client
   MUST use a value that is at least as large as the size of the assembled message data
   after resolution of all BURL parts.
   
</p>
<a name="esmtp-enhancedstatuscodes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Enhanced status code Support</h3>

<p>Lemonade compliant mail submission servers MUST support SMTP Service
   Extension for Returning Enhanced Error Codes <a class='info' href='#SMTP-STATUSCODES'>[SMTP&#8209;STATUSCODES]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Returning Enhanced Error Codes,&rdquo; October&nbsp;1996.</span><span>)</span></a>. These allow a client to determine the precise cause of failure.
</p>
<a name="esmtp-starttls"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Encryption and Compression</h3>

<p>Lemonade Compliant mail submission servers MUST support SMTP Service
   Extension for Secure SMTP over TLS <a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a>.
</p>
<p>Support for the DEFLATE compression method, as described in <a class='info' href='#TLS-COMP'>[TLS&#8209;COMP]<span> (</span><span class='info'>Hollenbeck, S., &ldquo;Transport Layer Security Protocol Compression Methods,&rdquo; May&nbsp;2004.</span><span>)</span></a>, is RECOMMENDED.
</p>
<p>
</p>
<a name="store-gen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Lemonade Message Stores</h3>

<p>All Lemonade Message Stores implement Internet Message Access Protocol, as defined in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>. Therefore any MUA written to access messages using the facilities described in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> will interoperate with a Lemonade Message Store.
</p>
<p>In addition, Lemonade Message Stores provide a set of extensions to address the limitations of some clients and networks.
</p>
<a name="imap-condstore"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Quick resynchronization</h3>

<p>Resynchronization is a costly part of an IMAP session, and mobile networks are generally more prone to unintended disconnection, which in turns makes this problem more acute. Therefore Lemonade Message Stores provide a suite of extensions to reduce the synchronization cost.
</p>
<p>Lemonade Compliant IMAP servers MUST support the CONDSTORE
   <a class='info' href='#IMAP-CONDSTORE'>[IMAP&#8209;CONDSTORE]<span> (</span><span class='info'>Melnikov, A. and S. Hole, &ldquo;IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization,&rdquo; June&nbsp;2006.</span><span>)</span></a>, the QRESYNC
   <a class='info' href='#IMAP-QRESYNC'>[IMAP&#8209;QRESYNC]<span> (</span><span class='info'>Melnikov, A., Cridland, D., and C. Wilson, &ldquo;IMAP4 Extensions for Quick Mailbox Resynchronization,&rdquo; March&nbsp;2008.</span><span>)</span></a> and the ENABLE
   <a class='info' href='#IMAP-ENABLE'>[IMAP&#8209;ENABLE]<span> (</span><span class='info'>Gulbrandsen, A. and A. Melnikov, &ldquo;The IMAP ENABLE Extension,&rdquo; March&nbsp;2008.</span><span>)</span></a> extensions.
   These allow a client to quickly resynchronize
   any mailbox by asking the server to return all flag changes and expunges
   that have occurred since a previously recorded state.
   This can also speed up client reconnect in case the transport layer is cut,
   whether accidentally or as part of a change in network.
   
</p>
<p><a class='info' href='#IMAP-SYNC-HOWTO'>[IMAP&#8209;SYNC&#8209;HOWTO]<span> (</span><span class='info'>Melnikov, A., &ldquo;Synchronization Operations for Disconnected IMAP4 Clients,&rdquo; June&nbsp;2006.</span><span>)</span></a> details how clients perform efficient mailbox resynchronization.
</p>
<a name="imap-bodypart"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Message part handling</h3>

<p>The handling of message parts, especially attachments, represents a set of challenges to limited devices, both in terms of the bandwidth used, and the capability of the device.
</p>
<p>Lemonade Compliant IMAP servers MUST support the BINARY
   <a class='info' href='#IMAP-BINARY'>[IMAP&#8209;BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a> extension. This moves MIME body part decoding operations
   from the client to the server. The decoded data is always equal or less than
   the encoded representation, so this reduces bandwidth effectively.
</p>
<p><a class='info' href='#IMAP-BINARY'>[IMAP&#8209;BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a> allows for servers to refuse to accept uploaded
   messages containing binary data, by not accepting the Binary
   content-transfer-encoding; however Lemonade Compliant IMAP servers SHALL always
   accept binary encoded MIME messages in APPEND commands for any folder.
</p>
<p><a class='info' href='#IMAP-CONVERT'>[IMAP&#8209;CONVERT]<span> (</span><span class='info'>Melnikov, A. and P. Coates, &ldquo;Internet Message Access Protocol - CONVERT Extension,&rdquo; July&nbsp;2008.</span><span>)</span></a> MUST also be supported by servers, which
   allows clients to request conversions between media types, and allows for
   scaling images, etc. This provides the ability to view attachments (and
   sometimes body parts) without the facility to cope with a wide range of
   media types, or to efficiently view attachments.
</p>
<a name="imap-compression"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Compression</h3>

<p>The IETF has for some time generally agreed that compression is best handled at as low a level as possible, therefore Lemonade Message Stores SHOULD support the Deflate compression algorithm for TLS, as defined in <a class='info' href='#TLS-COMP'>[TLS&#8209;COMP]<span> (</span><span class='info'>Hollenbeck, S., &ldquo;Transport Layer Security Protocol Compression Methods,&rdquo; May&nbsp;2004.</span><span>)</span></a>.
</p>
<p>However, the working group acknowledges that for many endpoints, this is a rarely deployed technology, and as such, Lemonade Message Stores MUST provide <a class='info' href='#IMAP-COMPRESS'>[IMAP&#8209;COMPRESS]<span> (</span><span class='info'>Gulbrandsen, A., &ldquo;The IMAP COMPRESS Extension,&rdquo; August&nbsp;2007.</span><span>)</span></a> support for fallback application-level stream compression, where TLS is not actively providing compression.
</p>
<a name="notifications"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Notifications</h3>

<p>The addition of Server-to-client notifications ransforms the
    LEMONADE profile into an event-based synchronization protocol.
    Whenever an event occurs that interests the MUA, a
    notification can be generated.
</p>
<p>If the MUA is connected to the IMAP server, inband notifications are
    generated using the facilities outlined in <a class='info' href='#imap-idle'>Section&nbsp;5.4.1<span> (</span><span class='info'>IMAP Notifications</span><span>)</span></a>.
</p>
<p>When the MUA is not connected, the Notification filter generates a
    outband notification.  The notification filter may be considered as
    acting on a PUSH repository.
</p>
<p>If the MUA is not connected, and outband notification is disabled,
    the client must perform a quick-sync on reconnect to determine
    mailbox changes, using the mechanisms outlined in <a class='info' href='#imap-condstore'>Section&nbsp;5.1<span> (</span><span class='info'>Quick resynchronization</span><span>)</span></a>.
</p>
<a name="imap-idle"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
IMAP Notifications</h3>

<p>Lemonade Message Stores MUST support the IDLE <a class='info' href='#IMAP-IDLE'>[IMAP&#8209;IDLE]<span> (</span><span class='info'>Leiba, B., &ldquo;IMAP4 IDLE command,&rdquo; June&nbsp;1997.</span><span>)</span></a>
   extension. The extension allows clients to receive unsolicited
   notifications about changes in the selected mailbox, without needing
   to poll for changes. The responses forming these notifications MUST be
   sent in a timely manner when such changes happen.
</p>
<p>Lemonade Message Stores also provide the NOTIFY extension described in <a class='info' href='#IMAP-NOTIFY'>[IMAP&#8209;NOTIFY]<span> (</span><span class='info'>Gulbrandsen, A., Melnikov, A., and C. King, &ldquo;The IMAP NOTIFY Extension,&rdquo; August&nbsp;2008.</span><span>)</span></a>, which allows clients to request specific event types to be sent immediately to the client, both for the currently selected folder and others. Such event types include message delivery, and mailbox renames.
</p>
<a name="outband-notify"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
External Notifications</h3>

<p>Lemonade, and TCP, provide for long-lived idle connections between the client and mail store, allowing the server to
push notifications within IMAP.  Some mobile networks support dormancy, which shuts down the radio traffic channel
during idle periods to conserve handset and network resources, while maintaining IP and TCP state.  (See the
<a class='info' href='#LEMONADE-DEPLOYMENTS'>[LEMONADE&#8209;DEPLOYMENTS]<span> (</span><span class='info'>Gellens, R., &ldquo;Deployment Considerations for lemonade-compliant Mobile Email,&rdquo; June&nbsp;2007.</span><span>)</span></a> document for more information.)
</p>
<p>However, there are environments where the email client cannot remain active indefinitely, or where it is not advisable
(or even always possible) for TCP connections to the server to remain up while idle for extended periods.  In these
situations, a good user experience requires that when "interesting" events occur in the mail store, the client be
informed so that it can connect and resynchronize.  At an absolute minimum, this requires that at least the arrival of
new mail generate some sort of wake-up to the email client.  A number of vendors have implemented various
solutions to this.  As examples of what has been done, for many years (long pre-dating cellular handsets) the
technique described in <a class='info' href='#FINGER-HACK'>[FINGER&#8209;HACK]<span> (</span><span class='info'>Gellens, R., &ldquo;Simple New Mail Notification,&rdquo; August&nbsp;2005.</span><span>)</span></a> has been supported. Today, a number of email vendors include facilities to send SMS
or other simple non-stream messages to clients on handsets when new mail arrives.  OMA has published a
mechanism that uses WAP PUSH to send a basic message containing a URL <a class='info' href='#OMA-EMN'>[OMA&#8209;EMN]<span> (</span><span class='info'>Open Mobile Alliance, &ldquo;Open Mobile Alliance Email Notification Version 1.0,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  The IETF is investigating
ways to standardize enhanced functionality in this area.
</p>
<p>A "push email" user experience can be achieved using any number of techniques, ranging from always-on TCP
connectivity to the server and the NOTIFY extension described above, to OMA EMN, or even a non-standard trigger
message over SMS.  In any technique, the client learns of the existence of new mail, and decides to fetch information
about it, some part of it, or all of it, and then presents this to the user.
</p>
<a name="imap-vfolder"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Searching and View Filters</h3>

<p>Lemonade Message Stores MUST support the ESEARCH <a class='info' href='#IMAP-ESEARCH'>[IMAP&#8209;ESEARCH]<span> (</span><span class='info'>Melnikov, A. and D. Cridland, &ldquo;IMAP4 Extension to SEARCH Command for Controlling What Kind of Information Is Returned,&rdquo; November&nbsp;2006.</span><span>)</span></a>
   extension. The extension allows clients to efficiently find the first or last messages,
   find a count of matching messages, and obtain a list of matching messages in a
   considerably more compact representation.
</p>
<p>Lemonade Message Stores also provide a mechanism for clients to avoid handling an entire mailbox, instead accessing a view of the mailbox. This technique, common in many desktop clients as a client-side capability, is useful for constrained clients to minimize the quantity of messages and notification data.
</p>
<p>Lemonade Message Stores therefore MUST implement the CONTEXT=SEARCH, ESORT and
	CONTEXT=SORT extensions defined in <a class='info' href='#IMAP-CONTEXT'>[IMAP&#8209;CONTEXT]<span> (</span><span class='info'>Cridland, D. and C. King, &ldquo;Contexts for IMAP4,&rdquo; July&nbsp;2008.</span><span>)</span></a>, as well as the SORT
	extension defined in <a class='info' href='#IMAP-SORT'>[IMAP&#8209;SORT]<span> (</span><span class='info'>Crispin, M. and K. Murchison, &ldquo;Internet Message Access Protocol - SORT and THREAD Extensions,&rdquo; June&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="imap-mbox"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Mailbox Handling</h3>

<p>Lemonade Message Stores MUST support the NAMESPACE
   <a class='info' href='#IMAP-NAMESPACE'>[IMAP&#8209;NAMESPACE]<span> (</span><span class='info'>Gahrns, M. and C. Newman, &ldquo;IMAP4 Namespace,&rdquo; May&nbsp;1998.</span><span>)</span></a> extension. The extension allows clients to discover
   shared mailboxes and mailboxes belonging to other users, and provide a normalized
   hierarchy view of the mailboxes available.
</p>
<p>Lemonade Message Stores MUST support the I18NLEVEL=&lt;n&gt; <a class='info' href='#IMAP-I18N'>[IMAP&#8209;I18N]<span> (</span><span class='info'>Newman, C., Gulbrandsen, A., and A. Melnikov, &ldquo;Internet Message Access Protocol Internationalization,&rdquo; June&nbsp;2008.</span><span>)</span></a> extension,
   with &lt;n&gt; having value 1 or 2. It adds support for non-English (internationalized) search and sort functions.
   (Note that I18NLEVEL=2 implies support for I18NLEVEL=1, so a Lemonade compliant client that make use of this extension
   MUST recognize either one.)
</p>
<a name="imap-fwd"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Forward Without Download</h3>

<p>In order to optimize network usage for the typical case where message content is copied to, or sourced from, the IMAP store, Lemonade provides support for a suite of extensions collectively known as Forward Without Download, discussed in detail in <a class='info' href='#fwd-main'>Section&nbsp;8<span> (</span><span class='info'>Forward without download</span><span>)</span></a>.
</p>
<p>Lemonade Message Stores MUST support
   CATENATE <a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a>,
   UIDPLUS <a class='info' href='#IMAP-UIDPLUS'>[IMAP&#8209;UIDPLUS]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - UIDPLUS extension,&rdquo; December&nbsp;2005.</span><span>)</span></a> and
   URLAUTH <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>.
   Lemonade Message Stores MUST also support URL-PARTIAL <a class='info' href='#url-partial'>Section&nbsp;5.7.1<span> (</span><span class='info'>Support for PARTIAL in CATENATE and URLAUTH</span><span>)</span></a>.
   
</p>
<a name="url-partial"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7.1"></a><h3>5.7.1.&nbsp;
Support for PARTIAL in CATENATE and URLAUTH</h3>

<p><a class='info' href='#IMAP-URL'>[IMAP&#8209;URL]<span> (</span><span class='info'>Melnikov, A. and C. Newman, &ldquo;IMAP URL Scheme,&rdquo; November&nbsp;2007.</span><span>)</span></a> introduced a new syntactic element for referencing
		a byte range of a message/body part. This is done using the ;PARTIAL= field.
		If an IMAP server supports PARTIAL in IMAP URL used in CATENATE and URLAUTH extensions,
		then it MUST advertise the URL-PARTIAL capability in the CAPABILITY response/response code.
		
</p>
<a name="imap-other"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
Additional IMAP extensions</h3>

<p>Lemonade Message Stores MUST support the LITERAL+ <a class='info' href='#IMAP-LITERAL+'>[IMAP&#8209;LITERAL+]<span> (</span><span class='info'>Myers, J., &ldquo;IMAP4 non-synchronizing literals,&rdquo; January&nbsp;1997.</span><span>)</span></a>
   extension. The extension allows clients to save a round trip each
   time a non-synchronizing literal is sent.
</p>
<p>Lemonade Message Stores MUST also implement the SASL-IR <a class='info' href='#IMAP-SASL-IR'>[IMAP&#8209;SASL&#8209;IR]<span> (</span><span class='info'>Siemborski, R. and A. Gulbrandsen, &ldquo;IMAP Extension for Simple Authentication and Security Layer (SASL) Initial Client Response,&rdquo; September&nbsp;2007.</span><span>)</span></a> extension, which allows clients to save a round trip during authentication, potentially pipelining the entire authentication sequence.
</p>
<p>Lemonade Compliant IMAP servers MUST support IMAP over TLS <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>
   as required by <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>. As noted above in <a class='info' href='#imap-compression'>Section&nbsp;5.3<span> (</span><span class='info'>Compression</span><span>)</span></a>, servers SHOULD support the deflate compression
   algorithm for TLS, as specified in <a class='info' href='#TLS-COMP'>[TLS&#8209;COMP]<span> (</span><span class='info'>Hollenbeck, S., &ldquo;Transport Layer Security Protocol Compression Methods,&rdquo; May&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="imap-fwd-keyword"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.9"></a><h3>5.9.&nbsp;
Registration of $Forwarded IMAP keyword</h3>

<p>The $Forwarded IMAP keyword is used by several IMAP clients to
   specify that the marked message was forwarded to another email address,
   embedded within or attached to a new message. A mail client sets this
   keyword when it successfully forwards the message to another email
   address. Typical usage of this keyword is to show a different (or
   additional) icon for a message that has been forwarded. Once set the
   flag SHOULD NOT be cleared.
</p>
<p>Lemonade Message Stores MUST be able to store the $Forwarded
   keyword. They MUST preserve it on the COPY operation.  The servers
   MUST support the SEARCH KEYWORD $Forwarded.
</p>
<a name="imap-submission-keywords"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.10"></a><h3>5.10.&nbsp;
Registration of $SubmitPending and $Submitted IMAP keywords</h3>

<p>The $SubmitPending IMAP keyword designates the message as
   awaiting to be submitted. This keyword allows to store messages waiting
   to be submitted in the same mailbox where messages that were already
   submitted and/or being edited are stored. A mail client sets this keyword
   when it decides that the message needs to be sent out.
   When a client (it might be a different client from the one that decided that
   the message is pending submission) starts sending the message, it atomically
   (using "STORE (UNCHANGEDSINCE)") adds the $Submitted keyword.
   Once submission is successful, the $SubmitPending keyword is atomically cleared.
   The two keywords allow to distinguish messages being actively submitted 
   (messages that have both $Submitted and $SubmitPending keywords set) from
   messages awaiting to be submitted, or from messages already submitted.
   They also allow to find all messages that were supposed to be submitted,
   if the client submitting them crashes or quits before submitting them.
   
</p>
<p>Lemonade Message Stores MUST be able to store the $SubmitPending
   and the $Submitted keyword. Lemonade Message Stores MUST preserve
   them on the COPY operation.  The servers MUST support the
   SEARCH KEYWORD $SubmitPending and SEARCH KEYWORD $Submitted.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.11"></a><h3>5.11.&nbsp;
Related IMAP extensions</h3>

<p>This section is non-normative.
</p>
<p>Server implementations targeting to fulfil OMA MEM requirements <a class='info' href='#OMA-MEM-REQ'>[OMA&#8209;MEM&#8209;REQ]<span> (</span><span class='info'>Open Mobile Alliance, &ldquo;Mobile Email Requirements Document,&rdquo; Oct&nbsp;2005.</span><span>)</span></a>
	should consider implementing <a class='info' href='#IMAP-FILTERS'>[IMAP&#8209;FILTERS]<span> (</span><span class='info'>Melnikov, A. and C. King, &ldquo;IMAP4 extension for named searches (filters),&rdquo; September&nbsp;2008.</span><span>)</span></a>, which provides a way to persist
	definition of virtual mailboxes on the server.
	They should also consider implementing <a class='info' href='#METADATA'>METADATA-SERVER<span> (</span><span class='info'>Daboo, C., &ldquo;IMAP METADATA Extension,&rdquo; July&nbsp;2008.</span><span>)</span></a> [METADATA] extension,
	which provides a way of storing user-defined data associated with a user account.
	
</p>
<a name="sieve-mda"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Lemonade Message Delivery Agents</h3>

<p>Lemonade Message Delivery Agents MUST support the <a class='info' href='#SIEVE'>[SIEVE]<span> (</span><span class='info'>Guenther, P. and T. Showalter, &ldquo;Sieve: An Email Filtering Language,&rdquo; January&nbsp;2008.</span><span>)</span></a> filtering language at the point of delivery, allowing the user to control which messages are accepted, and where they are filed.
</p>
<p>Lemonade Message Delivery Agents MUST support the Sieve Vacation extension
	<a class='info' href='#SIEVE-VACATION'>[SIEVE&#8209;VACATION]<span> (</span><span class='info'>Showalter, T. and N. Freed, &ldquo;Sieve Email Filtering: Vacation Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a>, which allows the client
	to setup an auto-responder, typically to report being on vacation (thus the name
	of the Sieve extension).
</p>
<p>Lemonade Message Delivery Agents MUST support the Sieve Enotify extension
	<a class='info' href='#SIEVE-NOTIFY'>[SIEVE&#8209;NOTIFY]<span> (</span><span class='info'>Melnikov, A., Leiba, B., Segmuller, W., and T. Martin, &ldquo;SIEVE Email Filtering: Extension for Notifications,&rdquo; December&nbsp;2007.</span><span>)</span></a>, which allows a Sieve script
	to generate notifications (such as XMPP, SIP or email) about received messages.
</p>
<p>Lemonade Message Delivery Agents MUST support the Sieve Variables extension
	<a class='info' href='#SIEVE-VARIABLES'>[SIEVE&#8209;VARIABLES]<span> (</span><span class='info'>Homme, K., &ldquo;Sieve Email Filtering: Variables Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a>, which adds support for variables
	to the Sieve scripting language. This extension is typically used with Sieve Enotify
	or Vacation to customize responses/notifications.
</p>
<p>Lemonade Message Delivery Agents MUST support the Sieve Relational extension
	<a class='info' href='#SIEVE-RELATIONAL'>[SIEVE&#8209;RELATIONAL]<span> (</span><span class='info'>Segmuller, W. and B. Leiba, &ldquo;Sieve Email Filtering: Relational Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a>, which adds support for relational
	comparisons to the Sieve scripting language. This extension is typically used
	together with Sieve Enotify.
</p>
<p>Lemonade Message Delivery Agents MUST support the Sieve Imap4Flags extension
	<a class='info' href='#SIEVE-IMAP4FLAGS'>[SIEVE&#8209;IMAP4FLAGS]<span> (</span><span class='info'>Melnikov, A., &ldquo;Sieve Email Filtering: Imap4flags Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a>, which allows a Sieve script
	to set IMAP flags/keywords when delivering a message to a mailbox. For example
	this can be used to automatically mark certain messages as interesting, urgent, etc.
</p>
<p>Lemonade Message Delivery Agents MUST support the i;unicode-casemap comparator in Sieve
	<a class='info' href='#UNICODE-CASEMAP'>[UNICODE&#8209;CASEMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;i;unicode-casemap - Simple Unicode Collation Algorithm,&rdquo; October&nbsp;2007.</span><span>)</span></a>. The comparator allows for case-insensitive
	matching of Unicode characters.
</p>
<p>Lemonade Message Delivery Agents should consider supporting Sieve script management using the
	<a class='info' href='#MANAGESIEVE'>[MANAGESIEVE]<span> (</span><span class='info'>Melnikov, A. and T. Martin, &ldquo;A Protocol for Remotely Managing Sieve Scripts,&rdquo; September&nbsp;2008.</span><span>)</span></a> protocol. If they do, they MUST also advertise
	
	in <a class='info' href='#MANAGESIEVE'>[MANAGESIEVE]<span> (</span><span class='info'>Melnikov, A. and T. Martin, &ldquo;A Protocol for Remotely Managing Sieve Scripts,&rdquo; September&nbsp;2008.</span><span>)</span></a> all Sieve extensions listed in
	this section.
</p>
<a name="client-main"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Lemonade Mail User Agents</h3>

<p>Although all existing IMAP MUAs are Lemonade compliant in as much as all Lemonade services are based on the existing <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> and <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> protocols, client implementors are encouraged to take full advantage of the facilities provided by Lemonade Submission Servers and Lemonade Message Stores, as described in <a class='info' href='#submit-gen'>Section&nbsp;4<span> (</span><span class='info'>Lemonade Submission Servers</span><span>)</span></a> and <a class='info' href='#store-gen'>Section&nbsp;5<span> (</span><span class='info'>Lemonade Message Stores</span><span>)</span></a> respectively.
</p>
<p>Note that the explicit usage of <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> means that when opening a connection to the submission server, clients MUST do so using port 587 unless explicitly configured to use an alternate port. If the TCP connection to the submission server fails to open using port 587, the client MAY then immediately retry using a different port, such as 25. See <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> information on why using port 25 is likely to fail depending on the current location of the client, and may result in a failure code during the SMTP transaction.
</p>
<p>In addition, some specifications are useful to support interoperable messaging with an enhanced user experience.
</p>
<p>Lemonade capable clients SHOULD support the Format and DelSp parameters to the text/plain media type described in <a class='info' href='#FLOWED'>[FLOWED]<span> (</span><span class='info'>Gellens, R., &ldquo;The Text/Plain Format and DelSp Parameters,&rdquo; February&nbsp;2004.</span><span>)</span></a>, and generate this format for messages.
</p>
<p>Lemonade capable clients SHOULD support, and use, the $Forwarded keyword described in <a class='info' href='#imap-fwd-keyword'>Section&nbsp;5.9<span> (</span><span class='info'>Registration of $Forwarded IMAP keyword</span><span>)</span></a>.
</p>
<a name="fwd-main"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Forward without download</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Motivations</h3>

<p>The advent of client/server email using the <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> and <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> protocols changed what formerly were local disk
   operations to become repetitive network data transmissions.
</p>
<p>Lemonade "forward without download" makes use of the <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>
   extension to enable access to external sources during the submission
   of a message.  In combination with the <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> extension,
   inclusion of message parts or even entire messages from the IMAP mail
   store is possible with a minimal trust relationship between the IMAP
   and SMTP SUBMIT servers.
</p>
<p>Lemonade "forward without download" has the advantage of maintaining
   one submission protocol, and thus avoids the risk of having multiple
   parallel and possibly divergent mechanisms for submission. The client
   can use <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> extensions without these being added to
   IMAP. Furthermore, by keeping the details of message submission in
   the SMTP SUBMIT server, Lemonade "forward without download" can work
   with other message retrieval protocols such as POP, NNTP, or whatever
   else may be designed in the future.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Message Sending Overview</h3>

<p>The act of sending an email message can be thought of as involving
   multiple steps: initiation of a new draft, draft editing, message
   assembly, and message submission.
</p>
<p>Initiation of a new draft and draft editing takes place in the MUA.
   Frequently, users choose to save more complex messages on an
   <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> server (via the APPEND command with the \Draft flag) for
   later recall by the MUA and resumption of the editing process.
</p>
<p>Message assembly is the process of producing a complete message from
   the final revision of the draft and external sources.  At assembly
   time, external data is retrieved and inserted in the message.
</p>
<p>Message submission is the process of inserting the assembled message
   into the <a class='info' href='#ESMTP'>[ESMTP]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> infrastructure, typically using the <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>
   protocol.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Traditional Strategy</h3>

<p>Traditionally, messages are initiated, edited, and assembled entirely
   within an MUA, although drafts may be saved to an <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> server
   and later retrieved from the server.  The completed text is then
   transmitted to an MSA for delivery.
</p>
<p>There is often no clear boundary between the editing and assembly
   process.  If a message is forwarded, its content is often retrieved
   immediately and inserted into the message text.  Similarly, when
   external content is inserted or attached, the content is usually
   retrieved immediately and made part of the draft.
</p>
<p>As a consequence, each save of a draft and subsequent retrieve of the
   draft transmits that entire (possibly large) content, as does message
   submission.
</p>
<p>In the past, this was not much of a problem, because drafts, external
   data, and the message submission mechanism were typically located on
   the same system as the MUA.  The most common problem was running out
   of disk quota.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Step by step description</h3>

<p>The model distinguishes between a Messaging User Agent (MUA), an
   IMAPv4Rev1 Server (<a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>) and a SMTP submit server (<a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>), as
   illustrated in Figure 1.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +--------------------+               +--------------+
      |                    | &lt;------------ |              |
      |     MUA (M)        |               | IMAPv4Rev1   |
      |                    |               |  Server      |
      |                    | ------------&gt; | (Server I)   |
      +--------------------+               +--------------+
             ^    |                              ^     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     v
             |    |                        +--------------+
             |    |----------------------&gt; |   SMTP       |
             |                             |   Submit     |
             |-----------------------------|   Server     |
                                           |  (Server S)  |
                                           +--------------+
</pre></div>
<p>Figure 1:  Lemonade "forward without download"
</p>
<p>Lemonade "forward without download" allows a Messaging User Agent to
   compose and forward an e-mail combining fragments that are located in
   an IMAP server, without having to download these fragments to the
   client.
</p>
<p>There are two ways to perform "forward without download" based on
   where the message assembly takes place.  The first uses extended
   APPEND command <a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a> to edit a draft message in the message
   store and cause the message assembly on the IMAP server. This is most often used when a copy of the message is to be retained on the IMAP server, as discussed in <a class='info' href='#fcc-problem'>Section&nbsp;8.6<span> (</span><span class='info'>Copies of Sent messages: The fcc problem</span><span>)</span></a>.
</p>
<p>The second
   uses a succession of BURL and BDAT commands to submit and assemble
   through concatenation, message data from the client and external data
   fetched from the provided URL. The two subsequent sections provide
   step-by-step instructions on how "forward without download" is
   achieved.
</p>
<a name="fwd-catenate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.1"></a><h3>8.4.1.&nbsp;
Message assembly using IMAP CATENATE extension</h3>

<p>In the <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>/<a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a> variant of the Lemonade "forward without
   download" strategy, messages are initially composed and edited within
   an MUA.  The <a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a> extension to <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> is then used to create
   the messages on the IMAP server by transmitting new text and
   assembling them. The UIDPLUS <a class='info' href='#IMAP-UIDPLUS'>[IMAP&#8209;UIDPLUS]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - UIDPLUS extension,&rdquo; December&nbsp;2005.</span><span>)</span></a> IMAP extension is used by the client
   in order to learn the UID of the created messages. Finally a
   <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> format URL is given to a <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> server for submission
   using the BURL <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> extension.
</p>
<p>The flow involved to support such a use case consists of:
</p>
<p>M: {to I -- Optional} The client connects to the IMAP server,
     optionally starts TLS (if data confidentiality is required),
     authenticates, opens a mailbox ("INBOX" in the example below) and
     fetches body structures (See <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>).
</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         M: A0051 UID FETCH 25627 (UID BODYSTRUCTURE)
         I: * 161 FETCH (UID 25627 BODYSTRUCTURE (("TEXT" "PLAIN"
             ("CHARSET" "US-ASCII") NIL NIL "7BIT" 1152 23)(
             "TEXT" "PLAIN" ("CHARSET" "US-ASCII" "NAME"
             "trip.txt")
             "&lt;960723163407.20117h@washington.example.com&gt;"
             "Your trip details" "BASE64" 4554 73) "MIXED"))
         I: A0051 OK completed
</pre></div>
<p>M: {to I} The client invokes CATENATE (See <a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a> for details
     of the semantics and steps) -- this allows the MUA to create
     messages on the IMAP server using new data combined with one or
     more message parts already present on the IMAP server.
</p>
<p>Note that the example for this step doesn't use the LITERAL+
     <a class='info' href='#IMAP-LITERAL+'>[IMAP&#8209;LITERAL+]<span> (</span><span class='info'>Myers, J., &ldquo;IMAP4 non-synchronizing literals,&rdquo; January&nbsp;1997.</span><span>)</span></a> extension. Without LITERAL+ the new message is
     constructed using 3 round-trips. If LITERAL+ is used, the new
     message can be constructed using one round-trip.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      M: A0052 APPEND Sent FLAGS (\Draft \Seen $MDNSent)
          CATENATE (TEXT {475}
      I: + Ready for literal data
      M: Message-ID: &lt;419399E1.6000505@caernarfon.example.org&gt;
      M: Date: Thu, 12 Nov 2004 16:57:05 +0000
      M: From: Bob Ar &lt;bar@example.org&gt;
      M: MIME-Version: 1.0
      M: To: foo@example.net
      M: Subject: About our holiday trip
      M: Content-Type: multipart/mixed;
      M:     boundary="------------030308070208000400050907"
      M:
      M: --------------030308070208000400050907
      M: Content-Type: text/plain; format=flowed
      M:
      M: Our travel agent has sent the updated schedule.
      M:
      M: Cheers,
      M: Bob
      M: --------------030308070208000400050907
      M:  URL "/INBOX;UIDVALIDITY=385759045/;
         UID=25627/;Section=2.MIME" URL "/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2" TEXT {44}
      I: + Ready for literal data
      M:
      M: --------------030308070208000400050907--
      M: )
      I: A0052 OK [APPENDUID 387899045 45] CATENATE Completed
</pre></div>
<p>M: {to I} The client uses GENURLAUTH command to request a URLAUTH
     URL (See <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>).<br />

      I: {to M} The IMAP server returns a URLAUTH URL suitable for later
     retrieval with URLFETCH (See <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the semantics
     and steps).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      M: A0054 GENURLAUTH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45;expire=2005-10-
         28T23:59:59Z;urlauth=submit+bob.ar" INTERNAL
      I: * GENURLAUTH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45;expire=
         2005-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038"
      I: A0054 OK GENURLAUTH completed
</pre></div>
<p>M: {to S} The client connects to the mail submission server and
     starts a new mail transaction. It uses BURL to let the SMTP submit
     server fetch the content of the message from the IMAP server (See
     <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the semantics and steps -- this allows the
     MUA to authorize the SMTP submit server to access the message
     composed as a result of the CATENATE step). Note that the second
     EHLO command is required after a successful STARTTLS command.
     Also note that there might be a third required EHLO command if the
     second EHLO response doesn't list any BURL options. <a class='info' href='#fwd-chunking'>Section&nbsp;8.4.2<span> (</span><span class='info'>Message assembly using SMTP CHUNKING and BURL extensions</span><span>)</span></a>
     demonstrates this.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: 220 owlry.example.org ESMTP
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap
      S: 250-CHUNKING
      S: 250-AUTH PLAIN
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250-STARTTLS
      S: 250 ENHANCEDSTATUSCODES
      M: STARTTLS
      S: 220 Ready to start TLS
      ...TLS negotiation, subsequent data is encrypted...
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap
      S: 250-CHUNKING
      S: 250-AUTH PLAIN
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: AUTH PLAIN aGFycnkAaGFycnkAYWNjaW8=
      S: 235 2.7.0 PLAIN authentication successful.
      M: MAIL FROM:&lt;bob.ar@example.org&gt;
      S: 250 2.5.0 Address Ok.
      M: RCPT TO:&lt;foo@example.net&gt;
      S: 250 2.1.5 foo@example.net OK.
      M: BURL imap://bob.ar@example.org/Sent;UIDVALIDITY=387899045/;
         uid=45/;urlauth=submit+bar:internal:
         91354a473744909de610943775f92038 LAST
</pre></div>
<p>S: {to I} The mail submission server uses URLFETCH to fetch the
     message to be sent (See <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the semantics and
     steps. The so-called "pawn-ticket" authorization mechanism uses a
     URI which contains its own authorization credentials.).<br />

      I: {to S} Provides the message composed as a result of the
     CATENATE step).
</p>
<p>Mail submission server opens IMAP connection to the IMAP server:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      I: * OK [CAPABILITY IMAP4REV1 STARTTLS NAMESPACE LITERAL+
          CATENATE URLAUTH UIDPLUS CONDSTORE IDLE] imap.example.com
          IMAP server ready
      S: a000 STARTTLS
      I: a000 Start TLS negotiation now
      ...TLS negotiation, if successful - subsequent data
         is encrypted...
      S: a001 LOGIN submitserver secret
      I: a001 OK submitserver logged in
      S: a002 URLFETCH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45/;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038"
      I: * URLFETCH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45/;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038" {15065}
      ...message body follows...
      S: a002 OK URLFETCH completed
      I: a003 LOGOUT
      S: * BYE See you later
      S: a003 OK Logout successful
</pre></div>
<p>Note that if the IMAP server doesn't send CAPABILITY response code
     in the greeting, the mail submission server must issue the
     CAPABILITY command to learn about supported IMAP extensions as
     described in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.
</p>
<p>Also, if data confidentiality is not required the mail submission
     server may omit the STARTTLS command before issuing the LOGIN
     command.
</p>
<p>S: {to M} Submission server assembles the complete message and if
     the assembly succeeds it returns OK to the MUA:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: 250 2.5.0 Ok.
</pre></div>
<p>M: {to I} The client marks the message containing the forwarded attachment on the IMAP
     server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      M: A0053 UID STORE 25627 +FLAGS.SILENT ($Forwarded)
      I: * 215 FETCH (UID 25627 MODSEQ (12121231000))
      I: A0053 OK STORE completed
</pre></div>
<p>Note: the UID STORE command shown above will only work if the
     marked message is in the currently selected mailbox; otherwise, it
     requires a SELECT. This command can be omitted, as it simply changes non-operational metadata not essential to client operations or interoperability.
     The untagged FETCH response is due to <a class='info' href='#IMAP-CONDSTORE'>[IMAP&#8209;CONDSTORE]<span> (</span><span class='info'>Melnikov, A. and S. Hole, &ldquo;IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization,&rdquo; June&nbsp;2006.</span><span>)</span></a>.
     The $Forwarded IMAP keyword is described in <a class='info' href='#imap-fwd-keyword'>Section&nbsp;5.9<span> (</span><span class='info'>Registration of $Forwarded IMAP keyword</span><span>)</span></a>.
</p>
<a name="fwd-chunking"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.2"></a><h3>8.4.2.&nbsp;
Message assembly using SMTP CHUNKING and BURL extensions</h3>

<p>In the <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>/<a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> variant of the Lemonade "forward without
   download" strategy, messages are initially composed and edited within
   an MUA.  During submission <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>, BURL <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> and BDAT <a class='info' href='#SMTP-BINARYMIME'>[SMTP&#8209;BINARYMIME]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a>
   commands are used to create the messages from multiple parts. New
   body parts are supplied using BDAT commands, while existing body
   parts are referenced using <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> format URLs in BURL commands.
</p>
<p>The flow involved to support such a use case consists of:<br />

      M: {to I -- Optional} The client connects to the IMAP server,
     optionally starts TLS (if data confidentiality is required),
     authenticates, opens a mailbox ("INBOX" in the example below) and
     fetches body structures (See <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>).
</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         M: A0051 UID FETCH 25627 (UID BODYSTRUCTURE)
         I: * 161 FETCH (UID 25627 BODYSTRUCTURE (("TEXT" "PLAIN"
            ("CHARSET" "US-ASCII") NIL NIL "7BIT" 1152 23)(
            "TEXT" "PLAIN" ("CHARSET" "US-ASCII" "NAME"
            "trip.txt")
            "&lt;960723163407.20117h@washington.example.com&gt;"
            "Your trip details" "BASE64" 4554 73) "MIXED"))
         I: A0051 OK completed
</pre></div>
<p>M: {to I} The client uses GENURLAUTH command to request URLAUTH
     URLs (See <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>) referencing pieces of the message to be
     assembled.<br />

      I: {to M} The IMAP server returns URLAUTH URLs suitable for later
     retrieval with URLFETCH (See <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the semantics
     and steps).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      M: A0054 GENURLAUTH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar"
         INTERNAL "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar" INTERNAL
      I: * GENURLAUTH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF"
         "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9"
      I: A0054 OK GENURLAUTH completed
</pre></div>
<p>M: {to S} The client connects to the mail submission server and
     starts a new mail transaction. It uses BURL to instruct the SMTP
     submit server to fetch from the IMAP server pieces of the message
     to be sent (See <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the semantics and steps).
</p>
<p>Note that the second EHLO command is required after a successful
     STARTTLS command. The third EHLO command is required if and only if
     the second EHLO response doesn't list any BURL options. See
      <a class='info' href='#fwd-catenate'>Section&nbsp;8.4.1<span> (</span><span class='info'>Message assembly using IMAP CATENATE extension</span><span>)</span></a>
      for an example of submission where the third EHLO
     command/response is not present.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: 220 owlry.example.org ESMTP
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250-STARTTLS
      S: 250 ENHANCEDSTATUSCODES
      M: STARTTLS
      S: 220 Ready to start TLS
      ...TLS negotiation, subsequent data is encrypted...
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5 CRAM-MD5 PLAIN EXTERNAL
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: AUTH PLAIN aGFycnkAaGFycnkAYWNjaW8=
      S: 235 2.7.0 PLAIN authentication successful.
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap imap://imap.example.org
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5 CRAM-MD5 PLAIN EXTERNAL
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: MAIL FROM:&lt;bob.ar@example.org&gt; BODY=BINARY
      S: 250 2.5.0 Address Ok.
      M: RCPT TO:&lt;foo@example.net&gt;
      S: 250 2.1.5 foo@example.net OK.
      M: BDAT 475
      M: Message-ID: &lt;419399E1.6000505@caernarfon.example.org&gt;
      M: Date: Thu, 12 Nov 2004 16:57:05 +0000
      M: From: Bob Ar &lt;bar@example.org&gt;
      M: MIME-Version: 1.0
      M: To: foo@example.net
      M: Subject: About our holiday trip
      M: Content-Type: multipart/mixed;
      M:     boundary="------------030308070208000400050907"
      M:
      M: --------------030308070208000400050907
      M: Content-Type: text/plain; format=flowed
      M:
      M: Our travel agent has sent the updated schedule.
      M:
      M: Cheers,
      M: Bob
      M: --------------030308070208000400050907
      S: 250 2.5.0 OK
      M: BURL imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF
      S: 250 2.5.0 OK
      M: BURL imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9
      S: 250 2.5.0 OK
      M: BDAT 44 LAST
      M:
      M: --------------030308070208000400050907--
</pre></div>
<p>S: {to I} The mail submission server uses URLFETCH to fetch the
     pieces of the message to be sent (See <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> for details of the
     semantics and steps. The so-called "pawn-ticket" authorization
     mechanism uses a URI which contains its own authorization
     credentials.).<br />

      I: {to S} Returns the requested body parts.
</p>
<p>Mail submission server opens IMAP connection to the IMAP server:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      I: * OK [CAPABILITY IMAP4REV1 STARTTLS NAMESPACE LITERAL+
          CATENATE URLAUTH UIDPLUS CONDSTORE IDLE] imap.example.com
          IMAP server ready
      S: a001 LOGIN submitserver secret
      I: a001 OK submitserver logged in
      S: a002 URLFETCH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF" "imap://
         bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9"
      I: * URLFETCH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF" {84}
      ...message section follows...
          "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9" {15065}
      ...message section follows...
      S: a002 OK URLFETCH completed
      I: a003 LOGOUT
      S: * BYE See you later
      S: a003 OK Logout successful
</pre></div>
<p>Note that if the IMAP server doesn't send CAPABILITY response code
     in the greeting, the mail submission server must issue the
     CAPABILITY command to learn about supported IMAP extensions as
     described in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.
</p>
<p>Also, if data confidentiality is required the mail submission
     server should start TLS before issuing the LOGIN command.
</p>
<p>S: {to M} Submission server assembles the complete message and if
     the assembly succeeds it acknowledges acceptance of the message by
     sending 250 response to the last BDAT command:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: 250 2.5.0 Ok, message accepted.
</pre></div>
<p>M: {to I} The client marks the message containing the forwarded attachment on the IMAP
     server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      M: A0053 UID STORE 25627 +FLAGS.SILENT ($Forwarded)
      I: * 215 FETCH (UID 25627 MODSEQ (12121231000))
      I: A0053 OK STORE completed
</pre></div>
<p>
     Note: the UID STORE command shown above will only work if the
     marked message is in the currently selected mailbox; otherwise, it
     requires a SELECT. As in the previous example, this command is not critical, and can be omitted.
     The untagged FETCH response is due to <a class='info' href='#IMAP-CONDSTORE'>[IMAP&#8209;CONDSTORE]<span> (</span><span class='info'>Melnikov, A. and S. Hole, &ldquo;IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization,&rdquo; June&nbsp;2006.</span><span>)</span></a>.
     The $Forwarded IMAP keyword is described in <a class='info' href='#imap-fwd-keyword'>Section&nbsp;5.9<span> (</span><span class='info'>Registration of $Forwarded IMAP keyword</span><span>)</span></a>.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Security Considerations for pawn-tickets.</h3>

<p>The so-called "pawn-ticket" authorization mechanism uses a URI, which
   contains its own authorization credentials using <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>.  The
   advantage of this mechanism is that the SMTP submit <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> server
   cannot access any data on the <a class='info' href='#IMAP-URLAUTH'>[IMAP&#8209;URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> server without a "pawn-
   ticket" created by the client.
</p>
<p>The "pawn-ticket" grants access only to the specific data that the
   SMTP submit <a class='info' href='#SUBMIT'>[SUBMIT]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> server is authorized to access, can be revoked
   by the client, and can have a time-limited validity.
</p>
<a name="fcc-problem"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Copies of Sent messages: The fcc problem</h3>

<p>The "fcc problem" refers to delivering a copy of a message to a mailbox, or "file carbon copy".  By far, the most common case of fcc is a
   client leaving a copy of outgoing mail in a "Sent Mail" or "Outbox"
   mailbox.
</p>
<p>In the traditional strategy, the MUA duplicates the effort spent in
   transmitting to the MSA by writing the message to the fcc destination
   in a separate step.  This may be a write to a local disk file or an
   APPEND to a mailbox on an IMAP server.  The latter is one of the "repetitive
   network data transmissions" which represents the "problem"
   aspect of the "fcc problem".
</p>
<p>The BURL <a class='info' href='#SMTP-BURL'>[SMTP&#8209;BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> extension can be used to eliminate
   the additional transmission. The final message is uploaded to the mailbox
   designed for outgoing mail, by the APPEND command of <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.
   Note that APPEND, including when enhanced by <a class='info' href='#IMAP-CATENATE'>[IMAP&#8209;CATENATE]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Access Protocol (IMAP) CATENATE             Extension,&rdquo; April&nbsp;2006.</span><span>)</span></a>, can
   only create a
   single copy of the message and this is only of use on the server which stages the outgoing
   message for submission. Additional copies of the message on the same server can be
   created by using one or more COPY commands.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Deployment Considerations</h3>

<p>Deployment considerations are discussed extensively in <a class='info' href='#LEMONADE-DEPLOYMENTS'>[LEMONADE&#8209;DEPLOYMENTS]<span> (</span><span class='info'>Gellens, R., &ldquo;Deployment Considerations for lemonade-compliant Mobile Email,&rdquo; June&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>Implementors are advised to examine the Security Considerations of all the referenced documents. This section merely highlights these, and advises implementors on specific issues relating to the combination of extensions.
</p>
<p>Security considerations on Lemonade "forward without download" are
   discussed throughout <a class='info' href='#fwd-main'>Section&nbsp;8<span> (</span><span class='info'>Forward without download</span><span>)</span></a>. Additional security considerations
   can be found in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> and other documents describing other SMTP
   and IMAP extensions comprising the Lemonade Profile.
</p>
<p>Note that the mandatory-to-implement authentication mechanism for
   SMTP submission is described in <a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a>. The mandatory-to-implement
   authentication mechanism for IMAP is described in <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Confidentiality Protection of Submitted Messages</h3>

<p>When clients submit new messages, link protection such as TLS guards
   against an eavesdropper seeing the contents of the submitted message.
   It is worth noting, however, that even if TLS is not used, the
   security risks are no worse if BURL is used to reference the text
   than if the text is submitted directly.  If BURL is not used, an
   eavesdropper gains access to the full text of the message.  If BURL
   is used, the eavesdropper may or may not be able to gain such access,
   depending on the form of BURL used.  For example, some forms restrict
   use of the URL to an entity authorized as a submission server or a
   specific user.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
TLS</h3>

<p>When Lemonade clients use the BURL extension to mail submission, an
   extension that requires sending a URLAUTH token to the mail
   submission server, such a token should be protected from interception
   to avoid a replay attack that may disclose the contents of the
   message to an attacker. TLS based encryption of the mail submission
   path will provide protection against this attack.
</p>
<p>Lemonade clients SHOULD use TLS-protected IMAP and mail submission
   channels when using BURL-based message submission to protect the
   URLAUTH token from interception.
</p>
<p>Lemonade compliant mail submission servers SHOULD use TLS-protected
   IMAP connections when fetching message content using the URLAUTH
   token provided by the Lemonade client.
</p>
<p>When a client uses SMTP STARTTLS to send a BURL command which
   references non-public information, there is a user expectation that
   the entire message content will be treated confidentially.  To meet
   this expectation, the message submission server should use STARTTLS
   or a mechanism providing equivalent data confidentiality when
   fetching the content referenced by that URL.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Additional extensions and deployment models</h3>

<p> This specification provides no additional security measures beyond those in the 
		    referenced Internet Mail and Lemonade documents.
</p>
<p> We note however the security risks associated to:
		 </p>
<ul class="text">
<li>Outband notifications
</li>
<li>Server configuration by client
</li>
<li>Client configuration by server
</li>
<li>Presence of proxy servers
</li>
<li>Presence of servers as intermediaries
</li>
<li>In general the deployment models considered by OMA MEM that are not conventional IETF deployment models.
</li>
<li>Measures to address a perceived need to traverse firewalls and mobile network intermediaries.
</li>
</ul>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA considerations</h3>

<p>
			IMAP4 capabilities are registered by publishing a standards track or 
			IESG approved experimental RFC.  The registry is currently located at 
			&lt;http://www.iana.org/assignments/imap4-capabilities&gt;. This document 
			defines the URL-PARTIAL IMAP capability <a class='info' href='#url-partial'>Section&nbsp;5.7.1<span> (</span><span class='info'>Support for PARTIAL in CATENATE and URLAUTH</span><span>)</span></a>.
			IANA is requested to add this extension to the IANA IMAP Capability registry.
			
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Version history</h3>

<p>
</p>
<p></p>
<ul class="text">
<li> Version 11:
		  
<ul class="text">
<li>Made ManageSieve reference Informative.
</li>
<li>Renamed $PendingSubmission to $SubmitPending, dropped $BeingSubmitted and added $Submitted IMAP keywords.
</li>
</ul>
	  
</li>
<li> Version 10:
		  
<ul class="text">
<li>Added ManageSieve.
</li>
<li>Added a requirement to support i;unicode-casemap in Sieve (already required in IMAP).
</li>
<li>Added description of various Sieve extensions.
</li>
<li>Added definition of URL-PARTIAL IMAP extension.
</li>
<li>Added definition of $PendingSubmission and $BeingSubmitted IMAP keywords.
</li>
</ul>
	  
</li>
<li> Version 9:
		  
<ul class="text">
<li>Updated references and removed extensions that there was an agreement to remove.
</li>
</ul>
	  
</li>
<li> Version 08: 
<ul class="text">
<li>Removed LIST-EXTENDED, WITHIN and QUICKSTART.
</li>
<li>Updated names of required extensions when they were renamed (e.g. COMPARATOR ==&gt; I18NLEVEL=1).
</li>
</ul>
	 
</li>
<li> Version 06: 
<ul class="text">
<li>Updated references and added extensions agreed at the Lemonade interim in Spring 2007.
</li>
<li>Require any Lemonade compliant IMAP server to support CAPABILITY response code.
</li>
</ul>
	 
</li>
<li> Version 04: 
<ul class="text">
<li>Major reorganization of text.
</li>
<li>Move checklist summary to beginning of document, collate Submission and Store server requirements.
</li>
</ul>
	 
</li>
<li> Version 03: 
<ul class="text">
<li> Replaced RECONNECT (server side quick reconned) with QRESYNC (client side quick reconnect)
</li>
<li> Added WITHIN and LIST-EXTENDED.
</li>
<li> Moved IDLE extension to a separate section.
</li>
<li> Added requirement for clients to use Format=flowed.
</li>
</ul>
</li>
<li> Version 02: 
<ul class="text">
<li> Update of references and how they are displayed in the text (Comments from Randy Gellens)
</li>
<li> Update of list of extensions to support as MUST by the Lemonade Profile Bis
</li>
<li> Update of options for compression via placeholder imap-compression section describing compression requirements
</li>
<li> Update of support of TCP chalenged environments
</li>
<li> Update of support of object level encryption
</li>
<li> Clarified the use of $Forwarded in the examples, and demonstrated how to remove the \Draft flag from the sent message
</li>
<li> Clarified $Forwarded 
</li>
<li> Added RECONNECT to imap-condstore section
</li>
<li> Add new section imap-bodypart, "Message part handling", describing BINARY and CONVERT requirements
</li>
<li> Added placeholder section for notifications
</li>
<li> Added various extensions to imap-other section, and added clarifying comments to IDLE, NAMESPACE, and a further references to TLS DEFLATE compression 
</li>
<li> Added extension names to IMAP table
</li>
<li> Fixed all issues found with original Lemonade profile so far.
</li>
</ul>
</li>
<li> Version 01: 
<ul class="text">
<li> Lemonade profile has been introduced in-line, with some updates / corrections. 
</li>
<li> Subsequent re-organization of the text
</li>
<li> Details of extensions proper to Lemonade Profile-bis have been updated to refer to the drafts newly accepted as WG IETF drafts.
</li>
<li> Addition of appendix on attachements streaming.
</li>
</ul>
</li>
<li> Version 00: 
<ul class="text">
<li>It evolved from a combination of the content 
		of Lemonade profile and the 
		OMA MEM realization internet draft.
</li>
</ul>
</li>
</ul>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>The editors acknowledge and appreciate the work and comments of the IETF Lemonade
                working group and the OMA MEM working group. 
</p>
<p>In particular, the editors would like to thank Eric Burger, Randall Gellens, Filip Navara, Zoltan Ordogh, Greg Vaudreuil, and Fan Xiaohui for their comments and reviews.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FLOWED">[FLOWED]</a></td>
<td class="author-text">Gellens, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3676">The Text/Plain Format and DelSp Parameters</a>,&rdquo; RFC&nbsp;3676, February&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3676.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP">[IMAP]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-BINARY">[IMAP-BINARY]</a></td>
<td class="author-text">Nerenberg, L., &ldquo;<a href="http://tools.ietf.org/html/rfc3516">IMAP4 Binary Content Extension</a>,&rdquo; RFC&nbsp;3516, April&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-CATENATE">[IMAP-CATENATE]</a></td>
<td class="author-text"><a href="mailto:presnick@qualcomm.com">Resnick, P.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4469">Internet Message Access Protocol (IMAP) CATENATE
            Extension</a>,&rdquo; RFC&nbsp;4469, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4469.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4469.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4469.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-COMPRESS">[IMAP-COMPRESS]</a></td>
<td class="author-text">Gulbrandsen, A., &ldquo;<a href="http://tools.ietf.org/html/rfc4978">The IMAP COMPRESS Extension</a>,&rdquo; RFC&nbsp;4978, August&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4978.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-CONDSTORE">[IMAP-CONDSTORE]</a></td>
<td class="author-text">Melnikov, A. and S. Hole, &ldquo;<a href="http://tools.ietf.org/html/rfc4551">IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization</a>,&rdquo; RFC&nbsp;4551, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4551.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-CONTEXT">[IMAP-CONTEXT]</a></td>
<td class="author-text">Cridland, D. and C. King, &ldquo;<a href="http://tools.ietf.org/html/rfc5267">Contexts for IMAP4</a>,&rdquo; RFC&nbsp;5267, July&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5267.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-CONVERT">[IMAP-CONVERT]</a></td>
<td class="author-text">Melnikov, A. and P. Coates, &ldquo;<a href="http://tools.ietf.org/html/rfc5259">Internet Message Access Protocol - CONVERT Extension</a>,&rdquo; RFC&nbsp;5259, July&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5259.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-ENABLE">[IMAP-ENABLE]</a></td>
<td class="author-text">Gulbrandsen, A. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc5161">The IMAP ENABLE Extension</a>,&rdquo; RFC&nbsp;5161, March&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5161.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-ESEARCH">[IMAP-ESEARCH]</a></td>
<td class="author-text">Melnikov, A. and D. Cridland, &ldquo;<a href="http://tools.ietf.org/html/rfc4731">IMAP4 Extension to SEARCH Command for Controlling What Kind of Information Is Returned</a>,&rdquo; RFC&nbsp;4731, November&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4731.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-I18N">[IMAP-I18N]</a></td>
<td class="author-text">Newman, C., Gulbrandsen, A., and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc5255">Internet Message Access Protocol Internationalization</a>,&rdquo; RFC&nbsp;5255, June&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5255.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-IDLE">[IMAP-IDLE]</a></td>
<td class="author-text"><a href="mailto:leiba@watson.ibm.com">Leiba, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2177">IMAP4 IDLE command</a>,&rdquo; RFC&nbsp;2177, June&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2177.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2177.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2177.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-LITERAL+">[IMAP-LITERAL+]</a></td>
<td class="author-text"><a href="mailto:jgm+@cmu.edu">Myers, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2088">IMAP4 non-synchronizing literals</a>,&rdquo; RFC&nbsp;2088, January&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2088.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-NAMESPACE">[IMAP-NAMESPACE]</a></td>
<td class="author-text"><a href="mailto:mikega@microsoft.com">Gahrns, M.</a> and <a href="mailto:chris.newman@innosoft.com">C. Newman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2342">IMAP4 Namespace</a>,&rdquo; RFC&nbsp;2342, May&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2342.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2342.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-NOTIFY">[IMAP-NOTIFY]</a></td>
<td class="author-text">Gulbrandsen, A., Melnikov, A., and C. King, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-imap-notify-07.txt">The IMAP NOTIFY Extension</a>,&rdquo; draft-ietf-lemonade-imap-notify-07 (work in progress), August&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-imap-notify-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-QRESYNC">[IMAP-QRESYNC]</a></td>
<td class="author-text">Melnikov, A., Cridland, D., and C. Wilson, &ldquo;<a href="http://tools.ietf.org/html/rfc5162">IMAP4 Extensions for Quick Mailbox Resynchronization</a>,&rdquo; RFC&nbsp;5162, March&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5162.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-SASL-IR">[IMAP-SASL-IR]</a></td>
<td class="author-text">Siemborski, R. and A. Gulbrandsen, &ldquo;<a href="http://tools.ietf.org/html/rfc4959">IMAP Extension for Simple Authentication and Security Layer (SASL) Initial Client Response</a>,&rdquo; RFC&nbsp;4959, September&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4959.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-SORT">[IMAP-SORT]</a></td>
<td class="author-text">Crispin, M. and K. Murchison, &ldquo;<a href="http://tools.ietf.org/html/rfc5256">Internet Message Access Protocol - SORT and THREAD Extensions</a>,&rdquo; RFC&nbsp;5256, June&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5256.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-UIDPLUS">[IMAP-UIDPLUS]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4315">Internet Message Access Protocol (IMAP) - UIDPLUS extension</a>,&rdquo; RFC&nbsp;4315, December&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-URL">[IMAP-URL]</a></td>
<td class="author-text">Melnikov, A. and C. Newman, &ldquo;<a href="http://tools.ietf.org/html/rfc5092">IMAP URL Scheme</a>,&rdquo; RFC&nbsp;5092, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5092.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-URLAUTH">[IMAP-URLAUTH]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4467">Internet Message Access Protocol (IMAP) - URLAUTH Extension</a>,&rdquo; RFC&nbsp;4467, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4467.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KEYWORDS">[KEYWORDS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE">[SIEVE]</a></td>
<td class="author-text">Guenther, P. and T. Showalter, &ldquo;<a href="http://tools.ietf.org/html/rfc5228">Sieve: An Email Filtering Language</a>,&rdquo; RFC&nbsp;5228, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5228.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE-IMAP4FLAGS">[SIEVE-IMAP4FLAGS]</a></td>
<td class="author-text">Melnikov, A., &ldquo;<a href="http://tools.ietf.org/html/rfc5232">Sieve Email Filtering: Imap4flags Extension</a>,&rdquo; RFC&nbsp;5232, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5232.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE-NOTIFY">[SIEVE-NOTIFY]</a></td>
<td class="author-text">Melnikov, A., Leiba, B., Segmuller, W., and T. Martin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sieve-notify-12.txt">SIEVE Email Filtering: Extension for Notifications</a>,&rdquo; draft-ietf-sieve-notify-12 (work in progress), December&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sieve-notify-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE-RELATIONAL">[SIEVE-RELATIONAL]</a></td>
<td class="author-text">Segmuller, W. and B. Leiba, &ldquo;<a href="http://tools.ietf.org/html/rfc5231">Sieve Email Filtering: Relational Extension</a>,&rdquo; RFC&nbsp;5231, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5231.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE-VACATION">[SIEVE-VACATION]</a></td>
<td class="author-text">Showalter, T. and N. Freed, &ldquo;<a href="http://tools.ietf.org/html/rfc5230">Sieve Email Filtering: Vacation Extension</a>,&rdquo; RFC&nbsp;5230, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5230.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIEVE-VARIABLES">[SIEVE-VARIABLES]</a></td>
<td class="author-text">Homme, K., &ldquo;<a href="http://tools.ietf.org/html/rfc5229">Sieve Email Filtering: Variables Extension</a>,&rdquo; RFC&nbsp;5229, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5229.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-8BITMIME">[SMTP-8BITMIME]</a></td>
<td class="author-text"><a href="mailto:klensin@mci.net">Klensin, J.</a>, <a href="mailto:ned@innosoft.com">Freed, N.</a>, <a href="mailto:mrose@dbc.mtview.ca.us">Rose, M.</a>, <a href="mailto:stef@nma.com">Stefferud, E.</a>, and <a href="mailto:dcrocker@sgi.com">D. Crocker</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1652">SMTP Service Extension for 8bit-MIMEtransport</a>,&rdquo; RFC&nbsp;1652, July&nbsp;1994 (<a href="ftp://ftp.isi.edu/in-notes/rfc1652.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-AUTH">[SMTP-AUTH]</a></td>
<td class="author-text">Siemborski, R. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc4954">SMTP Service Extension for Authentication</a>,&rdquo; RFC&nbsp;4954, July&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4954.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-BINARYMIME">[SMTP-BINARYMIME]</a></td>
<td class="author-text">Vaudreuil, G., &ldquo;<a href="http://tools.ietf.org/html/rfc3030">SMTP Service Extensions for Transmission of Large and Binary MIME Messages</a>,&rdquo; RFC&nbsp;3030, December&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc3030.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-BURL">[SMTP-BURL]</a></td>
<td class="author-text">Newman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4468">Message Submission BURL Extension</a>,&rdquo; RFC&nbsp;4468, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4468.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-DSN">[SMTP-DSN]</a></td>
<td class="author-text">Moore, K., &ldquo;<a href="http://tools.ietf.org/html/rfc3461">Simple Mail Transfer Protocol (SMTP) Service Extension for Delivery Status Notifications (DSNs)</a>,&rdquo; RFC&nbsp;3461, January&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3461.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-PIPELINING">[SMTP-PIPELINING]</a></td>
<td class="author-text">Freed, N., &ldquo;<a href="http://tools.ietf.org/html/rfc2920">SMTP Service Extension for Command Pipelining</a>,&rdquo; STD&nbsp;60, RFC&nbsp;2920, September&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2920.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-SIZE">[SMTP-SIZE]</a></td>
<td class="author-text"><a href="mailto:klensin@mci.net">Klensin, J.</a>, <a href="mailto:ned@innosoft.com">Freed, N.</a>, and <a href="mailto:moore@cs.utk.edu">K. Moore</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1870">SMTP Service Extension for Message Size Declaration</a>,&rdquo; STD&nbsp;10, RFC&nbsp;1870, November&nbsp;1995 (<a href="ftp://ftp.isi.edu/in-notes/rfc1870.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-STATUSCODES">[SMTP-STATUSCODES]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2034">SMTP Service Extension for Returning Enhanced Error Codes</a>,&rdquo; RFC&nbsp;2034, October&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2034.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2034.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2034.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-TLS">[SMTP-TLS]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>,&rdquo; RFC&nbsp;3207, February&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3207.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SUBMIT">[SUBMIT]</a></td>
<td class="author-text">Gellens, R. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4409">Message Submission for Mail</a>,&rdquo; RFC&nbsp;4409, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4409.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS-COMP">[TLS-COMP]</a></td>
<td class="author-text">Hollenbeck, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3749">Transport Layer Security Protocol Compression Methods</a>,&rdquo; RFC&nbsp;3749, May&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3749.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UNICODE-CASEMAP">[UNICODE-CASEMAP]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5051">i;unicode-casemap - Simple Unicode Collation Algorithm</a>,&rdquo; RFC&nbsp;5051, October&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5051.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ESMTP">[ESMTP]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc2821">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001 (<a href="ftp://ftp.isi.edu/in-notes/rfc2821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="FINGER-HACK">[FINGER-HACK]</a></td>
<td class="author-text">Gellens, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4146">Simple New Mail Notification</a>,&rdquo; RFC&nbsp;4146, August&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4146.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-FILTERS">[IMAP-FILTERS]</a></td>
<td class="author-text">Melnikov, A. and C. King, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-melnikov-imapext-filters-06.txt">IMAP4 extension for named searches (filters)</a>,&rdquo; draft-melnikov-imapext-filters-06 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-melnikov-imapext-filters-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP-SYNC-HOWTO">[IMAP-SYNC-HOWTO]</a></td>
<td class="author-text">Melnikov, A., &ldquo;<a href="http://tools.ietf.org/html/rfc4549">Synchronization Operations for Disconnected IMAP4 Clients</a>,&rdquo; RFC&nbsp;4549, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4549.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LEMONADE-DEPLOYMENTS">[LEMONADE-DEPLOYMENTS]</a></td>
<td class="author-text">Gellens, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-deployments-09.txt">Deployment Considerations for lemonade-compliant Mobile Email</a>,&rdquo; draft-ietf-lemonade-deployments-09 (work in progress), June&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-deployments-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MANAGESIEVE">[MANAGESIEVE]</a></td>
<td class="author-text">Melnikov, A. and T. Martin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-martin-managesieve-12.txt">A Protocol for Remotely Managing Sieve Scripts</a>,&rdquo; draft-martin-managesieve-12 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-martin-managesieve-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="METADATA">[METADATA]</a></td>
<td class="author-text">Daboo, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-daboo-imap-annotatemore-14.txt">IMAP METADATA Extension</a>,&rdquo; draft-daboo-imap-annotatemore-14 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-daboo-imap-annotatemore-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OMA-EMN">[OMA-EMN]</a></td>
<td class="author-text">Open Mobile Alliance, &ldquo;<a href="http://www.openmobilealliance.org/tech/docs/EmailNot/OMA-Push-EMN-V1_0-20020830-C.pdf">Open Mobile Alliance Email Notification Version 1.0</a>,&rdquo; OMA&nbsp;http://www.openmobilealliance.org/tech/docs/EmailNot/OMA-Push-EMN-V1_0-20020830-C.pdf, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="OMA-MEM-ARCH">[OMA-MEM-ARCH]</a></td>
<td class="author-text">Open Mobile Alliance, &ldquo;<a href="http://www.openmobilealliance.org/">Mobile Email Architecture Document</a>,&rdquo; OMA&nbsp;(Work in Progress), http://www.openmobilealliance.org/, October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OMA-MEM-REQ">[OMA-MEM-REQ]</a></td>
<td class="author-text">Open Mobile Alliance, &ldquo;<a href="http://www.openmobilealliance.org/release_program/docs/RD/OMA-RD-MobileEmail-V1_0_20051018-C.pdf">Mobile Email Requirements Document</a>,&rdquo; OMA&nbsp;http://www.openmobilealliance.org/release_program/docs/RD/OMA-RD-MobileEmail-V1_0_20051018-C.pdf, Oct&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Cridland (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Isode Limited</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5 Castle Business Village</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">36 Station Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hampton, Middlesex  TW12 2BX</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dave.cridland@isode.com">dave.cridland@isode.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alexey Melnikov (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Isode Limited</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5 Castle Business Village</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">36 Station Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hampton, Middlesex  TW12 2BX</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Alexey.Melnikov@isode.com">Alexey.Melnikov@isode.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stephane H. Maes (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Oracle</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MS 4op634, 500 Oracle Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redwood Shores, CA  94539</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-203-300-7786</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stephane.maes@oracle.com">stephane.maes@oracle.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
