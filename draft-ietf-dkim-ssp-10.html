<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)">
<meta name="keywords" content="email, e-mail, rfc5322, rfc 5322, rfc822, rfc 822, rfc5321, rfc
      5321, rfc821, rfc 821, rfc4871, rfc 4871, DKIM, domain keys, domainkeys,
      ADSP, ADSP, SSP, architecture, mta, user, delivery, smtp, submission,
      email, e-mail, smtp, Internet, mailfrom, mail from, author, return
      address, sender signing, signing practices">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Allman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Sendmail, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Fenton</td></tr>
<tr><td class="header">Expires: November 12, 2009</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Delany</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Yahoo! Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Levine</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Taughannock Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">May 11, 2009</td></tr>
</table></td></tr></table>
<h1><br />DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)<br />draft-ietf-dkim-ssp-10</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 12, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>DomainKeys Identified Mail (DKIM) defines a domain-level
        authentication framework for email to permit verification of the
        source and contents of messages. This document specifies an adjunct
        mechanism to aid in assessing messages that do not contain a DKIM
        signature for the domain used in the author's address. It defines a
        record that can advertise whether a domain signs its outgoing mail, and
        how other hosts can access that record. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Language and Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Terms Imported from DKIM Signatures Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Valid Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Author Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Author Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.5.</a>&nbsp;
Alleged Author<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.6.</a>&nbsp;
Author Domain Signing Practices<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.7.</a>&nbsp;
Author Domain Signature<br />
<a href="#anchor10">3.</a>&nbsp;
Operation Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#applicability">3.1.</a>&nbsp;
ADSP Applicability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#usage">3.2.</a>&nbsp;
ADSP Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.3.</a>&nbsp;
ADSP Results<br />
<a href="#anchor12">4.</a>&nbsp;
Detailed Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnsrep">4.1.</a>&nbsp;
DNS Representation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.</a>&nbsp;
Publication of ADSP Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Lookup">4.3.</a>&nbsp;
ADSP Lookup Procedure<br />
<a href="#anchor14">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.</a>&nbsp;
ADSP Specification Tag Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.2.</a>&nbsp;
ADSP Outbound Signing Practices Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana_auth_results_method">5.3.</a>&nbsp;
Authentication-Results Method Registry Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana_auth_results_results">5.4.</a>&nbsp;
Authentication-Results Result Registry Update<br />
<a href="#anchor17">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.1.</a>&nbsp;
ADSP Threat Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.2.</a>&nbsp;
DNS Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wildcards">6.3.</a>&nbsp;
DNS Wildcards<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.4.</a>&nbsp;
Inappropriate Application of Author Domain Signatures<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
References - Normative<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
References - Informative<br />
<a href="#lookupex">Appendix&nbsp;A.</a>&nbsp;
Lookup Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">A.1.</a>&nbsp;
Domain and ADSP exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">A.2.</a>&nbsp;
Domain exists, ADSP does not exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">A.3.</a>&nbsp;
Domain does not exist<br />
<a href="#anchor26">Appendix&nbsp;B.</a>&nbsp;
Usage Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#allexamp">B.1.</a>&nbsp;
Single Location Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">B.2.</a>&nbsp;
Bulk Mailing Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">B.3.</a>&nbsp;
Bulk Mailing Domains with Discardable Mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">B.4.</a>&nbsp;
Third Party Senders<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">B.5.</a>&nbsp;
Domains with Independent Users and Liberal Use Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">B.6.</a>&nbsp;
Non-email Domains<br />
<a href="#anchor32">Appendix&nbsp;C.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor33">Appendix&nbsp;D.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">D.1.</a>&nbsp;
Changes since -ietf-dkim-09<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">D.2.</a>&nbsp;
Changes since -ietf-dkim-08<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">D.3.</a>&nbsp;
Changes since -ietf-dkim-07<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">D.4.</a>&nbsp;
Changes since -ietf-dkim-06<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">D.5.</a>&nbsp;
Changes since -ietf-dkim-05<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">D.6.</a>&nbsp;
Changes since -ietf-dkim-04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">D.7.</a>&nbsp;
Changes since -ietf-dkim-03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">D.8.</a>&nbsp;
Changes since -ietf-dkim-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">D.9.</a>&nbsp;
Changes since -ietf-dkim-ssp-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">D.10.</a>&nbsp;
Changes since -ietf-dkim-ssp-00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">D.11.</a>&nbsp;
Changes since -allman-ssp-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">D.12.</a>&nbsp;
Changes since -allman-ssp-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">D.13.</a>&nbsp;
Changes since -allman-ssp-00<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>DomainKeys Identified Mail (DKIM) defines a mechanism by which email
        messages can be cryptographically signed, permitting a signing domain
        to claim responsibility for the introduction of a message into the
        mail stream. Message recipients can verify the signature by querying
        the signer's domain directly to retrieve the appropriate public key,
        and thereby confirm that the message was attested to by a party in
        possession of the private key for the signing domain.
</p>
<p>However, the legacy of the Internet is such that not all messages
        will be signed, and the absence of a signature on a message is not an
        a priori indication of forgery. In fact, during early phases of
        deployment it is very likely that most messages will remain unsigned.
        However, some domains might decide to sign all of their outgoing mail,
        for example, to protect their brand names. It might be
	desirable for such
        domains to be able to advertise that fact to other hosts. This is the
        topic of Author Domain Signing Practices (ADSP).
</p>
<p>Hosts implementing this specification can inquire what Author Domain
	Signing
        Practices a domain advertises. This inquiry is called an Author
        Domain Signing Practices check.
</p>
<p>The basic requirements for ADSP are given in <a class='info' href='#RFC5016'>[RFC5016]<span> (</span><span class='info'>Thomas, M., &ldquo;Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a>. This document refers extensively to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> and
        assumes the reader is familiar with it.
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Requirements Notation:  </dt>
<dd> The key words "MUST", "MUST
            NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
            "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
            interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Language and Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terms Imported from DKIM Signatures Specification</h3>

<p>Some terminology used herein is derived directly from <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. In several cases, references in that document
          to Sender have been changed to Author here, to emphasize the
          relationship to the Author address(es) in the From: header field
          described in <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. Briefly, </p>
<ul class="text">
<li>A "Signer" is the agent that signs a message, as defined in
              section 2.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>A "Local-part" is the part of an address preceding the @ character,
              as defined in <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> and used in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Valid Signature</h3>

<p>A "Valid Signature" is any signature on a message which correctly
          verifies using the procedure described in section 6.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Author Address</h3>

<p>An "Author Address" is an email address in the From header field of
          a message <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. If the From header field
          contains multiple addresses, the message has multiple Author
          Addresses.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Author Domain</h3>

<p>An "Author Domain" is everything to the right of the "@" in an
          Author Address (excluding the "@" itself).
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Alleged Author</h3>

<p>An "Alleged Author" is an Author Address of a message; it is
          "alleged" because it has not yet been checked.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Author Domain Signing Practices</h3>

<p>"Author Domain Signing Practices" (or just "practices") consist of
          a machine-readable record published by the domain of an Alleged
          Author which includes statements about the domain's practices with
          respect to mail it sends with its domain in the From: line.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7"></a><h3>2.7.&nbsp;
Author Domain Signature</h3>

<p>An "Author Domain Signature" is a Valid Signature in which
	  the domain name of the DKIM signing entity,
	  the d= tag in the DKIM-Signature header field,
	  is the same as the domain name in the Author Address.
	  Following <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>, 
	  domain name comparisons are case insensitive.
</p>
<p>For example, if the From: line address is bob@domain.example,
	  and the message has a Valid Signature, with the
          DKIM-Signature header field containing <tt>d=domain.example</tt>, then the message has an Author
	  Domain Signature.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operation Overview</h3>

<p>Domain owners publish ADSP information via a query mechanism such
        as the Domain Name System; specific details are given in <a class='info' href='#dnsrep'>Section&nbsp;4.1<span> (</span><span class='info'>DNS Representation</span><span>)</span></a>.
</p>
<p>Hosts can look up the ADSP information of the domain(s) specified by
        the Author Address(es) as described in <a class='info' href='#Lookup'>Section&nbsp;4.3<span> (</span><span class='info'>ADSP Lookup Procedure</span><span>)</span></a>. If a
        message has multiple Author Addresses the ADSP lookups SHOULD be
        performed independently on each address. This document does not
        address the process a host might use to combine the lookup results. 
</p>
<a name="applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
ADSP Applicability</h3>

<p> ADSP as defined in this document is bound to DNS. For this reason,
          ADSP is applicable only to Author Domains with appropriate DNS
          records (see Note below). The handling of other Author Domains is
          outside the scope of this document. However, attackers may use such
          domain names in a deliberate attempt to sidestep an organization's
          ADSP policy statements. It is up to the ADSP checker implementation
          to return an appropriate error result for Author Domains outside the
          scope of ADSP.
</p>
<p>ADSP applies to specific domains, not domain subtrees.
	  If, for example, an Author Address were user@domain.example, the
	  Author Domain would be domain.example, and the applicable ADSP
	  record would be at _adsp._domainkey.domain.example.
	  An Author Address in a subdomain such as user@sub.domain.example
	  would have a different ADSP record at
	  _adsp._domainkey.sub.domain.example.
	  ADSP makes no connection between a domain and its parent or
	  child domains.
	  
	  </p>
<blockquote class="text"><dl>
<dt>Note:  </dt>
<dd>If an organization wants
	      to publish Author Domain Signing
	      Practices for all the subdomains it uses, such as host names
	      of servers within the domain,
	      it does so by creating ADSP
	      records for every _adsp._domainkey.&lt;sub&gt;.domain.example.
	      Wildcards cannot be used (see <a class='info' href='#wildcards'>Section&nbsp;6.3<span> (</span><span class='info'>DNS Wildcards</span><span>)</span></a>.);
	      however, suitable DNS management tools
	      could automate creation of the ADSP records.
</dd>
<dt>Note:  </dt>
<dd> The results from DNS queries that are
              intended to validate a domain name unavoidably approximate
              the set of Author Domains that can appear in legitimate email.
              For example, a DNS A record could belong to a device that does
              not even have an email implementation. It is up to the checker
              to decide what degree of approximation is acceptable.
</dd>
</dl></blockquote>

<a name="usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
ADSP Usage</h3>

<p>Depending on the Author Domain(s) and the signatures in a message,
          a recipient gets varying amounts of useful information from each
          ADSP lookup. </p>
<ul class="text">
<li>If a message has no Valid Signature, the ADSP result is
              directly relevant to the message.
</li>
<li>If a message has an Author Domain Signature, ADSP
              provides no benefit relative to that domain since the message is
              already known to be compliant with any possible ADSP for that
              domain.
</li>
<li>If a message has a Valid Signature other than an
              Author Domain Signature, the receiver can use both the Signature and the
              ADSP result in its evaluation of the message.
</li>
</ul>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
ADSP Results</h3>

<p>An ADSP lookup for an Author Address produces one of four possible
          results: </p>
<ul class="text">
<li>Messages from this domain might or might not have an author
              domain signature. This is the default if the domain exists in the DNS
              but no ADSP record is found.
</li>
<li>All messages from this domain are signed with
	      an Author Domain Signature.
</li>
<li>All messages from this domain are signed with an Author
	      Domain Signature and
	      discardable, i.e., if a message
	      arrives without a valid Author Domain Signature,
	      the domain encourages the recipient(s) to discard it.
</li>
<li>This domain is out of scope, i.e., the domain does not
	      exist in the DNS.
</li>
</ul>

<p>An ADSP lookup could terminate without producing any result if
	a DNS lookup results in a temporary failure.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Detailed Description</h3>

<a name="dnsrep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DNS Representation</h3>

<p>ADSP records are published using the DNS TXT resource record type.
</p>
<p>The RDATA for ADSP resource records is textual in format, with
          specific syntax and semantics relating to their role in describing
          ADSP. The "Tag=Value List" syntax described in section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> is used, modified to use WSP rather than FWS.
	  Records not in compliance with that
          syntax or the syntax of individual tags described in Section 4.3
          MUST be ignored (considered equivalent to a NODATA result) for
          purposes of ADSP, although they MAY cause the logging of warning
          messages via an appropriate system logging mechanism. If the RDATA
          contains multiple character strings, the strings are logically
          concatenated with no delimiters between the strings. 
	  </p>
<blockquote class="text"><dl>
<dt>Note:  </dt>
<dd> ADSP changes the "Tag=Value List" syntax
	      from  <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> to use WSP rather than FWS
	      in its DNS records.
</dd>
<dt>Note:  </dt>
<dd>
	      Domains
	      MUST NOT publish ADSP records with wildcard names.
              Wildcards within a domain publishing ADSP records pose
	      a particular
              problem, as discussed in more detail in 
	      <a class='info' href='#wildcards'>Section&nbsp;6.3<span> (</span><span class='info'>DNS Wildcards</span><span>)</span></a>.
</dd>
</dl></blockquote>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Publication of ADSP Records</h3>

<p>ADSP is intended to apply to all mail sent using the domain name
          string of an Alleged Author.
</p>
<a name="syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Record Syntax</h3>

<p>ADSP records use the "tag=value" syntax described in section 3.2
            of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>, modified to use WSP rather than FWS.
	  Every ADSP record MUST start with an outbound signing practices
	    tag, so
	    the first four characters of the record are lower case "dkim",
	    followed by optional whitespace and "=".
</p>
<p>Tags used in ADSP records are described below. Unrecognized tags
            MUST be ignored. In the ABNF below, the WSP token,
	    and the ALPHA and DIGIT tokens are
            imported from <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>. </p>
<blockquote class="text"><dl>
<dt>dkim=  </dt>
<dd>Outbound signing practices for the domain
                (plain-text; REQUIRED). Possible values are as follows: 
<blockquote class="text"><dl>
<dt>unknown  </dt>
<dd>The domain might sign some or all
                    email.
</dd>
<dt>all  </dt>
<dd>All mail from the domain is signed with
                    an Author Domain Signature.
</dd>
<dt>discardable  </dt>
<dd>All mail from the domain is
                    signed with an Author Domain Signature. Furthermore, if a message
                    arrives without a valid Author Domain Signature due to
                    modification in transit, submission via a path without
                    access to a signing key, or any other reason, the domain
                    encourages the recipient(s) to discard it.
</dd>
</dl></blockquote>
		Any other values are treated as "unknown".
                
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>adsp-dkim-tag = %x64.6b.69.6d *WSP "=" *WSP
                ("unknown" / "all" / "discardable")</pre></div>
              
</dd>
</dl></blockquote>

<a name="Lookup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
ADSP Lookup Procedure</h3>

<p>Hosts doing an ADSP lookup MUST produce a result that is
            semantically equivalent to applying the following steps in the
            order listed below. In practice, these steps can be
            performed in parallel in order to improve performance. However,
            implementations SHOULD avoid doing unnecessary DNS lookups.
</p>
<p>For the purposes of this section a "valid ADSP record" is one that
          is both syntactically and semantically correct; in particular, it
          matches the ABNF for a <tt>tag-list</tt> and
          starts with a valid <tt>dkim</tt> tag.
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Check Domain Scope:  </dt>
<dd> An ADSP checker
              implementation MUST determine whether a given Author Domain is
              within scope for ADSP. Given the background in <a class='info' href='#applicability'>Section&nbsp;3.1<span> (</span><span class='info'>ADSP Applicability</span><span>)</span></a> the checker MUST decide which
              degree of approximation is acceptable. The checker MUST
              return an appropriate error result for Author Domains that are
              outside the scope of ADSP.
</dd>
<dt></dt>
<dd>The host MUST
              perform a DNS query for a record corresponding to the Author
              Domain (with no prefix). The type of the query can be of any type,
              since this step is only to determine if the domain itself exists
              in DNS. This query MAY be done in parallel with the query to
              fetch the named ADSP Record. If the result of this query is that
	      the Author domain does not exist in the DNS (often called an
	      NXDOMAIN error, rcode=3 in <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>), the algorithm
	      MUST terminate with an error indicating that the domain is
	      out of scope.
	      Note that a result with rcode=0 but no records
	      (often called NODATA)
	      is not the same as NXDOMAIN.
	      
<blockquote class="text">
<p>NON-NORMATIVE DISCUSSION: Any resource record type
                could be used for this query since the existence of a
                resource record of any type will prevent an
                NXDOMAIN error. 
                MX is a reasonable choice for
                this purpose because this record type is thought to
                be the most common for domains used in e-mail, and will
                therefore produce a result which can be more readily
                cached than a negative result.
</p>
</blockquote>
</dd>
<dt></dt>
<dd>If the domain does exist,
	      the checker MAY make more extensive checks to verify the
	      existence of the domain, such as the ones described in
	      Section 5 of <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
	      If those checks indicate that the Author domain does not exist
	      for mail, e.g., the domain has no MX, A, or AAAA record,
	      the checker SHOULD terminate with an error
	      indicating that the domain is out of scope.
	    
</dd>
<dt>Fetch Named ADSP Record:  </dt>
<dd>The host MUST query DNS
              for a TXT record corresponding to the Author Domain prefixed by
                <tt>_adsp._domainkey.</tt> (note the
              trailing dot).
</dd>
<dt></dt>
<dd>If the result of this query is a 
              NOERROR response (rcode=0 in <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>)
	      with an answer which is a single record that is a valid ADSP
              record, use that record, and the algorithm
              terminates.
</dd>
<dt></dt>
<dd>If the result of the query is NXDOMAIN or NOERROR with zero
	      records, there is no ADSP record.
	      If the result of the query contains more than one record,
	      or a record that is not a valid ADSP record,
	      the ADSP result is undefined.
</dd>
<dt></dt>
<dd>If a query results in a <tt>SERVFAIL</tt>
              error response (rcode=2 in <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>), the algorithm terminates without returning a
              result; possible actions include queuing the message or
              returning an SMTP error indicating a temporary failure.
</dd>
</dl></blockquote><p>
        
</p>
<p>See <a class='info' href='#lookupex'>Appendix&nbsp;A<span> (</span><span class='info'>Lookup Examples</span><span>)</span></a> for examples of ADSP Lookup.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>ADSP adds the following namespaces to the IANA registry. In all
        cases, new values are assigned only for values that have been
        documented in a published RFC after IETF Review as specified in <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
ADSP Specification Tag Registry</h3>

<p>An ADSP record provides for a list of specification tags. IANA has
          established the ADSP Specification Tag Registry for specification
          tags that can be used in ADSP fields.
</p>
<p>The initial entry in the registry is: </p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>+------+-----------------+
| TYPE | REFERENCE       |
+------+-----------------+
| dkim | (this document) |
+------+-----------------+</pre></div><p>

<p>ADSP Specification Tag Registry Initial
            Values
</p>
        

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
ADSP Outbound Signing Practices Registry</h3>

<p>The <tt>dkim=</tt> tag spec, defined in <a class='info' href='#syntax'>Section&nbsp;4.2.1<span> (</span><span class='info'>Record Syntax</span><span>)</span></a>, provides for a value specifying Outbound
          Signing Practices. IANA has established the ADSP Outbound Signing
          Practices Registry for Outbound Signing Practices.
</p>
<p>The initial entries in the registry comprise: </p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>+-------------+-----------------+
| TYPE        | REFERENCE       |
+-------------+-----------------+
| unknown     | (this document) |
| all         | (this document) |
| discardable | (this document) |
+-------------+-----------------+</pre></div><p>

<p>ADSP Outbound Signing Practices Registry Initial
            Values
</p>
        

<a name="iana_auth_results_method"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Authentication-Results Method Registry Update</h3>

<p> IANA is requested to add the following to the
	 	    Email Authentication Method Name Registry:

		</p>
<blockquote class="text"><dl>
<dt>Method:</dt>
<dd> dkim-adsp 
</dd>
<dt>Defined In:</dt>
<dd> this memo 
</dd>
<dt>ptype:</dt>
<dd> header 
</dd>
<dt>property:</dt>
<dd> from 
</dd>
<dt>value:</dt>
<dd> Contents of the
			  <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>
				From: header field, with comments removed 
</dd>
</dl></blockquote>

<a name="iana_auth_results_results"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Authentication-Results Result Registry Update</h3>

<p> IANA is requested to add or update the following in the
	 	    Email Authentication Result Name Registry:

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> none 
</dd>
<dt>Existing/New Code:</dt>
<dd> existing 
</dd>
<dt>Defined In:</dt>
<dd> <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp (added) 
</dd>
<dt>Meaning:</dt>
<dd> No DKIM author domain signing
				practises (ADSP) record was published. 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> pass 
</dd>
<dt>Existing/New Code:</dt>
<dd> existing 
</dd>
<dt>Defined In:</dt>
<dd> <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp (added) 
</dd>
<dt>Meaning:</dt>
<dd> This message had an Author
				Domain Domain Signature that was validated.  (An ADSP
				check is not strictly required to be performed
				for this result, since a valid Author Domain 
				Signature satisfies all possible ADSP
				policies.) 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> unknown 
</dd>
<dt>Existing/New Code:</dt>
<dd> new 
</dd>
<dt>Defined In:</dt>
<dd> this memo 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp 
</dd>
<dt>Meaning:</dt>
<dd> No valid Author Domain
				Signature was found on the message and the
				published ADSP was "unknown". 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> fail 
</dd>
<dt>Existing/New Code:</dt>
<dd> existing 
</dd>
<dt>Defined In:</dt>
<dd> <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp (added) 
</dd>
<dt>Meaning:</dt>
<dd> No valid Author Domain
				Signature was found on the message and the
				published ADSP was "all". 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> discard 
</dd>
<dt>Existing/New Code:</dt>
<dd> new 
</dd>
<dt>Defined In:</dt>
<dd> this memo 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp 
</dd>
<dt>Meaning:</dt>
<dd> No valid Author Domain
				Signature was found on the message and the
			  published ADSP was "discardable". 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> nxdomain 
</dd>
<dt>Existing/New Code:</dt>
<dd> new 
</dd>
<dt>Defined In:</dt>
<dd> this memo 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp 
</dd>
<dt>Meaning:</dt>
<dd> Evaluating the ADSP for the
				Author's DNS domain indicated that the
				Author's DNS domain does not exist. 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> temperror 
</dd>
<dt>Existing/New Code:</dt>
<dd> existing 
</dd>
<dt>Defined In:</dt>
<dd> <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp (added) 
</dd>
<dt>Meaning:</dt>
<dd> An ADSP record could not be
				retrieved due to some error that is likely
				transient in nature, such as a temporary
				DNS error.  A later attempt may produce
				a final result. 
</dd>
</dl></blockquote><p>

		</p>
<blockquote class="text"><dl>
<dt>Code:</dt>
<dd> permerror 
</dd>
<dt>Existing/New Code:</dt>
<dd> existing 
</dd>
<dt>Defined In:</dt>
<dd> <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> 
</dd>
<dt>Auth Method:</dt>
<dd> dkim-adsp (added) 
</dd>
<dt>Meaning:</dt>
<dd> An ADSP record could not be
				retrieved due to some error that is likely not
				transient in nature, such as a permanent
				DNS error.  A later attempt is unlikely to
				produce a final result. 
</dd>
</dl></blockquote>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Security considerations in the ADSP are mostly related to attempts on
        the part of malicious senders to represent themselves as authors for
        whom they are not authorized to send mail, often in an attempt to
        defraud either the recipient or an Alleged Author.
</p>
<p>Additional security considerations regarding Author Domain Signing
        Practices are found in <a class='info' href='#RFC4686'>the DKIM threat
        analysis<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a> [RFC4686].
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
ADSP Threat Model</h3>

<p>Email recipients often have a core set of content authors that they
          already trust. Common examples include financial institutions with
          which they have an existing relationship and Internet web
          transaction sites with which they conduct business.
</p>
<p>Email abuse often seeks to exploit  a legitimate email author's
	  name-recognition among recipients, by using the author's
          domain name in the From: header field. Especially since many popular
          MUAs do not display the author's email address, there is no
          empirical evidence of the extent that this particular unauthorized
          use of a domain name contributes to recipient deception or that
          eliminating it will have significant effect.
</p>
<p>However, closing this exploit could facilitate some types of
          optimized processing by receive-side message filtering engines,
          since it could permit them to maintain higher-confidence assertions
          about From: header field uses of a domain, when the occurrence is
          authorized.
</p>
<p>Unauthorized uses of domain names occur elsewhere in messages, as
          do unauthorized uses of organizations' names. These attacks are
          outside the scope of this specification.
</p>
<p>ADSP does not provide any benefit--nor, indeed, have any effect at
          all--unless an external system acts upon the verdict, either by
          treating the message differently during the delivery process or by
          showing some indicator to the end recipient. Such a system is out of
          scope for this specification.
</p>
<p>ADSP checkers may perform multiple DNS lookups per Alleged Author
          Domain. Since these lookups are driven by domain names in email
          message headers of possibly fraudulent email, legitimate ADSP
          checkers can become participants in traffic multiplication
          attacks on domains that appear in fraudulent email.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
DNS Considerations</h3>

<p>An attacker might attack the DNS infrastructure in an attempt to
          impersonate ADSP records to influence a receiver's
          decision on how it will handle mail. However, such an attacker is
          more likely to attack at a higher level, e.g., redirecting A or MX
          record lookups in order to capture traffic that was legitimately
          intended for the target domain. These DNS security issues are
          addressed by <a class='info' href='#RFC4033'>DNSSEC<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033].
</p>
<p>Because ADSP operates within the framework of the legacy e-mail
          system, the default result in the absence of an ADSP record is that
          the domain does not sign all of its messages. It is therefore
          important that the ADSP clients distinguish a DNS failure such as
            <tt>SERVFAIL</tt> from other DNS errors so that
          appropriate actions can be taken.
</p>
<a name="wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
DNS Wildcards</h3>

<p>DNS wildcards (described in <a class='info' href='#RFC4592'>[RFC4592]<span> (</span><span class='info'>Lewis, E., &ldquo;The Role of Wildcards in the Domain Name System,&rdquo; July&nbsp;2006.</span><span>)</span></a>) that exist
	  in the DNS hierarchy at or above the domain being checked
	  interfere with the ability to verify the
	  scope of the ADSP check described in <a class='info' href='#Lookup'>Section&nbsp;4.3<span> (</span><span class='info'>ADSP Lookup Procedure</span><span>)</span></a>.
	  For example, a
	  wildcard record for *.domain.example makes all subdomains
	  such as foo.domain.example exist in the DNS.
	  Domains that intend to make active use of ADSP by publishing
	  a practice other than Unknown are advised
	  to avoid the use of wildcards in their hierarchy.
</p>
<p>If a domain contains wildcards, then any name that matches
	  the wildcard can appear to be a valid mail domain eligible for ADSP.
	  But the <tt>_adsp._domainkey.</tt> prefix
	  on ADSP records does not allow publication of wildcard records that
	  cover ADSP records without also covering non-ADSP records,
	  nor publication
	  of wildcard records that cover non-ADSP records without
	  also covering ADSP records.
	  A domain that uses ADSP practices other than unknown
	  SHOULD NOT publish wildcard records.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Inappropriate Application of Author Domain Signatures</h3>

<p>
	  In one model of DKIM usage, a domain signs messages that are
	  in transit through their system.  Since any signature whose
	  domain matches the Author Domain is by definition an Author
	  Domain Signature, it would be unwise to sign mail whose
	  Author Domain is the signer's domain if the mail is not
	  known to meet the domain's standards for an Author Domain
	  Signature.
</p>
<p>One such use case is where a domain might apply such a
	  signature is following application of an
	  Authentication-Results header field as described in Section
	  7.1 of <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>.
	  This problem can be easily avoided either
	  by not applying a signature that might be confused with an
	  Author Domain Signature or by applying a signature from some
	  other domain, such as a subdomain of the Author Domain.
	  
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;References - Normative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4592">[RFC4592]</a></td>
<td class="author-text">Lewis, E., &ldquo;<a href="http://tools.ietf.org/html/rfc4592">The Role of Wildcards in the Domain Name System</a>,&rdquo; RFC&nbsp;4592, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4592.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text"><a href="mailto:presnick@qualcomm.com">Resnick, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc5322.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc5322.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5451">[RFC5451]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5451">Message Header Field for Indicating Message Authentication Status</a>,&rdquo; RFC&nbsp;5451, April&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5451.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;References - Informative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5016">[RFC5016]</a></td>
<td class="author-text">Thomas, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5016">Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol</a>,&rdquo; RFC&nbsp;5016, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5016.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5321">[RFC5321]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5321.txt">TXT</a>).</td></tr>
</table>

<a name="lookupex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Lookup Examples</h3>

<p>Assume the example domain publishes these DNS records:
      (In these examples, the numbers in parentheses are comments to help
	identify the records, not part of the records themselves.)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
aaa.example                  A     192.0.2.1        (1)
_adsp._domainkey.aaa.example TXT   "dkim=all"       (2)

bbb.example                  MX 10 mail.bbb.example (3)
mail.bbb.example             A     192.0.2.2        (4)
</pre></div>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Domain and ADSP exist</h3>

<p>A mail message contains this From: header line:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
From: bob@aaa.example (Bob the Author)</pre></div>
<p>The ADSP Lookup first identifies the Author Address
	 bob@aaa.example and the Author Domain aaa.example.
	It does an MX DNS query for aaa.example, and gets back
	a NOERROR result with no DNS records.
	(There's no MX record, but since record (1) exists, the name
	exists in the DNS.)
	Since that query didn't return an error,
	the Lookup proceeds to a TXT DNS
	query for  _adsp._domainkey.aaa.example, which returns
	record (2).
	Since this is a valid DKIM record, the result is that all messages
	from this domain are signed.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Domain exists, ADSP does not exist</h3>

<p>A mail message contains this From: header line:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
From: alice@bbb.example (Old-fashioned Alice)</pre></div>
<p>The ADSP Lookup first identifies the Author Address
	 alice@bbb.example and the Author Domain bbb.example.
	It does an MX DNS query for bbb.example, and gets back
	record (3).
	Since that query didn't return an error, it then  proceeds to a TXT DNS
	query for _adsp._domainkey.bbb.example, which returns NXDOMAIN.
	Since the domain exists but there is no ADSP record, ADSP returns
	the default unknown result: messages may or may not have an author domain signature.
	
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Domain does not exist</h3>

<p>A mail message contains this From: header line:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
From: frank@ccc.example (Unreliable Frank)</pre></div>
<p>The ADSP Lookup first identifies the Author Address
	 frank@ccc.example and the Author Domain ccc.example.
	It does an MX DNS query for ccc.example, and gets back
	an NXDOMAIN result since there are no records at all for ccc.example.
	The lookup terminates with the result that the domain does not exist
	in the DNS and so is out of scope.
      
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Usage Examples</h3>

<p>These examples are intended to illustrate typical uses of ADSP. They
        are not intended to be exhaustive, nor to apply to every domain's or
        mail system's individual situation.
</p>
<p>Domain managers are advised to consider the ways that mail processing
        can modify messages in ways that will invalidate an existing DKIM
        signature, such as mailing lists, courtesy forwarders, and other paths
        that could add or modify headers, or modify the message body. In that
        case, if the modifications invalidate the DKIM signature, recipient
        hosts will consider the mail not to have an Author Domain Signature, even
        though the signature was present when the mail was originally sent.
</p>
<a name="allexamp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Single Location Domains</h3>

<p>A common mail system configuration handles all of a domain's users'
          incoming and outgoing mail through a single MTA or group of MTAs. In
          that case, the MTA(s) can be configured to sign outgoing mail with
          an Author Domain Signature.
</p>
<p>In this situation it might be appropriate to publish an ADSP record
          for the domain containing "all", depending on whether the users also
          send mail through other paths that do not apply an Author Domain Signature.
          Such paths could include MTAs at hotels or hotspot networks used by
          travelling users, web sites that provide "mail an article"
	  features,
	  user messages sent through mailing lists,
	  or third party mail clients that
	  support multiple user identities.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Bulk Mailing Domains</h3>

<p>Another common configuration uses a domain solely for bulk or
          broadcast mail, with no individual human users, again typically
          sending all the mail through a single MTA or group of MTAs that can
          apply an Author Domain Signature. In this case, the domain's management can
          be confident that all of its outgoing mail will be sent through the
          signing MTA. Lacking individual users, the domain is unlikely to
          participate in mailing lists, but could still send mail through
          other paths that might invalidate signatures.
</p>
<p>Domain owners often use specialist mailing providers to send their
          bulk mail. In that case, the mailing provider needs access to a
          suitable signing key in order to apply an Author Domain Signature. One
          possible route would be for the domain owner to generate the key and
          give it to the mailing provider. Another would be for the domain to
          delegate a subdomain to the mailing provider, for example,
          bigbank.example might delegate email.bigbank.example to such a
          provider. In that case, the provider can generate the keys and DKIM
          DNS records itself and use the subdomain in the Author address in
          the mail.
</p>
<p>Regardless of the DNS and key management strategy chosen, whoever
	  maintains the DKIM records for the domain could also install an
	  ADSP record containing "all".
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
Bulk Mailing Domains with Discardable Mail</h3>

<p>In some cases, a domain might sign all of its outgoing mail with an
          Author Domain Signature, but prefer that recipient systems discard mail
          without a valid Author Domain Signature to avoid confusion from mail sent
          from sources that do not apply an Author Domain Signature.
	  (In the case of domains with tightly controlled outgoing mail,
	  this latter
          kind of mail is sometimes loosely called "forgeries".) In that case,
          it might be appropriate to publish an ADSP record containing
          "discardable". Note that a domain SHOULD NOT publish a "discardable"
          record if it wishes to maximize the likelihood that mail from the
          domain is delivered, since it could cause some fraction of the mail
          the domain sends to be discarded.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.4"></a><h3>B.4.&nbsp;
Third Party Senders</h3>

<p>Another common use case is for a third party to enter into an
          agreement whereby that third party will send bulk or other mail on
          behalf of a designated author or author domain, using that domain in
          the RFC5322 From: or other headers. Due to the many and varied
          complexities of such agreements, third party signing is not
          addressed in this specification.
          
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.5"></a><h3>B.5.&nbsp;
Domains with Independent Users and Liberal Use Policies</h3>

<p>When a domain has independent users and its usage policy
	  does not explicitly restrict them to sending mail only from
	  designated mail servers (e.g. many ISP domains and even some
	  corporate domains), then it is only appropriate to publish
	  an ADSP record containing "unknown". Publishing either "all"
	  or "discardable" will likely result in significant breakage
	  because independent users are likely to send mail from the
	  external paths enumerated in <a class='info' href='#allexamp'>Appendix&nbsp;B.1<span> (</span><span class='info'>Single Location Domains</span><span>)</span></a>.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.6"></a><h3>B.6.&nbsp;
Non-email Domains</h3>

<p>If a domain sends no mail at all, it can safely
          publish a "discardable" ADSP record, since any mail with an author
          address in the domain is a forgery.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Acknowledgements</h3>

<p>This document greatly benefited from comments by
	 Steve Atkins, Jon Callas, Dave Crocker,
	 Pasi Eronen,
	 JD Falk, Arvel Hathcock,
	 Ellen Siegel, Michael Thomas, and Wietse Venema.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Change Log</h3>

<p>
        <strong>NOTE TO RFC EDITOR: This section may be removed
          upon publication of this document as an RFC.</strong>
      
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.1"></a><h3>D.1.&nbsp;
Changes since -ietf-dkim-09</h3>

<p></p>
<ul class="text">
<li>Change author signature to use d=.
</li>
<li>Change all "author signature" to "author domain signature".
</li>
<li>Add authentication results for IANA per Murray K.
</li>
<li>Minor editorial clarifications.
</li>
</ul>

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.2"></a><h3>D.2.&nbsp;
Changes since -ietf-dkim-08</h3>

<p></p>
<ul class="text">
<li>Simplify and clarify interpretation of d= and i=.
</li>
<li>Add note pointing out that i= usage conflicts with normal usage,
	    and suggest workaround.
</li>
<li>Add note pointing out that you can mechanically add ADSP records
	      for all the subdomains you use.
</li>
<li>in <a class='info' href='#usage'>Section&nbsp;3.2<span> (</span><span class='info'>ADSP Usage</span><span>)</span></a> fix text to say that only an Author
	      Signature counts.
</li>
</ul>

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.3"></a><h3>D.3.&nbsp;
Changes since -ietf-dkim-07</h3>

<p>Clarify that ADSP records use WSP rather than FWS in 4.1 and 4.2.1.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.4"></a><h3>D.4.&nbsp;
Changes since -ietf-dkim-06</h3>

<p>Minor editorial changes suggested by AD:
          </p>
<ul class="text">
<li>expand DKIM in title
</li>
<li> clarify that there's no
	  subdomain matching in <a class='info' href='#applicability'>Section&nbsp;3.1<span> (</span><span class='info'>ADSP Applicability</span><span>)</span></a>
</li>
<li>ADSP lookup can terminate without a result if the DNS lookup fails
</li>
<li>random dkim= values are treated as unknown
</li>
<li>in 4.2 note WSP not FWS
</li>
<li>in 4.3 note that NODATA is not NXDOMAIN
</li>
<li>add new Appendix A with lookup examples
</li>
</ul><p>
	
</p>
<p>Also address Tony's nits in
http://mipassoc.org/pipermail/ietf-dkim/2008q3/010720.html.
	  Make the examples consistently use the .example domain.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.5"></a><h3>D.5.&nbsp;
Changes since -ietf-dkim-05</h3>

<p>Minor editorial nits: define NOERROR, SERVFAIL, NXDOMAIN as rfc1035
	  rcodes, change some punctuation, IANA section change IETF Consensus
	  to the new IETF Review.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.6"></a><h3>D.6.&nbsp;
Changes since -ietf-dkim-04</h3>

<p>
          </p>
<ul class="text">
<li>Require dkim at the front of each record.
</li>
<li>Disparage wildcard records.
</li>
<li>Changed ABNF use of whitespace from FWS back to WSP,
	      dkim-base is wrong.
</li>
<li>RFC 2434 -> 5226, make ref to 4686 informational since it's
	      not standards track.
</li>
<li>Improve examples with material from Ellen.
</li>
</ul><p>
        
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.7"></a><h3>D.7.&nbsp;
Changes since -ietf-dkim-03</h3>

<p>
          </p>
<ul class="text">
<li>Name change for title and filename, to be ADSP
</li>
<li>String changes throughout, to author Domain signing practices
              and to aDsp.
</li>
<li>Added some keywords.
</li>
<li>Clarified comparison of local part and domain in Author Address.
</li>
<li>Streamlined the Abstract.
</li>
<li>Revised text of last bullet in Results list.
</li>
<li>Removed definitions not used in the document.
</li>
<li>Removed all specification details pertaining to sub-domains.
</li>
<li>Moved Lookup Procedure up one document level.
</li>
<li>Revised domain validity specification. Part in ADSP Usage in
              Operations section, and part as it as first step in Lookup.
</li>
<li>Fixed xml for figures, including labeling ABNF with new xml2rfc
              construct.
</li>
<li>Revised wildcard text.
</li>
<li>Removed 't' tag.
</li>
<li>Removed ADSP Flags Registry section.
</li>
<li>Changed ABNF use of whitespace from WSP back to FWS,
	      for consistency with dkim-base.
</li>
</ul><p>
        
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.8"></a><h3>D.8.&nbsp;
Changes since -ietf-dkim-02</h3>

<p>
          </p>
<ul class="text">
<li>Merge in more text from ADSP draft.
</li>
<li>Phrase actions as host's rather than checker.
</li>
<li>Explanatory description of i= matching.
</li>
<li>Lookup procedure consistently refers to one ADSP record per
              lookup.
</li>
<li>Update security section w/ language from W. Venema
</li>
<li>Simplify imports of terms from other RFCs, add Local-part, 4234
              -> 5234.
</li>
<li>Add usage example appendix.
</li>
<li>Add IANA considerations.
</li>
<li>Update authors list
</li>
</ul><p>
        
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.9"></a><h3>D.9.&nbsp;
Changes since -ietf-dkim-ssp-01</h3>

<p>
          </p>
<ul class="text">
<li>Reworded introduction for clarity.
</li>
<li>Various definition clarifications.
</li>
<li>Changed names of practices to unknown, all, and discardable.
</li>
<li>Removed normative language mandating use of SSP in particular
              situations (issue 1538).
</li>
<li>Clarified possible confusion over handling of syntax errors.
</li>
<li>Removed normative language from Introduction (issue 1538).
</li>
<li>Changed "Originator" to "Author" throughout (issue 1529).
</li>
<li>Removed all references to Third-Party Signatures (issues 1512,
              1521).
</li>
<li>Removed all mention of "Suspicious" (issues 1528, 1530).
</li>
<li>Removed "t=y" (testing) flag (issue 1540).
</li>
<li>Removed "handling" tag (issue 1513).
</li>
<li>Broke up the "Sender Signing Practices Check Procedure" into
              two algorithms: fetching the SSP record and interpretation
              thereof (issues 1531, 1535; partially addresses issue 1520).
              Interpretation is now the responsibility of the Evaluator.
</li>
<li>Document restructuring for better flow and remove redundancies
              (some may address issue 1523, but I'm not sure I understand that
              issue completely; also issues 1532, 1537).
</li>
<li>Removed all mention of how this interacts with users, even
              though it makes parts of the document harder to understand
              (issue 1526).
</li>
<li>Introduced the concepts of "SSP Checker" and "Evaluator".
</li>
<li>Multiple author case now handled my separate invocations of SSP
              checker by Evaluator (issue 1525).
</li>
<li>Removed check to avoid querying top-level domains.
</li>
<li>Changed ABNF use of whitespace from [FWS] to *WSP (partially
              addresses issue 1543).
</li>
</ul><p>
        
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.10"></a><h3>D.10.&nbsp;
Changes since -ietf-dkim-ssp-00</h3>

<p>
          </p>
<ul class="text">
<li>Clarified Operation Overview and eliminated use of Legitimate
              as the counterpart of Suspicious since the words have different
              meanings.
</li>
<li>Improved discussion (courtesy of Arvel Hathcock) of the use of
              TXT records in DNS vs. a new RR type.
</li>
<li>Clarified publication rules for multilevel names.
</li>
<li>Better description of overall record syntax, in particular that
              records with unknown tags are considered syntactically correct.
</li>
<li>Clarified Sender Signing Practices Check Procedure, primarily
              by use of new term Author Domain.
</li>
<li>Eliminated section "Third-Party Signatures and Mailing Lists"
              that is better included in the DKIM overview document.
</li>
<li>Added "handling" tag to express alleged sending domain's
              preference about handling of Suspicious messages.
</li>
<li>Clarified handling of SERVFAIL error in SSP check.
</li>
<li>Replaced "entity" with "domain", since with the removal of
              user-granularity SSP, the only entities having sender signing
              policies are domains.
</li>
</ul><p>
        
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.11"></a><h3>D.11.&nbsp;
Changes since -allman-ssp-02</h3>

<p>
          </p>
<ul class="text">
<li>Removed user-granularity SSP and u= tag.
</li>
<li>Replaced DKIMP resource record with a TXT record.
</li>
<li>Changed name of the primary tag from "p" to "dkim".
</li>
<li>Replaced lookup algorithm with one which traverses upward at
              most one level.
</li>
<li>Added description of records to be published, and effect of
              wildcard records within the domain, on SSP.
</li>
</ul><p>
        
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.12"></a><h3>D.12.&nbsp;
Changes since -allman-ssp-01</h3>

<p>
          </p>
<ul class="text">
<li>Changed term "Sender Signing Policy" to "Sender Signing
              Practices".
</li>
<li>Changed query methodology to use a separate DNS resource record
              type, DKIMP.
</li>
<li>Changed tag values from SPF-like symbols to words.
</li>
<li>User level policies now default to that of the domain if not
              specified.
</li>
<li>Removed the "Compliance" section since we're still not clear on
              what goes here.
</li>
<li>Changed the "parent domain" policy to only search up one level
              (assumes that subdomains will publish SSP records if
              appropriate).
</li>
<li>Added detailed description of SSP check procedure.
</li>
</ul><p>
        
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.13"></a><h3>D.13.&nbsp;
Changes since -allman-ssp-00</h3>

<p>From a "diff" perspective, the changes are extensive. Semantically,
          the changes are:</p>
<ul class="text">
<li>Added section on "Third-Party Signatures and Mailing Lists"
</li>
<li>Added "Compliance" (transferred from -base document). I'm not
              clear on what needs to be done here.
</li>
<li>Extensive restructuring.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Allman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sendmail, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6475 Christie Ave, Suite 350</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Emeryville, CA  94608</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 510 594 5501</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eric+dkim@sendmail.org">eric+dkim@sendmail.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jim Fenton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MS SJ-9/2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W. Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134-1706</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 526 5914</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fenton@cisco.com">fenton@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark Delany</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yahoo! Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">701 First Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 349 6831</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:markd+dkim@yahoo-inc.com">markd+dkim@yahoo-inc.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Levine</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Taughannock Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box 727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trumansburg, NY  14886</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 831 480 2300</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:standards@taugh.com">standards@taugh.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.taugh.com">http://www.taugh.com</a></td></tr>
</table>
</body></html>
