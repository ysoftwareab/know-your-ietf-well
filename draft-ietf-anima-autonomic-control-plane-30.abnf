acp-node-name = local-part "@" acp-domain-name
local-part = [ acp-address ] [ "+" rsub extensions ]
acp-address = 32HEXDIG | "0" ; HEXDIG as of RFC5234 section B.1
rsub = [ <subdomain> ] ; <subdomain> as of RFC1034, section 3.5
acp-domain-name = ; <domain> ; as of RFC 1034, section 3.5
extensions = *( "+" extension )
extension  = 1*etext  ; future standard definition.
etext      = ALPHA / DIGIT /  ; Printable US-ASCII
                  "!" / "#" / "$" / "%" / "&" / "'" /
                  "*" / "-" / "/" / "=" / "?" / "^" /
                  "_" / "`" / "{" / "|" / "}" / "~"

routing-subdomain = [ rsub "." ] acp-domain-name

acp-node-name      = fd89b714f3db00000200000064000000
                          +area51.research@acp.example.com
acp-domain-name    = acp.example.com
routing-subdomain  = area51.research.acp.example.com
                        Figure 2: ACP Node Name ABNF

flood-message = [M_FLOOD, session-id, initiator, ttl,
                     +[objective, (locator-option / [])]]
                                 ; see example above and explanation
                                 ; below for initiator and ttl

objective = ["SRV.est", objective-flags, loop-count,
                                           objective-value]

objective-flags = sync-only  ; as in GRASP spec
sync-only       = 4          ; M_FLOOD only requires synchronization
loop-count      = 255        ; recommended as there is no mechanism
                                 ; to discover network diameter.
objective-value = any        ; reserved for future extensions


                     Figure 5: GRASP SRV.est definition

flood-message = [M_FLOOD, session-id, initiator, ttl,
                        +[objective, (locator-option / [])]]

objective = ["AN_ACP", objective-flags, loop-count,
                                              objective-value]

objective-flags = sync-only ; as in the GRASP specification
sync-only =  4    ; M_FLOOD only requires synchronization
loop-count = 1    ; limit to link-local operation

objective-value = method-name / [ method, *extension ]
method = method-name / [ method-name, *method-param ]
method-name = "IKEv2" / "DTLS" / id
extension = any
method-param = any
id = text .regexp "[A-Za-z@_$]([-.]*[A-Za-z0-9@_$])*"

                     Figure 7: GRASP AN_ACP definition

TSi = (0, 0-65535, :: - FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF)

TSr = (0, 0-65535, :: - FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF)
TSi = (47, 0-65535, Initiator-IPv6-LL-addr ... Initiator-IPv6-LL-
TSr = (47, 0-65535, Responder-IPv6-LL-addr ... Responder-IPv6-LL-
F=1 it is 15 bits.  Each format of node-number is considered to be
connection = [ method , local-addr, remote-addr, ?pmtu ]
method =  [ "IKEv2", ?port ]
method =/ [ "DTLS",    port ]
local-addr  = [ address , ?vrf  ]
remote-addr = [ address ]
address = ("any" | ipv4-address | ipv6-address )
vrf = tstr ; Name of a VRF on this node with local-address

               Figure 18: Parameters for remote ACP neighbors

