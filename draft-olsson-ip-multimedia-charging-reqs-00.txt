



                                                 Patrik Olsson, Ericsson
INTERNET-DRAFT
Draft: <draft-olsson-ip-multimedia-charging-reqs-00.txt>
Expires: April 2002
                                                          November, 2001






       IP Multimedia Charging requirements on Diameter Accounting


Status of this memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/lid-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This document is an individual submission to the IETF. Comments
   should be directed to the authors.


Abstract

   The 3rd Generation Partnership Project (3GPP) are currently
   standardizing charging for 3GPP IP Multimedia Core Network Subsystem
   (IM CN Subsystem). One of the proposals for charging protocol is
   Diameter accounting. IP Multimedia will also be used in other
   network, both mobile and fixed networks and the operators needs
   proper charging mechanisms to bill the users.





Olsson                                                          [Page 1]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   Although Diameter is a protocol that fulfills most of the
   requirements to collect accounting information, that can be used for
   charging, from the Multimedia nodes, the Diameter protocol has never
   been evaluated against the specific requirements for on-line charging
   in a cellular network.


TABLE OF CONTENTS

   1.0 Introduction
       1.1 Requirements language
       1.2 Terminology
       1.3 Abbreviations
   2.0 Charging and Accounting Principles
       2.1 Telecom Charging in Cellular Network
       2.2 IP Network Accounting
   3.0 Overview of IP Multimedia network
   4.0 IP Multimedia Charging Requirements on Diameter
      4.1 General
      4.2 On-line charging
      4.3 One generic charging interface
      4.4 IP Multimedia specific charging
          4.4.1 Diameter IP multimedia Application
          4.4.2 User Identities
          4.4.3 SIP Call Id
          4.4.4 SIP Messages
          4.4.5 SDP data/Media information
          4.4.6 Time-Stamp
          4.4.7 Request-URI
          4.4.8 Charging Correlation Id
          4.4.9 QoS parameters
          4.4.10 Multiparty calls
          4.4.11 Call transfer, redirect and call forwarding
   5.0 Security Considerations
   6.0 Scalability Considerations
   7.0 Author's Address
   8.0 References
   9.0 Fully Copyright Statement


1. Introduction

   This document is an effort to define the requirements applicable to
   the usage of the Diameter protocol [3] (Accounting part) for off-line
   and on-line charging in IP Multimedia networks.

   The rest of this document is structured as follows:





Olsson                                                          [Page 2]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   Section 2 offers an overview of charging mechanisms in cellular
   networks and accounting principles in IP network.

   Section 3 contains the short description of charging in IP Multimedia
   networks.

   Section 4 contains the IP Multimedia charging requirements on
   Diameter accounting. Requirements are grouped by categories. Some
   requirements include a statement on possible solutions that would be
   able to fulfill the requirement.

1.1 Requirements language

   This document does not specify any protocol of any kind. Therefore,
   the use of the key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
   "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
   "OPTIONAL" in this document, as described in RFC-2119 [2], does not
   apply.

1.2 Terminology

   Accounting
     The act of collecting information on resource usage for the purpose
     of trend analysis, auditing, billing or cost allocation.

   Charging
     A function whereby information related to a chargeable event is
     transferred in order to make it possible to determine usage for
     which the charged party may be billed. This applies for all
     charging levels. Charging is one of the users of accounting.

   Accounting Server
     A network element that accepts Usage Events from Service Elements.
     It acts as an interface to back-end rating, billing, and
     operations support systems.

   Billing
     The functions whereby charging data are transformed into bills
     requiring payment. In case of pre-paid, billing means the deduction
     of an account. As an outcome of the transformation an invoice,
     including an optional list of detailed charges, has to be delivered
     to the user.

   Pre-paid billing
     Billing arrangement between customer and operator/service provider
     where the customer deposits an amount of money in advance, which is
     subsequently used to pay for service usage.

   Post-paid billing



Olsson                                                          [Page 3]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


     Billing arrangement between customer and operator/service provider
     where the customer periodically receives a bill for service usage
     in the past period.

     Note: Pre-paid and post-paid are different payment methods for the
     subscribers. These payment methods could be based on both on-line
     and off-line charging mechanisms. To get full credit control, pre-
     paid should be built on on-line charging. If the operator would
     like to have post-paid subscribers on credit control, these
     subscribers should be charged with the on-line charging mechanism.

   On-line Charging
     A charging process where charging information can affect, in real-
     time, the service rendered and therefore directly interacts with
     the session/service control.

     Note: Due to the real-time interaction between charging and
     session/service control, this mode requires a bi-directional
     interface that support on-line charging.

   Off-line Charging
     A charging process where charging information does not affect, in
     real-time, the service rendered.

     Note: No real-time interaction is required between charging and
     session/service control, but charging information may be delivered
     in real time or near real time.

   Call Data Record
     A formatted collection of information about a chargeable event
     (e.g. time of call set-up, duration of the call, amount of data
     transferred, etc) for use in billing and accounting. For each party
     to be charged for parts of or all charges of a chargeable event a
     separate CDR shall be generated, i.e. more than one CDR may be
     generated for a single chargeable event, e.g. because of its long
     duration, or because more than one charged party is to be charged.

   User Equipment
     A device allowing a user access to network services. For the
     purpose of 3GPP specifications the interface between the UE and the
     network is the radio interface. A User Equipment can be subdivided
     into a number of domains, the domains being separated by reference
     points. Currently defined domains are the USIM and ME Domains.

1.3 Abbreviations

   AAA: Authentication, Authorization and Accounting

   AS: Application Server



Olsson                                                          [Page 4]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001



   AVP: Attribute Value Pair

   CDR: Call Data Record

   GPRS: General Packet Radio service

   IM CN: IP Multimedia Core Network

   ME: Mobile Equipment

   MM: Multimedia

   QoS: Quality of Service

   UE: User Equipment

   USIM: Universal Subscriber Identity Module

2.0 Charging and Accounting principles

2.1 Telecom Charging in Cellular Network

   In traditional cellular networks the subscriber charging and
   settlements between operators have been based on Off-line charging.

   The access network elements normally collect the charging data
   related to service usage to produce Call Data Record (CDR) after
   service usage has been completed in the serving network. These Call
   Data Records (CDR) are then transferred in batch mode to a billing
   systems in the serving network. The roaming subscriber's Call Data
   Records are sent from the visited network to the home network billing
   system.

   In addition to billing, Call Data Records are also used for fraud
   detection, statistic for trend analysis and network engineering, etc.

   During the last few years the On-line charging has become very
   popular. On-line charging mechanisms provide charging information
   from the access network nodes to a on-line charging function (for
   example a pre-paid system) in home. The charging information is sent
   from the access network nodes prior, during and after service usage.
   This allows the on-line charging function in home network to decide
   before or during service usage if the service in question shall be
   allowed to continue (Credit Control). On-line charging protocols such
   as the CAMEL Application Part (CAP) are used to support on-line
   charging mechanisms.





Olsson                                                          [Page 5]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   Pre-paid and post-paid can be built on both on-line and off-line
   charging mechanisms, but to get full credit control of the
   subscriber, on-line charging must be used.

2.2 IP Network Accounting

   In IP network the accounting management [8] architecture involves
   interactions between network devices, accounting servers, and billing
   servers. The network device collects resource consumption data in the
   form of accounting metrics. This information is then transferred to
   an accounting server.  Typically this is accomplished via an
   accounting protocol, although it is also possible for devices to
   generate their own session records.

   The accounting server then processes the accounting data received
   from the network device.  This processing may include summarization
   of interim accounting information, elimination of duplicate data, or
   generation of session records.

   The processed accounting data is then submitted to a billing server,
   which typically handles rating and invoice generation, but may also
   carry out auditing, cost allocation, trend analysis or capacity
   planning functions.

   One of the functions of the accounting server is to distinguish
   between inter and intra-domain accounting events and to route them
   appropriately. Intra-domain accounting events are typically routed to
   the local billing server, while inter-domain accounting events will
   be routed to accounting servers operating within other administrative
   domains.

3.0 Overview of a IP Multimedia network

   This section gives the reader an overview of a IP Multimedia network
   from charging point of view. It is not intended to be comprehensive.
   But it provides enough information to understand the basis of the IP
   Multimedia charging.

   The IP Multimedia network is decomposed in a home network and a
   visited network. An IPMM Subsystem subscriber belongs to his or her
   home network.

                             Home Network

                              +----------+
                              | Charging |
                    +-------->| Function |<--------+
        Charging    |         |Accounting|         | Charging
        Information |         |  Server  |         | Information



Olsson                                                          [Page 6]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


                    v         +----------+         v
               +--------+                     +--------+
               | Central|                     | Anchor |
               | SIP POC|<------------------->| SIP POC|
               | server |        SIP          | server |
               +--------+                     +--------+
                   |
                   | SIP
                   |
                   v
              +---------+              Visited Network
              | SIP POC |
              | server  |
              | Visited |
              | Domain  |
              +---------+
                     ^
                     | SIP
                     |
                     v
             +---------+
             |  SIP    |
             | Client  |
             +---------+

                 Figure 1: Functional Block Diagram

   The Charging Function (Which is an Accounting Server) is located in
   the Home Network, which will provide charging support for the home
   network subscribers. The multimedia Services are triggered and may be
   executed in the home network. Services are typically executed in an
   Application Server (AS). Authentication/Authorization servers may be
   part of the home network as well. Users are authenticated in the home
   network.

   The visited network contains the SIP POC Server. It is the first
   contact point from the SIP Client. It accepts requests and services
   internally or forwards them on, possibly after translation.

   At the home network the Central and Anchor SIP POC Servers are
   located. The Central SIP POC is the contact point within home network
   for all connections destined to a subscriber of that network.

   The Anchor SIP POC Server in the home network performs the session
   control services for the SIP Client.

   The IP multimedia network (in figure 1) in the home network is
   independent of the access and the Visited SIP POC server is the
   connection to the access network in some cellular networks. The



Olsson                                                          [Page 7]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   visited SIP POC server can∆t provide more accounting/charging
   information the what can be get from the SIP POC servers in the home
   network. Accounting data to be used for charging should be collected
   from the home networks SIP servers.

   The way charging is performed for IP multimedia services differs
   significantly from traditional cellular networks. The main reason
   behind is that the following charging levels can occur for the IMS
   charging:
   a) Access Charging: The charging of usage of bearer resources.

   b) IP Multimedia session based charging: The charging of services
   provided by the IP Multimedia network. Typical example would be voice
   or video call with a certain QoS.

   c) Content based Charging: This means the charging for the
   provisioning of information, like Web pages or the sale of hard or
   soft goods.

   In Multimedia calls the signaling and the bearer normally don't
   follow the same path. Therefore, the basic principle is to handle
   charging for signaling and bearer separately. Charging based on
   signaling is done in the IP multimedia system, and charging for
   bearer usage is done in the access network. The charging based on
   content is performed by the Application Servers in the service
   platform.

   Charging for access is outside of the scope of this draft, but it
   must be considered when charging the user.

4.0 IP Multimedia Charging Requirements on Diameter

4.1 General

   The basic concept behind Diameter is to provide a base protocol that
   can be extended in order to provide AAA services to new applications.
   The base protocol is not intended to be used by itself, and must be
   used with a Diameter application. The Diameter accounting is part of
   base protocol and therefore it is not intended to be used without a
   Diameter application.

   The Diameter can provide two different types of services to
   applications. The first involves authentication and authorization,
   and can optionally make use of accounting. The second only make use
   of accounting.

   Diameter accounting protocol is based on server directed model with
   capabilities for real-time delivery of accounting information.




Olsson                                                          [Page 8]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   The server directed model means that the instance generating the
   charging data gets information from either the authorization server
   (if contacted) or the accounting server regarding the way
   accounting data shall be forwarded.

   The Diameter accounting provides the way accounting information can
   be collected from certain applications, but it does not provide on-
   line charging.

4.2 On-line charging

   The Diameter accounting protocol provides real-time accounting
   meaning the processing of information on resource usage within a
   defined time window. Time constraints are typically imposed in order
   to limit financial risk.

   The next generation cellular networks specify more critical
   requirements for the on-line charging. The Accounting Server must be
   able to check the subscriber's account for coverage of the requested
   service charge prior to execution of that service. The subscriber's
   account shall be decreased each time the subscriber use the services
   related to that account and all the chargeable events related to a
   specific account shall be prevented from the subscriber when the
   credit of that account is exhausted or expired.

   Also a mechanism shall be provided to indicate to the subscriber of
   the charges to be levied for a chargeable event. This mechanism shall
   be able to handle all possible charging scenarios, and all service
   and tariff variants.

   The on-line charging support is needed from the Diameter accounting
   protocol. Before any service is allowed to the subscriber the service
   node acting as a client shall contact the home accounting server to
   request a credit for the event. If the subscriber is allowed to use
   the service, the home accounting server returns the granted amount of
   units for the service. When these units are used the Client can
   request the new amount of service unit to continue the service
   execution. After the service execution (and each interim request) the
   client informs the home accounting server about the used amount of
   the units.

   The granted unit type can be for example time (in seconds), volume
   (in Kbytes), events (as a number of executable events) or money (as a
   monetary value).

   The accounting server shall also return the accumulated cost of the
   session to the client and the total cost of the session at the end of
   the session.




Olsson                                                          [Page 9]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   This requirement can be met for example by using the Diameter Credit
   Control Application described in [10].

4.3 One generic charging interface

   There is a need as an option to offer also possibility not to
   generate CDRs in IP Multimedia nodes.

   The fact that a large number of subscribers require on-line charging
   (and the number is likely to grow) and the fact that on-line charging
   interface provides a large part of the data which is included in the
   Call Data Records, makes it feasible to combine on- and off-line
   charging into one generic charging interface.

   As described earlier the Diameter base protocol (and accounting part
   of it) is not intended to be used without a Diameter application. By
   using the Diameter accounting with the Diameter IP Multimedia
   application, which support both on-line and off-line charging, these
   requirement on one generic charging interface can be met.

4.4 IP Multimedia specific charging

   Depending on the role of the IP Multimedia node and if the node
   maintains the SIP session state, the on-line and/or off-line charging
   can be used.

   Author assumes that upon receipt of the SIP Invite method, but after
   optional authorization, the IP Multimedia node may initiate an on-
   line charging session.

   IP Multimedia node may also initiate one time event accounting
   records after the successful SIP registration.

   When charging for IP Multimedia session you also have to consider
   charging for the access network. How you charge for access is
   depending on the access network (for example GPRS, WLAN, ADSL).

   The Accounting information, which is needed, is listed in sub-
   chapters below.

4.4.1 Diameter IP Multimedia Application

   There will be a new Diameter IP Multimedia application, which shall
   also describe the accounting part of IP Multimedia. According to the
   principles define the Diameter base protocol each Diameter
   application must define their service specific AVPs that must be
   present in the Accounting messages.

   The Accounting messages from the base protocol shall be used.



Olsson                                                         [Page 10]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   The Accounting parameters listed below shall be defined in this new
   Diameter IP Multimedia application as the IP Multimedia specific
   accounting AVPs.

4.4.2 User Identities

   Every user must have a user identities. The user identity/identities
   (Called-Party-Id and Calling-Party-Id) MAY take any form, for example
   SIP URL (as defined in SIP [4] and RFC2396 [5]) or the form of a TEL-
   URL/E.164 number [6] and [7].

4.4.3 SIP Call Id

   The SIP Call Id [4] identifies uniquely a particular SIP invitation
   or all SIP registrations of a particular client.

4.4.4 SIP Messages

   The SIP server may generate an accounting messages for every SIP
   messages. It must be configurable in the SIP server if the accounting
   messages should be outputted. Examples of SIP messages are INVITE,
   BUSY, NO ANSWER, NOT AVAILABLE, REDIRECT.

4.4.5 SDP data/Media information

   The accounting messages must contain information about the media
   used.

4.4.6 Time-Stamp

   Time Stamp specifies the time when the SIP server generated the
   accounting-request.

4.4.7 Request-URI

   The Request URI [5] indicates the user or the service to which the
   request is being addressed.

4.4.8 Charging Correlation Id

   The Unique Charging Correlation Id is needed to be able to correlate
   the charging data from the different charging layers (IP Multimedia
   session and access network). The Charging Correlation Id must be
   globally unique throughout the session lifetime. It must by possible
   to correlate on a media in a SIP session with a specific bearer in
   the access network.

4.4.9 QoS parameters




Olsson                                                         [Page 11]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   The accounting messages must contain information about the
   requested/negotiated quality of service.

4.4.10 Multiparty calls

   It the SIP call is a multiparty call, the accounting messages must
   contain information about involved parties (e.g. number of parties
   and identifiers of the involved parties).

4.4.11 Call transfer, redirect and call forwarding

   The operator must be able to charge for the different services, call
   transfer, redirect and call forwarding so relevant information must
   be outputted in the accounting messages.

5.0 Security considerations

   The Diameter base protocol [3] assumes that messages are secured by
   using either IP security, or TLS. This security model is acceptable
   in environments where there are no un-trusted third party relay,
   proxy or redirect servers.

6.0 Scalability considerations

   The IPMM diameter accounting application must scalable and work for
   networks with more the 10 million users.

7.0 Author's Addresses

     Patrik Olsson               Tel:    +46 455 395831
     Ericsson Software Tech      Mobile: +46 703 105831
     Karlskrona, Sweden          EMail:  patrik.m.olsson@epk.ericsson.se

8.0 References
   1. Bradner, S., "The Internet Standards Process -- Revision 3", BCP
      9, RFC 2026, October 1996.
   2. Bradner, S., "Key words for use in RFCs to Indicate Requirement
      Levels", BCP 14, RFC 2119, March 1997.
   3. P.Calhoun, H. Akhtar, J. Arkko, E. Guttman, A. Rubens, "Diameter
      Base Protocol", draft-ietf-aaa-diameter-07.txt, IETF work in
      progress, July 2001.
   4. Handley M, Schulzrinne H, Schooler E, Rosenberg J., "SIP, Session
      Initiation Protocol", draft-ietf-sip-rfc2543bis-04.txt, Work in
      Progress.
   5. T.Bernes-Lee, R.Fielding, L.Masinter, "Uniform Resource
      Identifiers (URI):Generic Syntax, RFC 2396, August 1998.
   6. Recommendation E.164/I.331 (05/97): The International Public
      Telecommunication Numbering Plan. 1997.




Olsson                                                         [Page 12]

INTERNET-DRAFT   IPMM Charging requirements on Diameter   November, 2001


   7. Complement to ITU-T recommendation E.164 (05/1997): List of ITU-T
      Recommendation E.164 assigned country codes", June 2000
   8. B.Aboba, J.Arkko, D. Harrington, "Introduction to Accounting
      Management", RFC 2975, October 2000.
   9. B. Aboba, M. Beadles, "The Network Access Identifier", RFC 2486,
      January 1999.
   10.      H. Hakala, "Diameter Credit Control Application", draft-hakala-
      Diameter-Credit-Control-00.txt, Work in Progress.
   11.      M. Handley, V. Jacobson, " SDP: Session Description Protocol", RFC
      2327, April 1998.
   12.      M. Garcia et al. "3GPP requirements on SIP", draft-garcia-sipping-
      3gpp-reqs-00.txt, Work in Progress.

9.0 Full Copyright Statement

   "Copyright (C) The Internet Society (2000). All Rights Reserved. This
   document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.  The limited permissions granted above are perpetual and
   will not be revoked by the Internet Society or its successors or
   assigns.  This document and the information contained herein is
   provided on an "AS IS" basis and THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."


This Internet-Draft expires in April 2002.













Olsson                                                         [Page 13]
