<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>RADIUS Mobile IPv6 Support</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="RADIUS Mobile IPv6 Support">
<meta name="keywords" content="RADIUS, IPv6 Mobility, Request for Comments, I-D, Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">A. Lior</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Bridgewater Systems</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">K. Chowdhury</td></tr>
<tr><td class="header">Expires: May 7, 2009</td><td class="header">Starent Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 03, 2008</td></tr>
</table></td></tr></table>
<h1><br />RADIUS Mobile IPv6 Support<br />draft-ietf-mip6-radius-06.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 7, 2009.</p>

<h3>Abstract</h3>

<p> This document defines new attributes to facilitate Mobile
                IPv6 operations using RADIUS infrastructure. The operations
                include bootstrapping of information required by the Mobile Node
                and the interface between the Network Access Server, Home Agent
                and the RADIUS server used to assist MIP6 operations. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Solution Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#integrated">3.1.</a>&nbsp;
RADIUS Transaction in Integrated Scenario<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#split">3.2.</a>&nbsp;
RADIUS Transactions in Split Scenario<br />
<a href="#anchor4">4.</a>&nbsp;
Use of existing RADIUS Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
User-Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Service-Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
NAS-Port-Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.4.</a>&nbsp;
Calling-Station-Id<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.5.</a>&nbsp;
Use of MS-MPPE-Recv-Key and MS-MPPE-Send-Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.6.</a>&nbsp;
Session-Timeout<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.7.</a>&nbsp;
Message Authenticator<br />
<a href="#anchor12">5.</a>&nbsp;
RADIUS attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.1.</a>&nbsp;
MIP6-Feature-Vector Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.2.</a>&nbsp;
MIP6-HA Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.3.</a>&nbsp;
MIP6-HA-FQDN Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.4.</a>&nbsp;
MIP6-HL-Prefix Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.5.</a>&nbsp;
MIP6-HOA Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.6.</a>&nbsp;
MIP6-DNS-MO Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.7.</a>&nbsp;
MIP6-Careof-Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.8.</a>&nbsp;
MIP6-MN-AAA-SPI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.9.</a>&nbsp;
MIP6-Authenticator<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.10.</a>&nbsp;
MIP6-MAC-Mobility-Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.11.</a>&nbsp;
MIP6-Timestamp<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.12.</a>&nbsp;
MIP6-MN-HA-SPI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.13.</a>&nbsp;
MIP6-Algorithm-Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.14.</a>&nbsp;
MIP6-Replay-Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.15.</a>&nbsp;
MIP6-Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">5.16.</a>&nbsp;
MIP6-Auth-Mode<br />
<a href="#anchor29">6.</a>&nbsp;
Message Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.1.</a>&nbsp;
Use of RADIUS in Integrated Scenario (MSA=ASA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.1.1.</a>&nbsp;
HA allocation in the MSP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.1.2.</a>&nbsp;
HA allocation in the ASP (visited network)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.2.</a>&nbsp;
Use of RADIUS In Split Scenario<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.2.1.</a>&nbsp;
Split using IKEv2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.2.2.</a>&nbsp;
Split and Mobile IPv6 Authentication Protocol<br />
<a href="#anchor36">7.</a>&nbsp;
Goals for the HA-AAA Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">7.1.</a>&nbsp;
General Goals<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">7.2.</a>&nbsp;
Service Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">7.3.</a>&nbsp;
Accounting<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">7.4.</a>&nbsp;
MN Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">7.5.</a>&nbsp;
Provisioning of Configuration Parameters<br />
<a href="#anchor42">8.</a>&nbsp;
Table of Attributes<br />
<a href="#anchor43">9.</a>&nbsp;
Diameter Considerations<br />
<a href="#anchor44">10.</a>&nbsp;
Security Considerations<br />
<a href="#anchor45">11.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">11.1.</a>&nbsp;
Registration of new AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">11.2.</a>&nbsp;
New Registry: Mobility Capability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">11.3.</a>&nbsp;
Addition of existing values<br />
<a href="#anchor49">12.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> This document covers two aspects of MIP6 operations: bootstrapping of
    information required by a Mobile IPv6 Mobile using the AAA infrastructure
    and the interaction between the Network Access Server(NAS), MIPv6 Home Agent
    (HA) and the Authentication Authorization and Accounting (AAA)
    infrastructure.
</p>
<p> Mobile IPv6 specification <a class='info' href='#RFC3775'>[14]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> requires a Mobile
    Node (MN) to perform registration with an HA with information about its
    current point of attachment (Care-of Address). The HA creates and maintains
    binding between the MN's Home Address (HOA) and the MN's Care-of Address.
    
</p>
<p> In order to register with a HA, the MN needs to know some information
    such as, the Home Link prefix, the HA Address, the HOA, the Home Link prefix
    Length and security related information in order to secure the Binding
    Update. 
</p>
<p> The aforementioned set of information may be statically provisioned in
    the MN. However, static provisioning of this information has its drawbacks.
    It increases provisioning and network maintenance burden for the operator.
    Moreover, static provisioning does not allow load balancing, failover,
    opportunistic home link assignment etc. For example, the user may be
    accessing the network from a location that may be geographically far away
    from the preconfigured home link; the administrative burden to configure the
    MN's with the respective addresses is large and the ability to react on
    environmental changes is minimal. In these situations static provisioning
    may not be desirable. 
</p>
<p> Dynamic assignment of Mobile IPv6 home registration information is a
    desirable feature for ease of deployment and network maintenance. For this
    purpose, the RADIUS infrastructure, which is used for access authentication,
    can be leveraged to assign some or all of the necessary parameters. The
    RADIUS server in the Access Service Provider (ASP) or in the Mobility
    Service Provider's (MSP) network may return these parameters to the AAA
    client. The AAA client might either be the NAS, in case of the integrated
    scenario, or the HA, in case of the split scenario. The terms integrated and
    split are described in the terminology section and are introduced in <a class='info' href='#RFC4640'>[15]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>. 
</p>
<p> The second aspect of MIP6 and RADIUS interworking is the interaction
     between the HA and the AAA using the RADIUS AAA protocols. From a mobility
     service provider (MSP) perspective, it is important to verify that the MN
     is authenticated and authorized to utilize Mobile IPv6 service and that
     such services are accounted for. Thus, prior to processing the Mobile IPv6
     registrations, the HA, participates in the authentication of the MN to
     verify the MN's identity. The HA also participates in the Mobile IPv6
     authorization process involving the RADIUS infrastructure. The HA, due to
     its role in traffic forwarding, may also perform accounting for the Mobile
     IPv6 service provided to the MN. This document specifies the interaction
     between the NAS, HA and the RADIUS server and aligns with the work done in
     with the Diameter specifications described in <a class='info' href='#I-D.ietf-dime-mip6-split'>[16]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Bournelle, J., Giaretta, G., and M. Nakhjiri, &ldquo;Diameter Mobile IPv6: Support for Home Agent to Diameter Server Interaction,&rdquo; April&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-dime-mip6-integrated'>[17]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction,&rdquo; January&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in <a class='info' href='#RFC2119'>[1]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
    
</p>
<p> General mobility terminology can be found in <a class='info' href='#RFC3753'>[18]<span> (</span><span class='info'>Manner, J. and M. Kojo, &ldquo;Mobility Related Terminology,&rdquo; June&nbsp;2004.</span><span>)</span></a>.
    The following additional terms, as defined in <a class='info' href='#RFC4640'>[15]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>, are
    used in this document: 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Access Service Authorizer (ASA):</dt>
<dd>
                        
            <br />
 A network operator that authenticates a
            mobile node and establishes the mobile node's authorization to
            receive Internet service. 
</dd>
<dt>Access Service Provider (ASP):</dt>
<dd>
                        
            <br />
 A network operator that provides direct IP
            packet forwarding to and from the end host. 
</dd>
<dt>Mobility Service Authorizer (MSA):</dt>
<dd>
                        
            <br />
 A service provider that authorizes Mobile
            IPv6 service. 
</dd>
<dt>Mobility Service Provider (MSP):</dt>
<dd>
                        
            <br />
A service provider that provides Mobile IPv6
            service. In order to obtain such service, the MN must be
            authenticated and authorized to obtain the Mobile IPv6 service. 
</dd>
<dt>Split Scenario:</dt>
<dd>
                        
            <br />
A scenario where the mobility service and
            the network access service are authorized by different entities.
            
</dd>
<dt>Integrated Scenario:</dt>
<dd>
                        
            <br />
A scenario where the mobility service and
            the network access service are authorized by the same entity. 
</dd>
</dl></blockquote>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Solution Overview</h3>

<p> This document addresses the authentication, authorization and accounting
    functionality required by MIPv6 bootstrapping and Authentication as outlined
    in the MIPv6 bootstrapping problem statement document (see <a class='info' href='#RFC4640'>[15]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>). As such, the AAA functionality for the integrated and
    the split scenario needs to be defined. This requires the ability to offer
    support for the HA to AAA server and the network access server(NAS) to AAA
    server communication.
</p>
<p> To highlight the main use cases, we briefly describe the integrated and
    the split scenarios in <a class='info' href='#integrated'>Section&nbsp;3.1<span> (</span><span class='info'>RADIUS Transaction in Integrated Scenario</span><span>)</span></a> and <a class='info' href='#split'>Section&nbsp;3.2<span> (</span><span class='info'>RADIUS Transactions in Split Scenario</span><span>)</span></a>, respectively. 
</p>
<a name="integrated"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
RADIUS Transaction in Integrated Scenario</h3>

<p> In the integrated scenario MIPv6 bootstrapping is provided as part
        of the network access authentication procedure. <a class='info' href='#figure1'>Figure&nbsp;1<span> (</span><span class='info'>Mobile IPv6 Service Access in the Integrated Scenario</span><span>)</span></a>
        shows the participating entities. 
</p><br /><hr class="insert" />
<a name="figure1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                   +---------------------------+  +-----------------+
                   |Access Service Provider    |  |ASA/MSA/(/MSP)   |
                   |(Mobility Service Provider)|  |                 |
                   |                           |  |    +-------+    |
                   | +-------+                 |  |    |Remote |    |
                   | |Local  |          RADIUS |  |    |RADIUS |    |
                   | |RADIUS |-------------------------|Server |    |
                   | |Proxy  |                 |  |    +-------+    |
                   | +-------+                 |  |        ^        |
                   |     ^  ^                  |  |        |RADIUS  |
                   |     |  |                  |  |        |        |
                   |     |  |                  |  |        v        |
                   |  RADIUS|                  |  |    +-------+    |
                   |     |  |        +-------+ |  |    |Local  |    |
                   |     |  | RADIUS |Home   | |  |    |Home   |    |
                   |     |  +-------&gt;|Agent  | |  |    |Agent  |    |
                   |     |           |in ASP | |  |    +-------+    |
                   |     v           +-------+ |  +-----------------+
+-------+ IEEE     | +-----------+   +-------+ |
|Mobile | 802.1X   | |NAS / Relay|   |DHCPv6 | |
|Node   |----------+-|RADIUS     |---|Server | |
|       | PANA,... | |Client     |   |       | |
+-------+ DHCP     | +-----------+   +-------+ |
                   +---------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Mobile IPv6 Service Access in the Integrated Scenario&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> In the typical Mobile IPv6 access scenario as shown above, the MN
        attaches in the ASP's network. During this network attachment procedure,
        the NAS/RADIUS client interacts with the MN. As shown in <a class='info' href='#figure1'>Figure&nbsp;1<span> (</span><span class='info'>Mobile IPv6 Service Access in the Integrated Scenario</span><span>)</span></a>, the authentication and authorization happens via a
        RADIUS infrastructure. 
</p>
<p> At the time of authorizing the user for IPv6 access, the RADIUS
        server in the MSA detects that the user is authorized for Mobile IPv6
        access. Based on the MSA's policy, the RADIUS server may allocate
        several parameters to the MN for use during the subsequent Mobile IPv6
        protocol interaction with the HA. 
</p>
<p> Depending on the details of the solution, interaction with the
        DHCPv6 server may be required, as described in <a class='info' href='#I-D.ietf-mip6-bootstrapping-integrated-dhc'>[2]<span> (</span><span class='info'>Chowdhury, K. and A. Yegin, &ldquo;MIP6-bootstrapping for the Integrated Scenario,&rdquo; April&nbsp;2008.</span><span>)</span></a>. 
</p>
<a name="split"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
RADIUS Transactions in Split Scenario</h3>

<p> In the split scenario, Mobile IPv6 bootstrapping is not performed
        as part of the network access authentication procedure. Other RADIUS
        transactions such as authentication and authorization, accounting and
        parameter configuration for MIP6 service is provided by the HA to
        RADIUS transactions.
</p>
<p> The Mobile IPv6 RADIUS transaction are executed with the Mobility
        Service Provider when desired by the MN. Two scenarios can be considered:
                                         
            </p>
<ol class="text">
<li>The MSA and the MSP are the same entity. 
</li>
<li>The MSA and the MSP are different entities. 
</li>
</ol>

<p> Since scenario (2) is the more generic scenario we show it in <a class='info' href='#figure2'>Figure&nbsp;2<span> (</span><span class='info'>Mobile IPv6 service access in the split scenario (MSA != MSP)</span><span>)</span></a>. 
</p><br /><hr class="insert" />
<a name="figure2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                      +----------------------+
                                      |                      |
                                      |Mobility   +-------+  |
                                      |Service    |Remote |  |
                                      |Authorizer |RADIUS |  |
                                      |(MSA)      |Server |  |
                                      |           +-------+  |
                                      +---------------^------+
                                                      |
                                                      |RADIUS
                                                      |
                                                      |
                    +---------------------------------|------+
                    |Mobility Service Provider (MSP)  v      |
+-------+           | +-----------+               +-------+  |
|Mobile |  MIPv6 /  | |HA/        |     RADIUS    |Local  |  |
|Node   |-------------|RADIUS     |-------------- |RADIUS |  |
|       |  IKEv2    | |Client     |               |Proxy  |  |
+-------+           | +-----------+               +-------+  |
                    +----------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Mobile IPv6 service access in the split scenario (MSA != MSP)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> As shown in <a class='info' href='#figure2'>Figure&nbsp;2<span> (</span><span class='info'>Mobile IPv6 service access in the split scenario (MSA != MSP)</span><span>)</span></a> the interaction between the
        RADIUS client and the RADIUS server is triggered by the protocol
        interaction between the MN and the HA/RADIUS client using IKEv2 <a class='info' href='#I-D.ietf-mip6-ikev2-ipsec'>[19]<span> (</span><span class='info'>Dupont, F. and V. Devarapalli, &ldquo;Mobile IPv6 Operation with IKEv2 and the revised IPsec Architecture,&rdquo; December&nbsp;2006.</span><span>)</span></a> or MIPv6 Authentication Protocol
        <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>. The important aspect is,
        however, that for these two approaches, several different authentication
        and key exchange solutions are available. To establish IPsec security
        associations for the protection of Mobile IPv6 signaling messages, IKEv2
        is used <a class='info' href='#I-D.ietf-mip6-ikev2-ipsec'>[19]<span> (</span><span class='info'>Dupont, F. and V. Devarapalli, &ldquo;Mobile IPv6 Operation with IKEv2 and the revised IPsec Architecture,&rdquo; December&nbsp;2006.</span><span>)</span></a>. IKEv2 supports
        EAP-based authentication, certificates and pre-shared secrets. For
        protection of Mobile IPv6 signaling messages using the MIPv6
        Authentication Protocol <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a> a
        mechanism has been designed that is very similar to the one used by
        Mobile IPv4.
</p>
<p> The ability to use different credentials has an impact on the
        interaction between the HA (acting as a RADIUS client) and the RADIUS
        Server. For that reason this document illustrates the usage of these
        authentication mechanisms with different subsections for:
                                         
        </p>
<ul class="text">
<li> IKEv2 usage with EAP
</li>
<li> MIPv6 Authentication Protocol using MN-AAA
</li>
</ul>

<p> Authentication schemes using IKEv2 with certificates and pre-shared
        secrets; or MIPv6 Authentication Protocol using MN-HA only are not
        covered by this document.
</p>
<p> For accounting of Mobile IPv6 services provided to the MN, this
        specification uses the RADIUS based accounting defined in <a class='info' href='#RFC2866'>[4]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>.
</p>
<p> Additionally, the MN might instruct the RADIUS server (via the HA)
        to perform a dynamic DNS update. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Use of existing RADIUS Attributes</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
User-Name</h3>

<p>If authentication via IKEv2 is used then the User-Name attribute
        SHALL be set to the IDi payload received in the IKE_AUTH exchange. In
        the case of the Mobile IPv6 Authentication Protocol the User-Name(1)
        attribute is set to the value received in the MN-NAI mobility option as
        defined in <a class='info' href='#RFC4283'>[20]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Mobile Node Identifier Option for Mobile IPv6 (MIPv6),&rdquo; November&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Service-Type</h3>

<p>The HA uses Service-Type(6) to indicate whether the Access-Request
        operation is for Authentication and Authorization or just
        Authorization.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
NAS-Port-Type</h3>

<p> In order for the AAA to distinguish the source of the Access-Request
        NAS-Port-Type(61) is used as follows:
</p>
<p> When the Access-Request originates from an MIP6 HA, NAS-Port-Type
        MUST be included and its value set to HA6(IANA-TBD1).
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Calling-Station-Id</h3>

<p>In the split-scenario, the HA SHOULD use the Calling-Station-Id(31)
        to send the MN's COA to the AAA. If used, the string value of the
        Calling-Station-Id(31) should be set to the 128-bit MN IPv6 COA.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Use of MS-MPPE-Recv-Key and MS-MPPE-Send-Key</h3>

<p>To transport the MSK from the RADIUS to the HA, RADIUS SHALL utilize
        the MS-MPPE-Recv-Key and the MS-MPPE-Send-Key as defined in <a class='info' href='#RFC2548'>[5]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a>. The first up to 32 octets of the MSK is stored into
        the MS-MPPE-Recv-Key, and the next up to 32 octets are stored into the
        MS-MPPE-Send-Key. The encryption of these attributes is described in
        <a class='info' href='#RFC2548'>[5]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Session-Timeout</h3>

<p>The use of Session-Timeout attribute during bootstrapping operations
        is covered by various RFC's.
</p>
<p>The use of Session-Timeout attribute during the EAP exchanges between
        the HA and the RADIUS server are as per <a class='info' href='#RFC3579'>[6]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>In the case of the RADIUS server sending Session-Timeout to the HA in
        the Access-Accept packet, the HA SHALL use this time as the MIP
        Registration Lifetime.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Message Authenticator</h3>

<p>The use of Message Authenticator is mandated during EAP AAA
        procedures by <a class='info' href='#RFC3579'>[6]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>. In the case of the HA sending an
        Access-Request where EAP is not used, then the HA MUST also include the
        Message Authenticator attribute in the Access-Request packet.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
RADIUS attributes</h3>

<p>This section defines format and syntax for the attribute that carries
    the Mobile IPv6 parameters that are described in the previous section.
</p>
<p>The attributes MAY be present in Access-Request, Access-Accept, and
    Accounting-Request packets. 
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
MIP6-Feature-Vector Attribute</h3>

<p> Exactly one of this attribute MUST be sent by the NAS or HA in an
        Access-Request packet to inidcate support for MIP6. For example, a NAS
        uses this attribute to indicate whether it can provide a local home
        agent.
</p>
<p> Exactly one of this attribute MUST be sent by the RADIUS server in
        an Access-Accept packet to indicate support for MIP6 and to select
        features advetized by the NAS or the HA. For example, if the NAS
        indicated support for local home agent assignment, the RADIUS server
        authorizes the NAS to support local home agent assignment by echoing the
        setting the same flag in the Access-Accept packet.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |        MIP6 Features Vectors  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   MIP6 Features Vectors cont.                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   MIP6 Features Vectors cont. |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p></p>
<blockquote class="text">
<p>Type:</p>
<blockquote class="text">
<p>MIP6-FV-TYPE to be defined by IANA. 
</p>
</blockquote>

<p>Length:</p>
<blockquote class="text">
<p> = 10 octets 
</p>
</blockquote>

<p>Feature Flags: </p>
<blockquote class="text">
<p> This field is of type String. Supporting the following values:</p>
<blockquote class="text">
<p>MIP6_INTEGRATED (0x0000000000000001)
</p>
<p>When this flag is set by the NAS then it means that the
                    Mobile IPv6 integrated scenario bootstrapping functionality
                    is supported by the NAS. When this flag is set by the RADIUS
                    server then the Mobile IPv6 integrated scenario
                    bootstrapping is supported by the RADIUS server.
</p>
<p>LOCAL_HOME_AGENT_ASSIGNMENT (0x0000000000000002)
</p>
<p>When this flag is set by the NAS then a local home agent
                    can be assigned to the MN. When this flag is set by the
                    Diameter server then the assignment of location HAs is
                    authorized by the Diameter server.
</p>
<p>RO_SUPPORTED (0x0000000800000000)
</p>
<p>Route optimization is supported. When the Home Agent sets
                    this bit, it indicates support for the route optimization.
                    If this bit is unset in the returned Mobility-Capability
                    AVP, the HAAA does not authorize route optimization for the
                    MN.
</p>
<p>In a case the Home Agent or the HAAA cannot authorize the
                    use of route optimization then the Home Agent will send a
                    Binding Acknowledgement with a Status Code set to
                    ACCEPTED_BUT_NO_ROUTE_OPTIMIZATION (status code TBD). This
                    Status Code indicates that the binding registration
                    succeeded but the Home Agent will fail all possible
                    subsequent route optimization attempts because of
                    subscription or operator policy.
</p>
</blockquote>

</blockquote>

</blockquote>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
MIP6-HA Attribute</h3>

<p> In the case of bootstrapping, the RADIUS server may decide to assign
        a HA to the MN that is in close proximity to the point of attachment
        (e.g., as determined by the NAS-ID). There may be other reasons for
        dynamically assigning HAs to the MN, for example to share the traffic
        load. The attribute also contains the prefix length so that the MN can
        easily infer the Home Link prefix from the HA address. 
</p>
<p>In the case of bootstrapping, one or more of this attribute MAY be
        sent by the NAS to the RADIUS server in an Access-Request packet as a
        proposal by the NAS to allocate a local HA to the MN.
</p>
<p>In the case of bootstrapping, one or more of this attribute MAY be
        sent by the RADIUS server to the NAS in an Access-Accept packet. The
        attribute carries the HA address that may be assigned to the MN.
</p>
<p>[EDITOR: WHAT IS THIS ABOUT?] This attribute MAY be MIP6-DNS-MO
        Attribute sent by the NAS to the RADIUS server in an Access-Request
        packet as a hint to suggest a dynamic HA that may be assigned to the MN.
        The RADIUS server MAY use this value or may ignore this suggestion.
</p>
<p> If available at the NAS, at least MIP6-HA attribute and/or
        MIP6-HA-FQDN SHOULD appear in accounting packets to indicate the
        identity of the serving HA for this session.
</p>
<p>In the case of split, the MIP6-HA attribute contains the IPv6 address
        of the Home Agent as received in the BU message. One and only one of
        this attribute SHALL be sent by the HA to the RADIUS server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Reserved    | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   IPv6 address of assigned HA                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          IPv6 address of assigned HA cont.                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          IPv6 address of assigned HA cont.                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          IPv6 address of assigned HA cont.                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          IPv6 address of assigned HA cont.                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          IPv6 address of assigned HA cont.                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p></p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>MIP6-HA-TYPE to be defined by IANA. 
</p>
</blockquote>

<p>Length: </p>
<blockquote class="text">
<p>= 28 octets 
</p>
</blockquote>

<p>Reserved: </p>
<blockquote class="text">
<p>Reserved for future use. The bits MUST be set to zero by
                    the sender, and MUST be ignored by the receiver.
</p>
</blockquote>

<p>Prefix-Length: </p>
<blockquote class="text">
<p>This field indicates the prefix length of the Home Link.
                    
</p>
</blockquote>

<p>IPv6 address of assigned HA: </p>
<blockquote class="text">
<p> 128-bit IPv6 address of the assigned HA. 
</p>
</blockquote>

</blockquote>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
MIP6-HA-FQDN Attribute</h3>

<p>In the case of bootstrapping, one or more instance of this
            attribute MAY be sent by the NAS to the RADIUS server in an
            Access-Request packet as a hint to suggest a dynamic HA that may be
            assigned to the MN. The RADIUS server MAY use this value or may
            ignore this suggestion.
</p>
<p>In the case of bootstrapping, one or more of this attribute is
            sent by the RADIUS server to the NAS in an Access-Accept packet. The
            attribute carries the FQDN of the assigned HA. The mobile node can
            perform DNS query with the FQDN to derive the HA address. 
</p>
<p>If available at the NAS, at least MIP6-HA-FQDN attribute and/or
            MIP6-HA SHOULD appear in accounting packets to indicate the identity
            of the serving HA for this session.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   FQDN of the assigned HA .....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-HA-FQDN-TYPE to be defined by IANA. 
</p>
</blockquote>

<p>Length: </p>
<blockquote class="text">
<p> Variable length. 
</p>
</blockquote>

<p>FQDN of the assigned HA: </p>
<blockquote class="text">
<p> The data field MUST contain a FQDN as described in <a class='info' href='#RFC1035'>[21]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>. 
</p>
</blockquote>

</blockquote>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
MIP6-HL-Prefix Attribute</h3>

<p> In the case of bootstrapping, this attribute MAY be sent by the
            NAS to the RADIUS server in an Access-Request packet along with the
            MIP6-HA and/or MIP6-HA-FQDN attribute as a hint to suggest a Home
            Link prefix that may be assigned to the MN. The RADIUS server MUST
            use this value if it accepts the NAS's HA suggestion.
</p>
<p>In the case of bootstrapping, this attribute is sent by the
            RADIUS server to the NAS in an Access-Accept packet and carries the
            assigned Home Link prefix that is in close proximity to the point of
            attachment (NAS-ID). The MN can perform <a class='info' href='#RFC3775'>[14]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>
            specific procedures to discover other information for Mobile IPv6
            registration.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      | Reserved      | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                       Home Link Prefix                        |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-HL-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length:</p>
<blockquote class="text">
<p> &gt;= 4 octets + the minimum length of a prefix. 
</p>
</blockquote> 

<p>Reserved:  </p>
<blockquote class="text">
<p> Reserved for future use. The bits MUST be set to zero by
                    the sender, and MUST be ignored by the receiver.
</p>
</blockquote> 

<p>Prefix-Length:  </p>
<blockquote class="text">
<p> This field indicates the prefix length of the Home Link.
                    
</p>
</blockquote> 

<p>Home Link Prefix:  </p>
<blockquote class="text">
<p>Home Link prefix (upper order bits) of the assigned Home
                    Link where the MN should send binding update. 
</p>
</blockquote> 

</blockquote><p> 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
MIP6-HOA Attribute</h3>

<p>In the bootstrapping case, this attribute is sent by the RADIUS
            server to the NAS in an Access-Accept packet. The attribute carries
            the assigned Home IPv6 Address for the MN. This allows the network
            operator to support mobile devices that are not configured with
            static addresses. The attribute also contains the prefix length so
            that the MN can easily infer the Home Link prefix from the HA
            address.
</p>
<p>This attribute MAY be sent by the NAS to the RADIUS server in an
            Access-Request packet along with the MIP6-HA and/or MIP6-HA-FQDN
            attribute as a hint to suggest a Home Address that may be assigned
            to the MN. The RADIUS server MUST use this value if it accepts the
            NAS's HA suggestion.
</p>
<p>In the case of split, in Access-Request packet, the MIP6-HOA
            contains the IPv6 Home Address assigned by the HA to the MN. If the
            MIP6-HOA AVP contains unspecified IPv6 address (0::0), then the Home
            Agent expects the RADIUS server to assign the Home Address in a
            subsequent Access-Accept packet. In case the RADIUS server assigns
            only a Home Network Prefix to the Mobile Node the lower 64 bits of
            the MIP-Mobile-Node-Address AVP provided address MUST be set to
            zero.
</p>
<p>If available at the NAS, this attribute SHOULD appear in the
            accounting packets so that the IPv6 addressed used for this session
            is known in the accounting stream.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Reserved    | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                   Assigned IPv6 HOA                           |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-HOA-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p> = 20 octets. 
</p>
</blockquote> 

<p>Reserved: </p>
<blockquote class="text">
<p>Reserved for future use. The bits MUST be set to zero by
                    the sender, and MUST be ignored by the receiver.
</p>
</blockquote> 

<p>Prefix-Length: </p>
<blockquote class="text">
<p>This field indicates the prefix length of the Home Link. 
</p>
</blockquote> 

<p>Assigned IPv6 HOA: </p>
<blockquote class="text">
<p>IPv6 HOA that is assigned to the MN. 
</p>
</blockquote> 

</blockquote><p> 
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
MIP6-DNS-MO Attribute</h3>

<p>In the case of bootstrapping, the MIP6-DNS-MO attribute is
            included by the NAS in an Access-Request packet and MUST set its
            value to the MN's FQDN to indicate to the RADIUS server to perform a
            dynamic DNS update. Upon receiving this attribute, the RADIUS server
            SHALL perform a dynamic update of the DNS and MUST inlcude the
            MIP6-DNS-MO attribute in the Access-Accept indicating the result of
            the dynmaic DNS update.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Reserved-1  |     Status    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |R| Reserved-2  |   FQDN                                    ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> DNS-UPDATE-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>Variable length. 
</p>
</blockquote> 

<p>Reserved-1: </p>
<blockquote class="text">
<p>Reserved for future use. The bits MUST be set to zero by
                    the sender, and MUST be ignored by the receiver.
</p>
</blockquote> 

<p>Status: </p>
<blockquote class="text">
<p> This 8 bit unsigned integer field indicates the result
                    of the dynamic DNS update procedure as defined in <a class='info' href='#I-D.ietf-mip6-bootstrapping-split'>[7]<span> (</span><span class='info'>Giaretta, G., &ldquo;Mobile IPv6 bootstrapping in split scenario,&rdquo; July&nbsp;2007.</span><span>)</span></a>. This field
                    MUST be set to 0 and ignored by the RADIUS server when the
                    MIP6-DNS-MO is sent from the RADIUS client to the RADIUS
                    server. When the MIP6-DNS-MO is provided in the response,
                    values of the Status field less than 128 indicate that the
                    dynamic DNS update was performed successfully by the RADIUS
                    server. Values greater than or equal to 128 indicate that
                    the dynamic DNS update was not successfully completed. The
                    following values for the Status field are currently defined:
                    
</p>
<p>0   DNS update performed 
</p>
<p>128 Reason unspecified 
</p>
<p>129 Administratively prohibited 
</p>
<p>130 DNS Update Failed 
</p>
</blockquote>

<p>R flag: </p>
<blockquote class="text">
<p>If this bit for the R flag is set then the RADIUS client
                    requests the RADIUS server to remove the DNS entry
                    identified by the FQDN included in this attribute. If not
                    set, the RADIUS client is requesting the RADIUS server to
                    create or update a DNS entry with the FQDN specified in this
                    attribute and the Home Address carried in another attribute
                    specified in this document. 
</p>
</blockquote> 

<p>Reserved-2:  </p>
<blockquote class="text">
<p> Reserved for future use. The bits MUST be set to zero by
                    the sender, and MUST be ignored by the receiver.
</p>
</blockquote>

<p>FQDN of the MN: </p>
<blockquote class="text">
<p> In an Access-Request packet the data field MUST contain
                    a FQDN. In an Access-Accept packet the data field MAY
                    contain an FQDN. FQDN is described in <a class='info' href='#RFC1035'>[21]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>. 
</p>
</blockquote> 

</blockquote><p> 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
MIP6-Careof-Address</h3>

<p>In the case of split, this attribute is sent from the HA to the
            RADIUS Server and contains the IPv6 addresss of the Care-of Address
            of the MN extracted from the BU message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Reserved    | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                   Assigned IPv6 COA                           |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-CAREOF-ADDRESS-TYPE to be defined
                            by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p> = 20 octets. 
</p>
</blockquote> 

<p>Reserved: </p>
<blockquote class="text">
<p>Reserved for future use. The bits MUST be set to
                        zero by the sender, and MUST be ignored by the
                        receiver.
</p>
</blockquote> 

<p>Prefix-Length: </p>
<blockquote class="text">
<p>This field indicates the prefix length of the COA
                        Link. 
</p>
</blockquote> 

<p>Assigned IPv6 COA: </p>
<blockquote class="text">
<p>IPv6 COA that is assigned to the MN. 
</p>
</blockquote> 

</blockquote><p> 
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
MIP6-MN-AAA-SPI</h3>

<p>In the case of split, this attribute MUST be present in an
            Access-Request sent from the HA to the RADIUS Server when using
            MIPv6 Authentication Protocol. The MIP6-MN-AAA-SPI attribute
            contains a SPI code extracted from the Mobility Message
            Authentication Option included in the received BU message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     SPI                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   SPI cont.                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-MIP6-MN-AAA-SPI-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p> 6 octets 
</p>
</blockquote> 

<p>Integer representing a Security Parameter Index.
</p>
</blockquote><p> 
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.9"></a><h3>5.9.&nbsp;
MIP6-Authenticator</h3>

<p>In the case of split, this attribute is sent from the HA to the
            RADIUS server and contains the Authenticator data from the BU
            message. The HA extract the data form the MN-AAA Mobility Message
            Authentication Option if included in the received BU message.
</p>
<p>Upon receiving this attribute from the HA, the RADIUS server
            computes its own version of the Authenticator Data from the received
            MIP6-MAC-Mobility-Data (see below) and compares it to the value
            received in the MIP6-Authenticator from the HA. If the values match
            then the Mobile Node is authenticated.
</p>
<p>In the case of split, this attribute MUST be present in an
            Access-Request sent from the HA to the RADIUS Server when using
            MIPv6 Authentication Protocol.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     Authenticator Data        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Authenticator Data cont ....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-MIP6-AUTHENTICATOR-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p> Variable length 
</p>
</blockquote> 

<p> String.  An OctetString representing authenticator data.
</p>
</blockquote><p> 
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.10"></a><h3>5.10.&nbsp;
MIP6-MAC-Mobility-Data</h3>

<p>In the case of split, the MIP6-MAC-Mobility-Data attribute is
            sent from the HA to the RADIUS Server. The attribute contains the
            calculated MAC_Mobility_Data as defined in <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>.
</p>
<p>This attribute MUST be present in an Access-Request sent from the
            HA to the RADIUS Server when using MIPv6 Authentication
            Protocol.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     MAC Mobility Data         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     MAC Mobility Data cont ....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-MAC-MOBILITY-DATA-TYPE to be defined by
                    IANA.
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>Variable length 
</p>
</blockquote> 

<p>String.  An OctetString representing authenticator data.
</p>
</blockquote><p> 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.11"></a><h3>5.11.&nbsp;
MIP6-Timestamp</h3>

<p>The MIP6-Timestamp contains the timestamp value from the Mobility
            message replay protection option, defined in <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>. The Home Agent extracts this
            value from the received BU message, if available.
</p>
<p>The support for replay protection is an optional feature in <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>. When the RADIUS server checks
            the timestamp provided by the MN via the HA and recognizes a
            clock-drift (outside a locally defined replay protection window)
            then it MUST initiate the re-synchronization procedure by returning
            an Access-Accept packet with Result-Code set to
            MIP6-TIMESTAMP-MISMATCH and attaches the MIP6-Timestamp including
            it's current time back to the HA.
</p>
<p>In the case of split, this attribute is sent from the HA to the
            RADIUS server when performing MIP6 Authentication protocol. The
            attribute MUST appear in the Access-Request if the attribute is
            present in the Mobility message replay protection. Otherwise the
            attribute MUST NOT appear in the Access-Request packet.
</p>
<p>[EDITOR'S NOTE] there is an issue here. In the diameter protocol,
            if there is a time mismatch we return a result code that states that
            there was a time mismatch and we return this value. In RADIUS land
            we return an Access-Reject but we cant really return any other
            attributes.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     Timestamp                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Timestamp cont.             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-MIP6-TIMESTAMP-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>6 octets 
</p>
</blockquote> 

<p>Integer representing time since standard epoch of 1/1/1970
                in seconds.
</p>
</blockquote><p> 
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.12"></a><h3>5.12.&nbsp;
MIP6-MN-HA-SPI</h3>

<p>In the case of split, the MIP6-MN-HA-SPI available to be sent in
            an Access-Accept packet from the RADIUS server to he HA. It is part
            of a group of attributes used with the MIPv6 Authentication Protocol
            and contains the Security Parameter Index used to reference the
            MN-HA mobility security association.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     SPI                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   SPI cont.                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-MN-HA-SPI-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>6 octets 
</p>
</blockquote> 

<p>Integer representing a Security Parameter Index.
</p>
</blockquote><p> 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.13"></a><h3>5.13.&nbsp;
MIP6-Algorithm-Type</h3>

<p>In the case of split, the MIP6-Algorithm-Type is available to be
            sent in an Access-Accept packet from the RADIUS server to the HA. It
            is part of a group of attributes used with the MIPv6 Authentication
            protocol and contains the algorithm type. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     enumeration               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   enumeration cont.           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-ALGORITHM-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>6 octets 
</p>
</blockquote> 

<p>Integer representing an enumeration as supported by <a class='info' href='#RFC3344'>[22]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>:</p>
<blockquote class="text">
<p>2: HMAC-SHA-1 <a class='info' href='#RFC2104'>[8]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>
</p>
</blockquote> 

</blockquote><p> 
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.14"></a><h3>5.14.&nbsp;
MIP6-Replay-Mode</h3>

<p>In the case of split, the MIP6-Replay-Mode is available to be
            sent in an Access-Accept packet from the RADIUS server to the HA. It
            is part of a group of attribute used with the MIPv6 Authentication
            protocol and contains the replay mode as defined in RFC4004 to be
            used by the HA.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     enumeration               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   enumeration cont.           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-REPLAY-MODE-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>6 octets 
</p>
</blockquote> 

<p>Integer representing an enumeration as supported by <a class='info' href='#RFC3344'>[22]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>:</p>
<blockquote class="text">
<p>1: None.
</p>
<p>2: Timestamps.
</p>
<p>3: Nonces.
</p>
</blockquote>

</blockquote><p> 
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.15"></a><h3>5.15.&nbsp;
MIP6-Nonce</h3>

<p>In the case of split, the MIP6-Nonce is available to be sent in
            an Access-Accept packet from the RADIUS Server to the HA. It is part
            of a group of attributes used with the MIPv6 Authentication protocol
            and contains the nonce to send to the MN.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |     nonce                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                               ....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p> </p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p> ASSIGNED-MIP6-NONCE-TYPE to be defined by IANA. 
</p>
</blockquote> 

<p>Length: </p>
<blockquote class="text">
<p>Variable length 
</p>
</blockquote> 

<p>String.  A binary string representing a nonce.
</p>
</blockquote><p> 
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.16"></a><h3>5.16.&nbsp;
MIP6-Auth-Mode</h3>

<p>The MIP6-Auth-Mode is of type enumerated and sent by the HA to
            the RADIUS server to indicate which procedural variant and
            credential to use when Authentication Protocol for MIP6 <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a> is being used to authenticate
            the Binding Update. This specification defines only one value.
</p>
<p>If the RADIUS server does not support the Mobile IPv6
            Authentication Protocol mode proposed by the HA, then the RADIUS
            server MUST fail the authentication/authorization by sending an
            Access-Reject packet to the HA.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |        MIP6 Auth Mode         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   MIP6 Auth Mode cont.        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p></p>
<blockquote class="text">
<p>Type: </p>
<blockquote class="text">
<p>ASSIGNED-MIP6-AUTH-MODE-TYPE to be defined by IANA. 
</p>
</blockquote>

<p>Length: </p>
<blockquote class="text">
<p>6 octets
</p>
</blockquote> 

<p>Integer value representing the following values: </p>
<blockquote class="text">
<p>1: MIP6_AUTH_MN_AAA
</p>
<p>All other values reserved.
</p>
</blockquote>

</blockquote>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Message Flows</h3>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Use of RADIUS in Integrated Scenario (MSA=ASA)</h3>

<p>This section is based on <a class='info' href='#I-D.ietf-mip6-bootstrapping-integrated-dhc'>[2]<span> (</span><span class='info'>Chowdhury, K. and A. Yegin, &ldquo;MIP6-bootstrapping for the Integrated Scenario,&rdquo; April&nbsp;2008.</span><span>)</span></a> and uses the
            RADIUS attributes that are defined in this document. 
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
HA allocation in the MSP</h3>

<p>RADIUS is used to authenticate the MN, to authorize it for
                mobility service and to send information about the assigned HA
                to the NAS. 
</p><br /><hr class="insert" />
<a name="figure3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         |
                 --------------ASP------&gt;|&lt;--ASA+MSA--
                                         |
   +----+        +------+      +-------+   +-------+
   |    |        |RADIUS|      |       |   |       |
   |    |        |Client|      |       |   |       |
   | MN |        |NAS/  |      | DHCP  |   |Home   |
   |    |        |DHCP  |      | Server|   |RADIUS |
   |    |        |Relay |      |       |   |Server |
   +----+        +------+      +-------+   +-------+
     |               |             |          |
     |     1         |          1  |          |
     |&lt;-------------&gt;|-----------------------&gt;|
     |               |             |          |
     |               |          2  |          |
     |               |&lt;-----------------------|
     |               |             |          |
     |     3         |             |          |
     |--------------&gt;|             |          |
     |               |             |          |
     |               |       4     |          |
     |               |------------&gt;|          |
     |               |             |          |
     |               |       5     |          |
     |               |&lt;------------|          |
     |               |             |          |
     |     6         |             |          |
     |&lt;--------------|             |          |
     |               |             |          |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: HA allocation in the MSP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In step (1), the MN executes the network access
                    authentication procedure (e.g., IEEE 802.11i/802.1x, PANA)
                    with the NAS. The NAS acts as an authenticator in
                    "pass-through" mode, i.e., the endpoint of the
                    authentication dialogue is the MN's home RADIUS server. This
                    is the typical scenario in case the messages involved in the
                    authentication protocol are transported in EAP.
</p>
<p>As per <a class='info' href='#RFC3579'>[6]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>, the NAS
                    encapsulates/de-capsulates EAP packets into/from RADIUS
                    packets until an Access-Response (either an Access-Accept or
                    an Access/Reject packet is received by the NAS). This
                    concludes the network access authentication phase.
</p>
<p>If the NAS has the ability to support MIP6 Bootstrapping
                    it includes the MIP6-Feature-Vector in the first
                    Access-Request message and indicates whether it supports
                    MIP6 bootstrapping and/or local home agent assignment by
                    setting the appropriate flags therein.
</p>
<p>If the NAS indicates support for local home agent
                    assignment, then it may also include the MIP6-HA
                    attribute(s) and/or MIP6-HA-FQDN attribute(s) as a proposal
                    to the RADIUS server to indicate that the HA is to be
                    assigned in the ASP.
</p>
<p>In step (2), the RADIUS server sends an Access-Accept
                    packet with the MIP6-Feature-Vector with the Local Home
                    Agent Assignment flag set or cleared. If the flag is cleared
                    then the RADIUS server needs to provide one or more Home
                    Agent(s) to be assigned to the MN. If the flag is set, then
                    it indicates to the NAS that it can assign HA to the MN; the
                    RADIUS server may also include one or more HA addresses thus
                    indicating that the NAS can either allocate a local HA or
                    one specified by the RADIUS server.
</p>
<p>In step (3) the MN performs home information discovery
                    procedures as specified in [DHCPv6 for Home Info Discovery
                    in MIPv6][hiopt]. The MN sends a DHCPv6 Information-request
                    message including the Home Network Information option
                    according to the stateless DHCPv6 procedures <a class='info' href='#RFC3736'>[23]<span> (</span><span class='info'>Droms, R., &ldquo;Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6,&rdquo; April&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#RFC3315'>[24]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>. The MN MUST
                    also include the Option code for the Home Network
                    Information option in the Option Request option in the
                    request. The id-type of the Home Network Identifier Option
                    is set to 1 indicating that the MN is requesting to discover
                    the home network information that pertains to the given
                    realm, i.e., the user's home domain (identified by the NAI
                    of the MN). The OPTION_CLIENTID is set by the MN to identify
                    itself to the DHCP server.
</p>
<p> In step (4) the DHCP relay agent forwards this request
                    to the DHCP server. The OPTION_MIP6-RELAY-Option is included
                    in this forwarded message. This option carries the RADIUS
                    MIP6-HA attribute received in the Access-Accept packet.
</p>
<p> In step (5), the DHCP server identifies the client (by
                    DUID) and finds out that it requests HA information in the
                    MSP (by the Home Network Identifier Option = 1). The DHCP
                    server extracts the HA address from OPTION_MIP6-RELAY-Option
                    and places it into Home Network Information Option in the
                    Reply message.
</p>
<p>In step (6), the Relay Agent forwards the Reply Message
                    to the MN. On reception of this message, the HA address or
                    the FQDN of the HA is available at the MN.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
HA allocation in the ASP (visited network)</h3>

<p>This scenario is similar to the one described in Section
                    7.1.1. The difference is in step (4), where the type-id
                    field in the Home Network Identifier Option is set to zero,
                    indicating that a HA is requested in the ASP instead of in
                    the MSP. Thus, the information received by the home RADIUS
                    server, via the DHCP relay, in the OPTION_MIP6-RELAY-Option
                    (Information Request) is ignored. The DHCP server allocates
                    a HA from its list of possible HAs and returns it in the
                    Reply message (Home Network Information Option). 
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Use of RADIUS In Split Scenario</h3>

<p>In this section we present the call flows used in the Split
                scenario. In the Split scenario the MN can be authenticated and
                authorized for Mobile IPv6 by using IKEv2 or the Mobile IPv6
                Authentication Protocol <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>. The authentication and or
                authorization takes place between the HA and the RADIUS
                server.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Split using IKEv2</h3>

<p>This section describes IKEv2 based authentication and
                    authorization for the SPLIT scenario using IKEv2 and EAP.
                    Use of IKEv2 with certificates or preshared keys is not in
                    scope for this document.
</p>
<p>The use of IKEv2 with EAP between the MN and the HA
                    allows the AAA to authenticate the MN. When EAP is used with
                    IKEv2, the RADIUS EAP procedures, as defined in <a class='info' href='#RFC3579'>[6]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>, are used. EAP methods that do not
                    establish a shared key SHOULD NOT be used, as they are
                    subject to a number of man-in-the-middle attacks as stated
                    in Section 2.16 and Section 5 of RFC 4306 <a class='info' href='#RFC4306'>[25]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Attributes specific to Mobile IPv6
                    bootstrapping are added to the AAA packets.
</p>
<p><a class='info' href='#figure4'>Figure&nbsp;4<span> (</span><span class='info'>Split Scenario Exchange                     Using IKEv2 and EAP</span><span>)</span></a> shows the message flow involved
                    during the authentication phase when EAP is used.
</p><br /><hr class="insert" />
<a name="figure4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     ----------------------------ASP---------&gt;|&lt;-----MSA/MSP

  +----+      IKEv2  +----+    RADIUS (EAP)      +--------------------+
  | MN |&lt;-----------&gt;| HA |&lt;--------------------&gt;| Home RADIUS Server |
  +----+             +----+                      +--------------------+



    Mobile                           Home                        RADIUS
    Node                             Agent                       Server
     |                                 |                           |
     | HDR, SAi1, KEi, Ni  (1)         |                           |
     |--------------------------------&gt;|                           |
     |                                 |                           |
     | HDR, SAr1, KEr, Nr, [CERTREQ](2)|                           |
     |&lt;--------------------------------|                           |
     |                                 |                           |
     | HDR, SK{IDi,[CERTREQ,] [IDr,]   |                           |
     | [CP(CFG_REQUEST),]              |                           |
     | SAi2, TSi, TSr} (3)             |                           |
     |--------------------------------&gt;| Access-Request            |
     |                                 | (EAP-Response) (4)        |
     |                                 |--------------------------&gt;|
     |                                 |                           |
     |                                 | Access-Challenge          |
     |                                 | (EAP-Request) (5)         |
     | HDR, SK{IDr, [CERT,] AUTH, EAP} |&lt;--------------------------|
     |&lt;------------------------------- |                           |
     |                                 |                           |
     | HDR, SK{EAP}                    |                           |
     |--------------------------------&gt;|Access-Request(EAP-Res.)   |
     |                                 |--------------------------&gt;|
     |                                 |                           |
     |                                 |Access-Challenge(EAP-Req.) |
     | HDR, SK{EAP-Request}            |&lt;--------------------------|
     |&lt;--------------------------------|                           |
     |                                 |                           |
     | HDR, SK{EAP-Response}           |                           |
     |--------------------------------&gt;|Access-Request (EAP-Res.)  |
     |                                 |--------------------------&gt;|
     |               ...               |          ...              |
     |                                 |                           |
     |                                 |Access-Accept(EAP-Success) |
     |                              (6)|&lt;--------------------------|
     | HDR, SK{EAP-Success}            |                           |
     |&lt;--------------------------------|                           |
     |                                 |                           |
     | HDR, SK{AUTH}                   |                           |
     |--------------------------------&gt;|                           |
     |                                 |                           |
     | HDR, SK{AUTH, [CP(CFG_REPLY,]   |                           |
     | SAr2, TSi, TSr}                 |                           |
     |&lt;--------------------------------|                           |
     |                                 |                           |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Split Scenario Exchange
                    Using IKEv2 and EAP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Before this scenario started the MN has to know the IP
                    address of the HA to use. The MN may be configured with the
                    HA-IP address or the FQDN of the HA to use or with a
                    mobility service name. In the case where the MN is
                    configured with the domain name of the HA or a mobility
                    service name, it uses DNS to resolve the IP address of the
                    HA to use. Alternatively, MN could have received the
                    information by performing a DHCP request as per <a class='info' href='#I-D.ietf-mip6-hiopt'>[26]<span> (</span><span class='info'>Jang, H., Yegin, A., Chowdhury, K., and J. Choi, &ldquo;DHCP Options for Home Information Discovery in MIPv6,&rdquo; May&nbsp;2008.</span><span>)</span></a>
</p>
<p>The MN and the HA start the interaction with an
                    IKE_SA_INIT exchange(1)(2). In this phase cryptographic
                    algorithms are negotiated, nonces and Diffie-Hellman
                    parameters are exchanged.
</p>
<p>Exchange (3) starts the IKE_AUTH phase. This second phase
                    of IKEv2 authenticates the previous messages, exchanges
                    identities and certificates and establishes the first
                    CHILD_SA. It is used to mutually authenticate the MN (acting
                    as an IKEv2 Initiator) and the HA (acting as an IKEv2
                    Responder). The identity of the user/MN is provided in the
                    IDi field. The MN indicates its willingness to be
                    authenticated via EAP by omitting the AUTH field in message
                    (3) (see Section 2.16 of <a class='info' href='#RFC4306'>[25]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>).
</p>
<p>As part of the authentication process, the MN MAY request
                    a Home- Address, a Home Prefix or suggests one, see <a class='info' href='#RFC4877'>[27]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a>, using a CFG_REQUEST payload in the
                    exchange(3).
</p>
<p>The HA extracts the IDi field from exchange (3) and sends
                    a RADIUS Access-Request packet(4) towards the authenticating
                    RADIUS server. The User-Name(1) attribute is set to the
                    value received in the IDi field and the EAP-Payload
                    attribute contains a EAP-Response/ Identity with the
                    identity extracted from the IDi field. The Access-Request
                    packet is integrity protected by the
                    Message-Authenticator(89) attribute.
</p>
<p>This message is routed to the MN's home RADIUS server/EAP
                    server. The RADIUS server selects the EAP method and replies
                    with the RADIUS Access-Challenge packet(5). Depending on the
                    type of EAP method chosen, a number of Access-Request and
                    Access-Challenge exchanges are conducted to execute the EAP
                    method between the MN and the RADIUS server/EAP server.
</p>
<p>At the end of the EAP authentication phase, the RADIUS
                    server indicates the result of the authentication by either
                    sending an Access-Accept packet(6) containing EAP-Success or
                    an Access-Reject packet containing EAP-Reject. The last
                    IKEv2 message sent by the HA contains the Home Address or
                    the Home Prefix. In the latter case, a CREATE_CHILD_SA
                    exchange is necessary to setup IPSec SAs for Mobile IPv6
                    signaling.
</p>
<p>In some deployment scenarios, the HA may also acts as a
                    IKEv2 Responder for IPSec VPN access. A problem in this case
                    is that the IKEv2 responder may not know if IKEv2 is used
                    for Mobile IPv6 service or for IPSec VPN access service. A
                    network operator needs to be aware of this limitation. The
                    MN may provide a hint of the intended service, for example,
                    by using different identities in the IKE_AUTH message for
                    the IPSec VPN service and Mobile IPv6 service. However, the
                    use of different identities during the IKEv2 negotiation is
                    deployment specific. Another possibility is to make the
                    distinction on the MN subscription basis. In this case the
                    RADIUS server can inform the HA during the IKEv2 negotiation
                    whether the MN is provisioned with an IPSec VPN access
                    service or Mobile IPv6 service.
</p>
<p>Eventually, when the HA receives a Binding Update (BU),
                    the HA authenticates and authorizes the MN. It is
                    RECOMMENDED that the HA sends a RADIUS accounting request
                    message every time it receives a BU. Alternatively, if the
                    HA does not support RADIUS Accounting, it SHOULD send a
                    User-Session-Notification packet as defined in <a class='info' href='#I-D.zorn-radius-logoff'>[9]<span> (</span><span class='info'>Zorn, G. and A. Lior, &ldquo;User Session Tracking in RADIUS,&rdquo; February&nbsp;2008.</span><span>)</span></a> to inform the AAA server
                    that the mobile ip session has termianted.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Split and Mobile IPv6 Authentication Protocol</h3>

<p> <a class='info' href='#figure5'>Figure&nbsp;5<span> (</span><span class='info'>Mobile IPv6 Bootstrapping using the Mobile IPv6 Authentication Protocol</span><span>)</span></a> shows the message sequence
                    between the MN, the HA and the RADIUS server during the
                    registration when Mobile IPv6 Authentication Protocol is
                    used. A BU and a Binding Acknowledgement (BA) messages are
                    used in the binding registration process.
</p>
<p>Mobile IPv6 Authentication Protocol as specfied in <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a> allows the initial BU
                    to be protected using the MN-HA key or the MN-AAA key.
                    Support for the use of MN-HA key to protected the initial BU
                    is not in scope of this specification.
</p>
<p>Receiving a BU at the HA initiates a MIP6-Request to be
                    sent to the RADIUS server. The RADIUS server in turn
                    responds with an Access-Accept or an Access-Reject. The HA
                    may assign a Home Address to the MN and provide it to the
                    RADIUS server in the MIP6-HOA attribute.
</p>
<p>According to <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>
                    the MN uses the Mobile Node Identifier Option, specifically
                    the MN-NAI mobility option (as defined in <a class='info' href='#RFC4283'>[20]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Mobile Node Identifier Option for Mobile IPv6 (MIPv6),&rdquo; November&nbsp;2005.</span><span>)</span></a>) to identify itself. The HA MUST copy the
                    MN-NAI mobility option value to the User-Name(1) attribute
                    in the Access-Request packet.
</p>
<p>The procedure described in this specification for the
                    Mobile IPv6 Authentication Protocol is only needed for the
                    initial BU received by the HA. When the HA receives
                    subsequent BUs, they are processed locally in the HA using
                    the MN-HA key received from the AAA upon successful
                    authentication and authorization. It is RECOMMENDED that the
                    HA sends an accounting request packet upon each new BU
                    update reauthentication.
</p>
<p>Upon receiving a BU containing the MN-AAA Mobile Message
                    Authentication Option, the HA extracts the Mobility SPI from
                    the Mobility Message Authentication Option and sends it to
                    the RADIUS server in the MIP6-MN-AAA-SPI attribute. The HA
                    also extract the Authentication Data from the Message
                    Authentication Option and includes it in the Access-Request
                    in the MIP6-Authenticator attribute. The HA includes the
                    MIP6-Auth-Mode attribute in the Access-Request setting its
                    value to MIP6_AUTH_MN_AAA indicating that the MN-AAA key is
                    used as the credential protecting the BU.
</p>
<p>In the case of RADIUS based authentication, the Mobility
                    SPI MUST be set the well-know value HMAC-SHA1_SPI (see
                    section 8 of <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>). In
                    this case the HA SHALL compute the MAC_Mobility Data as per
                    <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a> using HMAC_SHA1
                    as the hash_fn() and include the result in the
                    MIP6-MAC-Mobility-Data attribute in the Access-Request.
</p>
<p>The HA inlcudes the MIP6-Authenticator attribute set to
                    the authenticator data extracted from the MN-AAA Mobility
                    Message Authentication Option contained in the BU
                    message.
</p>
<p>The MIP6-Timestamp attribute is set to the value
                    contained in the mobility message prelay protection option
                    defined in <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a> if
                    available.
</p>
<p>Upon receiving the Access-Request packet from the HA, the
                    RADIUS server MUST ensure that the MIP6-Auth-Mode attribute
                    is present and set to MIP6_AUTH_MN_AAA. If not, the RADIUS
                    Server SHALL respond with an Access-Reject packet which
                    includes Error-Cause (101) attribute with value set to
                    "Invalid Attribute Value". Upon receiving an Access-Reject
                    with Error-Cause (101) attribute set to "Invalid Attribute
                    Value", the HA SHALL reject the BU.
</p>
<p>The Access-Request packet MUST contain the
                    MIP6-MN-AAA-SPI attribute with a SPI set the well-know value
                    HMAC-SHA1_SPI (see section 8 of <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>). If not, the RADIUS
                    server SHALL repond back to the HA with an Access-Reject
                    packet contain Error-Cause (101) attribute set to "Missing
                    Attribute".
</p>
<p> The RADIUS server uses the data received in the
                    MIP6-MAC-Mobility-Data attribute to computes its own version
                    of the Authenticator as per <a class='info' href='#I-D.patel-mip6-rfc4285bis'>[3]<span> (</span><span class='info'>Patel, A., &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; October&nbsp;2006.</span><span>)</span></a>. The RADIUS server
                    compares the value computed to the value received in the
                    MIP6-Authenticator. If the values don't match the RADIUS
                    server SHALL respond back with an Access-Reject packet.
</p>
<p>If the MN is authenticated and is authorized for MIP6
                    service, the RADIUS server responds back with an
                    Access-Accpet otherwise it responds with an Access-Reject.
                    In the case of Access-Accept and if the MIP6-MN-HA-SPI value
                    was inclued in the Access-Request packet, the RADIUS server
                    includes the MN-HA security association parameters
                    associated with the MN-HA SPI and the NAI received in the
                    User-Name attributes in the MS-MPPE-Recv-Key,
                    MS-MPPE-Send-Key, MIP6-Algorithm-Type, MIP6-Replay-Mode,
                    MIP6-Nonce. The MS-MPPE-Recv-Key, MS-MPPE-Send-Key must be
                    encrypted using the procedures defined in section 3.3 of
                    <a class='info' href='#RFC2868'>[10]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>. The RADIUS Access-Accept packet
                    MUST be integrity protected using Message-Authenticator(89)
                    attribute.
</p>
<p>If the RADIUS server detected a replay attack when
                    checking the MIP6-Timestamp received in the Access-Request
                    fromt he HA. The RADIUS server SHALL respond back with an
                    Access-Reject.
</p><br /><hr class="insert" />
<a name="figure5"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     Mobile                                Home                Diameter
     Node                                  Agent                 Server
       |                                     |                     |
       |                                     |                     |
       |       Binding Update                |RADIUS Access-Request|
       |------------------------------------&gt;|--------------------&gt;|
       | (Mobile Node Identifier Option,     |                     |
       |  Mobility Message Replay Protection |                     |
       |  Option, Authentication Option)     |                     |
       |                                     |                     |
       |                                     |                     |
       |       Binding Acknowledgement       |RADIUS Access-Accept |
       |                                     |or Access-Reject     |
       |&lt;------------------------------------|&lt;--------------------|
       | (Mobile Node Identifier Option      |                     |
       |  Mobility Message Replay Protection |                     |
       |  Option, Authentication Option)     |                     |
       |                                     | Acct-Request(start) |
       |                                     |--------------------&gt;|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Mobile IPv6 Bootstrapping using the Mobile IPv6 Authentication Protocol&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Goals for the HA-AAA Interface</h3>

<p>Here, we follow the classification and labels listed in the
            MIPv6-AAA-Goals document <a class='info' href='#I-D.ietf-mip6-aaa-ha-goals'>[28]<span> (</span><span class='info'>Giaretta, G., &ldquo;AAA Goals for Mobile IPv6,&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
General Goals</h3>

<p> G1.1-G1.4 Security
</p>
<p> These are standard requirements for a AAA protocol 
                mutual authentication, integrity, replay protection,
                confidentiality. IPsec can be used to achieve the goals. Goal
                G1.5 regarding inactive peer detection needs further
                investigations since heartbeat messages do not exist (like in
                the Diameter case, Watch-Dog-Request/Answer).
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Service Authorization</h3>

<p> G2.1. The AAA-HA interface should allow the use of Network
                Access Identifier (NAI) to identify the MN. The User-Name
                attribute can be used for the purpose to carry the NAI. 
</p>
<p> G2.2 The HA should be able to query the AAAH server to
                verify Mobile IPv6 service authorization for the MN. Any node
                implementing RADIUS functionality<a class='info' href='#RFC2865'>[11]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> can
                possibly initiate a request message. In combination with the
                ability of the RADIUS protocol to carry EAP messages <a class='info' href='#RFC3579'>[6]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> , our solution will enable an HA to query a
                RADIUS server and verify MIPv6 authorization for the MN. 
</p>
<p> G2.3 The AAAH server should be able to enforce explicit
                operational limitations and authorization restrictions on the HA
                (e.g., packet filters, QoS parameters). Work in progress in the
                area, including NAS-Filter-Rule, RADIUS quality of service
                support, prepaid extensions etc. is performed. The relevant
                attributes may be reused for providing required functionality
                over the AAAH-HA interface.
</p>
<p> G2.4 - G2.6. Issues addressing the maintenance of a Mobile
                IPv6 session by the AAAH server, e.g., authorization lifetime,
                extension of the authorization lifetime and explicit session
                termination by the AAAH server side.
</p>
<p>The attribute Session-Timeout may be sent in Access-Challenge
                or Access-Accept packet by the RADIUS server, thus limiting the
                authorization session duration. In order to
                reauthenticate/reauthorize the user, the Termination-Action
                attribute can be included, with value 1, meaning the NAS should
                send a new RADIUS-Request packet. Additional AVPs for dealing
                with pre-paid sessions (e.g,. volume, resource
                usedVolumeQuota AVP, ResourceQuota AVP) are specified in
                RADIUS prepaid extension. Exchanging of application specific
                authorization request/answer messages provides extension of the
                authorization session (e.g., Authorize Only Access-Request sent
                by the HA (NAS) to the RADIUS server). Initiation of the
                re-authorization by both sides could be supported. Both sides
                could initiate session termination  the RADIUS server by
                sending Disconnect message <a class='info' href='#RFC5176'>[29]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Accounting</h3>

<p>G3.1 The AAA-HA interface must support the transfer of
                accounting records needed for service control and charging.
                These include (but may not be limited to): time of binding cache
                entry creation and deletion, octets sent and received by the MN
                in bi-directional tunneling, etc. 
</p>
<p>The requirements for accounting over the AAAH-HA interface
                does not require enhancements to the existing accounting
                functionality. 
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
MN Authentication</h3>

<p>G4.1 The AAA-HA interface MUST support pass-through EAP
            authentication with the HA working as EAP authenticator operating in
            pass-through mode and the AAAH server working as back-end
            authentication server.
</p>
<p> These issues require the functionality of AAAH server working as
            a back-end authentication server and HA working as NAS and EAP
            authenticator in pass-through mode for providing a MN
            authentication. This document suggests this mode of operation in the
            context of the relevant scenarios. 
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Provisioning of Configuration Parameters</h3>

<p> G5.1 The HA should be able to communicate to the AAAH server the
            HOA allocated to the MN (e.g. for allowing the AAAH server to
            perform DNS update on behalf of the MN).
</p>
<p> This document describes needed AVPs for this purpose, see
            section "DNS Update Mobility Option Attribute"
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Table of Attributes</h3>

<p> The following tables provides a guide to which attributes may be
        found in RADIUS packet and in what number. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

The following defines the meaning of the notation used in the following
tables:

   0     An instance of this attribute MUST NOT be present.
   1     Exactly one instance of this attribute MUST be present
   0-1   Zero or one instance of this attribute MAY be present.
   0+    Zero or more instance of this attriubte MAY be present

The table below describes the RADIUS messages used for bootstrapping and are
exchanged between the NAS and the RADIUS Server.

Request  Accept  Reject  Challenge  Type    Attribute
1          1       0       0        MIP6-FV-TYPE        MIP6-Feature-Vector
0+[ac]     0+[a]   0       0        MIP6-HA-TYPE        MIP6-HA
0+[ac]     0+[a]   0       0        MIP6-HA-FQDN-TYPE   MIP6-HA-FQDN
0-1[b]     0-1     0       0        MIP6-HL-PREFIX-TYPE MIP6-HL-Prefix
0-1[b]     0-1     0       0        MIP6-HOA-TYPE       MIP6-HOA
0-1        0-1     0       0        MIP6-DNS-MO-TYPE    MIP6-DNS-MO

Notes:

[a] Either MIP6-HA or MIP6-HA-FQDN MAY appear in a RADIUS packet.

[b] If MIP6-HA or MIP6-HA-FQDN are present in the Access-Request
    then these attributes MUST also be present in the Access-Request.
    If the RADIUS server accepts the NAS suggestion for the HA, then
    the RADIUS server MUST also include the values received for these
    attributes in the Access-Accept.

[c] If these attributes are present in an Access-Request, then
    LOCAL_HOME_AGENT_ASSIGNMENT flag of the MIP6-Feature-Vector MUST be set.
    Otherwise these attributes are ignored.

The following tables lists the commands and attributes used in the interaction
between the HA and RADIUS server. Each table corresponds to the different
authentication modes supported.  These attributes are in addition to the any
other attributes specified by an other specification (for example, RADIUS EAP)



Table of attributes for IKEv2 and EAP-based Authentication:


Request  Accept  Reject  Challenge  Type    Attribute
1          0       0       0        61                  NAS-Port-Type
1          0       0       0        80                  Message-Authenticator
0-1        0-1     0       0        MIP6-FV-TYPE        MIP6-Feature-Vector
1          0-1     0       0        MIP6-HOA-TYPE       MIP6-HOA
0          0       0       0        MIP6-CAREOF-ADDRESS-TYPE MIP6-Careof-Address
0          0       0       0        MIP6-MN-AAA-SPI-TYPE MIP6-MN-AAA-SPI
0-1        0       0       0        MIP6-HA-TYPE        MIP6-HA
0-1        0       0       0        MIP6-AUTHENTICATOR-TYPE MIP6-Authenticator
0-1        0       0       0 MIP6-MAC-MOBILITY-DATA-TYPE MIP6-MAC-Mobility-Data
0          0       0       0        MIP6-TIMESTAMP-TYPE MIP6-Timestamp
0          0       0       0        MIP6-MN-HA-SPI-TYPE MIP6-MN-HA-SPI
0          0       0       0        MIP6-ALGORITH-TYPE  MIP6-Algorithm-Type
0          0       0       0        MIP6-REPLY-MODE     MIP6-Replay-Mode
0          0       0       0        MIP6-NONCE-TYPE     MIP6-Nonce


Table of attribute for MIPv6 Authentication Protocol:

Request  Accept  Reject  Challenge  Type    Attribute
1          0       0       0        61                  NAS-Port-Type
0-1        0       0       0        80                  Message-Authenticator
0-1        0-1     0       0        MIP6-FV-TYPE        MIP6-Feature-Vector
1          0       0       0        MIP6-AUTH-MODE-TYPE MIP6-Auth-Mode
1          0-1     0       0        MIP6-HOA-TYPE       MIP6-HOA
1          0       0       0        MIP6-CAREOF-ADDRESS-TYPE MIP6-Careof-Address
1          0       0       0        MIP6-MN-AAA-SPI-TYPE MIP6-MN-AAA-SPI
1          0       0       0        MIP6-HA-TYPE        MIP6-HA
1          0       0       0        MIP6-AUTHENTICATOR-TYPE MIP6-Authenticator
1          0       0       0 MIP6-MAC-MOBILITY-DATA-TYPE MIP6-MAC-Mobility-Data
0-1        0       0       0        MIP6-TIMESTAMP-TYPE MIP6-Timestamp
0          1       0       0        MIP6-MN-HA-SPI-TYPE MIP6-MN-HA-SPI
0          1       0       0        MIP6-ALGORITH-TYPE  MIP6-Algorithm-Type
0          1       0       0        MIP6-REPLY-MODE     MIP6-Replay-Mode
0          1       0       0        MIP6-NONCE-TYPE     MIP6-Nonce


As used in accounting packets:

   Request  Interim  Stop    Type    Attribute

   0-1        0-1     0-1    MIP6-HA-TYPE        MIP6-HA Attribute
   0-1        0-1     0-1    MIP6-HA-FQDN-TYPE   MIP6-HA-FQDN Attribute
   0          0       0      MIP6-HL-PREFIX-TYPE MIP6-HL-Prefix Attribute
   0-1        0-1     0-1    MIP6-HOA-TYPE       MIP6-HOA Attribute
   0          0       0      MIP6-DNS-MO-TYPE    MIP6-DNS-MO Attribute


</pre></div>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Diameter Considerations</h3>

<p>When used in Diameter, the attributes defined in this specification
        can be used as Diameter AVPs from the Code space 1-255 (RADIUS attribute
        compatibility space). No additional Diameter Code values are therefore
        allocated. The data types and flag rules for the attributes are as
        follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                  +---------------------+
                                  |    AVP Flag rules   |
                                  |----+-----+----+-----|----+
                                  |    |     |SHLD| MUST|    |
   Attribute Name      Value Type |MUST| MAY | NOT|  NOT|Encr|
   -------------------------------|----+-----+----+-----|----|
   MIP6-HA             Address    | M  |  P  |    |  V  | Y  |
   MIP6-HA-FQDN        UTF8String | M  |  P  |    |  V  | Y  |
   MIP6-HL-Prefix      OctetString| M  |  P  |    |  V  | Y  |
   MIP6-HOA            Address    | M  |  P  |    |  V  | Y  |
   MIP6-DNS-MO         OctetString| M  |  P  |    |  V  | Y  |
   -------------------------------|----+-----+----+-----|----|
</pre></div>
<p>Other than MIP6-HA and HOA-IPv6, the attributes in this specification
        have no special translation requirements for Diameter to RADIUS or
        RADIUS to Diameter gateways; they are copied as is, except for changes
        relating to headers, alignment, and padding. See also <a class='info' href='#RFC3588'>[12]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> Section 4.1 and <a class='info' href='#RFC4005'>[30]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> Section 9.
        MIP6-HA and HOA-IPv6 must be translated between their RADIUS
        representation of String to a Diameter Address format which requires
        that the AddressType field be set to 2 for IP6 (IP version 6) 
</p>
<p>What this specification says about the applicability of the
        attributes for RADIUS Access-Request packets applies in Diameter to
        AA-Request <a class='info' href='#RFC4005'>[30]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> or Diameter-EAP-Request <a class='info' href='#RFC4072'>[31]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. What is said about Access-Challenge applies in
        Diameter to AA-Answer <a class='info' href='#RFC4005'>[30]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> or Diameter-EAP-Answer
        <a class='info' href='#RFC4072'>[31]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> with Result-Code AVP set to
        DIAMETER_MULTI_ROUND_AUTH.
</p>
<p>What is said about Access-Accept applies in Diameter to AA-Answer or
        Diameter-EAP-Answer messages that indicate success. Similarly, what is
        said about RADIUS Access-Reject packets applies in Diameter to AA-
        Answer or Diameter-EAP-Answer messages that indicate failure.
</p>
<p>What is said about Accounting-Request applies to Diameter Accounting-
        Request <a class='info' href='#RFC4005'>[30]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> as well.
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p> Assignment of these values to a user should be based on successful
        authentication of the user at the NAS and/or at the HA. The RADIUS
        server should only assign these values to a user who is authorized for
        Mobile IPv6 service (this check could be performed with the user's
        subscription profile in the Home Network). 
</p>
<p> The NAS and the HA to the RADIUS server transactions must be
        adequately secured. Otherwise there is a possibility that the user may
        receive fraudulent values from a rogue RADIUS server potentially
        hijacking the user's Mobile IPv6 session. 
</p>
<p> These new attributes do not introduce additional security
        considerations besides the ones identified in <a class='info' href='#RFC2865'>[11]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>.
        
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Registration of new AVPs</h3>

<p> This specification defines the following new RADIUS attributes: 
            
                </p>
<blockquote class="text"><dl>
<dt></dt>
<dd> MIP6-Feature-Vector is set to MIP6-FV-TYPE 
</dd>
<dt></dt>
<dd> MIP6-HA is set to MIP6-HA-TYPE 
</dd>
<dt></dt>
<dd> MIP6-HA-FQDN is set to MIP6-HA-FQDN-TYPE
</dd>
<dt></dt>
<dd> MIP6-HL-Prefix is set to MIP6-HL-PREFIX-TYPE 
</dd>
<dt></dt>
<dd> MIP6-HOA is set to MIP6-HOsA-TYPE 
</dd>
<dt></dt>
<dd> MIP6-DNS-MO is set to MIP6-DNS-MO-TYPE 
</dd>
</dl></blockquote>

<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
New Registry: Mobility Capability</h3>

<p>For MIP6-FV-TYPE flag values must be generated:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  Token                             | Value                | Description
  ----------------------------------+----------------------+------------
  MIP6_INTEGRATED                   | 0x0000000000000001   | [RFC TBD]
  LOCAL_HOME_AGENT_ASSIGNMENT       | 0x0000000000000002   | [RFC TBD]
  Available for Assignment via IANA | 2^x                  |

</pre></div>
<p>Allocation rule: Only numeric values that are 2^x (power of
                two) are allowed based on the allocation policy described
                below.
</p>
<p>Following the policies outlined in [1] new values with a
                description of their semantic for usage with the
                MIP6-Feature-Vector AVP together with a Token will be assigned
                after Expert Review initiated by the O&amp;M Area Directors in
                consultation with the DIME working group chairs or the working
                group chairs of a designated successor working group. Updates
                can be provided based on expert approval only. A designated
                expert will be appointed by the O&amp;M Area Directors. No
                mechanism to mark entries as "deprecated" is envisioned. Based
                on expert approval it is possible to delete entries from the
                registry.
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3"></a><h3>11.3.&nbsp;
Addition of existing values</h3>

<p> A new value HA6(IANA-TBD1) MUST be assigned to
                NAS-Port-Type(61)
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<p> We would like to thank the following individuals for their
            review and constructive comments during the development of this
            document: 
</p>
<p> Florian Kohlmayer, Mark Watson, Jayshree Bharatia, Dimiter
            Milushev, Andreas Pashalidis, Rafa Marin Lopez and Pasi Eronen. 
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-bootstrapping-integrated-dhc">[2]</a></td>
<td class="author-text">Chowdhury, K. and A. Yegin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-integrated-dhc-06.txt">MIP6-bootstrapping for the Integrated Scenario</a>,&rdquo; draft-ietf-mip6-bootstrapping-integrated-dhc-06 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-integrated-dhc-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.patel-mip6-rfc4285bis">[3]</a></td>
<td class="author-text">Patel, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-patel-mip6-rfc4285bis-00.txt">Authentication Protocol for Mobile IPv6</a>,&rdquo; draft-patel-mip6-rfc4285bis-00 (work in progress), October&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-patel-mip6-rfc4285bis-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2866">[4]</a></td>
<td class="author-text">Rigney, C., &ldquo;<a href="http://tools.ietf.org/html/rfc2866">RADIUS Accounting</a>,&rdquo; RFC&nbsp;2866, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2548">[5]</a></td>
<td class="author-text"><a href="mailto:glennz@microsoft.com">Zorn, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>,&rdquo; RFC&nbsp;2548, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2548.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3579">[6]</a></td>
<td class="author-text">Aboba, B. and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3579, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-bootstrapping-split">[7]</a></td>
<td class="author-text">Giaretta, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-split-07.txt">Mobile IPv6 bootstrapping in split scenario</a>,&rdquo; draft-ietf-mip6-bootstrapping-split-07 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-bootstrapping-split-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[8]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.zorn-radius-logoff">[9]</a></td>
<td class="author-text">Zorn, G. and A. Lior, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zorn-radius-logoff-11.txt">User Session Tracking in RADIUS</a>,&rdquo; draft-zorn-radius-logoff-11 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-zorn-radius-logoff-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2868">[10]</a></td>
<td class="author-text">Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;<a href="http://tools.ietf.org/html/rfc2868">RADIUS Attributes for Tunnel Protocol Support</a>,&rdquo; RFC&nbsp;2868, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2868.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[11]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[12]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[13]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3775">[14]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4640">[15]</a></td>
<td class="author-text">Patel, A. and G. Giaretta, &ldquo;<a href="http://tools.ietf.org/html/rfc4640">Problem Statement for bootstrapping Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4640, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4640.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-mip6-split">[16]</a></td>
<td class="author-text">Korhonen, J., Tschofenig, H., Bournelle, J., Giaretta, G., and M. Nakhjiri, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-split-17.txt">Diameter Mobile IPv6: Support for Home Agent to Diameter Server Interaction</a>,&rdquo; draft-ietf-dime-mip6-split-17 (work in progress), April&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-split-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-mip6-integrated">[17]</a></td>
<td class="author-text">Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-integrated-12.txt">Diameter Mobile IPv6: Support for Network Access Server to Diameter Server  Interaction</a>,&rdquo; draft-ietf-dime-mip6-integrated-12 (work in progress), January&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-mip6-integrated-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3753">[18]</a></td>
<td class="author-text">Manner, J. and M. Kojo, &ldquo;<a href="http://tools.ietf.org/html/rfc3753">Mobility Related Terminology</a>,&rdquo; RFC&nbsp;3753, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3753.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-ikev2-ipsec">[19]</a></td>
<td class="author-text">Dupont, F. and V. Devarapalli, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-ikev2-ipsec-08.txt">Mobile IPv6 Operation with IKEv2 and the revised IPsec Architecture</a>,&rdquo; draft-ietf-mip6-ikev2-ipsec-08 (work in progress), December&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-ikev2-ipsec-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4283">[20]</a></td>
<td class="author-text">Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;<a href="http://tools.ietf.org/html/rfc4283">Mobile Node Identifier Option for Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4283, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4283.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[21]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3344">[22]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>,&rdquo; RFC&nbsp;3344, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3344.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3736">[23]</a></td>
<td class="author-text">Droms, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3736">Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6</a>,&rdquo; RFC&nbsp;3736, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3736.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[24]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[25]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-hiopt">[26]</a></td>
<td class="author-text">Jang, H., Yegin, A., Chowdhury, K., and J. Choi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-hiopt-17.txt">DHCP Options for Home Information Discovery in MIPv6</a>,&rdquo; draft-ietf-mip6-hiopt-17 (work in progress), May&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-hiopt-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4877">[27]</a></td>
<td class="author-text">Devarapalli, V. and F. Dupont, &ldquo;<a href="http://tools.ietf.org/html/rfc4877">Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture</a>,&rdquo; RFC&nbsp;4877, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4877.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip6-aaa-ha-goals">[28]</a></td>
<td class="author-text">Giaretta, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-aaa-ha-goals-03.txt">AAA Goals for Mobile IPv6</a>,&rdquo; draft-ietf-mip6-aaa-ha-goals-03 (work in progress), September&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip6-aaa-ha-goals-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5176">[29]</a></td>
<td class="author-text">Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc5176">Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;5176, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5176.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4005">[30]</a></td>
<td class="author-text">Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc4005">Diameter Network Access Server Application</a>,&rdquo; RFC&nbsp;4005, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4005.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[31]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2136">[32]</a></td>
<td class="author-text"><a href="mailto:paul@vix.com">Vixie, P.</a>, <a href="mailto:set@thumper.bellcore.com">Thomson, S.</a>, <a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, and <a href="mailto:bound@zk3.dec.com">J. Bound</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>,&rdquo; RFC&nbsp;2136, April&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2136.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2136.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2136.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3776">[33]</a></td>
<td class="author-text">Arkko, J., Devarapalli, V., and F. Dupont, &ldquo;<a href="http://tools.ietf.org/html/rfc3776">Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents</a>,&rdquo; RFC&nbsp;3776, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3776.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[34]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avi Lior</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bridgewater Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">303 Terry Fox Drive, Suite 100</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ottawa, Ontario  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada K2K 3J1</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 613-591-6655</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:avi@bridgewatersystems.com">avi@bridgewatersystems.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kuntal Chowdhury</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Starent Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">30 International Place</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tewksbury, MA  01876</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 214-550-1416</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kchowdhury@starentnetworks.com">kchowdhury@starentnetworks.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
