<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP Fast Reroute Framework</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP Fast Reroute Framework">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">M. Shand</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">S. Bryant</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Expires: March 22, 2010</td><td class="header">September 18, 2009</td></tr>
</table></td></tr></table>
<h1><br />IP Fast Reroute Framework<br />draft-ietf-rtgwg-ipfrr-framework-12</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 22, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document provides a framework for the development of IP
      fast-reroute mechanisms which provide protection against link or router
      failure by invoking locally determined repair paths. Unlike MPLS
      fast-reroute, the mechanisms are applicable to a network employing
      conventional IP routing and forwarding.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Problem Analysis<br />
<a href="#anchor4">4.</a>&nbsp;
Mechanisms for IP Fast-reroute <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fast-failure-detect">4.1.</a>&nbsp;
Mechanisms for fast failure detection <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.2.</a>&nbsp;
Mechanisms for repair paths<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.1.</a>&nbsp;
Scope of repair paths <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#coverage">4.2.2.</a>&nbsp;
Analysis of repair coverage <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.3.</a>&nbsp;
Link or node repair <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.4.</a>&nbsp;
Maintenance of Repair paths  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SRLG">4.2.5.</a>&nbsp;
Multiple failures and Shared Risk Link Groups  <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.</a>&nbsp;
Local Area Networks  <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.4.</a>&nbsp;
Mechanisms for micro-loop prevention  <br />
<a href="#anchor11">5.</a>&nbsp;
Management Considerations <br />
<a href="#anchor12">6.</a>&nbsp;
Scope and applicability <br />
<a href="#anchor13">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor14">8.</a>&nbsp;
Security Considerations<br />
<a href="#anchor15">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Terminology</h3>

<p>This section defines words and acronyms used in this draft and other
      drafts discussing IP fast-reroute.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>D</dt>
<dd>Used to denote the destination router under
          discussion.
</dd>
<dt>Distance_opt(A,B)</dt>
<dd>The distance of the shortest path
          from A to B.
</dd>
<dt>Downstream Path</dt>
<dd>This is a subset of the loop-free
          alternates where the neighbor N meets the following condition:-
          <br />
Distance_opt(N, D) &lt;
          Distance_opt(S,D)
</dd>
<dt>E</dt>
<dd>Used to denote the router which is the primary
          next-hop neighbor to get from S to the destination D. Where there is
          an ECMP set for the shortest path from S to D, these are referred to
          as E_1, E_2, etc.
</dd>
<dt>ECMP</dt>
<dd>Equal cost multi-path: Where, for a particular
          destination D, multiple primary next-hops are used to forward
          traffic because there exist multiple shortest paths from S via
          different output layer-3 interfaces.
</dd>
<dt>FIB</dt>
<dd>Forwarding Information Base. The database used by
          the packet forwarder to determine what actions to perform on a
          packet.
</dd>
<dt>IPFRR</dt>
<dd>IP fast-reroute.
</dd>
<dt>Link(A-&gt;B)</dt>
<dd>A link connecting router A to router
          B.
</dd>
<dt>LFA</dt>
<dd>Loop Free Alternate. A neighbor N, that is not a
          primary next-hop neighbor E, whose shortest path to the destination
          D does not go back through the router S. The neighbor N must meet
          the following condition:- <br />
Distance_opt(N,
          D) &lt; Distance_opt(N, S) + Distance_opt(S, D)
</dd>
<dt>Loop Free Neighbor</dt>
<dd>A neighbor N_i, which is not the
          particular primary neighbor E_k under discussion, and whose shortest
          path to D does not traverse S. For example, if there are two primary
          neighbors E_1 and E_2, E_1 is a loop-free neighbor with regard to
          E_2 and vice versa.
</dd>
<dt>Loop Free Link Protecting Alternate</dt>
<dd>A path via a Loop-Free Neighbor N_i that reaches
          destination D without going through the particular link of S that is
          being protected. In some cases the path to D may go through the
          primary neighbor E.
</dd>
<dt>Loop Free Node-protecting Alternate</dt>
<dd>A path via a Loop-Free Neighbor N_i that reaches
          destination D without going through the particular primary neighbor
          (E) of S which is being protected.
</dd>
<dt>N_i</dt>
<dd>The ith neighbor of S.
</dd>
<dt>Primary Neighbor</dt>
<dd>A neighbor N_i of S which is one of
          the next hops for destination D in S's FIB prior to any failure.
</dd>
<dt>R_i_j</dt>
<dd>The jth neighbor of N_i.
</dd>
<dt>Routing Transition</dt>
<dd>The process whereby routers
          converge on a new topology. In conventional networks this process
          frequently causes some disruption to packet delivery.
</dd>
<dt>RPF</dt>
<dd>Reverse Path Forwarding. I.e. checking that a
          packet is received over the interface which would be used to send
          packets addressed to the source address of the packet.
</dd>
<dt>S</dt>
<dd>Used to denote a router that is the source of a
          repair that is computed in anticipation of the failure of a
          neighboring router denoted as E, or of the link between S and E. It
          is the viewpoint from which IP fast-reroute is described.
</dd>
<dt>SPF</dt>
<dd>Shortest Path First, e.g. Dijkstra's
          algorithm.
</dd>
<dt>SPT</dt>
<dd>Shortest path tree
</dd>
<dt>Upstream Forwarding Loop</dt>
<dd>A
          forwarding loop that involves a set of routers, none of which are
          directly connected to the link that has caused the topology change
          that triggered a new SPF in any of the routers.
</dd>
</dl></blockquote>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>When a link or node failure occurs in a routed network, there is
      inevitably a period of disruption to the delivery of traffic until the
      network re-converges on the new topology. Packets for destinations which
      were previously reached by traversing the failed component may be
      dropped or may suffer looping. Traditionally such disruptions have
      lasted for periods of at least several seconds, and most applications
      have been constructed to tolerate such a quality of service.
</p>
<p>Recent advances in routers have reduced this interval to under a
      second for carefully configured networks using link state IGPs. However,
      new Internet services are emerging which may be sensitive to periods of
      traffic loss which are orders of magnitude shorter than this.
</p>
<p>Addressing these issues is difficult because the distributed nature
      of the network imposes an intrinsic limit on the minimum convergence
      time which can be achieved.
</p>
<p>However, there is an alternative approach, which is to compute backup
      routes that allow the failure to be repaired locally by the router(s)
      detecting the failure without the immediate need to inform other routers
      of the failure. In this case, the disruption time can be limited to the
      small time taken to detect the adjacent failure and invoke the backup
      routes. This is analogous to the technique employed by MPLS fast-reroute
      <a class='info' href='#RFC4090'>[RFC4090]<span> (</span><span class='info'>Pan, P., Swallow, G., and A. Atlas, &ldquo;Fast Reroute Extensions to RSVP-TE for LSP Tunnels,&rdquo; May&nbsp;2005.</span><span>)</span></a>, but the mechanisms employed for the
      backup routes in pure IP networks are necessarily very different.
</p>
<p>This document provides a framework for the development of this
      approach.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Problem Analysis</h3>

<p>The duration of the packet delivery disruption caused by a
      conventional routing transition is determined by a number of factors:
      </p>
<ol class="text">
<li>The time taken to detect the failure. This may be of the order of
          a few milliseconds when it can be detected at the physical layer, up
          to several tens of seconds when a routing protocol Hello is
          employed. During this period packets will be unavoidably lost.
</li>
<li>The time taken for the local router to react to the failure. This
          will typically involve generating and flooding new routing updates,
          perhaps after some hold-down delay, and re-computing the router's
          FIB.
</li>
<li>The time taken to pass the information about the failure to other
          routers in the network. In the absence of routing protocol packet
          loss, this is typically between 10 milliseconds and 100 milliseconds
          per hop.
</li>
<li>The time taken to re-compute the forwarding tables. This is
          typically a few milliseconds for a link state protocol using
          Dijkstra's algorithm.
</li>
<li>The time taken to load the revised forwarding tables into the
          forwarding hardware. This time is very implementation dependant and
          also depends on the number of prefixes affected by the failure, but
          may be several hundred milliseconds.
</li>
</ol><p>The disruption will last until the routers adjacent to the
      failure have completed steps 1 and 2, and then all the routers in the
      network whose paths are affected by the failure have completed the
      remaining steps.
</p>
<p>The initial packet loss is caused by the router(s) adjacent to the
      failure continuing to attempt to transmit packets across the failure
      until it is detected. This loss is unavoidable, but the detection time
      can be reduced to a few tens of milliseconds as described in <a class='info' href='#fast-failure-detect'>Section&nbsp;4.1<span> (</span><span class='info'>Mechanisms for fast failure detection </span><span>)</span></a>.
</p>
<p>In some topologies subsequent packet loss may be caused by the
      "micro-loops" which may form as a result of temporary inconsistencies
      between routers' forwarding tables<a class='info' href='#I-D.ietf-rtgwg-lf-conv-frmwk'>[I&#8209;D.ietf&#8209;rtgwg&#8209;lf&#8209;conv&#8209;frmwk]<span> (</span><span class='info'>Shand, M. and S. Bryant, &ldquo;A Framework for Loop-free Convergence,&rdquo; October&nbsp;2009.</span><span>)</span></a>. These inconsistencies are
      caused by steps 3, 4 and 5 above and in many routers it is step 5 which
      is both the largest factor and which has the greatest variance between
      routers. The large variance arises from implementation differences and
      from the differing impact that a failure has on each individual router.
      For example, the number of prefixes affected by the failure may vary
      dramatically from one router to another.
</p>
<p>In order to achieve packet disruption times which are commensurate
      with the failure detection times two mechanisms may be required:-
</p>
<p></p>
<ol class="text">
<li>A mechanism for the router(s) adjacent to the failure to rapidly
          invoke a repair path, which is unaffected by any subsequent
          re-convergence.
</li>
<li>In topologies that are susceptible to micro-loops, a mechanism to
          prevent the effects of any micro-loops during subsequent
          re-convergence.
</li>
</ol>

<p>Performing the first task without the second may result in the repair
      path being starved of traffic and hence being redundant. Performing the
      second without the first will result in traffic being discarded by the
      router(s) adjacent to the failure.
</p>
<p>Repair paths may always be used in isolation where the failure is
      short-lived. In this case, the repair paths can be kept in place until
      the failure is repaired in which case there is no need to advertise the
      failure to other routers.
</p>
<p>Similarly, micro-loop avoidance may be used in isolation to prevent
      loops arising from pre-planned management action. In which case the link
      or node being shut down can remain in service for a short time after its
      removal has been announced into the network, and hence it can function
      as its own "repair path".
</p>
<p>Note that micro-loops may also occur when a link or node is restored
      to service and thus a micro-loop avoidance mechanism may be required for
      both link up and link down cases.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mechanisms for IP Fast-reroute </h3>

<p>The set of mechanisms required for an effective solution to the
      problem can be broken down into the sub-problems described in this
      section.
</p>
<a name="fast-failure-detect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Mechanisms for fast failure detection </h3>

<p>It is critical that the failure detection time is minimized. A
        number of well documented approaches are possible, such as: </p>
<ol class="text">
<li>Physical detection; for example, loss of light.
</li>
<li>Routing protocol independent protocol detection; for example,
            The Bidirectional Failure Detection protocol <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; January&nbsp;2010.</span><span>)</span></a>.
</li>
<li>Routing protocol detection; for example, use of "fast
            Hellos".
</li>
</ol>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Mechanisms for repair paths</h3>

<p>Once a failure has been detected by one of the above mechanisms,
        traffic which previously traversed the failure is transmitted over one
        or more repair paths. The design of the repair paths should be such
        that they can be pre-calculated in anticipation of each local failure
        and made available for invocation with minimal delay. There are three
        basic categories of repair paths:
</p>
<p></p>
<ol class="text">
<li>Equal cost multi-paths (ECMP). Where such paths exist, and one
            or more of the alternate paths do not traverse the failure, they
            may trivially be used as repair paths.
</li>
<li>Loop free alternate paths. Such a path exists when a direct
            neighbor of the router adjacent to the failure has a path to the
            destination which can be guaranteed not to traverse the
            failure.
</li>
<li>Multi-hop repair paths. When there is no feasible loop free
            alternate path it may still be possible to locate a router, which
            is more than one hop away from the router adjacent to the failure,
            from which traffic will be forwarded to the destination without
            traversing the failure.
</li>
</ol>

<p>ECMP and loop free alternate paths (as described in <a class='info' href='#RFC5286'>[RFC5286]<span> (</span><span class='info'>Atlas, A. and A. Zinin, &ldquo;Basic Specification for IP Fast Reroute: Loop-Free Alternates,&rdquo; September&nbsp;2008.</span><span>)</span></a>) offer the simplest repair paths and would
        normally be used when they are available. It is anticipated that
        around 80% of failures (see <a class='info' href='#coverage'>Section&nbsp;4.2.2<span> (</span><span class='info'>Analysis of repair coverage </span><span>)</span></a>) can be
        repaired using these basic methods alone.
</p>
<p>Multi-hop repair paths are more complex, both in the computations
        required to determine their existence, and in the mechanisms required
        to invoke them. They can be further classified as:</p>
<ol class="text">
<li>Mechanisms where one or more alternate FIBs are pre-computed in
            all routers and the repaired packet is instructed to be forwarded
            using a "repair FIB" by some method of per packet signaling such
            as detecting a "U-turn" <a class='info' href='#I-D.atlas-ip-local-protect-uturn'>[I&#8209;D.atlas&#8209;ip&#8209;local&#8209;protect&#8209;uturn]<span> (</span><span class='info'>Atlas, A., &ldquo;U-turn Alternates for IP/LDP Fast-Reroute,&rdquo; March&nbsp;2006.</span><span>)</span></a> , <a class='info' href='#FIFR'>[FIFR]<span> (</span><span class='info'>Nelakuditi, S., Lee, S., Lu, Y., Zhang, Z., and C. Chuah, &ldquo;Fast local rerouting for handling transient link           failures.&quot;,&rdquo; 2004.</span><span>)</span></a> or by marking the packet <a class='info' href='#SIMULA'>[SIMULA]<span> (</span><span class='info'>Lysne, O., Kvalbein, A., Cicic, T., Gjessing, S., and A. Hansen, &ldquo;Fast IP Network Recovery using Multiple Routing           Configurations.&quot;,&rdquo; 2006.</span><span>)</span></a>.
</li>
<li>Mechanisms functionally equivalent to a loose source route
            which is invoked using the normal FIB. These include tunnels <a class='info' href='#I-D.bryant-ipfrr-tunnels'>[I&#8209;D.bryant&#8209;ipfrr&#8209;tunnels]<span> (</span><span class='info'>Bryant, S., Filsfils, C., Previdi, S., and M. Shand, &ldquo;IP Fast Reroute using tunnels,&rdquo; November&nbsp;2007.</span><span>)</span></a>, alternative shortest
            paths <a class='info' href='#I-D.tian-frr-alt-shortest-path'>[I&#8209;D.tian&#8209;frr&#8209;alt&#8209;shortest&#8209;path]<span> (</span><span class='info'>Tian, A., &ldquo;Fast Reroute using Alternative Shortest Paths,&rdquo; July&nbsp;2004.</span><span>)</span></a> and
            label based mechanisms.
</li>
<li>Mechanisms employing special addresses or labels which are
            installed in the FIBs of all routers with routes pre-computed to
            avoid certain components of the network. For example <a class='info' href='#I-D.ietf-rtgwg-ipfrr-notvia-addresses'>[I&#8209;D.ietf&#8209;rtgwg&#8209;ipfrr&#8209;notvia&#8209;addresses]<span> (</span><span class='info'>Shand, M., Bryant, S., and S. Previdi, &ldquo;IP Fast Reroute Using Not-via Addresses,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</li>
</ol><p>In many cases a repair path which reaches two hops away from
        the router detecting the failure will suffice, and it is anticipated
        that around 98% of failures (see <a class='info' href='#coverage'>Section&nbsp;4.2.2<span> (</span><span class='info'>Analysis of repair coverage </span><span>)</span></a>) can
        be repaired by this method. However, to provide complete repair
        coverage some use of longer multi-hop repair paths is generally
        necessary.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Scope of repair paths </h3>

<p>A particular repair path may be valid for all destinations which
          require repair or may only be valid for a subset of destinations. If
          a repair path is valid for a node immediately downstream of the
          failure, then it will be valid for all destinations previously
          reachable by traversing the failure. However, in cases where such a
          repair path is difficult to achieve because it requires a high order
          multi-hop repair path, it may still be possible to identify lower
          order repair paths (possibly even loop free alternate paths) which
          allow the majority of destinations to be repaired. When IPFRR is
          unable to provide complete repair, it is desirable that the extent
          of the repair coverage can be determined and reported via network
          management.
</p>
<p>There is a trade-off to be achieved between minimizing the number
          of repair paths to be computed, and minimizing the overheads
          incurred in using higher order multi-hop repair paths for
          destinations for which they are not strictly necessary. However, the
          computational cost of determining repair paths on an individual
          destination basis can be very high.
</p>
<p>It will frequently be the case that the majority of destinations
          may be repaired using only the "basic" repair mechanism, leaving a
          smaller subset of the destinations to be repaired using one of the
          more complex multi-hop methods. Such a hybrid approach may go some
          way to resolving the conflict between completeness and
          complexity.
</p>
<p>The use of repair paths may result in excessive traffic passing
          over a link, resulting in congestion discard. This reduces the
          effectiveness of IPFRR. Mechanisms to influence the distribution of
          repaired traffic to minimize this effect are therefore
          desirable.
</p>
<a name="coverage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Analysis of repair coverage </h3>

<p>The repair coverage obtained is dependent on the repair strategy
          and highly dependent on the detailed topology and metrics. Estimates
          of the repair coverage quoted in this document are for illustrative
          purposes only and may not be always be achievable.
</p>
<p>In some cases the repair strategy will permit the repair of all
          single link or node failures in the network for all possible
          destinations. This can be defined as 100% coverage. However, where
          the coverage is less than 100% it is important for the purposes of
          comparisons between different proposed repair strategies to define
          what is meant by such a percentage. There are four possibilities:
          </p>
<ol class="text">
<li>The percentage of links (or nodes) which can be fully
              protected for all destinations. This is appropriate where the
              requirement is to protect all traffic, but some percentage of
              the possible failures may be identified as being
              un-protectable.
</li>
<li>The percentage of destinations which can be fully protected
              for all link (or node) failures. This is appropriate where the
              requirement is to protect against all possible failures, but
              some percentage of destinations may be identified as being
              un-protectable.
</li>
<li>For all destinations (d) and for all failures (f), the
              percentage of the total potential failure cases (d*f) which are
              protected. This is appropriate where the requirement is an
              overall "best effort" protection.
</li>
<li>The percentage of packets normally passing though the network
              that will continue to reach their destination. This requires a
              traffic matrix for the network as part of the analysis.
</li>
</ol>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Link or node repair </h3>

<p>A repair path may be computed to protect against failure of an
          adjacent link, or failure of an adjacent node. In general, link
          protection is simpler to achieve. A repair which protects against
          node failure will also protect against link failure for all
          destinations except those for which the adjacent node is a single
          point of failure.
</p>
<p>In some cases it may be necessary to distinguish between a link
          or node failure in order that the optimal repair strategy is
          invoked. Methods for link/node failure determination may be based on
          techniques such as BFD<a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; January&nbsp;2010.</span><span>)</span></a>. This
          determination may be made prior to invoking any repairs, but this
          will increase the period of packet loss following a failure unless
          the determination can be performed as part of the failure detection
          mechanism itself. Alternatively, a subsequent determination can be
          used to optimise an already invoked default strategy.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Maintenance of Repair paths  </h3>

<p>
</p>
<p>In order to meet the response time goals, it is expected (though
          not required) that repair paths, and their associated FIB entries,
          will be pre-computed and installed ready for invocation when a
          failure is detected. Following invocation the repair paths remain in
          effect until they are no longer required. This will normally be when
          the routing protocol has re-converged on the new topology taking
          into account the failure, and traffic will no longer be using the
          repair paths.
</p>
<p>The repair paths have the property that they are unaffected by
          any topology changes resulting from the failure which caused their
          instantiation. Therefore there is no need to re-compute them during
          the convergence period. They may be affected by an unrelated
          simultaneous topology change, but such events are out of scope of
          this work (see <a class='info' href='#SRLG'>Section&nbsp;4.2.5<span> (</span><span class='info'>Multiple failures and Shared Risk Link Groups  </span><span>)</span></a>).
</p>
<p>Once the routing protocol has re-converged it is necessary for
          all repair paths to take account of the new topology. Various
          optimizations may permit the efficient identification of repair
          paths which are unaffected by the change, and hence do not require
          full re-computation. Since the new repair paths will not be required
          until the next failure occurs, the re-computation may be performed
          as a background task and be subject to a hold-down, but excessive
          delay in completing this operation will increase the risk of a new
          failure occurring before the repair paths are in place.
</p>
<a name="SRLG"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
Multiple failures and Shared Risk Link Groups  </h3>

<p>
</p>
<p>Complete protection against multiple unrelated failures is out of
          scope of this work. However, it is important that the occurrence of
          a second failure while one failure is undergoing repair should not
          result in a level of service which is significantly worse than that
          which would have been achieved in the absence of any repair
          strategy.
</p>
<p>Shared Risk Link Groups (SRLGs) are an example of multiple
          related failures, and the more complex aspects of their protection
          is a matter for further study.
</p>
<p>One specific example of an SRLG which is clearly within the scope
          of this work is a node failure. This causes the simultaneous failure
          of multiple links, but their closely defined topological
          relationship makes the problem more tractable.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Local Area Networks  </h3>

<p>Protection against partial or complete failure of LANs is more
        complex than the point to point case. In general there is a trade-off
        between the simplicity of the repair and the ability to provide
        complete and optimal repair coverage.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Mechanisms for micro-loop prevention  </h3>

<p>Ensuring the absence of micro-loops is important not only because
        they can cause packet loss in traffic which is affected by the
        failure, but because by saturating a link with looping packets they
        can also cause congestion loss of traffic flowing over that link which
        would otherwise be unaffected by the failure.
</p>
<p>A number of solutions to the problem of micro-loop formation have
        been proposed and are summarized in <a class='info' href='#I-D.ietf-rtgwg-lf-conv-frmwk'>[I&#8209;D.ietf&#8209;rtgwg&#8209;lf&#8209;conv&#8209;frmwk]<span> (</span><span class='info'>Shand, M. and S. Bryant, &ldquo;A Framework for Loop-free Convergence,&rdquo; October&nbsp;2009.</span><span>)</span></a>. The following factors
        are significant in their classification:</p>
<ol class="text">
<li>Partial or complete protection against micro-loops.
</li>
<li>Delay imposed upon convergence.
</li>
<li>Tolerance of multiple failures (from node failures, and in
            general).
</li>
<li>Computational complexity (pre-computed or real time).
</li>
<li>Applicability to scheduled events.
</li>
<li>Applicability to link/node reinstatement.
</li>
<li>Topological constraints.
</li>
</ol>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Management Considerations </h3>

<p>While many of the management requirements will be specific to
      particular IPFRR solutions, the following general aspects need to be
      addressed: </p>
<ol class="text">
<li>Configuration 
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Enabling/disabling IPFRR support.
</dd>
<dt>B.</dt>
<dd>Enabling/disabling protection on a per link/node basis.
</dd>
<dt>C.</dt>
<dd>Expressing preferences regarding the links/nodes used for
              repair paths.
</dd>
<dt>D.</dt>
<dd>Configuration of failure detection mechanisms.
</dd>
<dt>E.</dt>
<dd>Configuration of loop avoidance strategies
</dd>
</dl></blockquote>
</li>
<li>Monitoring and operational support
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Notification of links/nodes/destinations which cannot be
              protected.
</dd>
<dt>B.</dt>
<dd>Notification of pre-computed repair paths, and anticipated
              traffic patterns.
</dd>
<dt>C.</dt>
<dd>Counts of failure detections, protection invocations and
              packets forwarded over repair paths.
</dd>
<dt>D.</dt>
<dd>Testing repairs.
</dd>
</dl></blockquote>
</li>
</ol>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Scope and applicability </h3>

<p>The initial scope of this work is in the context of link state IGPs.
      Link state protocols provide ubiquitous topology information, which
      facilitates the computation of repairs paths.
</p>
<p>Provision of similar facilities in non-link state IGPs and BGP is a
      matter for further study, but the correct operation of the repair
      mechanisms for traffic with a destination outside the IGP domain is an
      important consideration for solutions based on this framework
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>There are no IANA considerations that arise from this framework
      document.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>This framework document does not itself introduce any security
      issues, but attention must be paid to the security implications of any
      proposed solutions to the problem.
</p>
<p>Where the chosen solution uses tunnels it is necessary to ensure that
      the tunnel is not used as an attack vector. One method of addressing
      this is to use a set of tunnel endpoint addresses that are excluded from
      use by user traffic. 
</p>
<p>There is a compatibility issue between IPFRR and reverse path
      forwarding (RPF) checking. Many of the solutions described in this
      document result in traffic arriving from a direction inconsistent with a
      standard RPF check. When a network relies on RPF checking for security
      purposes, an alternative security mechanism will need to be deployed in
      order to permit IPFRR to used.
</p>
<p>Because the repair path will often be of a different length to the
      pre-failure path, security mechanisms which rely on specific TTL values
      will be adversely affected.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>The authors would like to acknowledge contributions made by Alia
      Atlas, Clarence Filsfils, Pierre Francois, Joel Halpern, Stefano Previdi
      and Alex Zinin.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIFR">[FIFR]</a></td>
<td class="author-text">Nelakuditi, S., Lee, S., Lu, Y., Zhang, Z., and C. Chuah, &ldquo;Fast local rerouting for handling transient link
          failures.",&rdquo; Tech. Rep.&nbsp;TR-2004-004, 2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.atlas-ip-local-protect-uturn">[I-D.atlas-ip-local-protect-uturn]</a></td>
<td class="author-text">Atlas, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-atlas-ip-local-protect-uturn-03.txt">U-turn Alternates for IP/LDP Fast-Reroute</a>,&rdquo; draft-atlas-ip-local-protect-uturn-03 (work in progress), March&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-atlas-ip-local-protect-uturn-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bryant-ipfrr-tunnels">[I-D.bryant-ipfrr-tunnels]</a></td>
<td class="author-text">Bryant, S., Filsfils, C., Previdi, S., and M. Shand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bryant-ipfrr-tunnels-03.txt">IP Fast Reroute using tunnels</a>,&rdquo; draft-bryant-ipfrr-tunnels-03 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-bryant-ipfrr-tunnels-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-base">[I-D.ietf-bfd-base]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-11.txt">Bidirectional Forwarding Detection</a>,&rdquo; draft-ietf-bfd-base-11 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-rtgwg-ipfrr-notvia-addresses">[I-D.ietf-rtgwg-ipfrr-notvia-addresses]</a></td>
<td class="author-text">Shand, M., Bryant, S., and S. Previdi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-rtgwg-ipfrr-notvia-addresses-05.txt">IP Fast Reroute Using Not-via Addresses</a>,&rdquo; draft-ietf-rtgwg-ipfrr-notvia-addresses-05 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-rtgwg-ipfrr-notvia-addresses-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-rtgwg-lf-conv-frmwk">[I-D.ietf-rtgwg-lf-conv-frmwk]</a></td>
<td class="author-text">Shand, M. and S. Bryant, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-rtgwg-lf-conv-frmwk-07.txt">A Framework for Loop-free Convergence</a>,&rdquo; draft-ietf-rtgwg-lf-conv-frmwk-07 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-rtgwg-lf-conv-frmwk-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.tian-frr-alt-shortest-path">[I-D.tian-frr-alt-shortest-path]</a></td>
<td class="author-text">Tian, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-tian-frr-alt-shortest-path-01.txt">Fast Reroute using Alternative Shortest Paths</a>,&rdquo; draft-tian-frr-alt-shortest-path-01 (work in progress), July&nbsp;2004 (<a href="http://www.ietf.org/internet-drafts/draft-tian-frr-alt-shortest-path-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4090">[RFC4090]</a></td>
<td class="author-text">Pan, P., Swallow, G., and A. Atlas, &ldquo;<a href="http://tools.ietf.org/html/rfc4090">Fast Reroute Extensions to RSVP-TE for LSP Tunnels</a>,&rdquo; RFC&nbsp;4090, May&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4090.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5286">[RFC5286]</a></td>
<td class="author-text">Atlas, A. and A. Zinin, &ldquo;<a href="http://tools.ietf.org/html/rfc5286">Basic Specification for IP Fast Reroute: Loop-Free Alternates</a>,&rdquo; RFC&nbsp;5286, September&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5286.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIMULA">[SIMULA]</a></td>
<td class="author-text">Lysne, O., Kvalbein, A., Cicic, T., Gjessing, S., and A. Hansen, &ldquo;<a href="http://folk.uio.no/amundk/infocom06.pdf">Fast IP Network Recovery using Multiple Routing
          Configurations."</a>,&rdquo; Infocom&nbsp;10.1109/INFOCOM.2006.227, 2006.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mike Shand</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">250, Longwater Avenue.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Reading, Berks  RG2 6GB</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mshand@cisco.com">mshand@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stewart Bryant</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">250, Longwater Avenue.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Reading, Berks  RG2 6GB</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stbryant@cisco.com">stbryant@cisco.com</a></td></tr>
</table>
</body></html>
