<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Dynamic Provisioning
    using Flexible Authentication via Secure Tunneling Extensible
    Authentication Protocol (EAP-FAST)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Dynamic Provisioning
    using Flexible Authentication via Secure Tunneling Extensible
    Authentication Protocol (EAP-FAST)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Cam-Winget</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">Expires: January 31, 2009</td><td class="header">H. Zhou</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 30, 2008</td></tr>
</table></td></tr></table>
<h1><br />Dynamic Provisioning
    using Flexible Authentication via Secure Tunneling Extensible
    Authentication Protocol (EAP-FAST)<br />draft-cam-winget-eap-fast-provisioning-09</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 31, 2009.</p>

<h3>Abstract</h3>

<p>The flexible authentication via secure tunneling EAP method
      (EAP-FAST) enables secure communication between a peer and a server by
      using Transport Layer Security (TLS) to establish a mutually
      authenticated tunnel. EAP-FAST also enables the provisioning credentials
      or other information through this protected tunnel. This document describes
      the use of EAP-FAST for dynamic provisioning. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Specification Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Terminology  <br />
<br />
<a href="#anchor4">2.</a>&nbsp;
EAP-FAST Provisioning Modes<br />
<br />
<a href="#anchor5">3.</a>&nbsp;
Dynamic Provisioning using EAP-FAST Conversation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
Phase 1 TLS tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.1.</a>&nbsp;
Server-Authenticated Phase 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.2.</a>&nbsp;
Server-Unauthenticated Phase 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.</a>&nbsp;
Phase 2 - Tunneled Authentication and Provisioning<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.1.</a>&nbsp;
Server-Authenticated Tunneled Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.2.2.</a>&nbsp;
Server-Unauthenticated Tunneled Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mschap">3.2.3.</a>&nbsp;
Authenticating Using EAP-MSCHAPv2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.4.</a>&nbsp;
Use of other Inner EAP Methods for EAP-FAST Provisioning<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keyderiv">3.3.</a>&nbsp;
Key Derivations Used in the EAP-FAST Provisioning Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.4.</a>&nbsp;
Peer-Id, Server-Id and Session-Id <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.5.</a>&nbsp;
Network Access after EAP-FAST Provisioning<br />
<br />
<a href="#anchor15">4.</a>&nbsp;
Information Provisioned in EAP-FAST<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.1.</a>&nbsp;
Protected Access Credential<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.1.</a>&nbsp;
Tunnel PAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.2.</a>&nbsp;
Machine Authentication PAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.1.3.</a>&nbsp;
User Authorization PAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.1.4.</a>&nbsp;
PAC Provisioning<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pac-tlv">4.2.</a>&nbsp;
PAC TLV Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pacat">4.2.1.</a>&nbsp;
Formats for PAC Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.2.</a>&nbsp;
PAC-Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.2.3.</a>&nbsp;
PAC-Opaque<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.4.</a>&nbsp;
PAC-Info<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.2.5.</a>&nbsp;
PAC-Acknowledgement TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.2.6.</a>&nbsp;
PAC-Type TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.3.</a>&nbsp;
Trusted Server Root Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.3.1.</a>&nbsp;
Server-Trusted-Root TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.3.2.</a>&nbsp;
PKCS#7 TLV<br />
<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.1.</a>&nbsp;
Provisioning Modes and Man-in-the-middle Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.1.1.</a>&nbsp;
Server-Authenticated Provisioning Mode and Man-in-the-middle Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.1.2.</a>&nbsp;
Server-Unauthenticated Provisioning Mode and Man-in-the-middle Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.2.</a>&nbsp;
Dictionary Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.3.</a>&nbsp;
Considerations in Selecting a Provisioning Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.4.</a>&nbsp;
Diffie-Hellman Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.5.</a>&nbsp;
Tunnel PAC Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">6.6.</a>&nbsp;
Machine Authentication PAC Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">6.7.</a>&nbsp;
User Authorization PAC Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">6.8.</a>&nbsp;
PAC Storage Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">6.9.</a>&nbsp;
Security Claims <br />
<br />
<a href="#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br />
<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#anchor42">Appendix&nbsp;A.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tpacex">A.1.</a>&nbsp;
Example 1: Successful Tunnel PAC Provisioning<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">A.2.</a>&nbsp;
Example 2: Failed Provisioning<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certex">A.3.</a>&nbsp;
Example 3: Provisioning a Authentication Server's Trusted Root Certificate<br />
<br />
<a href="#anchor44">Appendix&nbsp;B.</a>&nbsp;
Recent Changes<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction </h3>

<p>EAP-FAST <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> is an EAP
      method that can be used to mutually authenticate peer and server.
      Credentials such as a pre-shared key, certificate trust anchor or 
      a Protected Access Credential (PAC)
      must be provisioned to the peer before it can establish mutual 
      authentication with the server. In many cases, the provisioning
      of such information presents deployment hurdles. Through the use of the
      protected TLS <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> tunnel, EAP-FAST can enable dynamic in-band provisioning to 
      address such deployment obstacles.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Specification Requirements</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology  </h3>

<p>Much of the terminology used in this document comes from <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The terms "peer" and "server" are used 
       interchangeably with the terms "EAP peer" and "EAP server" respectively. 
        Additional terms are defined below: 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Man in the Middle (MitM) </dt>
<dd><br />
An adversary that can
            successfully inject itself between a peer and EAP server. The MitM
            succeeds by impersonating itself as a valid peer or server. 
</dd>
<dt>Provisioning</dt>
<dd><br />
Providing peer with a trust anchor, shared secret or other
            appropriate information needed to establish a security association. 
</dd>
<dt>Protected Access Credential (PAC)</dt>
<dd><br />
Credentials distributed to a peer for future optimized network
            authentication. The PAC consists of at most three components: a
            shared secret, an opaque element and optional information.
            The shared secret part contains the secret key shared between the
            peer and server. The opaque part contains the shared secret encrypted by a private key only known to the server. It is provided to the
            peer and is presented back to the server when the peer
            wishes to obtain access to network resources. Finally, a PAC may
            optionally include other information that may be useful to the
            peer. 
</dd>
<dt>Tunnel PAC </dt>
<dd><br />
 A set of credentials stored by the peer and consumed by both
            the peer and the server to establish a TLS tunnel. 
</dd>
<dt>User Authorization PAC</dt>
<dd><br />
 
	    A User Authorization PAC is server encrypted data containing authorization information associated with a previously authenticated user.  The user authorization PAC does not typically contain a key, but rather it is generally bound to a tunnel PAC which is used with the User Authorization PAC. 
</dd>
<dt>Machine Authentication PAC</dt>
<dd><br />

	    A Machine Authentication PAC contains server encrypted data containing authorization information associated with a device.  A Machine Authentication PAC may be used instead of a tunnel PAC to establish the TLS tunnel to provide machine authentication and authorization information.  The Machine Authentication PAC is useful in cases where the machine needs to be authenticated and authorized to access a network before a user has logged in. 
</dd>
</dl></blockquote>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
EAP-FAST Provisioning Modes</h3>

<p>EAP-FAST supports two modes for provisioning: 
</p>
<p></p>
<ol class="text">
<li>Server-Authenticated Provisioning Mode - Provisioning inside a TLS tunnel that provides server-side authentication. 
</li>
<li>Server-Unauthenticated Provisioning Mode - Provisioning inside an anonymous TLS tunnel.
</li>
</ol>

<p>The EAP-FAST provisioning modes use EAP-FAST phase 2 inside a secure TLS tunnel established during phase 1.  <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> describes the EAP-FAST phases in greater detail.  
</p>
<p>In the Server-Authenticated Provisioning Mode, the peer has 
   successfully authenticated the EAP server as part of EAP-FAST Phase 1 
   (i.e. TLS tunnel establishment).  Additional exchanges MAY occur
   inside the tunnel to allow the EAP Server to authenticate the EAP peer before 
   provisioning any information.
</p>
<p>In the Server-Unauthenticated Provisioning Mode, an unauthenticated 
   TLS tunnel is established in the EAP-FAST Phase 1.  The peer MUST negotiate a TLS anonymous Diffie-Hellman  based cipher suite to 
   signal that it wishes to use Server-Unauthenticateded Provisioning Mode.  This provisioning mode enables
   the bootstrapping of peers where the peer lacks 
   strong credentials usable for mutual authentication with the server. 
</p>
<p>Since the server is not authenticated in the Server-Unauthenticated 
   Provisioning Mode, it is possible that an attacker may intercept the TLS tunnel. When using this mode,   
   an inner, phase 2, EAP method SHOULD be used to provide authentication and man-in-the-middle 
   detection as described in <a class='info' href='#security'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.  If an anonymous tunnel is used then the peer and server MUST negotiate and successfully complete an EAP method supporting mutual authentication and key derivation. The peer then uses the Crypto-Binding TLV to validate the integrity of the TLS tunnel, thereby verifying that the exchange was not subject to a man-in-the-middle attack. 
</p>
<p>Server-Authenticated mode protects against the man-in-the-middle, however it requires provisioning the peer with credentials necessary to authenticate the server.  Environments willing to trade off the security risk of a man-in-the-middle for ease of deployment can choose to use the Server-Unauthenticated mode. 
</p>
<p>Assuming that an inner EAP method and Crypto-Binding TLV exchange is 
   successful, the server will subsequently provide credential information, such 
   as a shared key using a PAC TLV or the trusted certificate root(s) of the server 
    using a Server-Trusted-Root TLV. Once the EAP-FAST Provisioning conversation completes, the peer is 
   expected to use the provisioned credentials in subsequent EAP-FAST 
   authentications.   
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Dynamic Provisioning using EAP-FAST Conversation</h3>

<p>The provisioning occurs in the following steps which are detailed in
  the subsequent sections and in RFC 4851.  First the EAP-FAST phase 1 TLS
  tunnel is established.  During this
  process extra material is extracted from the TLS key derivation for 
  use as challenges in the subsequent authentication exchange.   Next, 
  EAP-MSCHAPv2 is executed within the EAP-FAST phase 2 TLS tunnel to
  authenticate the client using the challenges derived from the phase 1
  TLS exchange.  Following successful authentication and Crypto-Binding
  TLV exchange, the server  provisions the peer with PAC information
  including the secret PAC key and the PAC opaque.  Finally, the
  EAP-FAST conversation completes with Result TLV exchanges defined
  in RFC 4851.  The exported EAP MSK and EMSK are derived from a
  combination of the tunnel key material and key material from the
  EAP-MSCHAPv2 exchange.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Phase 1 TLS tunnel</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Server-Authenticated Phase 1</h3>

<p>The provisioning EAP-FAST exchange uses the same sequence as the EAP-FAST 
   authentication phase 1 to establish a protected TLS tunnel.  Implementations supporting this version of the Sever-Authenticated Provisioning Mode MUST 
   support the following TLS ciphersuites defined in <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>: 
</p>
<p></p>
<blockquote class="text">
<p>TLS_RSA_WITH_RC4_128_SHA 
		<br />
TLS_RSA_WITH_AES_128_CBC_SHA 
		<br />
TLS_DHE_RSA_WITH_AES_128_CBC_SHA 
</p>
</blockquote>

<p>Other TLS ciphersuites that provide server authentication and encryption  MAY be supported. The server MAY authenticate the peer during the TLS handshake in Server-Authenticated Provisioning Mode.  To adhere to best security 
   practices, it is highly RECOMMENDED that the peer validate the server's 
   certificate chain when performing server-side authentication to obtain the full security benefits of Server-Authenticated provisioning.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Server-Unauthenticated Phase 1</h3>

<p> Implementations supporting this version of the Sever-Unauthenticated Provisioning Mode MUST 
   support the following TLS ciphersuites defined in <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>: 
</p>
<p></p>
<blockquote class="text">
<p>TLS_DH_anon_WITH_AES_128_CBC_SHA
</p>
</blockquote>

<p>  
 Anonymous 
   ciphersuites SHOULD NOT be allowed outside of EAP-FAST Server-Unauthenticated Provisioning 
   Mode. Ciphersuites that are used for provisioning MUST provide encryption. 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Phase 2 - Tunneled Authentication and Provisioning</h3>

<p>Once a protected tunnel is established, the peer and server MAY wish to execute additional 
   authentication and perform checks on the integrity of the TLS tunnel.   As defined in <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> the authentication exchange will be followed by an 
 Intermediate-Result TLV and a Crypto-Binding TLV if the EAP method succeeded. 
 The Crypto-Binding TLV provides a check on the integrity of the tunnel with respect to the
 endpoints of the EAP method. If the preceding is successful than a provisioning exchange MAY take
 place.  The provisioning exchange will use a PAC TLV exchange if a PAC is being provisioned and 
 a Server-Trusted-Root TLV if a trusted root certificate is being provisioned.  The provisioning MAY be solicited by the peer or it MAY be unsolicited. The 
 PAC TLV exchange consists of the server distributing the PAC in a corresponding PAC TLV to 
 the peer and the peer confirming its receipt in a final PAC TLV Acknowledgement message.  The peer may also use the PAC TLV to request that the server send a PAC. The provision TLVs MAY be piggybacked on the Result TLV, following the Result TLV. A PAC TLV MUST NOT be accepted if it is not encapsulated in an encrypted TLS tunnel.
</p>
<p> A fresh PAC MAY be distributed if the server detects that the PAC is expiring soon.  
      In-band PAC refreshing is through the PAC TLV mechanism.  The decision to refresh or not to refresh the PAC is determined by the server.  Based on the PAC-Opaque information, the server MAY determine not to 
   refresh a peer's PAC even if the PAC-Key has expired. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Server-Authenticated Tunneled Authentication</h3>

<p>  If 
   Server-Authenticated Mode is in use then any EAP method may be used within the TLS 
   tunnel to authenticate the peer that is allowed by the peer's policy. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Server-Unauthenticated Tunneled Authentication</h3>

<p> If 
   Server-Unauthenticated Mode is in use then peer authenticates the server 
   and the server authenticates the peer within the tunnel.  The only method for performing 
   authentication defined in this version of EAP-FAST is EAP-MSCHAPv2 <a class='info' href='#EAP-MSCHAPv2'>[EAP&#8209;MSCHAPv2]<span> (</span><span class='info'>Microsoft Developer Network (MSDN), &ldquo;[MS-CHAP]: Extensible Authentication Protocol Method for Microsoft Challenge Handshake Authentication Protocol (CHAP) Specification,&rdquo; January&nbsp;2008.</span><span>)</span></a> in a special way as described in the following section.  It is possible for other methods to be defined to perform 
   this authentication in the future. 
</p>
<a name="mschap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Authenticating Using EAP-MSCHAPv2</h3>

<p>Implementations of this version of the EAP-FAST Server-Unauthenticated Provisioning Mode MUST 
   support EAP-MSCHAPv2 <a class='info' href='#EAP-MSCHAPv2'>[EAP&#8209;MSCHAPv2]<span> (</span><span class='info'>Microsoft Developer Network (MSDN), &ldquo;[MS-CHAP]: Extensible Authentication Protocol Method for Microsoft Challenge Handshake Authentication Protocol (CHAP) Specification,&rdquo; January&nbsp;2008.</span><span>)</span></a>  as the inner authentication method. While other authentication 
   methods exist, EAP-MSCHAPv2 was chosen 
   for several reasons: 
</p>
<p></p>
<ul class="text">
<li>Provide the ability of slowing an active attack by using a hash based challenge-response protocol.
</li>
<li>The use of a challenge response protocol such as MSCHAPv2 provides some ability to detect a man-in-the-middle attack during Server-Unauthenticated Provisioning Mode. 
</li>
<li> A large deployed base is already able to 
     support MSCHAPv2 
</li>
<li>It allows support for password change during the EAP-FAST 
     provisioning modes.  
</li>
</ul>

<p>When using an anonymous Diffie-Hellman key agreement and EAP-MSCHAPv2, a binding 
   between the tunnel and the EAP-MSCHAPv2 exchanges is formed by using 
   keying material generated during the EAP-FAST tunnel establishment as 
   the EAP-MSCHAPv2 challenges instead of using the challenges exchanged within the protocol itself.  A detailed description of the challenge 
   generation is described in <a class='info' href='#keyderiv'>Section&nbsp;3.3<span> (</span><span class='info'>Key Derivations Used in the EAP-FAST Provisioning Exchange</span><span>)</span></a>. 
</p>
<p>The MSCHAPv2 <a class='info' href='#RFC2759'>[RFC2759]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft PPP CHAP Extensions, Version 2,&rdquo; January&nbsp;2000.</span><span>)</span></a> exchange forces the server to provide a valid 
   ServerChallengeResponse which must be a function of the server 
   challenge, peer challenge and password as part of its response.  
   This reduces the window of vulnerability of a man-in-the-middle spoofing the 
   server, by requiring the attacker to  successfully break the password within the peer's 
   challenge response time limit. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.4"></a><h3>3.2.4.&nbsp;
Use of other Inner EAP Methods for EAP-FAST Provisioning</h3>

<p>Once a protected tunnel is established, typically the peer authenticates 
   itself to the server before the server can provision the peer. If the authentication 
   mechanism does not support mutual authentication and protection from man-in-the-middle 
   attacks then Server-Authenticated Provisioning Mode MUST be used.  Within a server side 
   authenticated tunnel authentication mechanisms such as EAP-GTC <a class='info' href='#I-D.zhou-emu-fast-gtc'>[I&#8209;D.zhou&#8209;emu&#8209;fast&#8209;gtc]<span> (</span><span class='info'>Cam-Winget, N. and H. Zhou, &ldquo;Basic Password Exchange within the Flexible Authentication via Secure  Tunneling Extensible Authentication Protocol (EAP-FAST),&rdquo; November&nbsp;2008.</span><span>)</span></a>
   MAY be used. This will enable peers using other authentication mechanisms 
   such as password database and one-time passwords to be provisioned in-band as well.  
   This version of the EAP-FAST provisioning mode implementation MUST 
   support both EAP-GTC and EAP-MSCHAPv2 within the tunnel in Server-Authenticated Provisioning Mode.
</p>
<p> It should be noted that Server-Authenticated Provisioning Mode  
   provides significant security advantages over Server-Unauthenticated  
   Provisioning Mode even when EAP-MSCHAPv2 is being used as the inner method. It 
   protects the EAP-MSCHAPv2 exchanges from potential active MitM attacks by 
   verifying server's authenticity before exchanging MSCHAPv2. Server-Authenticated 
   Provisioning Mode is the recommended provisioning mode. The EAP-FAST peer MUST use the 
   Server-Authenticated Provisioning Mode whenever it is configured with valid trust root for 
   a particular server. 
</p>
<a name="keyderiv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Key Derivations Used in the EAP-FAST Provisioning Exchange</h3>

<p>The TLS tunnel key is calculated according to the TLS <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> 
   with an extra 72 octets of key material. Portions of the extra 72 octets 
   are used for the EAP-FAST provisioning exchange session key seed and 
   as the random challenges in the EAP-MSCHAPv2 exchange. 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>To generate the key material, compute</dt>
<dd> <br />
 
<blockquote class="text"><dl>
<dt>key_block = PRF(master_secret, </dt>
<dd>
                             "key expansion", 
                             <br />
server_random + 
                             <br />
client_random); 
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<p> until enough output has been generated. 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Then the key_block is partitioned as follows: </dt>
<dd> 
      <br />
 client_write_MAC_secret[hash_size] 
          <br />
server_write_MAC_secret[hash_size] 
          <br />
client_write_key[Key_material_length] 
           <br />
server_write_key[key_material_length] 
           <br />
client_write_IV[IV_size] 
           <br />
server_write_IV[IV_size] 
           <br />
session_key_seed[40] 
           <br />
MSCHAPv2 ServerChallenge[16] 
           <br />
MSCHAPv2 ClientChallenge[16] 
</dd>
</dl></blockquote>

<p>The extra key material, session_key_seed is used for the EAP-FAST Crypto-Binding TLV exchange while the ServerChallenge and ClientChallenge correspond to 
   the authentication server's MSCHAPv2 challenge and the peer's 
   MSCHAPv2 challenge respectively.  The ServerChallenge and 
   ClientChallenge are only used for the MSCHAPv2 exchange when Diffie-Hellman 
   anonymous key agreement is used in the EAP-FAST tunnel establishment.  
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Peer-Id, Server-Id and Session-Id </h3>

<p>The provisioning modes of EAP-FAST does not change the general EAP-
   FAST protocol and thus how the Peer-Id, Server-Id and Session-Id are 
   determined is based on the <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> techniques. 
</p>
<p><a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> Section 3.4 describes how the Peer-Id and Server-Id are 
   determined; Section 3.5 describes how the Session-Id is generated. 
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Network Access after EAP-FAST Provisioning</h3>

<p> After successful provisioning, network access MAY be granted or denied depending upon server policy.  For example, in the Server-Authenticated Provisioning Mode, 
   access can be granted after the EAP server has authenticated the peer 
   and provisioned the peer with a Tunnel PAC (i.e. a PAC used to 
   mutually authenticate and establish the EAP-FAST tunnel). Additionally, peer policy MAY instruct the peer to disconnect the current 
   provisioning connection and initiate a new EAP-FAST exchange for 
   authentication utilizing the newly provisioned information. At the end of the Server-Unauthenticated Provisioning Mode, network 
   access SHOULD NOT be granted as this conversation is intended for 
   provisioning only and thus no network access is authorized. The server MAY grant access at the end of a successful Server-Authenticated provisioning exchange. 
</p>
<p>If after successful provisioning access to the network is denied, the EAP Server SHOULD conclude with an EAP 
   Failure. The EAP Server SHALL NOT grant network 
   access or distribute any session keys to the NAS if this exchange is not 
   intended to provide network access.  Even though provisioning mode 
   completes with a successful inner termination (e.g. successful Result 
   TLV), server policy defines whether the peer gains network access or 
   not.  Thus, it is feasible for the server, while providing a 
   successful Result TLV may conclude that its authentication policy was not satisfied 
   and terminate the conversation with an EAP Failure. 
</p>
<p>The EAP-FAST server, when denying network access after EAP-FAST 
   Provisioning, MAY choose to instead, immediately invoke another EAP-
   FAST Start and thus initiate the EAP-FAST Phase 1 conversation.  This 
   server based implementation policy MAY be chosen to avoid 
   applications such as wireless devices from being disrupted (e.g. in 
   IEEE 802.11 devices, an EAP Failure may trigger a full 802.11 
   disassociation) and allow them to smoothly transition to the 
   subsequent EAP-FAST authentications to enable network access. As an 
   alternative, both the peer and server can initiate TLS renegotiation, 
   where the newly provisioned credentials can be used to establish a 
   server authenticated or mutually authenticated TLS tunnel for 
   authentication. Upon completion of the TLS negotiation and subsequent 
   authentication, normal network access policy on EAP-FAST 
   authentication can be applied.  
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Information Provisioned in EAP-FAST</h3>

<p> Multiple types of credentials MAY be provisioned within EAP-FAST. The most common credential
    is the Tunnel PAC that is used to establish the EAP-FAST phase 1 tunnel.  
   In addition to the Tunnel PAC, other types of credentials and information can 
   also be provisioned through EAP-FAST. They may include trusted root 
   certificates, PACs for specific purposes, 
   and user identities to name a few. Typically, provisioning is invoked 
   after both peer and server authenticate each other and after a 
   successful Crypto-Binding TLV exchange. However, depending on the 
   information being provisioned, mutual authentication MAY not be 
   needed.  
</p>
<p> At minimum, either the peer or server must prove 
   authenticity before credentials are provisioned to ensure that 
   information is not freely provisioned to or by adversaries.  For 
   example, the EAP server may not need to authenticate the peer to 
   provision the peer with trusted root certificates. However, the peer 
   SHOULD authenticate the server before it can accept a trusted server 
   root certificate. 
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Protected Access Credential</h3>

<p> A Protected Access Credential (PAC) is a security credential generated  
   by the server that holds information specific to a peer.
   The server distributes all PAC information through the 
   use of a PAC TLV.  Different types of PAC information are identified through the 
   PAC Type and other PAC attributes defined in this section. This document defines three types of PACs: a Tunnel PAC, a Machine Authentication PAC and a User Authorization PAC.      
    
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Tunnel PAC</h3>

<p>The server distributes the Tunnel PAC to the peer, which uses it in subsequent attempts to establish a secure EAP-FAST TLS tunnel with the server.  The Tunnel PAC includes a secret key (PAC-Key), data that is opaque to the peer (PAC-Opaque) and other information (PAC-Info) which the peer can interpret.  The opaque data is generated by the server and cryptographically protected so it cannot be modified or interpreted by the peer. 
The Tunnel PAC conveys the server policy 
   of what must and can occur in the protected phase 2 tunnel. It is up to the server policy to include what is necessary in 
   a PAC-Opaque to enforce the policy in subsequent TLS handshakes. For example, user identity, I-ID, can be included as the 
   part of the server policy. This I-ID information limits the inner 
   EAP methods to be carried only on the specified user identity. Other 
   types of information can also be included, such as which EAP 
   method(s) and which TLS ciphersuites are allowed. If the server policy is 
   not included in a PAC-Opaque, then there is no limitation imposed by the PAC on the usage of
   the inner EAP methods or user identities inside the tunnel 
   established by the use of that PAC.  
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Machine Authentication PAC</h3>

<p>
The Machine Authentication PAC contains information in the PAC opaque that identifies the machine.  It is meant to be used by a machine when network access is required and no user is logged in.  Typically a server will only grant the minimal amount of access required for a machine without a user present based on the Machine Authentication PAC. The Machine Authentication PAC MAY be provisioned during the authentication of a user.  It SHOULD be stored by the peer in a location that is only accessible to the machine.  This type of PAC is typically persisted across sessions.  

</p>
<p>The peer can use the Machine Authentication 
PAC as the Tunnel PAC to establish the TLS tunnel. The EAP server
 MAY have a policy to bypass additional inner EAP method and grant limited
 network access based on information in the Machine Authentication PAC. 
 Server MAY request additional exchanges to validate machine's other 
 authorization criteria, such as posture information etc., before granting 
 network access. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
User Authorization PAC</h3>

<p>
The User Authorization PAC contains information in the PAC opaque that identifies a user and provides authorization information.  The User Authorization PAC is used to provide user information during stateless session resume so user authentication MAY be skipped.  The User Authorization PAC MAY be provisioned during a user authentication.  It is meant to be short lived and not persisted across logon sessions. The User Authorization PAC SHOULD only be available to the user for which it is provisioned. The User Authorization PAC SHOULD be deleted from the peer when the local authorization state of a user's session changes, such as upon the user logs out. 
</p>
<p>
Once the EAP-FAST phase 1 TLS tunnel is established the peer MAY present a User Authorization PAC to the server in a PAC TLV.  This is sent as TLS application data, but it MAY be included in the same message as the Finished Handshake message sent by the peer.  The User Authorization PAC MUST only be sent within the protection of an encrypted tunnel to an authenticated entity.  The server will decrypt the PAC and evaluate the contents.  If the contents are valid and the server policy allows the session to be resumed based on this information then the server will complete the session resumption and grant access to the peer without requiring an inner authentication method. This is called stateless session resume in EAP-FAST. In this case the server sends the Result TLV indicating success without the Crypto-Binding TLV and the peer sends back a Result TLV indicating success. If the User Authorization PAC fails the server validation or the server policy the server MAY either reject the request or continue with performing full user authentication within the tunnel.  

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4"></a><h3>4.1.4.&nbsp;
PAC Provisioning</h3>

<p>To request provisioning of a PAC, a peer sends a PAC TLV 
   containing a PAC attribute of PAC Type set to the appropriate value.  For 
a Tunnel PAC the value is '1', for a Machine Authentication PAC the value is
 '2' and for a User Authorization PAC the value is '3'.  The request MAY be 
issued after the peer has determined that it has successfully authenticated the EAP Server and validated the 
Crypto-Binding TLV to ensure that the TLS tunnel's integrity is intact.  
Since anonymous DH ciphersuites are only allowed for provisioning a Tunnel PAC, if an 
anonymous ciphersuite is negotiated the Tunnel PAC MAY be provisioned 
automatically by the server. The peer MUST send separate PAC TLVs for each type
of PAC they want to provision. Multiple PAC TLVs can be sent in the same packet or different packets.  When requesting the Machine Authentication PAC the peer SHOULD include an I-ID TLV containing the machine name prefixed by "host/". The EAP server will 
send the PACs after its internal policy has been satisfied; or it MAY ignore
 the request or request additional authentications if its policy dictates. 
If a peer receives a PAC with unknown type, it MUST ignore it. 
</p>
<p>
A PAC-TLV containing PAC-Acknowledge 
Attribute MUST be sent by peer to acknowledge the receipt of the 
Tunnel PAC.  PAC-Acknowledge TLV MUST NOT be used from peer to acknowledge 
the receipt of other types of PACs.
</p>
<p>Please see <a class='info' href='#tpacex'>Appendix&nbsp;A.1<span> (</span><span class='info'>Example 1: Successful Tunnel PAC Provisioning</span><span>)</span></a> for an example of packet exchanges to 
   provision a Tunnel PAC.  
</p>
<a name="pac-tlv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
PAC TLV Format</h3>

<p>The PAC TLV provides support for provisioning the Protected Access Credential (PAC) 
   defined within <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a>. The PAC TLV carries the PAC and related information within PAC attribute fields. Additionally, the PAC TLV MAY be used by the peer to 
   request provisioning of a PAC of the type specified in the PAC Type PAC Attribute.  The PAC TLV MUST only be used in a protected tunnel providing encryption and integrity protection. A general PAC TLV 
   format is defined as follows:  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        PAC Attributes...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>M</dt>
<dd>
			<br />
0 - Non-mandatory TLV
			<br />
1 - Mandatory TLV
</dd>
<dt>R</dt>
<dd> 
			<br />
Reserved, set to zero (0)
</dd>
<dt>TLV Type</dt>
<dd><br />
11 - PAC TLV
</dd>
<dt>Length</dt>
<dd><br />
Two octets containing length of the PAC Attributes field in octets
</dd>
<dt>PAC Attributes</dt>
<dd><br />
A list of PAC attributes in the TLV format
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<a name="pacat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Formats for PAC Attributes</h3>

<p> Each PAC Attribute in a PAC TLV is formatted as a TLV defined as follows:     
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Value...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd>
			<br />
The type field is two octets, denoting the attribute type  
         Allocated Types include:
			
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - PAC-Key  
              <br />
2 - PAC-Opaque  
              <br />
3 - PAC-Lifetime 
              <br />
4 - A-ID  
              <br />
5 - I-ID  
              <br />
6 - Reserved 
              <br />
7 - A-ID-Info   
              <br />
8 - PAC-Acknowledgement  
              <br />
9 - PAC-Info  
             <br />
10 - PAC-Type 
</dd>
</dl></blockquote>
</dd>
<dt>Length</dt>
<dd>
<br />
Two octets containing the length of 
         the value field in octets.  
</dd>
<dt>Value</dt>
<dd><br />
The value of the PAC Attribute
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
PAC-Key</h3>

<p>The PAC-Key is a secret key distributed in a PAC attribute of type PAC-Key. The PAC-Key field is included within the PAC TLV whenever the server wishes to issue or renew a PAC that is bound to a key such as a Tunnel PAC. The key is a randomly generated octet string 32 octets in length.  The key is represented as an octet string.  The generator of this key is the issuer of the credential, identified by the A-ID. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                              Key                              ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd><br />
1 - PAC-Key
</dd>
<dt>Length</dt>
<dd><br />
2 octet length indicating a 32 octet long key
</dd>
<dt>Key</dt>
<dd><br />
The value of the PAC key
</dd>
</dl></blockquote>
	

</blockquote>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
PAC-Opaque</h3>

<p>The PAC-Opaque field is included within the PAC TLV whenever the server wishes to issue or renew a PAC.    
 
</p>
<p> The PAC-Opaque is opaque to the peer and thus the peer MUST NOT 
   attempt to interpret it.  A peer that has been issued a PAC-Opaque by 
   a server stores that data, and presents it back to the server according to its PAC Type.  The Tunnel PAC is used in the ClientHello SessionTicket extension field defined in <a class='info' href='#RFC5077'>[RFC5077]<span> (</span><span class='info'>Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;Transport Layer Security (TLS) Session Resumption without Server-Side State,&rdquo; January&nbsp;2008.</span><span>)</span></a>. If a 
   peer has opaque data issued to it by multiple servers, then it  
   stores the data issued by each server separately according to A-ID.  
   This requirement allows the peer to maintain and use each opaque 
   data as an independent PAC pairing, with a PAC-Key mapping to a PAC-Opaque identified by the A-ID. As there is a one to one 
   correspondence between PAC-Key and PAC-Opaque, the peer  
   determines the PAC-Key and corresponding PAC-Opaque based on the A-ID 
   provided in the EAP-FAST/Start message and the A-ID provided in the 
   PAC-Info when it was provisioned with a PAC-Opaque. 
</p>
<p>The PAC-Opaque field format is summarized as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Value ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd><br />
2 - PAC-Opaque 
</dd>
<dt>Length</dt>
<dd><br />
The Length filed is two octets, which contains the length of 
         the value field in octets
</dd>
<dt>Value</dt>
<dd><br />
The value field contains the actual data for PAC-Opaque. It is specific to the server implementation.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
PAC-Info</h3>

<p>   PAC-Info is comprised of a set of PAC attributes as defined in 
   <a class='info' href='#pacat'>Section&nbsp;4.2.1<span> (</span><span class='info'>Formats for PAC Attributes</span><span>)</span></a>.  The PAC-Info attribute MUST contain the 
   A-ID, A-ID-Info, and PAC-Type attributes.  Other attributes MAY be included 
   in the PAC-Info to provide more information to the peer. The PAC-Info attribute MUST NOT contain the PAC-Key, PAC-Acknowledgement, PAC-Info or PAC-Opaque attributes.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Attributes...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd><br />
9 - PAC-Info
</dd>
<dt>Length</dt>
<dd><br />
Two octet length field containing the length of 
         the Attributes field in octets 
</dd>
<dt>Attributes</dt>
<dd><br />
The Attributes field contains a list of PAC Attributes  
    
         Each mandatory and optional field type is defined as follows:
         
<blockquote class="text"><dl>
<dt>3 - PAC-LIFETIME</dt>
<dd><br />

			This is a 4 octet quantity representing the expiration time 
            of the credential in UNIX UTC time. This attribute MAY be 
            provided to the peer as part of PAC-Info. 
			
</dd>
<dt>4 - A-ID</dt>
<dd><br />
A-ID is the identity of the authority that 
           issued the PAC.  The A-ID is intended to be unique across 
           all issuing servers to avoid namespace collisions.  The A-ID is 
           used by the peer to determine which PAC to employ. This attribute MUST be included in the PAC-Info attribute.  The A-ID MUST match the A-ID the server used to establish the tunnel.  Since many existing implementations expect the A-ID to be 16 octets in length, it is RECOMMENDED that length of an A-ID be 16 octets for maximum interoperability.
</dd>
<dt>5 - I-ID</dt>
<dd><br />
Initiator identifier (I-ID) is the peer identity associated 
            with the credential. The server employs the I-ID in the EAP-FAST Phase 2 conversation to validate that the same peer 
            identity used to execute EAP-FAST Phase 1 is also used in at minimum one inner EAP method in EAP-FAST Phase 2.  If the server is enforcing the I-ID 
            validation on inner EAP method, then I-ID MUST be included in 
            PAC-Info, to enable the peer to also enforce a unique PAC 
            for each unique user. If I-ID is missing from the PAC-Info, 
            it is assumed that the Tunnel PAC can be used for multiple 
            users and peer will not enforce the unique Tunnel PAC per 
            user policy.
</dd>
<dt>7 - A-ID-Info</dt>
<dd><br />
Authority Identifier Information is a mandatory TLV intended 
            to provide a user-friendly name for the A-ID. It may contain 
            the enterprise name and server name in a human-readable 
            format. This TLV serves as an aid to the peer to better 
            inform the end-user about the A-ID.  The name is encoded as UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> format. This attribute MUST be included in the PAC-Info.
            
</dd>
<dt>10 - PAC-type</dt>
<dd><br />
PAC-Type is a mandatory TLV intended to provide the type of 
            PAC. This field SHOULD be included in the PAC-Info. If PAC-Type is not present, then it 
            defaults to a Tunnel PAC (Type 1). 
</dd>
</dl></blockquote>
    
         
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
PAC-Acknowledgement TLV</h3>

<p>The PAC-Acknowledgement is used to acknowledge the receipt of the 
   Tunnel PAC by the peer. The peer includes the PAC-Acknowledgement TLV in a PAC-TLV sent to the server to indicate the result of the processing and storing of a newly provisioned 
   Tunnel PAC. This TLV is only used when Tunnel PAC is provisioned.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Result             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd><br />
8 - PAC-Acknowledgement
</dd>
<dt>Length</dt>
<dd><br />
The length of this field is two octets containing a value of 2.
</dd>
<dt>Result</dt>
<dd><br />
The resulting value MUST be one of the following: 
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - Success 
		2 - Failure 
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.6"></a><h3>4.2.6.&nbsp;
PAC-Type TLV</h3>

<p>The PAC-Type TLV is a TLV intended to specify the PAC type. It is included in a PAC-TLV sent by the peer to request PAC provisioning from the server. Its 
   format is described below. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         PAC Type              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd><br />
10 - PAC-Type 
</dd>
<dt>Length</dt>
<dd><br />
Two Octet length field with a value of 2
</dd>
<dt>PAC Type</dt>
<dd><br />
This two octet field defined the type of PAC being requested or 
         provisioned.  The following values are defined: 
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - Tunnel PAC 
2 - Machine Authentication PAC <br />

3 - User Authorization PAC
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Trusted Server Root Certificate</h3>

<p>Server-Trusted-Root TLV facilitates the request and delivery of a trusted server root certificate. The Server-Trusted-Root TLV can be exchanged in regular EAP-FAST Authentication mode or Provisioning mode. The Server-Trusted-Root TLV is always marked as optional, and cannot be responded to with a NAK TLV. The Server-Trusted-Root TLV MUST only be sent as an inner TLV (inside 
   the protection of the tunnel).
</p>
<p>After the peer has determined that it has successfully authenticated  
   the EAP server and validated the Crypto-Binding TLV, it MAY send one or more Server-Trusted-Root TLVs  
   (marked as optional) to request the trusted server root certificates from  
   from the EAP server. The EAP server MAY send one or more root certificates with a PKCS#7 TLV inside Server-Trusted-Root TLV. The EAP server MAY also choose not to honor the request.  
   Please see Section <a class='info' href='#certex'>Appendix&nbsp;A.3<span> (</span><span class='info'>Example 3: Provisioning a Authentication Server's Trusted Root Certificate</span><span>)</span></a> for an example of a server provisioning a 
   server trusted root certificate. 
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Server-Trusted-Root TLV</h3>

<p>The Server-Trusted-Root TLV allows the peer to send a request to the 
   EAP server for a list of trusted roots. The server may respond with one or more root certificates in PKCS#7 <a class='info' href='#RFC2315'>[RFC2315]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #7: Cryptographic Message Syntax Version 1.5,&rdquo; March&nbsp;1998.</span><span>)</span></a> format.
</p>
<p>If the EAP server sets credential format to PKCS#7-Server-
   Certificate-Root, then the Server-Trusted-Root TLV should contain the 
   root of the certificate chain of the certificate issued to the EAP 
   server packaged in a PKCS#7 TLV.  If the Server certificate is a self-signed certificate, then the root is the self-signed 
   certificate. 
</p>
<p>If the Server-Trusted-Root TLV credential format contains a value unknown to the peer, then the EAP peer should ignore the TLV. 
</p>
<p>The Server-Trusted-Root TLV is defined as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Credential-Format   |     Cred TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-</pre></div>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>M</dt>
<dd>
			<br />
0 - Non-mandatory TLV
</dd>
<dt>R</dt>
<dd> 
			<br />
Reserved, set to zero (0)
</dd>
<dt>TLV Type</dt>
<dd><br />
18 - Server-Trusted-Root TLV  [RFC4851]
</dd>
<dt>Length</dt>
<dd><br />
>=2 octets
</dd>
<dt>Credential-Format</dt>
<dd><br />
The Credential-Format field is two octets.  Values include: 
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - PKCS#7-Server-Certificate-Root
</dd>
</dl></blockquote>
</dd>
<dt>Cred TLVs</dt>
<dd><br />
This field is of indefinite length.  It contains TLVs 
         associated with the credential format. The peer may leave this field empty when using this TLV to request server trust roots. 
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
PKCS#7 TLV</h3>

<p>The PKCS#7 TLV is sent by the EAP server to the peer inside the 
   Server-Trusted-Root TLV. It contains the PKCS #7 <a class='info' href='#RFC2315'>[RFC2315]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #7: Cryptographic Message Syntax Version 1.5,&rdquo; March&nbsp;1998.</span><span>)</span></a> wrapped 
   X.509 certificate.  This field contains a certificate or certificate 
   chain in PKCS#7 format requested by the peer as defined in <a class='info' href='#RFC2315'>[RFC2315]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #7: Cryptographic Message Syntax Version 1.5,&rdquo; March&nbsp;1998.</span><span>)</span></a>.
</p>
<p>The PKCS#7 TLV is always marked as optional, which cannot be 
   responded to with a NAK TLV.  EAP-FAST server implementations that 
   claim to support the dynamic provisioning defined in this document SHOULD support this TLV. EAP-FAST peer implementations MAY support this TLV. 
</p>
<p>If the PKCS#7 TLV contains a certificate or certificate chain that is 
   not acceptable to the peer, then peer MUST ignore the TLV. 
</p>
<p>The PKCS#7 TLV is defined as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           PKCS #7 Data...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-</pre></div>
<p>			
</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>M</dt>
<dd><br />
0 - Optional TLV
</dd>
<dt>R</dt>
<dd><br />
Reserved, set to zero (0)
</dd>
<dt>TLV Type</dt>
<dd><br />
20 - PKCS#7 TLV  [RFC4851]
</dd>
<dt>Length</dt>
<dd><br />
The length of the PKCS #7 Data field 
</dd>
<dt>PKCS #7 Data</dt>
<dd><br />
 This field contains the PKCS #7 wrapped X.509 certificate or 
         certificate chain in the PKCS #7 format.
</dd>
</dl></blockquote>

</blockquote>

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>   This section explains the criteria to be used by the IANA for 
   assignment of Type value in PAC attribute, PAC Type value in PAC-
   Type TLV, Credential-Format value in Server-Trusted-Root TLV.  The 
   "Specification Required" policy is used here with the meaning defined 
   in BCP 26 <a class='info' href='#RFC2434'>[RFC2434]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a>.
</p>
<p>A registry of values is needed for the PAC Attribute types. The initial 
   values to populate the registry are:
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
			1 - PAC-Key  
              <br />
2 - PAC-Opaque  
              <br />
3 - PAC-Lifetime 
              <br />
4 - A-ID  
              <br />
5 - I-ID  
              <br />
6 - Reserved 
              <br />
7 - A-ID-Info   
              <br />
8 - PAC-Acknowledgement  
              <br />
9 - PAC-Info  
             <br />
10 - PAC-Type 
</dd>
</dl></blockquote><p>
   Values from 11 to 63 are reserved.  Values 64 to 255 are assigned with a "Specification Required" policy.
</p>
<p>A registry of values is needed for PAC-Type values used in the PAC-Type TLV.  The initial values to populate the registry are:</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - Tunnel PAC
</dd>
<dt></dt>
<dd>2 - Machine Authentication PAC
</dd>
<dt></dt>
<dd>3 - User Authorization PAC
</dd>
</dl></blockquote><p>
      Values from 4 to 63 are reserved.  Values 64 to 255 are assigned with a "Specification Required" policy.
</p>
<p>A registry of values is needed for Credential-Format values used in Server-Trusted-Root TLV.  The initial values to populate the registry are:</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>1 - PKCS#7-Server-Certificate-Root
</dd>
</dl></blockquote><p>
		Values from 2 to 63 are reserved.  Values 64 to 255 are assigned with a "Specification Required" policy.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The Dynamic Provisioning EAP-FAST protocol shares the same security 
   considerations outlined in <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a>. Additionally, it also has its 
   unique security considerations described below: 
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Provisioning Modes and Man-in-the-middle Attacks</h3>

<p>EAP-FAST can be invoked in two different provisioning modes: Server-Authenticated Provisioning Mode and Server-Unauthenticated Provisioning Mode.  Each mode provides different levels of resistance to man-in-the-middle attacks. The following list identifies some of the problems associated with a man-in-the-middle attack:
</p>
<p></p>
<ul class="text">
<li>Disclosure of secret information such as keys, identities and credentials to an attacker
</li>
<li>Spoofing of a valid  server to a peer and the distribution of false credentials
</li>
<li>Spoofing of a valid peer and receiving credentials generated for that peer
</li>
<li>Denial of service
</li>
</ul><p> 
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Server-Authenticated Provisioning Mode and Man-in-the-middle Attacks</h3>

<p>In Server-Authenticated Provisioning Mode the TLS handshake assures protected communications with the server because the peer must have been securely pre-provisioned with the trust roots and/or other authentication information necessary to authenticate the server during the handshake.  This pre-provisioning step prevents an attacker from inserting themselves as a man-in-the-middle of the communications.  Unfortunately, secure pre-provisioning can be difficult to achieve in many environments.  
</p>
<p>Cryptographic binding of inner authentication mechanisms to the TLS tunnel provides additional protection from man-in-the-middle attacks resulting from the tunneling of authentication mechanism. 
</p>
<p>Server-Authenticated Provisioning Mode provides a high degree of protection from man-in-the-middle attacks. 
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
Server-Unauthenticated Provisioning Mode and Man-in-the-middle Attacks</h3>

<p>In Server-Unauthenticated Provisioning Mode the TLS handshake does not assure protected communications with the server because either an anonymous handshake is negotiated or the peer lacks the necessary information to complete the authentication of the server.  This allows an attacker to insert themselves in the middle of the TLS communications.  
</p>
<p>EAP-FAST Server-Unauthenticated Provisioning Mode mitigates the man-in-the-middle attack through the following techniques:
</p>
<p></p>
<ul class="text">
<li>Binding the phase 2 authentication method to secret values derived from the phase 1 TLS exchange:
      <br />
<br />
In the case of MSCHAPv2 used with an anonymous Diffie-Hellman ciphersuite the challenges for the MSCHAPv2 exchange are derived from the TLS handshake and are not transmitted within the MSCHAPv2 exchange.  Since the man-in-the-middle does not know these challenges it cannot successfully impersonate the server without cracking the MSCHAPv2 message from the peer before the peer times out.
</li>
<li>Cryptographic binding of secret values derived from the phase 2 authentication exchange with secret values derived from the phase 1 TLS exchange: 
<br />
<br />
This makes use of the cryptographic binding exchange defined within EAP-FAST to discover the presence of a man-in-the-middle by binding secret information obtained from the phase 2 MSCHAPv2 exchange with secret information from the phase 1 TLS exchange.
</li>
</ul>

<p> While it would be sufficient to only support the cryptographic binding to 
   mitigate the MitM; the binding of the MSCHAPv2 random challenge derivations to the TLS key agreement protocol enables early detection of a man-in-the-middle attack.  This guards against adversaries who may otherwise relay 
   the inner EAP authentication messages between the true peer and server 
   and enforces that the adversary successfully respond with a valid 
   challenge response.
</p>
<p>This document specifies MSCHAPv2 as the inner authentication exchange, however it is possible that other inner authentications mechanisms to authenticate the tunnel may be developed in the future. Since the strength of the man-in-the-middle protection is directly dependent on the strength of the inner method it is RECOMMENDED that any inner method used provide at least as much resistance to attack as MSCHAPv2.  Cleartext passwords MUST NOT be used in Server-Unauthenticated Provisioning Mode.  Note that an active man-in-the-middle may observe phase 2 authentication method exchange until the point that the peer determines that authentication mechanism fails or is aborted. This allows for the disclosure of sensitive information such as identity or authentication protocol exchanges to the man-in-the-middle. 
</p>
<p>The ciphersuite used to establish phase 1 of the Server-Unauthenticated provisioning mode MUST be one in which both the peer and server provide contribution to the derived TLS master key. The authenticated ephemeral Diffie-Hellman ciphersuites provide this type of key agreement. 
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Dictionary Attacks</h3>

<p>It is often the case that phase 2 authentication mechanisms are based on password credentials.  These exchanges may be vulnerable to both online and offline dictionary attacks.  The two provisioning modes provide various degrees of protection from these attacks. 
</p>
<p>In online dictionary attacks the attacker attempts to discover the password by repeated attempts at authentication using a guessed password.  Neither mode prevents this type of attack by itself.  Implementations should provide controls that limit how often an attacker can execute authentication attempts.
</p>
<p>In offline dictionary attacks the attacker captures information which can be processed offline to recover the password.  Server-Authenticated provisioning mode provides effecting mitigation because the peer will not engage in phase 2 authentication without first authenticating the server during phase 1.  Server-Unauthenticated Provisioning Mode is vulnerable to this type of attack.  If, during phase 2 authentication,  a peer receives no response or an invalid response from the server then there is a possibility there is a man-in-the-middle attack in progress.  Implementations SHOULD logs these events and , if possible, provide warnings to the user.  Implementations are also encouraged to provide controls that limit how and where Server-Unauthenticated Provisioning Mode can be performed that are appropriate to their environment.  For example, an implementation may limit this mode to be used only on certain interfaces or require user intervention before allowing this mode if provisioning has succeeded in the past. 
</p>
<p>Another mitigation technique that should not be overlooked is the choice of good passwords that have sufficient complexity and length and a password changing policy that requires regular password changes. 
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Considerations in Selecting a Provisioning Mode</h3>

<p>Since Server-Authenticated Provisioning Mode provides much better protection from attacks than Server-Unauthenticated Provisioning Mode, Server-Authenticated mode should be used whenever possible.  The Server-Unauthenticated Provisioning Mode provides a viable option as 
   there may be deployments that can physically confine devices during 
   the provisioning or are willing to accept the risk of an active 
   dictionary attack.   Further, it is the only option that enables zero 
   touch provisioning and facilitates simpler deployments 
   requiring little to no peer configuration. The peer MAY choose to use alternative secure out-of-band mechanisms for PAC provisioning that afford better security than the Server Unauthenticated Provisioning Mode. 
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Diffie-Hellman Groups</h3>

<p>Implementations of EAP-FAST anonymous provisioning modes MUST support
		 the Diffie-Hellman groups defined in <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>.
</p>
<p>The security of the DH key exchange is based on the difficulty of 
   solving the Discrete Logarithm Problem (DLP). As algorithms and 
   adversaries become more efficient in their abilities to pre-compute 
   values for a given fixed group, it becomes more important for a 
   server to generate new groups as a means to allay this threat.   EAP-FAST servers in closed environments may make use of groups outside <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>. The 
   server could, for instance, constantly compute new groups in the 
   background.  Peers in these environments need to employ proper parameter validation. Such an example is cited in <a class='info' href='#RFC4419'>[RFC4419]<span> (</span><span class='info'>Friedl, M., Provos, N., and W. Simpson, &ldquo;Diffie-Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol,&rdquo; March&nbsp;2006.</span><span>)</span></a>.
</p>
<p>   The server can maintain a list of safe primes and corresponding 
   generators to choose from.  A prime p is safe, if: 
</p>
<p>p = 2q + 1 and q is prime 
</p>
<p>Initial implementations of the EAP-FAST provisioning exchange limit 
   the generator to be 2 as it both improves the multiplication 
   efficiency and still covers half of the space of possible residues.  

</p>
<p>Additionally, since the EAP-FAST provisioning exchange employs DH per 
   <a class='info' href='#RFC3268'>[RFC3268]<span> (</span><span class='info'>Chown, P., &ldquo;Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS),&rdquo; June&nbsp;2002.</span><span>)</span></a> to generate AES keys, the DH keys should provide enough 
   entropy to ensure that a strong 128bit results from the DH key 
   agreement.   
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Tunnel PAC Usage</h3>

<p>The basic usage of the Tunnel PAC is to establish the TLS tunnel.  In this operation it does 
not have to provide user authentication as it is expected for user authentication to be carried out 
in phase 2 of EAP-FAST.  The EAP-FAST Tunnel PAC MAY contain information about the identity of a peer 
to prevent a particular tunnel PAC from being used to establish a tunnel which can perform phase 2 
authenticate other peers.  While it is possible for the server to accept the Tunnel PAC as 
authentication for the peer many current implementations do not do this.  The ability to use PAC to authenticate peers and provide authorizations will be the subject of a future document. <a class='info' href='#RFC5077'>[RFC5077]<span> (</span><span class='info'>Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;Transport Layer Security (TLS) Session Resumption without Server-Side State,&rdquo; January&nbsp;2008.</span><span>)</span></a> gives an example PAC opaque format in the Recommended Ticket Construction section. 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Machine Authentication PAC Usage</h3>

<p> In general the Machine Authorization PAC is expected to provide the minimum access required by a machine without a user.  This will typically be a subset of the privilege a registered user has.  The server provisioning the PAC should include information necessary to validate it at a later point in time.  This would include expiration information.  The Machine Authentication PAC includes a key so it can be used as a Tunnel PAC.  The PAC key MUST be kept secret by the peer.  

</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
User Authorization PAC Usage</h3>

<p>
The User Authorization PAC provides the privilege associated with a user.  The server provisioning the PAC should include the information necessary to validate it at a later point in time.  This includes expiration and other information associated with the PAC. The User Authorization PAC is typically used as a bearer credential such that it does not have a key that used to authenticate its ownership.  For this reason this type of PAC MUST NOT be sent in the clear.  For additional protection the PAC MAY be bound to a Tunnel PAC used to establish the TLS tunnel.  On the peer, the User authorization PAC SHOULD only be accessible by the user for which it is provisioned. 

</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
PAC Storage Considerations</h3>

<p>The main goal of EAP-FAST is to protect the authentication 
   stream over the media link.  However, host security is still an 
   issue.  Some care should be taken to protect the PAC on both the peer 
   and server.  The peer must store securely both the PAC-Key and PAC-Opaque, while the server must secure storage of its security 
   association context used to consume the PAC-Opaque.  Additionally, if 
   alternate provisioning is employed, the transportation mechanism used to 
   distribute the PAC must also be secured. 
</p>
<p>Most of the attacks described here would require some level of 
     effort to execute; conceivably greater than their value.  The main 
     focus therefore, should be to ensure that proper protections are 
     used on both the peer and server.  There are a number of 
     potential attacks which can be considered against secure key 
     storage such as: 
</p>
<p></p>
<ul class="text">
<li>Weak Passphrases <br />
<br />
 On the peer side, keys are usually protected by a passphrase.  On 
     some environments, this passphrase may be associated with the 
     user's password.  In either case, if an attacker can obtain the encrypted key for a range of users, he may be able to successfully 
     attack a weak passphrase.  The tools are already in place today to 
     enable an attacker to easily attack all users in an enterprise 
     environment through the use of email viruses and other techniques. 
     
</li>
<li>Key Finding Attacks <br />
<br />
  Key finding attacks are usually mentioned in reference to web 
     servers, where the private SSL key may be stored securely, but at 
     some point it must be decrypted and stored in system memory.  An 
     attacker with access to system memory can actually find the key by 
     identifying their mathematical properties.  To date, this attack 
     appears to be purely theoretical and primarily acts to argue 
     strongly for secure access controls on the server itself to prevent 
     such unauthorized code from executing. 
</li>
<li>Key duplication, Key substitution, Key modification <br />
<br />

     Once keys are accessible to an attacker on either the peer or 
     server, they fall under three forms of attack: key duplication, key 
     substitution and key modification.  The first option would be the 
     most common, allowing the attacker to masquerade as the user in 
     question.  The second option could have some use if an attacker  
     could implement it on the server.  Alternatively, an attacker could 
     use one of the latter two attacks on either the peer or server to 
     force a PAC re-key, and take advantage of the potential MitM/dictionary attack vulnerability of the EAP-FAST Server-Unauthenticated Provisioning Mode. 
     
</li>
</ul>

<p> Another consideration is the use of secure mechanisms afforded by the 
   particular device.  For instance, some laptops enable secure key 
   storage through a special chip.  It would be worthwhile for 
   implementations to explore the use of such a mechanism. 
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
Security Claims </h3>

<p>The <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> security claims for EAP-FAST are given in Section 7.8 of <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a>. When using anonymous provisioning mode there is a greater risk of offline dictionary attack since it is possible for a man-in-the-middle to capture the beginning of the inner MSCHAPv2 conversation.  However as noted previously it is possible to detect the man-in-the-middle.  
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>   The EAP-FAST design and protocol specification is based on the ideas 
   and contributions from Pad Jakkahalli, Mark Krischer, Doug Smith, 
   Ilan Frenkel and Jeremy Steiglitz.  The authors would also like to thank Jouni Malinen for reviewing this document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="EAP-MSCHAPv2">[EAP-MSCHAPv2]</a></td>
<td class="author-text">Microsoft Developer Network (MSDN), &ldquo;<a href="http://msdn2.microsoft.com/en-us/library/cc224612.aspx">[MS-CHAP]: Extensible Authentication Protocol Method for Microsoft Challenge Handshake Authentication Protocol (CHAP) Specification</a>,&rdquo; January&nbsp;2008.<p>
http://msdn2.microsoft.com/en-us/library/cc224612.aspx
</p>
</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.zhou-emu-fast-gtc">[I-D.zhou-emu-fast-gtc]</a></td>
<td class="author-text">Cam-Winget, N. and H. Zhou, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zhou-emu-fast-gtc-05.txt">Basic Password Exchange within the Flexible Authentication via Secure  Tunneling Extensible Authentication Protocol (EAP-FAST)</a>,&rdquo; draft-zhou-emu-fast-gtc-05 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-zhou-emu-fast-gtc-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2315">[RFC2315]</a></td>
<td class="author-text"><a href="mailto:burt@rsa.com">Kaliski, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2315">PKCS #7: Cryptographic Message Syntax Version 1.5</a>,&rdquo; RFC&nbsp;2315, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2315.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2315.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2315.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2759">[RFC2759]</a></td>
<td class="author-text"><a href="mailto:gwz@acm.org">Zorn, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2759">Microsoft PPP CHAP Extensions, Version 2</a>,&rdquo; RFC&nbsp;2759, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2759.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3268">[RFC3268]</a></td>
<td class="author-text">Chown, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3268">Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;3268, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3268.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3526">[RFC3526]</a></td>
<td class="author-text">Kivinen, T. and M. Kojo, &ldquo;<a href="http://tools.ietf.org/html/rfc3526">More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;3526, May&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3526.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4851">[RFC4851]</a></td>
<td class="author-text">Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;<a href="http://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>,&rdquo; RFC&nbsp;4851, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5077">[RFC5077]</a></td>
<td class="author-text">Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>,&rdquo; RFC&nbsp;5077, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5077.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4419">[RFC4419]</a></td>
<td class="author-text">Friedl, M., Provos, N., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc4419">Diffie-Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol</a>,&rdquo; RFC&nbsp;4419, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4419.txt">TXT</a>).</td></tr>
</table>

<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Examples</h3>

<a name="tpacex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example 1: Successful Tunnel PAC Provisioning</h3>

<p>The following exchanges show anonymous DH with a successful EAP-
   MSCHAPv2 exchange within Phase 2 to provision a Tunnel PAC, the 
   conversation will appear as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Authenticating Peer     Authenticator
       -------------------     -------------
                               &lt;- EAP-Request/Identity
       EAP-Response/
       Identity (MyID1) -&gt;
                               &lt;- EAP-Request/EAP-FAST,
                              (S=1, A-ID)

       EAP-Response/EAP-FAST
       (TLS Client Hello without
       PAC-Opaque in SessionTicket extension)-&gt;

                               &lt;- EAP-Request/EAP-FAST
                                 (TLS Server Hello,
                                  TLS Server Key Exchange
                                TLS Server Hello Done)

       EAP-Response/EAP-FAST
       (TLS Client Key Exchange
        TLS Change Cipher Spec
        TLS Finished)   -&gt;

                               &lt;- EAP-Request/EAP-FAST
                              ( TLS change_cipher_spec,
                               TLS finished,
                              EAP-Payload-TLV
                              (EAP-Request/Identity))

      // TLS channel established
         (Subsequent messages sent within the TLS channel,
                                  encapsulated within EAP-FAST)

      // First EAP Payload TLV is piggybacked to the TLS Finished as
         Application Data and protected by the TLS tunnel

       EAP Payload TLV
       (EAP-Response/Identity) -&gt;

                              &lt;-  EAP Payload TLV
                                  (EAP-Request/EAP-MSCHAPV2
                                   (Challenge))

       EAP Payload TLV
       (EAP-Response/EAP-MSCHAPV2
        (Response)) -&gt;

                              &lt;-  EAP Payload TLV
                                  (EAP-Request/EAP-MSCHAPV2)
                                  (Success))
       EAP Payload TLV
       (EAP-Response/EAP-MSCHAPV2
        (Success)) -&gt;
                               &lt;- Intermediate Result TLV(Success)
                                  Crypto-Binding-TLV (Version=1,
                                  EAP-FAST Version=1, Nonce,
                                  CompoundMAC)

       Intermediate Result TLV (Success)
       Crypto-Binding-TLV (Version=1,
       EAP-FAST Version=1, Nonce,
       CompoundMAC)
       PAC-TLV (Type=1)
                               &lt;- Result TLV (Success)
                                  PAC TLV

       Result TLV (Success)
       PAC Acknowledgment -&gt;

       TLS channel torn down
       (messages sent in cleartext)

                               &lt;- EAP-Failure</pre></div>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Example 2: Failed Provisioning</h3>

<p>The following exchanges show a failed EAP-MSCHAPV2 exchange  
       within Phase 2, where the peer failed to authenticate the Server.  
       The conversation will appear as follows:  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Authenticating Peer     Authenticator
       -------------------     -------------
                               &lt;- EAP-Request/Identity
       EAP-Response/
       Identity (MyID1) -&gt;
                               &lt;- EAP-Request/EAP-FAST
                                  (s=1, A-ID)

       EAP-Response/EAP-FAST
       (TLS Client Hello without
       SessionTicket extension)-&gt;

                               &lt;- EAP-Request/EAP-FAST
                               (TLS Server Hello
                               TLS Server Key Exchange
                               TLS Server Hello Done)
       EAP-Response/EAP-FAST
       (TLS Client Key Exchange
        TLS Change Cipher Spec,
        TLS Finished)   -&gt;

                                                &lt;- EAP-Request/EAP-FAST
                              ( TLS change_cipher_spec,
                               TLS finished,
                              EAP-Payload-TLV
                              (EAP-Request/Identity))

      // TLS channel established
         (Subsequent messages sent within the TLS channel,
                                  encapsulated within EAP-FAST)

      // First EAP Payload TLV is piggybacked to the TLS Finished as
         Application Data and protected by the TLS tunnel


       EAP Payload TLV
       (EAP-Response/Identity)-&gt;

                              &lt;-  EAP Payload TLV
                                 (EAP-Request/EAP-MSCHAPV2
                                   (Challenge))

       EAP Payload TLV
       (EAP-Response/EAP-MSCHAPV2
        (Response)) -&gt;

                              &lt;-  EAP Payload TLV
                                  (EAP-Request EAP-MSCHAPV2
                                   (Success))

       // peer failed to verify server MSCHAPv2 response
       EAP Payload TLV
       (EAP-Response/EAP-MSCHAPV2
        (Failure)) -&gt;

                              &lt;-  Result TLV (Failure)

       Result TLV (Failure) -&gt;
       TLS channel torn down
       (messages sent in cleartext)

                               &lt;- EAP-Failure</pre></div>
<a name="certex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Example 3: Provisioning a Authentication Server's Trusted Root Certificate</h3>

<p>The following exchanges show a successful provisioning of a server 
   trusted root certificate using anonymous DH and EAP-MSCHAPV2 exchange 
   within Phase 2, the conversation will appear as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Authenticating Peer     Authenticator
   -------------------     -------------
                           &lt;- EAP-Request/
                           Identity
   EAP-Response/
   Identity (MyID1) -&gt;
                           &lt;- EAP-Requese/EAP-FAST
                           (s=1, A-ID)

   EAP-Response/EAP-FAST
   (TLS Client Hello without
   SessionTicket extension)-&gt;
                           &lt;- EAP-Request/EAP-FAST
                           (TLS Server Hello,
                           (TLS Server Key Exchange
                            TLS Server Hello Done)

   EAP-Response/EAP-FAST
   (TLS Client Key Exchange
    TLS Change Cipher Spec,
    TLS Finished)  -&gt;

                           &lt;- EAP-Request/EAP-FAST
                           (TLS Change Cipher Spec
                            TLS Finished)
                            (EAP-Payload-TLV(
                            EAP-Request/Identity))

   // TLS channel established
      (messages sent within the TLS channel)

   // First EAP Payload TLV is piggybacked to the TLS Finished as
      Application Data and protected by the TLS tunnel

   EAP-Payload TLV
   (EAP-Response/Identity) -&gt;

                           &lt;- EAP Payload TLV
                              (EAP-Request/EAP-MSCHAPV2
                              (Challenge))

   EAP Payload TLV
   (EAP-Response/EAP-MSCHAPV2
    (Response)) -&gt;

                          &lt;-  EAP Payload TLV
                              (EAP-Request/EAP-MSCHAPV2
                               (success))

   EAP Payload TLV
   (EAP-Response/EAP-MSCHAPV2
    (Success) -&gt;

                           &lt;- Intermediate Result TLV(Success)
                              Crypto-Binding TLV (Version=1,
                              EAP-FAST Version=1, Nonce,
                              CompoundMAC),

   Intermediate Result TLV(Success)
   Crypto-Binding TLV (Version=1
   EAP-FAST Version=1, Nonce,
   CompoundMAC)
   Server-Trusted-Root TLV
   (Type = PKCS#7) -&gt;
                           &lt;- Result TLV (Success)
                              Server-Trusted-Root TLV
                              (PKCS#7 TLV)

   Result TLV (Success) -&gt;

   // TLS channel torn down
      (messages sent in cleartext)

                           &lt;- EAP-Failure</pre></div>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Recent Changes</h3>

<p>changes in -07
</p>
<p></p>
<ul class="text">
<li>Added definition for User Authorization PAC and Machine Authentication PAC
</li>
<li>Added sections for User Authorization PAC (4.1.3) and Machine Authentication PAC (4.1.2).
</li>
<li>Added security considerations for new types of PACs
</li>
<li>Added recommendation for 16 octet A-ID
</li>
</ul>

<p>changes in -08
</p>
<p></p>
<ul class="text">
<li>Clarified that Server-Unauthenticated provisioning mode uses anonymous TLS ciphersuites
</li>
<li>Editorial corrections
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nancy Cam-Winget</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3625 Cisco Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ncamwing@cisco.com">ncamwing@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hao Zhou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4125 Highlander Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richfield, OH  44286</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hzhou@cisco.com">hzhou@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
