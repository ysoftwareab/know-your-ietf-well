jid             = [ node "@" ] domain [ "/" resource ]
domain          = fqdn / address-literal
fqdn            = (sub-domain 1*("." sub-domain))
sub-domain      = ([IDNA] conformant domain label)
address-literal = IPv4address / IPv6address

xmlns='urn:ietf:params:xml:ns:xmpp-streams'/>
to='example.com'
xmlns='jabber:client'
version='1.0'>
from='example.com'
id='someid'
xmlns='jabber:client'
version='1.0'>
to='romeo@example.net'
to='juliet@example.com'
to='example.com'
xmlns='jabber:client'
version='1.0'>
from='example.com'
id='someid'
xmlns='jabber:client'
version='1.0'>
xmlns='urn:ietf:params:xml:ns:xmpp-streams'/>
xmlns='jabber:client'
to='example.com'
version='1.0'>

xmlns='jabber:client'
id='c2s_123'
from='example.com'
version='1.0'>
xmlns='jabber:client'
to='example.com'
version='1.0'>

xmlns='jabber:client'
from='example.com'
id='c2s_234'
version='1.0'>
xmlns='jabber:server'
to='example.com'
version='1.0'>

xmlns='jabber:server'
from='example.com'
id='s2s_123'
version='1.0'>
xmlns='jabber:server'
to='example.com'
version='1.0'>

xmlns='jabber:server'
from='example.com'
id='s2s_234'
version='1.0'>
xmlns='jabber:client'
to='example.com'
version='1.0'>

xmlns='jabber:client'
id='c2s_234'
from='example.com'
version='1.0'>

mechanism='DIGEST-MD5'/>
LGNoYXJzZXQ9dXRmLTgsYWxnb3JpdGhtPW1kNS1zZXNzCg==
realm="somerealm",nonce="OA6MG9tEQGm2hh",\
qop="auth",charset=utf-8,algorithm=md5-sess

username="somenode",realm="somerealm",\
nonce="OA6MG9tEQGm2hh",cnonce="OA6MHXh6VqTrRk",\
nc=00000001,qop=auth,digest-uri="xmpp/example.com",\
response=d388dad90d4bbd760a152321f2143af7,charset=utf-8

cnNwYXV0aD1lYTQwZjYwMzM1YzQyN2I1NTI3Yjg0ZGJhYmNkZmZmZAo=
rspauth=ea40f60335c427b5527b84dbabcdfffd
xmlns='jabber:client'
to='example.com'
version='1.0'>

xmlns='jabber:client'
id='c2s_345'
from='example.com'
version='1.0'>
xmlns='jabber:server'
to='example.com'
version='1.0'>

xmlns='jabber:server'
from='example.com'
id='s2s_234'
version='1.0'>

mechanism='DIGEST-MD5'/>

realm="somerealm",nonce="OA6MG9tEQGm2hh",\
qop="auth",charset=utf-8,algorithm=md5-sess

username="example.org",realm="somerealm",\
nonce="OA6MG9tEQGm2hh",cnonce="OA6MHXh6VqTrRk",\
nc=00000001,qop=auth,digest-uri="xmpp/example.org",\
response=d388dad90d4bbd760a152321f2143af7,charset=utf-8

cnNwYXV0aD1lYTQwZjYwMzM1YzQyN2I1NTI3Yjg0ZGJhYmNkZmZmZAo=
rspauth=ea40f60335c427b5527b84dbabcdfffd

xmlns='jabber:server'
to='example.com'
version='1.0'>

xmlns='jabber:client'
from='example.com'
id='s2s_345'
version='1.0'>
xmlns='jabber:client'
id='c2s_345'
from='example.com'
version='1.0'>
xmlns='jabber:server'
xmlns='jabber:server'
id='457F9224A0...'>

        Note: The 'to' and 'from' attributes are OPTIONAL on the root
        stream element.  If the namespace name is incorrect, then
        Originating Server MUST generate an <invalid-namespace/> stream
        error condition and terminate both the XML stream and the
        underlying TCP connection.  Note well that Receiving Server
        SHOULD reply but MAY silently terminate the XML stream and
        underlying TCP connection depending on security policies in
        place; however, if Receiving Server desires to proceed, it MUST
        send a stream header back to Originating Server.
to='Receiving Server'
from='Originating Server'>
xmlns='jabber:server'
xmlns='jabber:server'
id='1251A342B...'>

        Note: If the namespace name is incorrect, then Receiving Server
        MUST generate an <invalid-namespace/> stream error condition and
        terminate both the XML stream and the underlying TCP connection
        between it and Authoritative Server.  If a stream error occurs
        between Receiving Server and Authoritative Server, then
        Receiving Server MUST generate a <remote-connection-failed/>
        stream error condition and terminate both the XML stream and the
        underlying TCP connection between it and Originating Server.
from='Receiving Server'
to='Originating Server'
id='457F9224A0...'>
from='Originating Server'
to='Receiving Server'
type='valid'
id='457F9224A0...'/>

         or

from='Originating Server'
to='Receiving Server'
type='invalid'
id='457F9224A0...'/>

        Note: If the ID does not match that provided by Receiving Server
        in Step 3, then Receiving Server MUST generate an <invalid-id/>
        stream error condition and terminate both the XML stream and the
        underlying TCP connection.  If the value of the 'to' address
        does not match a hostname recognized by Receiving Server, then
        Receiving Server MUST generate a <host-unknown/> stream error
        condition and terminate both the XML stream and the underlying
        TCP connection.  If the value of the 'from' address does not
        match the hostname represented by Originating Server when
        opening the TCP connection (or any validated domain thereof,
        such as a validated subdomain of Originating Server's hostname
        or another validated domain hosted by Originating Server), then
        Receiving Server MUST generate an <invalid-from/> stream error
        condition and terminate both the XML stream and the underlying
        TCP connection.  After returning the verification to Receiving
        Server, Authoritative Server SHOULD terminate the stream between
        them.
from='Receiving Server'
to='Originating Server'
type='valid'/>

        Note: At this point the connection has either been validated via
        a type='valid', or reported as invalid.  If the connection is
        invalid, then Receiving Server MUST terminate both the XML
        stream and the underlying TCP connection.  If the connection is
        validated, data can be sent by Originating Server and read by
        Receiving Server; before that, all XML stanzas sent to Receiving
        Server SHOULD be silently dropped.

xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/>
xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'>
targetNamespace='http://etherx.jabber.org/streams'
xmlns='http://etherx.jabber.org/streams'
elementFormDefault='unqualified'>

minOccurs='0'
maxOccurs='unbounded'/>
minOccurs='0'
maxOccurs='unbounded'/>
minOccurs='0'
maxOccurs='1'/>
targetNamespace='urn:ietf:params:xml:ns:xmpp-streams'
xmlns='urn:ietf:params:xml:ns:xmpp-streams'
elementFormDefault='qualified'>

targetNamespace='urn:ietf:params:xml:ns:xmpp-tls'
xmlns='urn:ietf:params:xml:ns:xmpp-tls'
elementFormDefault='qualified'>

name='required'
minOccurs='0'
maxOccurs='1'
type='empty'/>
targetNamespace='urn:ietf:params:xml:ns:xmpp-sasl'
xmlns='urn:ietf:params:xml:ns:xmpp-sasl'
elementFormDefault='qualified'>

maxOccurs='unbounded'
type='xs:string'/>
type='xs:string'
use='optional'/>
targetNamespace='urn:ietf:params:xml:ns:xmpp-bind'
xmlns='urn:ietf:params:xml:ns:xmpp-bind'
elementFormDefault='qualified'>

targetNamespace='jabber:server:dialback'
xmlns='jabber:server:dialback'
elementFormDefault='qualified'>

targetNamespace='urn:ietf:params:xml:ns:xmpp-stanzas'
xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'
elementFormDefault='qualified'>

