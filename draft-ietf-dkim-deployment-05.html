<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DomainKeys
	    Identified Mail (DKIM) Development, Deployment and Operations</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DomainKeys
	    Identified Mail (DKIM) Development, Deployment and Operations">
<meta name="keywords" content="Email, Electronic Mail, Internet Mail, Message Verification">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DomainKeys Identified Mail</td><td class="header">T. Hansen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">AT&amp;T Laboratories</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">E. Siegel</td></tr>
<tr><td class="header">Expires: December 6, 2009</td><td class="header">Constant Contact, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">P. Hallam-Baker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">VeriSign Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Crocker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Brandenburg InternetWorking</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 04, 2009</td></tr>
</table></td></tr></table>
<h1><br />DomainKeys
	    Identified Mail (DKIM) Development, Deployment and Operations<br />draft-ietf-dkim-deployment-05</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 6, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
				DomainKeys Identified Mail (DKIM) allows an organization to claim
				responsibility for transmitting a message, in a way that can
				be validated by a recipient. The organization can be the
				author's, the originating sending site, an intermediary, or
				one of their agents. A message can contain multiple
				signatures, from the same or different organizations involved
				with the message. DKIM defines a domain-level digital
				signature authentication framework for email, using public key
				cryptography, using the domain name service as its key server
				technology <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. This permits verification of a
				responsible organization, as well as the integrity of the
				message contents. DKIM will also provide a mechanism that
				permits potential email signers to publish information about
				their email signing practices; this will permit email
				receivers to make additional assessments about messages.
				DKIM's authentication of email identity can assist in the
				global control of "spam" and "phishing". This document provides
				implementation, deployment, operational and migration
				considerations for DKIM. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Using DKIM as Part of Trust Assessment <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#system">2.1.</a>&nbsp;
A Systems View of Email Trust Assessment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tagchoice">2.2.</a>&nbsp;
Choosing a DKIM Tag for the Assessment Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signname">2.3.</a>&nbsp;
Choosing the Signing Domain Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.4.</a>&nbsp;
Recipient-based Assessments<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.5.</a>&nbsp;
Filtering<br />
<a href="#anchor5">3.</a>&nbsp;
DKIM Key Generation, Storage, and Management <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
Private Key Management: Deployment and Ongoing Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
Storing Public Keys: DNS Server Software Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
Per User Signing Key Management Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#thirdpartykeymgt">3.4.</a>&nbsp;
Third Party Signer Key Management and Selector Administration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.5.</a>&nbsp;
Key Pair / Selector Lifecycle Management<br />
<a href="#anchor13">4.</a>&nbsp;
Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
DNS Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
Signing Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.</a>&nbsp;
Signing Policies and Practices<br />
<a href="#anchor17">5.</a>&nbsp;
Verifying<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.1.</a>&nbsp;
Intended Scope of Use<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.</a>&nbsp;
Signature Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.3.</a>&nbsp;
Design Scope of Use<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#inbound_mail_filtering">5.4.</a>&nbsp;
Inbound Mail Filtering<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.5.</a>&nbsp;
Messages sent through Mailing Lists and other Intermediaries<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.6.</a>&nbsp;
Generation, Transmission and Use of Results Headers<br />
<a href="#anchor24">6.</a>&nbsp;
Taxonomy of Signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#singledomainsig">6.1.</a>&nbsp;
Single Domain Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.2.</a>&nbsp;
Parent Domain Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#thirdpartysig">6.3.</a>&nbsp;
Third Party Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trustedthirdparty">6.4.</a>&nbsp;
Using Trusted Third Party Senders<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.5.</a>&nbsp;
Multiple Signatures<br />
<a href="#anchor28">7.</a>&nbsp;
Example Usage Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">7.1.</a>&nbsp;
Author's Organization - Simple<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">7.2.</a>&nbsp;
Author's Organization - Differentiated Types of Mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">7.3.</a>&nbsp;
Author Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">7.4.</a>&nbsp;
Author Domain Signing Practices<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">7.5.</a>&nbsp;
Delegated Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">7.6.</a>&nbsp;
Independent Third Party Service Providers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">7.7.</a>&nbsp;
Mail Streams Based on Behavioral Assessment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">7.8.</a>&nbsp;
Agent or Mediator Signatures<br />
<a href="#anchor40">8.</a>&nbsp;
Usage Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">8.1.</a>&nbsp;
Non-standard Submission and Delivery Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">8.2.</a>&nbsp;
Protection of Internal Mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">8.3.</a>&nbsp;
Signature Granularity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">8.4.</a>&nbsp;
Email Infrastructure Agents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">8.5.</a>&nbsp;
Mail User Agent<br />
<a href="#anchor46">9.</a>&nbsp;
Other Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">9.1.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">9.2.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor49">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
Informative References<br />
<a href="#anchor51">Appendix&nbsp;A.</a>&nbsp;
Migrating from DomainKeys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">A.1.</a>&nbsp;
Signers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">A.2.</a>&nbsp;
Verifiers<br />
<a href="#anchor59">Appendix&nbsp;B.</a>&nbsp;
General Coding Criteria for Cryptographic Applications<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> DomainKeys Identified Mail (DKIM) allows an organization to claim
		responsibility for transmitting a message, in a way that can be
		validated by a recipient. This document provides practical tips for:
		those who are developing DKIM software, mailing list managers,
		filtering strategies based on the output from DKIM verification, and
		DNS servers; those who are deploying DKIM software, keys, mailing list
		software, and migrating from DomainKeys; and those who are responsible
		for the on-going operations of an email infrastructure that has
		deployed DKIM. 
</p>
<p> The document is organized around the key concepts related to DKIM.
		Within each section, additional considerations specific to
		development, deployment, or ongoing operations are highlighted where
		appropriate. The possibility of use of DKIM results as input to a
		local reputation database is also discussed. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Using DKIM as Part of Trust Assessment </h3>

<a name="system"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
A Systems View of Email Trust Assessment</h3>

<p>DKIM participates in a trust-oriented enhancement to the Internet's
			email service, to facilitate message handling decisions, such as
			for delivery and for content display. Trust-oriented message
			handling has substantial differences from approaches that consider
			messages in terms of risk and abuse. With trust, there is a
			collaborative exchange between a willing participant along the
			sending path and a willing participant at the recipient site. In
			contrast, the risk model entails independent action by the
			recipient site, in the face of a potentially unknown, hostile and
			deceptive sender. This translates into a very basic technical
			difference: In the face of unilateral action by the recipient and
			even antagonistic efforts by the sender, risk-oriented mechanisms
			will be based on heuristics, that is, on guessing. Guessing
			produces statistical results with some false negatives and some
			false positives. For trust-based exchanges, the goal is the
			deterministic exchange of information. For DKIM, that information
			is the one identifier that represents a stream of mail for which
			an independent assessment is sought (by the signer.) 
</p>
<p>A trust-based service is built upon a validated Responsible
			Identifier that labels a stream of mail and is controlled by an
			identity (role, person or organization). The identity is
			acknowledging some degree of responsibility for the message
			stream. Given a basis for believing that an identifier is being
			used in an authorized manner, the recipient site can make and use
			an assessment of the associated identity. An identity can use
			different identifiers, on the assumption that the different
			streams might produce different assessments. For example, even the
			best-run marketing campaigns will tend to produce some complaints
			that can affect the reputation of the associated identifier,
			whereas a stream of transactional messages is likely to have a
			more pristine reputation.
</p>
<p>Determining that the identifier's use is valid is quite different
			from determining that the content of a message is valid. The
			former means only that the identifier for the responsible role,
			person or organization has been legitimately associated with a
			message. The latter means that the content of the message can be
			believed and, typically, that the claimed author of the content is
			correct. DKIM validates only the presence of the identifier used
			to sign the message. Even when this identifier is validated, DKIM
			carries no implication that any of the message content, including
			the RFC5322.From field, is valid. Surprisingly, this limit to the
			semantics of a DKIM signature applies even when the validated
			signing identifier is the same domain name as is used in the From:
			field! DKIM's only claim about message content is that the content
			cited in the DKIM-Signature: field's h&#61; tag has been
			delivered without modification. That is, it asserts message
			content integrity, not message content validity.
</p>
<p>As shown in <a class='info' href='#trustseq'>Figure&nbsp;1<span> (</span><span class='info'>Actors in a Trust Sequence using DKIM</span><span>)</span></a>, this enhancement is a communication
			between a responsible role, person or organization that signs the
			message and a recipient organization that assesses its trust in
			the signer and then makes handling decisions based on a collection
			of assessments, of which the DKIM mechanism is only a part. In
			this model, validation is an intermediary step, having the sole
			task of passing a validated Responsible Identifier to the Identity
			Assessor. The communication is of a single Responsible Identifier
			that the Responsible Identity wishes to have used by the Identity
			Assessor. The Identifier is the sole, formal input and output
			value of DKIM signing. The Identity Assessor uses this single,
			provided Identifier for consulting whatever assessment data bases
			are deemed appropriate by the assessing entity. In turn, output
			from the Identity Assessor is fed into a Handling Filter engine
			that considers a range of factors, along with this single output
			value; the range of factors can include ancillary information from
			the DKIM validation.
</p>
<p>Identity Assessment covers a range of possible functions. It can be
			as simple as determining whether the identifier is a member of
			some list, such as authorized operators or participants in a group
			that might be of interest for recipient assessment. Equally, it
			can indicate a degree of trust (reputation) that is to be afforded
			the actor using that identifier. The extent to which the
			assessment affects handling of the message is, of course,
			determined later, by the Handling Filter.
</p><br /><hr class="insert" />
<a name="trustseq"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
  +------+------+                            +------+------+
  |   Author    |                            |  Recipient  |
  +------+------+                            +------+------+
         |                                          ^
         |                                          |
         |                                   +------+------+
         |                                --&gt;|  Handling   |&lt;--
         |                                --&gt;|   Filter    |&lt;--
         |                                   +-------------+
         |                                          ^
         V                  Responsible             |
  +-------------+           Identifier       +------+------+
  | Responsible |. .       . . . . . . . . .&gt;|  Identity   |
  |  Identity   |  .       .                 |  Assessor   |
  +------+------+  .       .                 +-------------+
         |         .       .                       ^ ^
         V         .       .                       | |
+------------------.-------.--------------------+  | |
| +------+------+  . . . . .   +-------------+  |  | |  +-------------+
| | Identifier  |              |  Identifier +--|--+ +--+ Assessment  |
| |   Signer    +-------------&gt;|  Validator  |  |       | Databases   |
| +-------------+              +-------------+  |       +-------------+
|                 DKIM Service                  |
+-----------------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Actors in a Trust Sequence using DKIM&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="tagchoice"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Choosing a DKIM Tag for the Assessment Identifier</h3>

<p>The signer of a message needs to be able to provide precise data
			and know what that data will mean upon delivery to the Assessor.
			If there is ambiguity in the choice that will be made on the
			receive side, then the sender cannot know what basis for
			assessment will be used. DKIM has three values that specify
			identification information and it is easy to confuse their use,
			although only one defines the formal input and output of DKIM,
			with the other two being used for internal protocol functioning
			and adjunct purposes, such as auditing and debugging. 
</p>
<p>The salient values include the s&#61;, d&#61; and
			i&#61; parameters in the DKIM-Signature: header field. In
			order to achieve the end-to-end determinism needed for this
			collaborative exchange from the signer to the assessor, the core
			model needs to specify what the signer is required to provide to
			the assessor. The Update to RFC4871 <a class='info' href='#rfc4871-update'>[rfc4871&#8209;update]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; April&nbsp;2009.</span><span>)</span></a>now specifies:</p>
<blockquote class="text">
<p>DKIM's primary task is to communicate from the Signer to a
					recipient-side Identity Assessor a single Signing Domain
					Identifier (SDID) that refers to a responsible identity.
					DKIM MAY optionally provide a single responsible Agent or
					User Identifier (AUID)... A receive-side DKIM verifier
					MUST communicate the Signing Domain Identifier (d=) to a
					consuming Identity Assessor module and MAY communicate the
					User Agent Identifier (i=) if present.... To the extent
					that a receiver attempts to intuit any structured
					semantics for either of the identifiers, this is a
					heuristic function that is outside the scope of DKIM's
					specification and semantics.
</p>
</blockquote>

<p>The single, mandatory value that DKIM supplies as its output is:</p>
<blockquote class="text">
<p>
					</p>
<blockquote class="text"><dl>
<dt>d&equals;  </dt>
<dd>This specifies the
							"domain of the signing entity." It is a domain
							name and is combined with the Selector to form a
							DNS query... A receive-side DKIM verifier MUST
							communicate the Signing Domain Identifier (d=) to
							a consuming Identity Assessor module and MAY
							communicate the User Agent Identifier (i=) if
							present.
</dd>
</dl></blockquote>
				

</blockquote><p>
		
</p>
<p>The adjunct values are:</p>
<blockquote class="text">
<p>
					</p>
<blockquote class="text"><dl>
<dt>s&equals;  </dt>
<dd>This tag specifies the
							Selector. It is used to discriminate among
							different keys that can be used for the same
							d&#61; domain name. As discussed in Section
							4.3 of <a class='info' href='#I-D.ietf-dkim-overview'>[I&#8209;D.ietf&#8209;dkim&#8209;overview]<span> (</span><span class='info'>Hansen, T., Crocker, D., and P. Hallam-Baker, &ldquo;DomainKeys Identified Mail (DKIM) Service Overview,&rdquo; July&nbsp;2008.</span><span>)</span></a>: "If
							verifiers were to employ the selector as part of a
							name assessment mechanism, then there would be no
							remaining mechanism for making a transition from
							an old, or compromised, key to a new one."
							Consequently, the Selector is not appropriate for
							use as part or all of the identifier used to make
							assessments.
</dd>
<dt>i&equals;  </dt>
<dd>This tag is optional
							and provides the "[i]dentity of the user or agent
							(e.g., a mailing list manager) on behalf of which
							this message is signed." The identity can be in
							the syntax of an entire email address or only a
							domain name. The domain name can be the same as
							for d= or it can be a sub-name of the
							d&#61; name.
</dd>
<dt></dt>
<dd>NOTE: Although the i&#61; identity has the
							syntax of an email address, it is not required to
							have that semantics. That is, "the identity of the
							user" need not be the same as the user's mailbox.
							For example the signer might wish to use
							i&#61; to encode user-related audit
							information, such as how they were accessing the
							service at the time of message posting. Therefore
							it is not possible to conclude anything from the
							i&#61; string's (dis)similarity to email
							addresses elsewhere in the header
</dd>
</dl></blockquote>
				

</blockquote><p>
		
</p>
<p>So, i&#61; can have any of these properties: </p>
<blockquote class="text">
<p>
					</p>
<ul class="text">
<li>Be a valid domain when it is the same as
							d&#61;
</li>
<li>Appear to be a sub-domain of d&#61; but
							might not even exist
</li>
<li>Look like a mailbox address but might have
							different semantics and therefore not function as
							a valid email address
</li>
<li>Be unique for each message, such as indicating
							access details of the user for the specific
							posting
</li>
</ul>
				

</blockquote><p> This underscores why the tag needs to be treated as being
			opaque, since it can represent any semantics, known only to the
			signer.
</p>
<p>Hence, i&#61; serves well as a token that is usable like a
			Web cookie, for return to the signing ADMD -- such as for auditing
			and debugging. Of course in some scenarios the i&#61;
			string might provide a useful adjunct value for additional
			(heuristic) processing by the Handling Filter.
</p>
<a name="signname"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Choosing the Signing Domain Name</h3>

<p>A DKIM signing entity can serve different roles, such as author of
			content, versus operator of the mail service, versus operator of a
			reputation service. In these different roles, the basis for
			distinguishing among portions of email traffic can vary. For an
			entity creating DKIM signatures it is likely that different
			portions of its mail will warrant different levels of trust. For
			example: </p>
<blockquote class="text">
<p>
					</p>
<ul class="text">
<li>Mail is sent for different purposes, such as
							marketing vs. transactional, and recipients
							demonstrate different patterns of acceptance
							between these.
</li>
<li>For an operator of an email service, there often
							are distinct sub-populations of users warranting
							different levels of trust or privilege, such as
							paid vs. free users, or users engaged in direct
							correspondence vs. users sending bulk mail.
</li>
<li>Mail originating outside an operator's system, such
							as when it is redistributed by a mailing list
							service run by the operator, will warrant a
							different reputation from mail submitted by users
							authenticated with the operator.
</li>
</ul>
				

</blockquote><p>It is therefore likely to be useful for a signer to use
			different d&#61; sub-domain names, for different message
			traffic streams, so that receivers can make differential
			assessments. However, too much differentiation -- that is, too
			fine a granularity of signing domains -- makes it difficult for
			the receiver to discern a sufficiently stable pattern of traffic
			for developing an accurate and reliable assessment. So the
			differentiation needs to achieve a balance. Generally in a trust
			system, legitimate signers have an incentive to pick a small
			stable set of identities, so that recipients and others can
			attribute reputations to them. The set of these identities a
			receiver trusts is likely to be quite a bit smaller than the set
			it views as risky. 
</p>
<p>The challenge in using additional layers of sub-domains is whether
			the extra granularity will be useful for the assessor. In fact,
			potentially excessive levels invites ambiguity: if the assessor
			does not take advantage of the added granularity, then what
			granularity will it use? That ambiguity would move the use of DKIM
			back to the realm of heuristics, rather than the deterministic
			processing that is its goal. 
</p>
<p>Hence the challenge is to determine a useful scheme for labeling
			different traffic streams. The most obvious choices are among
			different types of content and/or different types of authors.
			Although stability is essential, it is likely that the choices
			will change, over time, so the scheme needs to be flexible. 
</p>
<p>For those originating message content, the most likely choice of
			sub-domain naming scheme will by based upon type of content, which
			can use content-oriented labels or service-oriented labels. For example:</p>
<blockquote class="text">
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>transaction.example.com
newsletter.example.com
bugreport.example.com
support.example.com
sales.example.com
marketing.example.com</pre></div><p>

				
</p>
</blockquote><p> where the choices are best dictated by whether they
			provide the Identity Assessor with the ability to discriminate
			usefully among streams of mail that demonstrate significantly
			different degrees of recipient acceptance or safety. Again, the
			danger in providing too fine a granularity is that related message
			streams that are labeled separately will not benefit from an
			aggregate reputation. 
</p>
<p>For those operating messaging services on behalf of a variety of
			customers, an obvious scheme to use has a different sub-domain
			label for each customer. For example:</p>
<blockquote class="text">
<p>
					</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>widgetco.example.net
moviestudio.example.net
bigbank.example.net</pre></div><p>

				
</p>
</blockquote><p> However it can also be appropriate to label by the class
			of service or class of customer, such as:</p>
<blockquote class="text">
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>premier.example.net
free.example.net
certified.example.net</pre></div><p>

				
</p>
</blockquote><p>
		
</p>
<p>Prior to using domain names for distinguishing among sources of
			data, IP Addresses have been the basis for distinction. Service
			operators typically have done this by dedicating specific outbound
			IP Addresses to specific mail streams -- typically to specific
			customers. For example, a university might want to distinguish
			mail from the Administration, versus mail from the student dorms.
			In order to make adoption of a DKIM-based service easier, it can
			be reasonable to translate the same partitioning of traffic, using
			domain names in place of the different IP Addresses. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Recipient-based Assessments</h3>

<p>DKIM gives the recipient site's Identity Assessor a verifiable
			identifier to use for analysis. Although the mechanism does not
			make claims that the signer is a Good Actor or a Bad Actor, it
			does make it possible to know that use of the identifier is valid.
			This is in marked contrast with schemes that do not have
			authentication. Without verification, it is not possible to know
			whether the identifier -- whether taken from the RFC5322.From
			field, RFC5321.MailFrom command, or the like -- is being used by
			an authorized agent. DKIM solves this problem. Hence with DKIM,
			the Assessor can know that two messages with the same DKIM
			d&#61; identifier are, in fact, signed by the same person
			or organization. This permits a far more stable and accurate
			assessment of mail traffic using that identifier.
</p>
<p>DKIM is distinctive, in that it provides an identifier which is not
			necessarily related to any other identifier in the message. Hence,
			the signer might be the author's ADMD, one of the operators along
			the transit path, or a reputation service being used by one of
			those handling services. In fact, a message can have multiple
			signatures, possibly by any number of these actors. 
</p>
<p>As discussed above, the choice of identifiers needs to be based on
			differences that the signer thinks will be useful for the
			recipient Assessor. Over time, industry practices establish norms
			for these choices. </p>
<blockquote class="text">
<p>Absent such norms, it is best for signers to distinguish
					among streams that have significant differences, while
					consuming the smallest number of identifiers possible.
					This will limit the burden on recipient Assessors.
</p>
</blockquote>

<p>A common view about a DKIM signature is that it carries a degree of
			assurance about some or all of the message contents, and in
			particular that the RFC5322.From field is likely to be valid. In
			fact, DKIM makes assurances only about the integrity of the data
			and not about its validity. Still, presumptions of From: field
			validity remain a concern. Hence a signer using a domain name that
			is unrelated to the domain name in the From: field can reasonably
			expect that the disparity will warrant some curiosity, at least
			until signing by independent operators has produced some
			established practice among recipient Assessors. 
</p>
<p>With the identifier(s) supplied by DKIM, the Assessor can consult
			an independent assessment service about the entity associated with
			the identifier(s). Another possibility is that the Assessor can
			develop its own reputation rating for the identifier(s). That is,
			over time, the Assessor can observe the stream of messages
			associated with the identifier(s) developing a reaction to
			associated content. For example, if there is a high percentage of
			user complaints regarding signed mail with a "d=" value of
			"widgetco.example.net", the Assessor might include that fact in
			the vector of data it provides to the Handling Filter. This is
			also discussed briefly in <a class='info' href='#inbound_mail_filtering'>Section&nbsp;5.4<span> (</span><span class='info'>Inbound Mail Filtering</span><span>)</span></a>.
		
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Filtering</h3>

<p>After assessing the signer of a message, each receiving site
			creates and tunes its own Handling Filter according to criteria
			specific for that site. Still, there are commonalities across
			sites, and this section offers a discussion, rather than a
			specification, of some types of input to that process and how they
			can be used. 
</p>
<p>The discussion focuses on variations in Organizational Trust versus
			Message Risk, that is, the degree of positive assessment of a
			DKIM-signing organization, and the potential danger present in the
			message stream signed by that organization. While it might seem
			that higher trust automatically means lower risk, the experience
			with real-world operations provides examples of every combination
			of the two factors, as shown in <a class='info' href='#trustrisk'>Table&nbsp;1<span> (</span><span class='info'>Organizational Trust vs. Message Risk</span><span>)</span></a>. Only three levels of granularity are
			listed, in order to keep discussion manageable. This also ensures
			extensive flexibility for each site's detailed choices.
</p><br /><hr class="insert" />
<a name="trustrisk"></a>

<p style='text-align: center'> 
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left" width="33%"><col align="left" width="33%"><col align="left" width="33%">
<tr><th align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORG&nbsp;TRUST 
				MSG&nbsp;RISK&nbsp;&nbsp;&nbsp;\</th><th align="left">Low</th><th align="left">Medium</th><th align="left">High</th></tr>
<tr>
<td align="left">
				<strong>Low</strong>
			</td>
<td align="left">Unknown&nbsp;org, Few&nbsp;msgs:&nbsp; <em>Mild&nbsp;filtering</em></td>
<td align="left">Registered&nbsp;org, New&nbsp;Identifier:&nbsp; <em>Medium&nbsp;filtering</em></td>
<td align="left">Good&nbsp;Org, Good&nbsp;msgs:&nbsp; <em>Avoid&nbsp;FP(!)</em></td>
</tr>
<tr>
<td align="left">
				<strong>Medium</strong>
			</td>
<td align="left">Unknown&nbsp;org, New&nbsp;Identifier:&nbsp; <em>Default&nbsp;filtering</em></td>
<td align="left">Registered&nbsp;org, Mixed&nbsp;msgs:&nbsp; <em>Medium&nbsp;filtering</em></td>
<td align="left">Good&nbsp;org, Bad&nbsp;msg burst:&nbsp; <em>Accept&nbsp;&amp;&nbsp;Contact</em></td>
</tr>
<tr>
<td align="left">
				<strong>High</strong>
			</td>
<td align="left">Black&#8209;Listed&nbsp;org,
				Bad&nbsp;msgs:&nbsp; <em>Avoid&nbsp;FN(!)</em></td>
<td align="left">Registered&nbsp;org, Bad&nbsp;msgs:&nbsp; <em>Strong&nbsp;filtering</em></td>
<td align="left">Good&nbsp;org, Compromised:&nbsp; <em>Fully&nbsp;blocked</em></td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Organizational Trust vs. Message Risk&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The table indicates preferences for different handling of different
			combinations, such as tuning filtering to avoid False Positives
			(FP) or avoiding False Negatives (FN). Perhaps unexpectedly, it
			also lists a case in which the receiving site might wish to
			deliver problematic mail, rather than redirecting it, but also of
			course contacting the signing organization, seeking resolution of
			the problem.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
DKIM Key Generation, Storage, and Management </h3>

<p>
    By itself, verification of a digital signature only allows the verifier to conclude with a very high degree of certainty that the signature was created by a party with access to the corresponding private signing key.
    It follows that a verifier requires means to (1) obtain the public key for the purpose of verification and (2) infer useful attributes of the key holder.
  
</p>
<p>
    In a traditional Public Key Infrastructure (PKI), the functions of key distribution and key accreditation are separated.
    In DKIM <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>, these functions are both performed through the DNS.
  
</p>
<p>
    In either case, the ability to infer semantics from a digital signature depends on the assumption that the corresponding private key is only accessible to a party with a particular set of attributes.
    In traditional PKI, a Trusted Third Party (TTP) vouches that the key holder has been validated with respect to a specified set of attributes.
    The range of attributes that may be attested in such a scheme is thus limited only to the type of attributes that a TTP can establish effective processes for validating.
    In DKIM, Trusted Third parties are not employed and the functions of key distribution and accreditation are combined.
  
</p>
<p>
    Consequently there are only two types of inference that a signer may make from a key published in a DKIM Key Record:
  
</p>
<p>
    </p>
<ol class="text">
<li>That a party with the ability to control DNS records within a DNS zone intends to claim responsibility for messages signed using the corresponding private signature key.
</li>
<li>That use of a specific key is restricted to the particular subset of messages identified by the selector.
</li>
</ol><p>
  
</p>
<p>
    The ability to draw any useful conclusion from verification of a digital signature relies on the assumption that the corresponding private key is only accessible to a party with a particular set of attributes. In the case of DKIM, this means that the party that created the corresponding DKIM key record in the specific zone intended to claim responsibility for the signed message.
  
</p>
<p>
    Ideally we would like to draw a stronger conclusion, that if we obtain a DKIM key record from the DNS zone example.com, that the legitimate holder of the DNS zone example.com claims responsibility for the signed message. In order for this conclusion to be drawn it is necessary for the verifier to assume that the operational security of the DNS zone and corresponding private key are adequate.
  
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Private Key Management: Deployment and Ongoing Operations</h3>

<p>
      Access to signing keys MUST be carefully managed to prevent use by unauthorized parties and to minimize the consequences if a compromise were to occur.
    
</p>
<p>
      While a DKIM signing key is used to sign messages on behalf of many mail users,
      the signing key itself SHOULD be under direct control of as few key holders as possible.
      If a key holder were to leave the organization, all signing keys held by that key holder
      SHOULD be withdrawn from service and if appropriate, replaced.
    
</p>
<p>
      If key management hardware support is available, it SHOULD be used.
      If keys are stored in software, appropriate file control protections MUST be employed,
      and any location in which the private key is stored in plaintext form SHOULD be excluded
      from regular backup processes and SHOULD not be accessible through any form of network
      including private local area networks.
      Auditing software SHOULD be used periodically to verify that the permissions on the private key files remain secure.
    
</p>
<p>
      Wherever possible a signature key SHOULD exist in exactly one location and be erased when no longer used.
      Ideally a signature key pair SHOULD be generated as close to the signing point as possible and only the public key component transferred to another party.
      If this is not possible, the private key MUST be transported in an encrypted format that protects the confidentiality of the signing key.
      A shared directory on a local file system does not provide adequate security for distribution of signing keys in plaintext form.
    
</p>
<p>
      Key escrow schemes are not necessary and SHOULD NOT be used.
      In the unlikely event of a signing key becomming lost, a new signature key pair may be generated as easily as recovery from a key escrow scheme.
    
</p>
<p>
      To enable accountability and auditing:
      </p>
<ul class="text">
<li>
	  Responsibility for the security of a signing key SHOULD ultimately vest in a single named individual.
	  
</li>
<li>
	  Where multiple parties are authorized to sign messages, each signer SHOULD use a different key to enable accountability and auditing.
	  
</li>
</ul><p>
    
</p>
<p>
      Best practices for management of cryptographic keying material require keying material to be refreshed at regular intervals, particularly where key management is achieved through software.
      While this practice is highly desirable it is of considerably less importance than the requirement to maintain the secrecy of the corresponding private key.
      An operational practice in which the private key is stored in tamper proof hardware and changed once a year is considerably more desirable than one in which the signature key is changed on an hourly basis but maintained in software.
      
    
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Storing Public Keys: DNS Server Software Considerations</h3>

<p>
      In order to use DKIM a DNS domain holder requires (1) the ability to create the necessary DKIM DNS records and (2) sufficient operational security controls to prevent insertion of spurious DNS records by an attacker.
    
</p>
<p>
      DNS record management is often operated by an administrative staff that is different from those who operate an organization's email service.
      In order to ensure that DKIM DNS records are accurate, this imposes a requirement for careful coordination between the two operations groups.
      If the best practices for private key management described above are observed, such deployment is not a one time event;
      DNS DKIM selectors will be changed over time signing keys are terminated and replaced.
    
</p>
<p>
      At a minimum, a DNS server that handles queries for DKIM key records MUST allow the server administrators to add free-form TXT records.
      It would be better if the the DKIM records could be entered using a structured form, supporting the DKIM-specific fields.
    
</p>
<p>
      Ideally DNSSEC <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> SHOULD be employed in a configuration that provides protection against record insertion attacks and zone enumeration.
      In the case that NSEC3 <a class='info' href='#RFC5155'>[RFC5155]<span> (</span><span class='info'>Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;DNS Security (DNSSEC) Hashed Authenticated Denial of Existence,&rdquo; March&nbsp;2008.</span><span>)</span></a> records are employed to prevent insertion attack, the OPT-OUT flag MUST be set clear.
    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Assignment of Selectors</h3>

<p>
        Selectors are assigned according to the administrative needs of the signing domain, such as for rolling over to a new key or for delegating of the right to authenticate a portion of the namespace to a trusted third party.
	Examples include:
      
</p>
<p>
        jun2005.eng._domainkey.example.com
      
</p>
<p>
        widget.promotion._domainkey.example.com
      
</p>
<p>
        It is intended that assessments of DKIM identities be based on the domain name, and not include the selector.
	While past practice of a signer may permit a verifier to infer additional properties of particular messages from the structure DKIM key selector, unannounced administrative changes such as a change of signing softeware may cause such heuristics to fail at any time.
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Per User Signing Key Management Issues</h3>

<p>
      While a signer may establish business rules, such as issue of individual signature keys for each end-user, DKIM makes no provision for communicating these to other parties.
      Out of band distribution of such business rules is outside the scope of DKIM.
      Consequently there is no means by which external parties may make use of such keys to attribute messages with any greater granularity than a DNS domain.
    
</p>
<p>
      If per-user signing keys are assigned for internal purposes (e.g. authenticating messages sent to an MTA for distribution), the following issues need to be considered before using such signatures as an alternative to traditional edge signing at the outbound MTA:
    
</p>
<p>
      </p>
<blockquote class="text">
<p>External verifiers will be unable to make use of the additional signature granularity without access to additional information passed out of band with respect to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<p>If the number of user keys is large, the efficiency of local caching of key records by verifiers will be lower.
</p>
<p>A large number of end users may be less likely to be able to manage private key data securely on their personal computer than an administrator running an edge MTA.
</p>
</blockquote><p>
    
</p>
<a name="thirdpartykeymgt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Third Party Signer Key Management and Selector Administration</h3>

<p>
      A DKIM key record only asserts that the holder of the corresponding domain name makes a claim of responsibility for messages signed under the corresponding key.
      In some applications, such as bulk mail delivery, it is desirable to delegate the ability to make a claim of responsibility to another party.
      In this case the trust relationship is established between the domain holder and the verifier but the private signature key is held by a third party.
    
</p>
<p>
      Signature keys used by a third party signer SHOULD be kept entirely separate from those used by the domain holder and other third party signers.
      To limit potential exposure of the private key, the signature key pair SHOULD be generated by the third party signer and the public component of the key transmitted to the domain holder,
      rather than have the domain holder generate the key pair and transmit the private component to the third party signer.
    
</p>
<p>
      Domain holders SHOULD adopt a least privilege approach and grant third party signers the minimum access necessary to perform the desired function.
      Limiting the access granted to Third Party Signers serves to protect the interests of both parties.
      The domain holder minimizes its security risk and the Trusted Third Party Signer avoids unnecessary liability.
    
</p>
<p>
      In the most restrictive case a domain holder maintains full control over the creation of key records and employs appropriate key record restrictions to enforce restrictions on the messages for which the third party signer is able to sign.
      If such restrictions are impractical, the domain holder SHOULD delegate a DNS subzone for publishing key records to the third party signer.
      The domain holder SHOULD not allow a third party signer unrestricted access to its DNS service for the purpose of publishing key records.
    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Key Pair / Selector Lifecycle Management</h3>

<p>
      Deployments SHOULD establish, document and observe processes for managing the entire lifecycle of a public key pair.
    
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Example Key Deployment Process</h3>

<p>
        When it is determined that a new key pair is required:
      
</p>
<p>
        </p>
<ol class="text">
<li>
            A Key Pair is generated by the signing device.
          
</li>
<li>
            A proposed key selector record is generated and transmitted to the DNS administration infrasrtructure.
          
</li>
<li>
            The DNS administration infrastructure verifies the authenticity of the key selector registration request.
	    If accepted
            
<ol class="text">
<li>
                A key selector is assigned.
              
</li>
<li>
                The corresponding key record published in the DNS.
              
</li>
<li>
                Wait for DNS updates to propagate (if necessary).
              
</li>
<li>
                Report assigned key selector to signing device.
              
</li>
</ol>
          
</li>
<li>
            Signer verifies correct registration of the key record.
          
</li>
<li>
            Signer begins generating signatures using the new key pair.
          
</li>
<li>
            Signer terminates any private keys that are no longer required due to issue of replacement.
          
</li>
</ol><p>
      
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
Example Key Termination Process</h3>

<p>
	When it is determined that a private signature key is no longer required:
      
</p>
<p>
        </p>
<ol class="text">
<li>
            Signer stops using the private key for signature operations.
          
</li>
<li>
            Signer deletes all records of the private key, including in-memory copies at the signing device.
          
</li>
<li>
            Signer notifies the DNS administration infrasrtructure that the signing key is withdrawn from
            service and that the corresponding key records may be withdrawn from service at a specified future date.
          
</li>
<li>
            The DNS administration infrastructure verifies the authenticity of the key selector termination request.
	    If accepted,
            
<ol class="text">
<li>
                The key selector is scheduled for deletion at a future time determined by site policy.
              
</li>
<li>
                Wait for deletion time to arrive.
              
</li>
<li>
		The signer either publishes a revocation key selector with an empty "p=" field, or deletes the key selector record entirely.
	      
</li>
</ol>
          
</li>
<li>
	    As far as the verifier is concerned, there is no functional difference between verifying against a key selector with
	    an empty "p=" field, and verifying against a missing key selector:
	    both result in a failed signature and the signature should be treated as if it had not been there.
	    However, there is a minor semantic difference: with the empty "p=" field, the signer is explicitly stating that the key has been revoked.
	    The empty "p=" record provides a gravestone for an old selector, making it less likely that the selector might be accidently reused
	    with a different public key.
	  
</li>
</ol><p>
      
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Signing</h3>

<p>Creating messages that have one or more DKIM signatures,
			  requires support in only two outbound email service
			  components: </p>
<ul class="text">
<li>A DNS Administrative interface that can create and
			      maintain the relevant DNS
			      names&nbsp;&#8209;&#8209; including names
			      with underscores&nbsp;&#8209;&#8209; and
			      resource records (RR).
</li>
<li>A trusted module, called the Signing Module, which is
			      within the organization's outbound email handling
			      service and which creates and adds the DKIM-Signature:
			      header field(s) to the message.
</li>
</ul><p> If the module creates more than one signature, there
			  needs to be the appropriate means of telling it which one(s)
			  to use. If a large number of names is used for signing, it
			  will help to have the administrative tool support a batch
			  processing mode.
			
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DNS Records</h3>

<p>A receiver attempting to verify a DKIM signature obtains
			    the public key that is associated with the signature for
			    that message. The DKIM-Signature: header in the message
			    contains the d&#61; tag with the basic domain name
			    doing the signing and serving as output to the Identity
			    Assessor, and the s&#61; tag with the selector that
			    is added to the name, for finding the specific public key.
			    Hence, the relevant
			    &lt;selector&gt;._domainkey.&lt;domain-name&gt;
			    DNS record needs to contain a DKIM-related RR that
			    provides the public key information. 
</p>
<p>The administrator of the zone containing the relevant
			    domain name adds this information. Initial DKIM DNS
			    information is contained within TXT RRs. DNS
			    administrative software varies considerably in its
			    abilities to support DKIM names, such as with underscores,
			    and to add new types of DNS information. 
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Signing Module</h3>

<p>The module doing signing can be placed anywhere within an
			    organization's trusted Administrative Management Domain
			    (ADMD); obvious choices include department-level posting
			    agents, as well as outbound boundary MTAs to the open
			    Internet. However any other module, including the author's
			    MUA, is potentially acceptable, as long as the signature
			    survives any remaining handling within the ADMD. Hence the
			    choice among the modules depends upon software
			    development, administrative overhead, security exposures
			    and transit handling tradeoffs. One perspective that helps
			    to resolve this choice is the difference between the
			    increased flexibility, from placement at (or close to) the
			    MUA, versus the streamlined administration and operation,
			    that is more easily obtained by implementing the mechanism
			    "deeper" into the organization's email infrastructure,
			    such as at its boundary MTA. 
</p>
<p>Note the discussion in <a class='info' href='#tagchoice'>Section&nbsp;2.2<span> (</span><span class='info'>Choosing a DKIM Tag for the Assessment Identifier</span><span>)</span></a>, concerning use of the
			    i&#61; tag.
</p>
<p>The signing module uses the appropriate private key to
			    create one or more signatures. The means by which the
			    signing module obtains the private key(s) is not specified
			    by DKIM. Given that DKIM is intended for use during email
			    transit, rather than for long-term storage, it is expected
			    that keys will be changed regularly. For administrative
			    convenience, key information SHOULD NOT be hard-coded into
			    software.
			  
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Signing Policies and Practices</h3>

<p>Every organization (ADMD) will have its own policies and
			    practices for deciding when to sign messages (message
			    stream) and with what domain name, selector and key.
			    Examples of particular message streams include all mail
			    sent from the ADMD, versus mail from particular types of
			    user accounts, versus mail having particular types of
			    content. Given this variability, and the likelihood that
			    signing practices will change over time, it will be useful
			    to have these decisions represented through run-time
			    configuration information, rather than being hard-coded
			    into the signing software.
</p>
<p>As noted in <a class='info' href='#signname'>Section&nbsp;2.3<span> (</span><span class='info'>Choosing the Signing Domain Name</span><span>)</span></a>, the choice of signing name
			    granularity requires balancing administrative convenience
			    and utility for recipients. Too much granularity is higher
			    administrative overhead and well might attempt to impose
			    more differential analysis on the recipient than they wish
			    to support. In such cases, they are likely to use only a
			    super-name -- right-hand substring -- of the signing name.
			    When this occurs, the signer will not know what portion is
			    being used; this then moves DKIM back to the
			    non-deterministic world of heuristics, rather than the
			    mechanistic world of signer/recipient collaboration that
			    DKIM seeks.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Verifying</h3>

<p>
        A message recipient may verify a DKIM signature to determine if a claim of
        responsibility has been made for the message by a trusted domain.
    
</p>
<p>
        Access control requires two components: authentication and authorization.
	By design, verification of a DKIM signature only provides the authentication component of
        an access control decision and MUST be combined with additional sources of 
        information such as reputation data to arrive at an access control decision.
    
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Intended Scope of Use</h3>

<p>
            DKIM requires that a message with a signature that is found to be invalid is to be
            treated as if the message had not been signed at all.
        
</p>
<p>
            If a DKIM signature fails to verify, it is entirely possible that the
            message is valid and that either there is a configuration error in the signer's
            system (e.g. a missing key record) or that the message was inadvertently modified
            in transit.
	    It is thus undesirable for mail infrastructure to treat messages with
            invalid signatures less favorably than those with no signatures whatsoever.
	    Contrariwise, creation of an invalid signature requires a trivial amount of effort on the part
            of an attacker.
	    If messages with invalid signatures were to be treated preferentially to
            messages with no signatures whatsoever, attackers will simply add invalid signature
            blocks to gain the preferential treatment.
	    It follows that messages with invalid
            signatures SHOULD be treated no better and no worse than those with no signature at all.
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Signature Scope</h3>

<p>
        As with any other digital signature scheme, verifiers MUST only consider the part
        of the message that is inside the scope of the message as being authenticated 
        by the signature.
        
</p>
<p>
        For example, if the l= option is employed to specify a content length for the
        scope of the signature, only the part of the message that is within the scope of 
        the content signature would be considered authentic. 
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Design Scope of Use</h3>

<p>
            Public Key cryptography provides an exceptionally high degree of assurance, bordering
            on absolute certainty, that the party that created a valid digital signature had
            access to the private key corresponding to the public key indicated in the signature.
        
</p>
<p>
            In order to make useful conclusions from the verification of a valid digital signature,
            the verifier is obliged to make assumptions that fall far short of absolute certainty.
            Consequently, mere validation of a DKIM signature does not represent proof positive
            that a valid claim of responsibility was made for it by the indicated party, that the
            message is authentic, or that the message is not abusive.
	    In particular:
        
</p>
<p>
            </p>
<ul class="text">
<li>The legitimate private key holder may have lost control of its private key.
</li>
<li>
                    The legitimate domain holder may have lost control of the DNS server for the
                    zone from which the key record was retrieved.
                
</li>
<li>
                    The key record may not have been delivered from the legitimate DNS server for
                    the zone from which the key record was retrieved.
                
</li>
<li>Ownership of the DNS zone may have changed.
</li>
</ul><p>
        
</p>
<p>
            In practice these limitations have little or no impact on the field of use for
            which DKIM is designed but may have a bearing if use is made of the DKIM message
            signature format or key retrieval mechanism in other specifications.
        
</p>
<p>
            In particular the DKIM key retrieval mechanism is designed for ease of use and 
            deployment rather than to provide a high assurance Public Key Infrastructure
            suitable for purposes that require robust non-repudiation such as establishing 
            legally binding contracts.
	    Developers seeking to extend DKIM beyond its design
            application SHOULD consider replacing or supplementing the DNS key retreival 
            mechanism with one that is designed to meet the intended purposes.
	    
	    


        
</p>
<a name="inbound_mail_filtering"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Inbound Mail Filtering</h3>

<p>
            DKIM is frequently employed in a mail filtering strategy to avoid 
            performing content analysis on email originating from trusted sources.
	    Messages that carry a valid DKIM signature from a trusted source may be whitelisted, 
            avoiding the need to perform computation and hence energy intensive content
            analysis to determine the disposition of the message.
            
        
</p>
<p>
            Mail sources may be determined to be trusted by means of previously observed 
            behavior and/or reference to external reputation or accreditation services.
            The precise means by which this is acomplished is outside the scope of DKIM.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Non-Verifying Adaptive Spam Filtering Systems</h3>

<p>
                Adaptive (or learning) spam filtering mechanisms that are not capable of 
                verifying DKIM signatures SHOULD at minimum be configured to ignore DKIM 
                header data entirely. 
            
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Messages sent through Mailing Lists and other Intermediaries</h3>

<p>
            Intermediaries such as mailing lists pose a particular challenge for
            DKIM implementations as the message processing steps performed by
            the intermediary may cause the message content to change in ways that 
            prevent the signature passing verification.
        
</p>
<p>
            Such intermediaries are strongly encouraged to deploy DKIM signing 
            so that a verifiable claim of responsibility remains available to 
            parties attempting to verify the modified message.
        
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Generation, Transmission and Use of Results Headers</h3>

<p>
          In many deployments it is desirable to separate signature verification from the 
          application relying on the verification.
	  A system may choose to relay information indicating the results of its message authentication efforts
	  using various means; adding a "results header" to the message is one such mechanism. <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
	  For example, consider the cases where:
        
</p>
<p>
            </p>
<ul class="text">
<li>The application relying on DKIM signature verification is not capable of performing the verification.
</li>
<li>The message may be modified after the signature verification is performed.
</li>
<li>The signature key may not be available by the time that the message is read.
</li>
</ul><p>
        
</p>
<p>
        In such cases it is important that the communication link between the signature verifier and 
        the relying application be sufficiently secure to prevent insertion of a message that carries
        a bogus results header.
        
</p>
<p>
        An intermediary that generates results headers SHOULD ensure that relying applications are
        able to distinguish valid results headers issued by the intermediary from those introduced 
        by an attacker.
	For example, this can be accomplished by signing the results header.
	At a minimum, results headers on incoming messages SHOULD be removed if they purport to have
	been issued by the intermediary but cannot be verified as authentic.
        
</p>
<p>
	  Further discussion on trusting the results as relayed from a verifier to something downstream can be found in <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
	
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Taxonomy of Signatures</h3>

<p> A DKIM signature tells the signature verifier that the owner
    of a particular domain name accepts some responsibility for
    the message. It does not, in and of itself, provide any
    information about the trustworthiness or behavior of that
    identity. What it does provide is a
    verified identity to which such behavioral information can be
    associated, so that those who collect and use such information
    can be assured that it truly pertains to the identity in
    question. 
</p>
<p> This section lays out a taxonomy of some of the different
    identities, or combinations of identities, that might usefully
    be represented by a DKIM signature. 
</p>
<a name="singledomainsig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Single Domain Signature</h3>

<p>Perhaps the simplest case is when an organization signs its own
      outbound email using its own domain in the SDID (<a class='info' href='#rfc4871-update'>[rfc4871&#8209;update]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; April&nbsp;2009.</span><span>)</span></a>) of the signature. For 
      example, Company A would sign the outbound mail from its employees
      with d=companyA.example. 
    
</p>
<p>
      In the most straightforward configuration, the addresses in the RFC 5322 From
      would also be in the companyA.example domain, but that direct correlation is 
      not required. 
    
</p>
<p>A special case of the Single Domain Signature is an Author Signature as
      defined by the Author Domain Signing Practices specification 
      (<a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a>).
      Author signatures are signatures from an
      author's organization that have an SDID value that matches that of an RFC5322 From: address 
      of the signed  message. 
</p>
<p>Although an author signature might in some cases be proof against spoofing
      the domain name of the RFC 5322 From address, it is important to note
      that the DKIM and ADSP validation apply only to the exact address
      string and not to look-alike addresses nor to the
      human-friendly "display-name" or names and addresses used
      within the body of the message. That is, it protects only
      against the misuse of a precise address string within the
      RFC5322 From field and nothing else. For example, a
      message from bob@domain.example with a valid signature where
      d=d0main.example would fail an ADSP check because the
      signature domain, however similar, is distinct; however a
      message from bob@d0main.example with a valid signature where
      d=d0main.example would pass an ADSP check, even though to a
      human it might be obvious that d0main.example is likely a
      malicious attempt to spoof the domain domain.example. This
      example highlights that ADSP, like DKIM, is only able to
      validate a signing identifier: it still requires some
      external process to attach a meaningful reputation to that
      identifier. 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Parent Domain Signature</h3>

<p>Another approach that might be taken by an organization
      with multiple active subdomains is to apply the same
      (single) signature to mail from all subdomains. In this
      case, the signature chosen would usually be the signature
      of a parent domain common to all subdomains. For example,
      mail from marketing.domain.example,
      sales.domain.example, and engineering.domain.example might
      all use a signature with d=domain.example.
</p>
<p>This approach has the virtue of simplicity, but it is
      important to consider the implications of such a choice.
      As discussed in <a class='info' href='#signname'>Section&nbsp;2.3<span> (</span><span class='info'>Choosing the Signing Domain Name</span><span>)</span></a>,
      if the type of mail sent from the different subdomains is
      significantly different or if there is reason to believe
      that the reputation of the subdomains would differ, then
      it may be a good idea to acknowledge this and provide
      distinct signatures for each of the subdomains
      (d=marketing.domain.example, sales.domain.example, etc.).
      However, if the mail and reputations are likely to be
      similar, then the simpler approach of using a single
      common parent domain in the signature may work well. 
</p>
<p> Another approach to distinguishing the streams using a
      single DKIM key would be to leverage the AUID <a class='info' href='#rfc4871-update'>[rfc4871&#8209;update]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; April&nbsp;2009.</span><span>)</span></a> (i= tag)  in the DKIM
      signature to differentiate the mail streams. For example,
      marketing email would be signed with
      i=marketing.domain.example and d=domain.example. 
    
</p>
<p>
      It's important to remember, however, that under core DKIM semantics the 
      AUID is opaque to receivers. That means that it will only be an effective
      differentiator if there is an out of band agreement about the i= semantics.
    
</p>
<a name="thirdpartysig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Third Party Signature</h3>

<p>A signature whose domain does not match the domain of the
      RFC 5322 From address is sometimes referred to as a third party
      signature. In certain cases even the parent domain
      signature described above would be considered a third
      party signature because it would not be an exact match for
      the domain in the From: address. 
</p>
<p>Although there is often heated debate about the value of
      third party signatures, it is important to note that the
      DKIM specification attaches no particular significance to
      the identity in a DKIM signature. The identity specified
      within the signature is the identity that is taking
      responsibility for the message, and it is only the
      interpretation of a given receiver that gives one identity
      more or less significance than another. In particular,
      most independent reputation services assign trust based on
      the specific identifier string, not its "role": in general
      they make no distinction between, for example, an author
      signature and a third party signature. 
</p>
<p> For some, a signature unrelated to the author  domain (the domain  in
      the RFC 5322 From address) is less valuable because there
      is an assumption that the presence of an author signature
      guarantees that the use of the address in the From: header
      is authorized. 
</p>
<p> For others, that relevance is tied strictly to the
      recorded behavioral data assigned to the identity in
      question, i.e. its trust assessment or reputation. The
      reasoning here is that an identity with a good reputation
      is unlikely to maintain that good reputation if it is in
      the habit of vouching for messages that are unwanted or
      abusive; in fact, doing so will rapidly degrade its
      reputation so that future messages will no longer benefit
      from it. It is therefore low risk to facilitate the
      delivery of messages that contain a valid signature of a
      domain with a strong positive reputation, independent of
      whether or not that domain is associated with the address
      in the RFC5322 From header field of the message. 
</p>
<p> Third party signatures encompass a wide range of
      identities. Some of the more common are: </p>
<blockquote class="text"><dl>
<dt>Service Provider:</dt>
<dd> In cases where email
	  is outsourced to an Email Service Provider (ESP),
	  Internet Service Provider (ISP), or other type of
	  service provider, that service provider may choose
	  to DKIM sign outbound mail with either its own
	  identifier -- relying on its own, aggregate
	  reputation -- or with a subdomain of the provider
	  that is unique to the message author but still
	  part of the provider's aggregate reputation. Such
	  service providers may also encompass delegated
	  business functions such as benefit management,
	  although these will more often be treated as
	  trusted third party senders (see below). 
</dd>
<dt>Parent Domain.</dt>
<dd> As discussed above,
	  organizations choosing to apply a parent domain signature  to mail
	  originating from subdomains may have their signatures treated as
	  third
	  party by some verifiers, depending
	  on whether or not the "t=s" tag is used to
	  constrain the parent signature to apply only to
	  its own specific domain. The default is to consider a
	  parent domain signature valid for
	  its subdomains.
</dd>
<dt>Reputation Provider:</dt>
<dd> Another possible
	  category of third party signature would be the
	  identity of a third party reputation provider. Such
	  a signature would indicate to receivers that the
	  message was being vouched for by that third party.
	
</dd>
</dl></blockquote><p>
    
</p>
<a name="trustedthirdparty"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Using Trusted Third Party Senders</h3>

<p>For most of the cases described so far, there has been an
      assumption that the signing agent  was
      responsible for creating and maintaining its own DKIM
      signing infrastructure, including its own keys, and
      signing with its own identity. 
</p>
<p> A different model arises when an organization uses a
      trusted third party sender for certain key business
      functions, but still wants that email to benefit from the
      organization's own identity and reputation: in other
      words, the mail would come out of the trusted third party's
      mail servers, but the signature applied would be that of
      the controlling organization. 
</p>
<p> This can be done by having the third party generate a key pair that is
      designated uniquely for use by that trusted third party and publishing
      the public key in the controlling organization's DNS
      domain, thus enabling the third party  to sign mail using the signature 
      of the controlling organization. For example, if Company A
      outsources its employee benefits to a third party, it can
      use a special keypair that enables the benefits company
      to sign mail as "companyA.example". Because the keypair is
      unique to that trusted third party, it is easy for Company A
      to revoke the authorization if necessary by simply
      removing the public key from the companyA.example DNS. 
</p>
<p>In this scenario, may be a good idea to limit the
      specific identities that can be used by even trusted third
      parties.
      The DKIM g= tag enables a key record to specify
      one particular From: address local part that must be
      specified in the i= tag of the signature: for example,
      "g=benefits" would require a signature header tag of
      "i=benefits@companyA.example".
      It is important to note that
      although this distinction will be clear to the verifier it
      may be invisible to the recipient: there is no constraint
      within the DKIM verification process that constrains that
      specific i= value to correspond to any of the other
      message headers, including the From: header.
</p>
<p>
      A more reliable way of distinguishing the third party mail stream would 
      be to create a dedicated subdomain (e.g. benefits.companyA.example) and 
      publish the public key there; the signature would then use d=benefits.companyA.example.
    
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.1"></a><h3>6.4.1.&nbsp;
DNS Delegation</h3>

<p> Another possibility for configuring trusted third party
	access, as discussed in section 3.4,  is to have Company A use DNS delegation and
	have the designated subdomain managed directly
	by the trusted third party. In this case, Company A
	would create a subdomain benefits.companya.example, and
	delegate the DNS management of that subdomain to the
	benefits company so it could maintain its own key
	records. Should revocation become necessary, Company A
	could simply remove the DNS delegation record.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Multiple Signatures</h3>

<p>A simple configuration for DKIM-signed mail is to have a single
      signature on a given message. This works well for domains that
      manage and send all of their own email from single sources,
      or for cases where multiple email streams exist but each has
      its own unique key pair. It also represents the case in which
      only one of the participants in an email sequence is able to
      sign, no matter whether it represents the author or one of
      the operators. 
</p>
<p> The examples thus far have considered the implications of
      using different identities in DKIM signatures, but have
      used only one such identity for any given message. In some
      cases, it may make sense to have more than one identity
      claiming responsibility for the same message. 
</p>
<p> There are a number of situations where applying more than
      one DKIM signature to the same message might make sense. A
      few examples are: </p>
<blockquote class="text"><dl>
<dt>Companies with multiple subdomain
		     identities:</dt>
<dd> A company that has multiple
	  subdomains sending distinct categories of mail
	  might choose to sign with distinct subdomain
	  identities to enable each subdomain to manage its
	  own identity. However, it might also want to
	  provide a common identity that cuts across all of
	  the distinct subdomains. For example, Company A
	  may sign mail for its sales department with a
	  signature where d=sales.companya.example, and
	  a second signature where d=companya.example
</dd>
<dt>Service Providers:</dt>
<dd> A service providers
	  may, as described above, choose to sign outbound
	  messages with either its own identity or with an
	  identity unique to each of its clients (possibly
	  delegated). However, it may also do both: sign
	  each outbound message with its own identity as
	  well as with the identity of each individual client.
	  For example, ESP A might sign mail for its
	  client Company B with its service provider
	  signature d=espa.example, and a second
	  client-specific signature where d= either
	  companyb.example, or companyb.espa.example. The
	  existence of the service provider signature could,
	  for example, help cover a new client while it
	  establishes its own reputation, or help a very
	  small volume client who might never reach a volume
	  threshold sufficient to establish an individual
	  reputation. 
</dd>
<dt>Forwarders</dt>
<dd> Forwarded mail poses a
	  number of challenges to email authentication. DKIM
	  is relatively robust in the presence of forwarders
	  as long as the signature is designed to avoid
	  message parts that are likely to be modified,
	  although some forwarders do make modifications
	  that can invalidate a DKIM signature. 
</dd>
<dt></dt>
<dd> However, some forwarders such as mailing lists or
	  "forward article to a friend" services, might choose
	  to add their own signatures to outbound messages to
	  vouch for them having legitimately originated from
	  the designated service. In this case, the
	  signature would be added even in the presence of a
	  preexisting signature, and both signatures would
	  be relevant to the verifier. 
</dd>
<dt></dt>
<dd>Any forwarder that modifies messages in ways that
	  will break preexisting DKIM signatures SHOULD
	  always sign its forwarded messages. 
</dd>
<dt>Reputation Providers:</dt>
<dd> Although third
	  party reputation providers today use a variety of
	  protocols to communicate their information to
	  receivers, it is possible that they, or other
	  organizations willing to put their "seal of
	  approval" on an email stream might choose to use a
	  DKIM signature to do it. In nearly all cases, this
	  "reputation" signature would be in addition to the
	  author or originator signature. 
</dd>
</dl></blockquote><p>
    
</p>
<p>One important caveat to the use of multiple signatures is
      that there is currently no clear consensus among
      receivers on how they plan to handle them. The opinions
      range from ignoring all but one signature (and the
      specification of which of them is verified differs from
      receiver to receiver), to verifying all signatures present
      and applying a weighted blend of the trust assessments for
      those identifiers, to verifying all signatures present and
      simply using the identifier that represents the most
      positive trust assessment. It is likely that the industry
      will evolve to accept multiple signatures using either
      the second or third of these, but it may take some time before one
      approach becomes pervasive. 
    
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Example Usage Scenarios</h3>

<p>Signatures are created by different types of email actors,
    based on different criteria, such as where the actor operates
    in the sequence from author to recipient, whether they want
    different messages to be evaluated under the same reputation
    or a different one, and so on. This section provides some examples of
    usage scenarios for DKIM deployments; the selection is not intended
    to be exhaustive, but to illustrate a set of key deployment considerations. 
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Author's Organization - Simple</h3>

<p>The simplest DKIM configuration is to have some mail from a given organization (Company A)
      be signed with the same d= value (e.g. d=companya.example).
      If there is a desire to associate a user identity or some other related information,
      the AUID <a class='info' href='#rfc4871-update'>[rfc4871&#8209;update]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; April&nbsp;2009.</span><span>)</span></a>
      value can become uniqueID@companya.example, or @uniqueID.companya.example.
    
</p>
<p> In this scenario, Company A need only generate a single signing key and publish it under
      their top level domain (companya.example); the signing module would then tailor the AUID
      value as needed at signing time. 
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Author's Organization - Differentiated Types of Mail</h3>

<p> A slight variation of the one signature case is where Company A signs some of its mail,
      but it wants to differentiate different categories of its outbound mail by using
      different identifiers. For example, it might choose to distinguish marketing mail,
      billing or transactional mail, and individual corporate email into
      marketing.companya.example, billing.companya.example, and companya.example, where each
      category is assigned a unique subdomain and unique signing keys. 
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Author Signature</h3>

<p> As discussed in <a class='info' href='#singledomainsig'>Section&nbsp;6.1<span> (</span><span class='info'>Single Domain Signature</span><span>)</span></a>, author signatures are a special case
      of signatures from an author's organization where at least one signature on the message
      has a SDID <a class='info' href='#rfc4871-update'>[rfc4871&#8209;update]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; April&nbsp;2009.</span><span>)</span></a> value that matches the From: address of the message.
    
</p>
<p>
      Signers wishing to publish an Author Domain Signing Practices (ADSP) <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> 
      record describing their signing practices will want
      to include an author signature on their outbound mail to avoid ADSP verification
      failures. For example, if the address in the RFC 5322 From is bob@company.example, the
      SDID value of the author signature would be company.example.
    
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Author Domain Signing Practices</h3>

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4.1"></a><h3>7.4.1.&nbsp;
Introduction</h3>

<p>The  legacy of the Internet is such that not all messages
	will be signed, so the absence of a signature on a message is not an
	a priori indication of forgery: in fact, during early phases of
	deployment it is very likely that most messages will remain unsigned.
	
</p>
<p>Some domains may decide to sign all of their outgoing mail, for 
	example, to assist in protecting their brand names.  If all of the legitimate 
	mail for a brand is signed, recipients can be more aggressive in their 
	filtering of mail that uses the brand but is not signed by the domain name 
	associated with the brand, because in  such a configuration, the absence of a signature 
	should
	be more significant than it would be for the general case. 
	It might be desirable for such domains to be able to advertise their intent to other
	hosts: this is the topic of Author Domain Signing Practices (ADSP).
      
</p>
<p>
	Note that ADSP is not for everyone. Sending domains that do not  control
	all legitimate outbound mail purporting to be from their domain (i.e., with a 
	From address in their domain) are likely to experience delivery problems with some 
	percentage of that mail.
	Administrators evaluating ADSP for their domains SHOULD 
	carefully weigh the risk of phishing attacks against the likelihood of undelivered mail. 
      
</p>
<p>This section covers some examples of ADSP usage: for the complete specification,
	see <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a>
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4.2"></a><h3>7.4.2.&nbsp;
A Few Definitions</h3>

<p>In the ADSP specification, an &lt;addr-spec&gt; in the From header field of a message
	<a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> is defined as an "Author Address", and an "Author Domain" is
	defined as anything to the right of the '@' in an Author Address. 
</p>
<p>An "Author Signature" is thus any valid signature where the value of the SDID  matches an 
        Author Address in the message. 
	
</p>
<p>It is important to note that unlike the DKIM specification which makes no correlation
	between the signature domain and any message headers, the ADSP specification applies
	only to the author domain. In essence, under ADSP, any non-author signatures are
	ignored (treated as if they are not present). 
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4.3"></a><h3>7.4.3.&nbsp;
Some ADSP Examples</h3>

<p>An organization (Company A) may specify its signing practices by publishing an ADSP
	record with "dkim=all" or "dkim=discardable".
	In order to avoid misdelivery of its mail at receivers
	that are validating ADSP, Company A MUST first have done an exhaustive analysis to
	determine all sources of outbound mail from its domain (companyA.example) and ensure
	that they all have valid author signatures from that domain.
      
</p>
<p> For example, email with an RFC 5322 From &lt;addr-spec&gt; of bob@companyA.example 
        MUST have an author
	signature where theSDID value is either "companyA.example" 
	or it will fail an ADSP validation. 
</p>
<p> Note that once an organization publishes an ADSP record using dkim=all or
	dkim=discardable, any email with a RFC 5322 From address that uses the domain where the ADSP
	record is published that does not have a valid author signature is at risk of being
	mis-delivered or discarded. For example, if a message with an RFC 5322 From &lt;addr-spec&gt; of
	newsletter@companyA.example has a signature with d=marketing.companyA.example, that 
	message will fail the ADSP check because the
	signature would not be considered a valid author signature. 
</p>
<p>Because the semantics of an ADSP author signature are more constrained than the 
        semantics of a
	"pure" DKIM signature, it is important to make sure the nuances are well understood
	before deploying an ADSP record.
	The ADSP specification <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> provides some fairly extensive
	lookup examples (in Appendix A) and usage examples (in Appendix B).
      
</p>
<p>In particular, in order to prevent mail from being negatively impacted or even discarded at the
	receiver, it is essential to perform a thorough survey of outbound mail from a
	domain before publishing an ADSP policy of anything stronger than "unknown". This
	includes mail that might be sent from external sources that may not be authorized to
	use the domain signature, as well as mail that risks modification in transit that
	might invalidate an otherwise valid author signature (e.g. mailing lists, courtesy
	forwarders, and other paths that could add or modify headers, or modify the message
	body). 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Delegated Signing</h3>

<p> An organization may choose to outsource certain key services to an independent company.
      For example, Company A might outsource its benefits management, or Organization B might
      outsource its marketing email. 
</p>
<p> If Company A wants to ensure that all of the mail sent on its behalf through the
      benefits providers email servers shares the Company A reputation, as discussed in
      <a class='info' href='#trustedthirdparty'>Section&nbsp;6.4<span> (</span><span class='info'>Using Trusted Third Party Senders</span><span>)</span></a> it can either
      publish keys designated for the use of
      the benefits provider under companyA.example (preferably under a designated subdomain of
      companyA.example), or it can delegate a subdomain (e.g. benefits.companyA.example) to
      the provider and enable the provider to generate the keys and manage the DNS for the
      designated subdomain. 
</p>
<p> In both of these cases, mail would be physically going out of the benefit provider's
      mail servers with a signature of e.g. d=benefits.companya.example. Note that the From:
      address is not constrained: it could either be affiliated with the benefits company
      (e.g. benefits-admin@benefitprovider.example, or
      benefits-provider@benefits.companya.example), or with the companyA domain. 
</p>
<p> Note that in both of the above scenarios, as discussed in <a class='info' href='#thirdpartykeymgt'>Section&nbsp;3.4<span> (</span><span class='info'>Third Party Signer Key Management and Selector Administration</span><span>)</span></a>, 
      security concerns dictate that the keys be
      generated by the organization that plans to do the signing so that there is no need to
      transfer the private key. In other words, the benefits provider would generate keys for
      both of the above scenarios. 
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Independent Third Party Service Providers</h3>

<p> Another way to manage the service provider configuration would be to have the service
      provider sign the outgoing mail on behalf of its client Company A with its own
      (provider) identifier. For example, an Email Service Provider (ESP A) might want to
      share its own mailing reputation with its clients, and may sign all outgoing mail from
      its clients with its own d= domain (e.g. d=espa.example). 
</p>
<p> Should the ESP want to distinguish among its clients, it has two options: </p>
<ul class="text">
<li> Share the SDID domain, and use the AUID value to distinguish among the
	  clients: e.g. a signature on behalf of client A would have d=espa.example and
	  i=clienta.espa.example (or i=clienta@espa.example) 
</li>
<li> Extend the SDID domain, so there is a unique value (and subdomain) for
	  each client: e.g. a signature on behalf of client A would have
	  d=clienta.espa.example. 
</li>
</ul><p>
    
</p>
<p> Note that this scenario and the delegation scenario are not mutually exclusive: in some
      cases, it may be desirable to sign the same message with both the ESP and the ESP client
      identities. 
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Mail Streams Based on Behavioral Assessment</h3>

<p> An ISP (ISP A) might want to assign signatures to outbound mail from its users
      according to each user's past sending behavior (reputation).
      In other words, the ISP would segment its outbound traffic according to 
      its own assessment of message quality, to aid recipients in deciding to process 
      these different streams differently.
      Since the semantics of behavioral assessments aren't allowed as AUID values, ISP A
      (ispa.example) may configure subdomains corresponding to the assessment categories
      (e.g. good.ispa.example, neutral.ispa.example, bad.ispa.example), and use these subdomains in
      the d= value of the signature.
    
</p>
<p> The signing module can also optionally set the AUID value to have a unique user id
      (distinct from the local-part of the user's email address), for example
      user3456@neutral.domain.example.
      Using a userid that is distinct from a given email
      alias is useful in environments where a single user might register multiple email
      aliases.
    
</p>
<p> Note that in this case the AUID values are only partially stable. They are stable in the
      sense that a given i= value will always represent the same identity, but they are
      unstable in the sense that a given user can migrate among the assessment subdomains
      depending on their sending behavior (i.e., the same user might have multiple  AUID values
      over the lifetime of a single account).
    
</p>
<p> In this scenario, ISP A may generate as many keys as there are assessment
      subdomains (SDID values), so that each assessment subdomain has its own key.
      The signing module would then choose its signing key based on the assessment of the user
      whose mail was being signed, and if desired include the user id in the AUID of the signature. 
      As discussed earlier, the per-user granularity of the AUID may be ignored by many verifiers,
      so organizations choosing to use it should not rely on its use for receiver side filtering 
      results; however, some organizations may also find the information useful for thier own purposes
      in processing bounces or abuse reports. 
    
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Agent or Mediator Signatures</h3>

<p>Another scenario is that of an agent, usually a re-mailer of some kind, that signs on
      behalf of the service or organization that it represents. Some examples of agents might
      be a mailing list manager, or the "forward article to a friend" service that many online
      publications offer. In most of these cases, the signature is asserting that the message
      originated with, or was relayed by, the service asserting responsibility. In general, if the service
    is configured in such a way that its forwarding would break existing DKIM signatures, it should 
    always add its own signature. 
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Usage Considerations</h3>

<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Non-standard Submission and Delivery Scenarios</h3>

<p>The robustness of DKIM's verification mechanism is based on the fact
      that only authorized signing modules have access to the designated private key.
      This has the side effect that email submission and delivery scenarios
      that originate or relay messages from outside the domain of the authorized 
      signing module will not have access to that protected private key, and thus will be
      unable to attach the expected domain signature to those messages.
      Such scenarios include mailing
      lists, courtesy forwarders, MTAs at hotels, hotspot
      networks used by travelling users, and other paths that
      could add or modify headers, or modify the message body.
    
</p>
<p> For example, assume Joe works for Company A and has an
      email address joe@companya.example.
      Joe also has a ISP-1 account joe@isp1.example.com, and he uses ISP-1's multiple address
      feature to attach his work email joe@companya.example to
      his ISP-1 account.
      When Joe sends email from his ISP-1
      account and uses joe@companya.example as his designated From:
      address, that email cannot have a signature with
      d=companya.example because the ISP-1 servers have no
      access to Company A's private key. In ISP-1's case it will
      have a ISP-1 signature, but for some other mail clients
      offering the same multiple address feature there may be no
      signature at all on the message.
    
</p>
<p> Another example might be the use of a forward article to a
      friend service. Most instances of these services today
      allow someone to send an article with their email address
      in the RFC 5322 From to their designated recipient. If Joe
      used either of his two addresses (joe@companya.example or
      joe@isp1.example.com), the forwarder would be equally unable to
      sign with a corresponding domain . As in the mail client
      case, the forwarder may either sign as its own domain, or
      may put no signature on the message.
    
</p>
<p> A third example is the use of privately configured
      forwarding. Assume that Joe has another account at ISP-2,
      joe@isp-2.example.com, but he'd prefer to read his ISP-2 mail from
      his ISP-1 account. He sets up his ISP-2 account to forward
      all incoming mail to joe@isp1.example.com. Assume
      alice@companyb.example sends joe@isp-2.example.com an email.
      Depending on how companyb.example configured its signature,
      and depending on whether or not ISP-2 modifies messages
      that it forwards, it is possible that when Alice's message
      is received in Joe's ISP-1 account the original signature
      fails verification. 
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Protection of Internal Mail</h3>

<p>One identity is particularly amenable to easy and accurate
      assessment: the organization's own identity. Members of an
      organization tend to trust messages that purport to be
      from within that organization. However Internet Mail does
      not provide a straightforward means of determining whether
      such mail is, in fact, from within the organization. DKIM
      can be used to remedy this exposure. If the organization
      signs all of its mail, then its boundary MTAs can look for
      mail purporting to be from the organization that does not
      contain a verifiable signature. 
</p>
<p>Such mail can in most cases be presumed to be spurious.
      However, domain managers are advised to consider the ways
      that mail processing can modify messages in ways that will
      invalidate an existing DKIM signature: mailing lists,
      courtesy forwarders, and other paths that could add or
      modify headers or modify the message body (e.g. MTAs at
      hotels, hotspot networks used by travelling users, and
      other scenarios described in the previous section). Such
      breakage is particularly relevant in the presence of
      Author Domain Signing Practices.
    
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Signature Granularity</h3>

<p> Although DKIM's use of domain names is optimized for a
      scope of organization-level signing, it is possible to
      administer sub-domains or otherwise adjust signatures in a way that
      supports per-user identification.  This user level granularity
      can be specified in two ways: either by sharing the signing
      identity and specifying an extension to
      the i= value that has a per-user granularity, or by creating and
      signing with unique per-user keys.
    
</p>
<p>
      A subdomain or local part in the i= tag SHOULD be treated as an opaque identifier and thus need
      not correspond directly to a DNS subdomain or be a specific user address.
    
</p>
<p> The primary way to sign with per-user keys requires each user
      to have a distinct DNS (sub)domain, where each distinct d= value
      has a key published. (It is possible, although not
      recommended, to publish the same key in more than one
      distinct domain.)
    
</p>
<p>It is technically possible to publish
      per-user keys within a single domain or subdomain by
      utilizing different selector values. This is not recommended and is 
      unlikely to be treated uniquely by Assessors: the primary purpose of
      selectors is to facilitate key management, and the DKIM specification 
      recommends against using them in determining or assessing identies.
    
</p>
<p>In most cases,  it would be impractical to sign
      email on a per-user granularity.
      Such an approach would be 
      </p>
<blockquote class="text"><dl>
<dt>likely to be ignored: </dt>
<dd> In most cases
	  today, if receivers are verifying DKIM signatures
	  they are in general taking the simplest possible
	  approach. In many cases maintaining reputation
	  information at a per user granularity is not
	  interesting to them, in large part because the per
	  user volume is too small to be useful or
	  interesting. So even if senders take on the
	  complexity necessary to support per user
	  signatures, receivers are unlikely to retain
	  anything more than the base domain reputation.
	
</dd>
<dt>difficult to manage: </dt>
<dd> Any scheme that
	  involves maintenance of a significant number of
	  public keys may  require infrastructure
	  enhancements or extensive administrative
	  expertise. For domains of any size, maintaining
	  a valid per-user keypair, knowing when keys need
	  to be revoked or added due to user attrition or
	  onboarding, and the overhead of having the
	  signing engine constantly swapping keys can create
	  significant and often unnecessary managment
	  complexity. It is also important to note that there is no
	  way within the scope of the DKIM specification for a receiver
	  to infer that a sender intends a per-user granularity. 
	
</dd>
</dl></blockquote><p>
    
</p>
<p>As mentioned before, what may make sense, however, is to use
      the infrastructure
      that enables finer granularity in signatures to identify
      segments smaller than a domain but much larger than a
      per-user segmentation. For example, a university might
      want to segment student, staff, and faculty mail into
      three distinct streams with differing reputations. This
      can be done by creating seperate sub-domains for the
      desired segments, and either specifying the subdomains in
      the i= tag of the DKIM Signature or by adding subdomains
      to the d= tag and assigning and signing with different
      keys for each subdomain. 
</p>
<p>For those who choose to represent user level granularity in
      signatures, the performance and management considerations
      above suggest that it would be more effective to do it by
      specifying a local part or subdomain extension in the i=
      tag rather than by extending the d= domain and publishing
      individual keys. 
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Email Infrastructure Agents</h3>

<p>It is expected that the most common venue for a DKIM
      implementation will be within the infrastructure of an
      organization's email service, such as a department or a
      boundary MTA.
      What follows are some general recommendations for the Email Infrastructure.
      </p>
<blockquote class="text">
<p>
	  </p>
<blockquote class="text"><dl>
<dt>Outbound:  </dt>
<dd>
	      An MSA or an Outbound MTA used for mail submission SHOULD ensure that the
	      message sent is in compliance with the advertised email sending policy.
	      It SHOULD also be able to generate an operator alert
	      if it determines that the email messages do not comply with the published DKIM sending policy.
	    
</dd>
<dt></dt>
<dd>An MSA SHOULD be aware that some MUAs may add their own signatures.
	      If the MSA needs to perform operations on a message to make it comply with its email sending
	      policy, if at all possible, it SHOULD do so in a way that would not break those signatures.
	    
</dd>
<dt></dt>
<dd>
	      MUAs equipped with the ability to sign SHOULD NOT be encouraged.
	      In terms of security, MUAs are generally not under the direct control
	      of those in responsible roles within an organization and are thus
	      more vulnerable to attack and compromise, which would expose private
	      signing keys to intruders and thus jeopardize the integrity and
	      reputation of the organization.
	    
</dd>
<dt>Inbound:  </dt>
<dd>
	      When an organization deploys DKIM, it needs to make sure that its email infrastructure
	      components that do not have primary roles in DKIM handling do not modify message in ways
	      that prevent subsequent verification. 
	    
</dd>
<dt></dt>
<dd>An inbound MTA or an MDA may incorporate an indication
	      of the verification
	      results into the message, such as using an
	      Authentication-Results header field.
	      <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
	    
</dd>
<dt>Intermediaries:  </dt>
<dd> An email intermediary
	      is both an inbound and outbound MTA.
	      Each of the requirements outlined in the sections relating to MTAs apply.
	      If the intermediary modifies a message
	      in a way that breaks the signature, the
	      intermediary
	      
<ul class="text">
<li> SHOULD deploy abuse filtering measures on the inbound mail, and 
</li>
<li> MAY remove all signatures that will be broken
</li>
</ul>
</dd>
<dt></dt>
<dd>In addition the intermediary MAY: 
<ul class="text">
<li>Verify the message signature prior to modification.
</li>
<li>Incorporate an indication of the verification
		  results into the message, such as using an
		  Authentication-Results header field. <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
</li>
<li>Sign the modified message including the
		  verification results (e.g., the
		  Authentication-Results header field).
</li>
</ul>
	    
</dd>
</dl></blockquote>
	

</blockquote>

<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Mail User Agent</h3>

<p>
      The DKIM specification is expected to be used primarily
      between Boundary MTAs, or other infrastructure components
      of the originating and receiving ADMDs.
      However there is nothing in DKIM that is specific to those venues.
      In particular, MUAs MAY also support DKIM signing and verifying directly.
      </p>
<blockquote class="text">
<p>
	  </p>
<blockquote class="text"><dl>
<dt>Outbound:  </dt>
<dd>
	      An MUA MAY support signing even if mail is to be relayed through an outbound MSA.
	      In this case the signature applied by the MUA will be in addition to any
	      signature added by the MSA.
	      However, the warnings in the previous section should be taken into consideration.
	    
</dd>
<dt></dt>
<dd>
	      Some user software goes beyond simple user functionality and also perform MSA and MTA functions.
	      When this is employed for sending directly to a receiving ADMD, the user software SHOULD be considered an outbound MTA.
	    
</dd>
<dt>Inbound:  </dt>
<dd>
	      An MUA MAY rely on a report of a DKIM signature verification that
	      took place at some point in the inbound MTA/MDA path
	      (e.g., an Authentication-Results header field), or an
	      MUA MAY perform DKIM signature verification directly.
	      A verifying MUA SHOULD allow for the case where mail has modified in the inbound MTA path;
	      if a signature fails, the message SHOULD NOT be treated any different than if it did not have a signature.
	    
</dd>
<dt></dt>
<dd>
	      An MUA that looks for an Authentication-Results header field
	      MUST be configurable to choose which Authentication-Results
	      are considered trustable.
	      The MUA developer is encouraged to re-read the Security Considerations
	      of <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>.
	    
</dd>
<dt></dt>
<dd>
	      DKIM requires that all verifiers treat messages with
	      signatures that do not verify as if they are unsigned.
	    
</dd>
<dt></dt>
<dd>
	      If verification in the client is to be acceptable to users,
	      it is essential that successful verification of a
	      signature not result in a less than satisfactory user
	      experience compared to leaving the message unsigned.
	      
	      The mere presence of a verified DKIM signature MUST NOT by itself be used by an
	      MUA to indicate that a message is to be treated better than a message without a
	      verified DKIM signature.
	      However, the fact that a DKIM signature was verified MAY be
	      used as input into a reputation system (i.e., a whitelist
	      of domains and users) for presentation of such indicators.
	    
</dd>
</dl></blockquote>
	

</blockquote>

<p>
      It is common for components of an ADMD's email
      infrastructure to do violence to a message, such that a
      DKIM signature might be rendered invalid.
      Hence, users of MUAs that support
      DKIM signing and/or verifying need a basis for knowing that
      their associated email infrastructure will not break a
      signature. 
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Other Considerations</h3>

<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Security Considerations</h3>

<p> The security considerations of the DKIM protocol are described
      in the DKIM base specification <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. 
    
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
IANA Considerations</h3>

<p> This document has no considerations for IANA. 
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p> TBD 
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dkim-overview">[I-D.ietf-dkim-overview]</a></td>
<td class="author-text">Hansen, T., Crocker, D., and P. Hallam-Baker, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-overview-10.txt">DomainKeys Identified Mail (DKIM) Service Overview</a>,&rdquo; draft-ietf-dkim-overview-10 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-overview-10.txt">TXT</a>, <a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-overview-10.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dkim-ssp">[I-D.ietf-dkim-ssp]</a></td>
<td class="author-text">field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)</a>,&rdquo; draft-ietf-dkim-ssp-10 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-openpgp-rfc2440bis">[I-D.ietf-openpgp-rfc2440bis]</a></td>
<td class="author-text">Callas, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-22.txt">OpenPGP Message Format</a>,&rdquo; draft-ietf-openpgp-rfc2440bis-22 (work in progress), April&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0989">[RFC0989]</a></td>
<td class="author-text">Linn, J. and IAB Privacy Task Force, &ldquo;<a href="http://tools.ietf.org/html/rfc989">Privacy enhancement for Internet electronic mail: Part I: Message encipherment and authentication procedures</a>,&rdquo; RFC&nbsp;989, February&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc989.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1848">[RFC1848]</a></td>
<td class="author-text"><a href="mailto:crocker@cybercash.com">Crocker, S.</a>, <a href="mailto:galvin@tis.com">Galvin, J.</a>, <a href="mailto:murphy@tis.com">Murphy, S.</a>, and <a href="mailto:ned@innosoft.com">N. Freed</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1848">MIME Object Security Services</a>,&rdquo; RFC&nbsp;1848, October&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1848.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1991">[RFC1991]</a></td>
<td class="author-text"><a href="mailto:warlord@MIT.EDU">Atkins, D.</a>, <a href="mailto:stallings@ACM.org">Stallings, W.</a>, and <a href="mailto:prz@acm.org">P. Zimmermann</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1991">PGP Message Exchange Formats</a>,&rdquo; RFC&nbsp;1991, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1991.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2440">[RFC2440]</a></td>
<td class="author-text"><a href="mailto:jon@pgp.com">Callas, J.</a>, <a href="mailto:lutz@iks-jena.de">Donnerhacke, L.</a>, <a href="mailto:hal@pgp.com">Finney, H.</a>, and <a href="mailto:rodney@unitran.com">R. Thayer</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2440">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;2440, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2440.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2440.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2440.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3156">[RFC3156]</a></td>
<td class="author-text">Elkins, M., Del Torto, D., Levien, R., and T. Roessler, &ldquo;<a href="http://tools.ietf.org/html/rfc3156">MIME Security with OpenPGP</a>,&rdquo; RFC&nbsp;3156, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3156.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3164">[RFC3164]</a></td>
<td class="author-text">Lonvick, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3164">The BSD Syslog Protocol</a>,&rdquo; RFC&nbsp;3164, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3164.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3851">[RFC3851]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;3851, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4870">[RFC4870]</a></td>
<td class="author-text">Delany, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4870">Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)</a>,&rdquo; RFC&nbsp;4870, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4870.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5155">[RFC5155]</a></td>
<td class="author-text">Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;<a href="http://tools.ietf.org/html/rfc5155">DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</a>,&rdquo; RFC&nbsp;5155, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5155.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5321">[RFC5321]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text"><a href="mailto:presnick@qualcomm.com">Resnick, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc5322.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc5322.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5451">[RFC5451]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5451">Message Header Field for Indicating Message Authentication Status</a>,&rdquo; RFC&nbsp;5451, April&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5451.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="rfc4871-update">[rfc4871-update]</a></td>
<td class="author-text">Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; I-D&nbsp;draft-ietf-dkim-rfc4871-errata-03, April&nbsp;2009.</td></tr>
</table>

<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Migrating from DomainKeys</h3>

<p>
    As with any migration, the steps required will be determined by who is doing the migration and their assessment of
    </p>
<ul class="text">
<li>the users of what they are generating, or
      
</li>
<li>
	the providers of what they are consuming.
    
</li>
</ul><p>
  
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Signers</h3>

<p>
      A signer that currently signs with DomainKeys (DK) will go through various stages as it migrates to using DKIM,
      not all of which are required for all signers.
      The real questions that a signer must ask are:
      </p>
<ol class="text">
<li>how many receivers or what types of receivers are *only* looking at the DK signatures and not the DKIM signatures, and
	
</li>
<li>how much does the signer care about those receivers?
	
</li>
</ol><p>
      If no one is looking at the DK signature any more, then it's no longer necessary to sign with DK.
      Or if all "large players" are looking at DKIM in addition to or instead of DK, a signer MAY choose to stop signing with DK. 
    
</p>
<p>
      With respect to signing policies, a reasonable, initial approach is to use DKIM signatures in the same way as DomainKeys signatures are already being used.
      In particular, the same selectors and DNS Key Records may be used for both, after verifying that they are compatible as discussed below.
    
</p>
<p>
      Each secondary step in all of the following scenarios is to be prefaced with the gating factor "test, then when comfortable with the previous step's results, continue".
    
</p>
<p>
      One migration strategy is to:
      </p>
<ul class="text">
<li>ensure that the current selector DNS key record is compatible with both DK and DKIM
</li>
<li>sign messages with both DK and DKIM signatures
</li>
<li>when it's decided that DK signatures are no longer necessary, stop signing with DK
</li>
</ul><p>
    
</p>
<p>
      Another migration strategy is to:
      </p>
<ul class="text">
<li>add a new selector DNS key record only for DKIM signatures
</li>
<li>sign messages with both DK (using the old DNS key record) and DKIM signatures (using the new DNS key record) 
</li>
<li>when it's decided that DK signatures are no longer necessary, stop signing with DK
</li>
<li>eventually remove the old DK selector DNS record
</li>
</ul><p>
    
</p>
<p>
      A combined migration strategy is to:
      </p>
<ul class="text">
<li>ensure that the current selector DNS key record is compatible with both DK and DKIM
</li>
<li>start signing messages with both DK and DKIM signatures
</li>
<li>add a new selector DNS key record for DKIM signatures
</li>
<li>switch the DKIM signatures to use the new selector
</li>
<li>when it's decided that DK signatures are no longer necessary, stop signing with DK
</li>
<li>eventually remove the old DK selector DNS record
</li>
</ul><p>
    
</p>
<p>
      Another migration strategy is to:
      </p>
<ul class="text">
<li>add a new selector DNS key record for DKIM signatures
</li>
<li>do a flash cut and replace the DK signatures with DKIM signatures
</li>
<li>eventually remove the old DK selector DNS record
</li>
</ul><p>
    
</p>
<p>
      Another migration strategy is to:
      </p>
<ul class="text">
<li>ensure that the current selector DNS key record is compatible with both DK and DKIM
</li>
<li>do a flash cut and replace the DK signatures with DKIM signatures
</li>
</ul><p>
    
</p>
<p>
      Note that when you have separate key records for DK and DKIM, you can use the same public key for both.
    
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
DNS Selector Key Records</h3>

<p>
	The first step in some of the above scenarios is ensuring that the selector DNS key records are compatible for both DK and DKIM.
	The format of the DNS key record was intentionally meant to be backwardly compatible between the two systems, but not necessarily upwardly compatible.
	DKIM has enhanced the DK DNS key record format by adding several optional parameters, which DK must ignore.
	However, there is one critical difference between DK and DKIM DNS key records: the definitions of the "g" fields:
      
</p>
<p>
	</p>
<blockquote class="text"><dl>
<dt>g= granularity of the key</dt>
<dd>
	    In both DK and DKIM, this is an optional field that is used to constrain which sending address(es)
	    can legitimately use this selector. Unfortunately, the treatment of an empty field ("g=;")
	    is different. DKIM allows wildcards where DK does not. For DK, an empty field is the 
	    same as a missing value, and is treated as allowing any sending address. For DKIM, an empty field only
	    matches an empty local part. In DKIM, both a missing value and "g=*;" mean to allow any sending
	    address.
	  
</dd>
<dt></dt>
<dd>
	    If your DK DNS key record has an empty "g" field in it ("g=;"), your best course of action
	    is to modify the record to remove the empty field. In that way, the DK semantics will remain the same,
	    and the DKIM semantics will match.
	  
</dd>
</dl></blockquote><p>
      
</p>
<p>
	If your DNS key record does not have an empty "g" field in it ("g=;"), it's probable that the record can be left alone.
	But your best course of action would still be to make sure it has a "v" field.
	When the decision is made to stop supporting DomainKeys and to only support DKIM, 
	you MUST verify that the "g" field is compatible with DKIM, and it SHOULD have "v=DKIM1;" in it.
	It is highly RECOMMENDED that if you want to use an empty "g" field in your DKIM selector, you also include the "v" field.
      
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Removing DomainKeys Signatures</h3>

<p>
	The principal use of DomainKeys is at Boundary MTAs.
	Because no operational transition is ever instantaneous,
	it is advisable to continue performing DomainKeys signing until it is determined that DomainKeys receive-side support is no longer used,
	or is sufficiently reduced.
	That is, a signer SHOULD add a DKIM signature to a message that also has a DomainKeys signature
	and keep it there until you decide it is deemed no longer useful.
	The signer may do its transitions in a straightforward manner, or more gradually.
	Note that because digital signatures are not free, there is a cost to performing both signing algorithms,
	so signing with both algorithms should not be needlessly prolonged.
      
</p>
<p>
	The tricky part is deciding when DK signatures are no longer necessary.
	The real questions are:
	how many DomainKeys verifiers are there that do *not* also do DKIM verification,
	which of those are important,
	and how can you track their usage?
	Most of the early adopters of DK verification have added DKIM verification, but not all yet.
	If a verifier finds a message with both DK and DKIM, it may choose to verify both signatures, or just one or the other.
      
</p>
<p>
	Many DNS services offer tracking statistics so it can be determined how often a DNS record has been accessed.
	By using separate DNS selector key records for your signatures, you can chart the usage of your records over time,
	and watch the trends.
	An additional distinguishing factor to track would take into account the verifiers that verify both the DK and DKIM signatures,
	and discount those from counts of DK selector usage.
	When the number for DK selector access reaches a low-enough level, that's the time to consider discontinuing signing with DK.
      
</p>
<p>
	Note, this level of rigor is not required.
	It is perfectly reasonable for a DK signer to decide to follow the "flash cut" scenario described above.
      
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Verifiers</h3>

<p>
      As a verifier, several issues must be considered:
      
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
Should DK signature verification be performed?</h3>

<p>
	  At the time of writing, there is still a significant number of sites that are only producing DK signatures.
	  Over time, it is expected that this number will go to zero, but it may take several years.
	  So it would be prudent for the foreseeable future for a verifier to look for and verify both DKIM and DK signatures.
	
</p>
      
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2"></a><h3>A.2.2.&nbsp;
Should both DK and DKIM signatures be evaluated on a single message?</h3>

<p>
	  For a period of time, there will be sites that sign with both DK and DKIM.
	  A verifier receiving a message that has both types of signatures may verify both signatures, or just one.
	  One disadvantage of verifying both signatures is that signers will have a more difficult time deciding
	  how many verifiers are still using their DK selectors.
	  One transition strategy is to verify the DKIM signature, then only verify the DK signature if the DKIM verification fails.
	
</p>
      
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.3"></a><h3>A.2.3.&nbsp;
DNS Selector Key Records</h3>

<p>
	  The format of the DNS key record was intentionally meant to be backwardly compatible between DK and DKIM,
	  but not necessarily upwardly compatible.
	  DKIM has enhanced the DK DNS key record format by adding several optional parameters, which DK must ignore.
	  However, there is one key difference between DK and DKIM DNS key records: the definitions of the g fields:
	
</p>
<p>
	  </p>
<blockquote class="text"><dl>
<dt>g= granularity of the key</dt>
<dd>
	      In both DK and DKIM, this is an optional field that is used to constrain which sending address(es)
	      can legitimately use this selector.
	      Unfortunately, the treatment of an empty field ("g=;") is different.
	      For DK, an empty field is the same as a missing value, and is treated as allowing any sending address.
	      For DKIM, an empty field only matches an empty local part.
	    
</dd>
<dt>v= version of the selector</dt>
<dd>
	      It is recommended that a DKIM selector have "v=DKIM1;" at its beginning, but it is not required.
	    
</dd>
</dl></blockquote><p>
	
</p>
<p>
	  If a DKIM verifier finds a selector record that has an empty "g" field ("g=;") and
	  it does not have a "v" field ("v=DKIM1;") at its beginning,
	  it is faced with deciding if this record was
	  </p>
<ol class="text">
<li>
	      from a DK signer that transitioned to supporting DKIM but forgot to remove the "g" field
	      (so that it could be used by both DK and DKIM verifiers), or
	    
</li>
<li>
	      from a DKIM signer that truly meant to use the empty "g" field but forgot to put in the "v" field.
	      It is RECOMMENDED that you treat such records using the first interpretation,
	      and treat such records as if the signer did not have a "g" field in the record.
	    
</li>
</ol><p>
	
</p>
    

<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
General Coding Criteria for Cryptographic Applications</h3>

<p> NOTE: This section could possibly be changed into a reference
				to something else, such as another rfc. 
</p>
<p>Correct implementation of a cryptographic algorithm is a
				necessary but not a sufficient condition for the coding of
				cryptographic applications. Coding of cryptographic libraries
				requires close attention to security considerations that are
				unique to cryptographic applications. 
</p>
<p>In addition to the usual security coding considerations, such
				as avoiding buffer or integer overflow and underflow,
				implementers should pay close attention to management of
				cryptographic private keys and session keys, ensuring that
				these are correctly initialized and disposed of. 
</p>
<p>Operating system mechanisms that permit the confidentiality of
				private keys to be protected against other processes should be
				used when available. In particular, great care must be taken
				when releasing memory pages to the operating system to ensure
				that private key information is not disclosed to other
				processes. 
</p>
<p>Certain implementations of public key algorithms such as RSA
				may be vulnerable to a timing analysis attack. 
</p>
<p>Support for cryptographic hardware providing key management
				capabilities is strongly encouraged. In addition to offering
				performance benefits, many cryptographic hardware devices
				provide robust and verifiable management of private keys. 
</p>
<p>Fortunately appropriately designed and coded cryptographic
				libraries are available for most operating system platforms
				under license terms compatible with commercial, open source
				and free software license terms. Use of standard cryptographic
				libraries is strongly encouraged. These have been extensively
				tested, reduce development time and support a wide range of
				cryptographic hardware. 
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tony Hansen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AT&amp;T Laboratories</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">200 Laurel Ave. South</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Middletown, NJ  07748</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tony+dkimov@maillennium.att.com">tony+dkimov@maillennium.att.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ellen Siegel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Constant Contact, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1601 Trapelo Rd, Ste 329</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Waltham, MA  02451</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:esiegel@constantcontact.com">esiegel@constantcontact.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Phillip Hallam-Baker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VeriSign Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pbaker@verisign.com">pbaker@verisign.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Crocker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brandenburg InternetWorking</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">675 Spruce Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94086</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">dcrocker@bbiw.net</a></td></tr>
</table>
</body></html>
