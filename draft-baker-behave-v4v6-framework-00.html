<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Framework for IPv4/IPv6 Translation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Framework for IPv4/IPv6 Translation">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">behave</td><td class="header">F. Baker, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">October 26, 2008</td></tr>
<tr><td class="header">Expires: April 29, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Framework for IPv4/IPv6 Translation<br />draft-baker-behave-v4v6-framework-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 29, 2009.</p>

<h3>Abstract</h3>

<p>This note describes a framework for IPv4/IPv6 translation. This is in
      the context of replacing NAT-PT, which was deprecated by RFC 4966, and
      to enable networks to have IPv4 and IPv6 coexist in a somewhat rational
      manner while transitioning to an IPv6 network.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#why">1.1.</a>&nbsp;
Why translation?<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#glossary">1.2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#requirements">1.3.</a>&nbsp;
Translation objectives<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#plan">1.4.</a>&nbsp;
Transition Plan<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uses">1.5.</a>&nbsp;
Expected uses of translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#v4island">1.5.1.</a>&nbsp;
Connection of IPv4-only islands to an IPv6-only network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#v6island">1.5.2.</a>&nbsp;
Connection of IPv6-only islands to an IPv4-only network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#v4v6connect">1.5.3.</a>&nbsp;
Connecting IPv4-only devices with IPv6-only devices<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iviservice">1.5.4.</a>&nbsp;
ISP-supported connections between IPv4-only networks and IPv6-only networks<br />
<a href="#proposal">2.</a>&nbsp;
Framework<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#address">2.1.</a>&nbsp;
Mapped Address Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#components">2.2.</a>&nbsp;
Translation components<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dns">2.2.1.</a>&nbsp;
DNS Application Layer Gateway<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#stateless">2.2.2.</a>&nbsp;
Stateless Translation - mapped addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#stateful">2.2.3.</a>&nbsp;
Stateful translation - unmapped IPv6 address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#other">2.2.4.</a>&nbsp;
Translation gateway technologies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ops">2.3.</a>&nbsp;
Translation in operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">2.4.</a>&nbsp;
Unsolved problems<br />
<a href="#IANA">3.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">4.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">5.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">6.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">6.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">6.2.</a>&nbsp;
Informative References<br />
<a href="#addresses">Appendix&nbsp;A.</a>&nbsp;
Address proposals<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wellknown">A.1.</a>&nbsp;
Well-known address formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wellknownBenefit">A.1.1.</a>&nbsp;
Benefits of a well-known address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wellknownIssues">A.1.2.</a>&nbsp;
Issues in using a well-known address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wellknownConfiguration">A.1.3.</a>&nbsp;
Configuration of a well-known address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wellknownApplicability">A.1.4.</a>&nbsp;
Applicability of a well-known address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#operator">A.2.</a>&nbsp;
Network operator specified prefixes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ivi">A.2.1.</a>&nbsp;
The IVI prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#localPrefix">A.2.2.</a>&nbsp;
Network operator specified /96 prefixes<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This note describes a framework for IPv4/IPv6 translation. This is in
      the context of replacing <a class='info' href='#RFC2766'>NAT-PT<span> (</span><span class='info'>Tsirtsis, G. and P. Srisuresh, &ldquo;Network Address Translation - Protocol Translation (NAT-PT),&rdquo; February&nbsp;2000.</span><span>)</span></a> [RFC2766], which was
      deprecated by <a class='info' href='#RFC4966'>[RFC4966]<span> (</span><span class='info'>Aoun, C. and E. Davies, &ldquo;Reasons to Move the Network Address Translator - Protocol Translator (NAT-PT) to Historic Status,&rdquo; July&nbsp;2007.</span><span>)</span></a>, and to enable networks to
      have IPv4 and IPv6 coexist in a somewhat rational manner while
      transitioning to an IPv6-only network.
</p>
<p>Deprecation of NAT-PT wasn't intended to say that NAT-PT was "bad",
      nor did the IETF think that deprecating the technology would stop people
      from using it. As with the 1993 deprecation of the RIP routing protocol
      at the time the Internet was converting to CIDR, the point was to inform
      the community that NAT-PT had operational issues and was not considered
      a viable medium or long term strategy for either coexistence or
      transition. The point was to encourage network operators to actually
      move in the direction of transition.
</p>
<p><a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a> describes the IETF's view of the most
      sensible transition model. The IETF recommends, in short, that network
      operators (transit providers, service providers, enterprise networks,
      small and medium business, SOHO and residential customers, and any other
      kind of network that may currently be using IPv4) obtain an IPv6 prefix,
      turn on IPv6 routing within their networks and between themselves and
      any peer, upstream, or downstream neighbors, enable it on their
      computers, and use it in normal processing. This should be done while
      leaving IPv4 stable, until a point is reached that any communication
      that can be carried out could use either protocol equally well. At that
      point, the economic justification for running both becomes debatable,
      and network operators can justifiably turn IPv4 off. This process is
      comparable to that of <a class='info' href='#RFC4192'>[RFC4192]<span> (</span><span class='info'>Baker, F., Lear, E., and R. Droms, &ldquo;Procedures for Renumbering an IPv6 Network without a Flag Day,&rdquo; September&nbsp;2005.</span><span>)</span></a>, which describes
      how to renumber a network using the same address family without a flag
      day. While running stably with the older system, deploy the new. Use the
      coexistence period to work out such kinks as arise. When the new is also
      running stably, shift production to it. When network and economic
      conditions warrant, remove the old, which is now no longer
      necessary.
</p>
<p>The question arises: what if that is infeasible due to the time
      available to deploy or other considerations? What if the process of
      moving a network and its components or customers is starting too late
      for contract cycles to effect IPv6 turn-up on important parts at a point
      where it becomes uneconomical to deploy global IPv4 addresses in new
      services? How does one continue to deploy new services without
      balkanizing the network?
</p>
<p>This set of documents describes translation as one of the tools
      networks might use to facilitate coexistence and ultimate
      transition.
</p>
<a name="why"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Why translation?</h3>

<p>Besides dual stack deployment, there are two fundamental approaches
        one could take to interworking between IPv4 and IPv6: tunneling and
        translation. One could - and in the 6NET we did - build an overlay
        network using the new protocol inside tunnels. Various proposals take
        that model, including <a class='info' href='#RFC3056'>6to4<span> (</span><span class='info'>Carpenter, B. and K. Moore, &ldquo;Connection of IPv6 Domains via IPv4 Clouds,&rdquo; February&nbsp;2001.</span><span>)</span></a> [RFC3056], <a class='info' href='#RFC4380'>Teredo<span> (</span><span class='info'>Huitema, C., &ldquo;Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs),&rdquo; February&nbsp;2006.</span><span>)</span></a> [RFC4380], <a class='info' href='#RFC5214'>ISATAP<span> (</span><span class='info'>Templin, F., Gleeson, T., and D. Thaler, &ldquo;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP),&rdquo; March&nbsp;2008.</span><span>)</span></a> [RFC5214],and <a class='info' href='#I-D.durand-softwire-dual-stack-lite'>DS-Lite<span> (</span><span class='info'>Durand, A., Droms, R., Haberman, B., and J. Woodyatt, &ldquo;Dual-stack lite broadband deployments post IPv4 exhaustion,&rdquo; November&nbsp;2008.</span><span>)</span></a> [I&#8209;D.durand&#8209;softwire&#8209;dual&#8209;stack&#8209;lite]. The
        advantage of doing so is that the new is enabled to work without
        disturbing the old protocol, providing connectivity between users of
        the new protocol. There are two disadvantages to tunneling:</p>
<ul class="text">
<li>operators of those networks are unable to offer services to
            users of the new architecture, and those users are unable to use
            the services of the underlying infrastructure - it is just
            bandwidth, and
</li>
<li>it doesn't enable new protocol users to communicate with old
            protocol users.
</li>
</ul>

<p>As noted, in this work, we look at Internet Protocol translation as
        a transition strategy. <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> forcefully makes
        the point that many of the reasons people use Network Address
        Translators are met as well by routing or protocol mechanisms that
        preserve the end to end addressability of the Internet. What it did
        not consider is the case in which there is an ongoing requirement to
        communicate with IPv4 systems, but configuring IPv4 routing is not in
        the network operator's view the most desirable strategy, or is
        infeasible due to a shortage of global address space. Translation
        enables the client of a network, whether a transit network, an access
        network, or an edge network, to access the services of the network and
        communicate with other network users regardless of their protocol
        usage - within limits. Like NAT-PT, IPv4/IPv6 translation under this
        rubric is not a long term support strategy, but it is a medium term
        coexistence strategy that can be used to facilitate a long term
        program of transition.
</p>
<a name="glossary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>The following terminology is used in this document and other
        documents related to it. </p>
<blockquote class="text"><dl>
<dt>Advertised IPv4 Prefix:</dt>
<dd>The IPv4 prefix, if any,
            subdivided into Mapped IPv4 Prefixes in the IPv6-only domain. This is
            advertised in routing in the IPv4 domain to attract traffic
            intended for mapped IPv4 addresses in the IPv6-only domain.
</dd>
<dt>Dual Stack impementation:</dt>
<dd>A Dual Stack
            implementation, in this context, comprises an enabled end system
            stack plus routing in the network. It implies that two application
            instances are capable of communicating using either IPv4 or IPv6 -
            they have stacks, they have addresses, and they have any necessary
            network support including routing.
</dd>
<dt>IPv4-only:</dt>
<dd>An IPv4-only implementation, in this
            context, comprises an enabled end system stack plus routing in the
            network. It implies that two application instances are capable of
            communicating using either IPv4 but not IPv6 - they have an IPv4
            stack, addresses, and network support including IPv4 routing and
            potentially IPv4/IPv4 translation, but some element is missing
            that prevents communication using IPv6.
</dd>
<dt>IPv6-only:</dt>
<dd>An IPv6-only implementation, in this
            context, comprises an enabled end system stack plus routing in the
            network. It implies that two application instances are capable of
            communicating using either IPv6 but not IPv4 - they have an IPv6
            stack, addresses, and network support including routing in IPv6,
            but some element is missing that prevents communication using
            IPv4.
</dd>
<dt>LIR Prefix:</dt>
<dd>The IPv6 prefix assigned by the network
            operator for direct mapping of IPv6 addresses to IPv4.
</dd>
<dt>LIR:</dt>
<dd>See Local Internet Registry.
</dd>
<dt>Local Internet Registry:</dt>
<dd>A Local Internet Registry
            (LIR) is an organization which has received an IP address
            allocation from a Regional Internet Registry (RIR), and which may
            assign parts of this allocation to its own internal network or
            those of its customers. An LIR is thus typically an Internet
            service provider or an enterprise network.
</dd>
<dt>Mapped IPv4 Address:</dt>
<dd>An IPv6 address within a Mapped
            IPv4 Prefix.
</dd>
<dt>Mapped IPv4 Prefix:</dt>
<dd>An IPv6 prefix constructed from
            an LIR prefix and an IPv4 prefix.
</dd>
<dt>Overlay IPv4 Prefix:</dt>
<dd>Zero or more IPv4 addresses
            used in stateful translation.
</dd>
<dt>State:</dt>
<dd>"State" refers to dynamic information that is
            stored in a network element. For example, if two systems are
            connected by a TCP connection, each stores information about the
            connection, which is called "connection state". In this context,
            the term refers to correlations between IP addresses on either
            side of a translator, or {IP Address, Transport type, transport
            port number} tuples on either side of the translator. Of stateful
            algorithms, there are at least two major flavors depending on the
            kind of state they maintain: 
<blockquote class="text"><dl>
<dt>Hidden state:</dt>
<dd>the existence of this state is
                unknown outside the network element that contains it.
</dd>
<dt>Known state:</dt>
<dd>the existence of this state is
                known by other network elements.
</dd>
</dl></blockquote>
</dd>
<dt>Stateful Translation:</dt>
<dd>A translation algorithm may be
            said to "require state in a network element" or be "stateful" if
            the transmission or reception of a packet creates or modifies a
            data structure in the relevant network element.
</dd>
<dt>Stateless Translation:</dt>
<dd>A translation algorithm that
            is not "stateful" is "stateless". It may require configuration of
            a translation table, or may derive its needed information
            algorithmically from the messages it is translating.
</dd>
</dl></blockquote>

<a name="requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Translation objectives</h3>

<p>In any translation model, there is a question of objectives.
        Ideally, one would like to make any system and any application running
        on it able to "talk with" - exchange datagrams supporting applications
        - with any other system running the same application regardless of
        whether they have an IPv4 stack and connectivity or IPv6 stack and
        connectivity. That was the model NAT-PT, and the things it
        necessitated led to scaling and operational difficulties.
</p>
<p>So the question comes back to what different kinds of connectivity
        can be easily supported and what are harder, and what technologies are
        needed to at least pick the low-hanging fruit. We observe that
        applications today fall into three main categories:</p>
<blockquote class="text"><dl>
<dt>Client/Server Application:</dt>
<dd>Per whatis.com,
            "'Client/server' describes the relationship between two computer
            programs in which one program, the client, makes a service request
            from another program, the server, which fulfills the request." In
            networking, the behavior of the applications is that connections
            are initiated from client software and systems to server software
            and systems. Examples include mail handling between an end user
            and his mail system (POP3, IMAP, and MUA-&gt;MTA SMTP), FTP, the
            web, and DNS name translation.
</dd>
<dt>Peer to Peer Application:</dt>
<dd>Peer to peer applications
            are those that transfer information directly, rather than through
            the use of an intermediate repository such as a bulletin board or
            database. In networking, any system (peer) might initiate a
            session with any other system (peer) at any time. These in turn
            fall broadly into two categories:
<blockquote class="text"><dl>
<dt>Peer to peer inrastructure applications:</dt>
<dd>Examples
                of "infrastructure applications" include SMTP between MTAs,
                Network News, and SIP. Any MTA might open an SMTP session with
                any other at any time; any SIP Proxy might similarly connect
                with any other SIP Proxy. An important characteristic of these
                applications is that they use ephemeral sessions - they open
                sessions when they are needed and close them when they are
                done.
</dd>
<dt>Peer to peer file exchange applications:</dt>
<dd>Examples
                of these include Limewire, BitTorrent, and UTorrent. These are
                applications that open some sessions between systems and leave
                them open for long periods of time, and where ephemeral
                sessions are important, are able to learn about the
                reliability of peers from history or by reputation. They use
                the long term sessions to map content availability. Short term
                sessions are used to exchange content. They tend to prefer to
                ask for content from servers that they find reliable and
                available.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<p>NAT-PT is an example of a facility with known state - at least two
        software components (the data plane translator and the DNS Application
        Layer Gateway, which may be implemented in the same or different
        systems) share and must coordinate translation state. A typical
        IPv4/IPv4 NAT implements an algorithm with hidden state. Obviously,
        stateless translation requires less computational overhead than
        stateful translation, and less memory to maintain the state, because
        the translation tables and their associated methods and processes
        exist in a stateful algorithm and don't exist in a stateless one.
</p>
<p>If the key questions are the ability to open connections between
        systems, then one must ask who opens connections. </p>
<ul class="text">
<li>We need a technology that will enable systems that act as
            clients to be able to open sessions with other systems that act as
            servers, whether in the IPv6-&gt;IPv4 direction or the
            IPv4-&gt;IPv6 direction. Ideally, this is stateless; especially in
            a carrier infrastructure, the preponderance of accesses will be to
            servers, and this optimizes access to them. However, a stateful
            algorithm is acceptable if the complexity is minimized and a
            stateless algorithm cannot be constructed.
</li>
<li>We also need a technology that will allow peers to connect with
            each other, whether in the IPv6-&gt;IPv4 direction or the
            IPv4-&gt;IPv6 direction. Again, it would be ideal if this was
            stateless, but a stateful algorithm is acceptable if the
            complexity is minimized and a stateless algorithm cannot be
            constructed. In the case of infrastructure applications, which
            know nothing of choosing among peers by reputation, the
            IPv4-&gt;IPv6 direction is a stronger requirement. Peer to peer
            file exchange applications, however, may be more forgiving - it
            may well be adequate to make a subset of IPv4-&gt;IPv6 connections
            work instead of all. (EDITOR'S NOTE: I would be very interested in
            comments on this assertion)
</li>
<li>We do not need an algorithm that enables clients to connect to
            clients, because they don't connect.
</li>
</ul>

<p>The complexity arguments bring us in the direction of hidden state:
        if state must be shared between the application and the translator or
        between translation components, complexity and deployment issues are
        greatly magnified. We would very much prefer that any software changes
        be confined to the translator.
</p>
<a name="plan"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Transition Plan</h3>

<p>While IPv6 was "by design" incompatible with IPv4, the designers
        intended that it would coexist with IPv4 during a period of
        transition. The primary mode of coexistence was dual-stack operation -
        routers would be dual-stacked so that the network could carry both
        address families, and IPv6-capable hosts could be dual-stack to
        maintain access to IPv4-only partners. The goal was that the
        preponderance of hosts and routers in the Internet would be
        IPv6-capable long before IPv4 address space allocation was completed.
        At this time, it appears the exhaustion of IPv4 address space will
        occur before significant IPv6 adoption.
</p>
<p>Curran's <a class='info' href='#RFC5211'>"A Transition Plan for IPv6"<span> (</span><span class='info'>Curran, J., &ldquo;An Internet Transition Plan,&rdquo; July&nbsp;2008.</span><span>)</span></a> [RFC5211] proposes a three-phase progression: </p>
<blockquote class="text"><dl>
<dt>Preparation Phase (current):</dt>
<dd>characterized by pilot
            use of IPv6, primarily through transition mechanisms defined in
            RFC 4213, and planning activities.
</dd>
<dt>Transition Phase (2010 through 2011):</dt>
<dd>characterized
            by general availability of IPv6 in provider networks which SHOULD
            be native IPv6; organizations SHOULD provide IPv6 connectivity for
            their Internet-facing servers, but SHOULD still provide IPv4-based
            services via a separate service name.
</dd>
<dt>Post-Transition Phase (2012 and beyond):</dt>
<dd>characterized
            by a preponderance of IPv6-based services and diminishing support
            for IPv4-based services.
</dd>
</dl></blockquote>

<p>In each of these phases, the coexistence problem and solution space
        has a different focus: </p>
<blockquote class="text"><dl>
<dt>Preparation Phase:</dt>
<dd>Coexistence tools are needed to
            facilitate early adopters by removing impediments to IPv6
            deployment, and to assure that nothing is lost by adopting IPv6,
            in particular that the IPv6 adopter has unfettered access to the
            global IPv4 Internet regardless of whether they have a global IPv4
            address (or any IPv4 address or stack at all.) While it might
            appear reasonable for the cost and operational burden to be borne
            by the early adopter, the shared goal of promoting IPv6 adoption
            would argue against that model. Additionally, current IPv4 users
            should not be forced to retire or upgrade their equipment and the
            burden remains on service providers to carry and route native
            IPv4.
</dd>
<dt>Transition Phase:</dt>
<dd>While IPv6 adoption can be
            expected to accelerate, there will still be a significant portion
            of the Internet operating in IPv4-only or preferring IPv4. During
            this phase the norm shifts from IPv4 to IPv6, and coexistence
            tools evolve to ensure interoperability between domains that may
            be restricted to IPv4 or IPv6.
</dd>
<dt>Post-Transition Phase:</dt>
<dd>In this phase, IPv6 is
            ubiquitous and the burden of maintaining interoperability shifts
            to those who choose to maintain IPv4-only systems. While these
            systems should be allowed to live out their economic life cycles,
            the IPv4-only legacy users at the edges should bear the cost of
            coexistence tools, and at some point service provider networks
            should not be expected to carry and route native IPv4 traffic.
</dd>
</dl></blockquote>

<p>The choice between the terms "transition" versus "coexistence" has
        engendered long philosophical debate. "Transition" carries the sense
        that we are going somewhere, while "coexistence" seems more like we
        are sitting somewhere. Historically with IETF, "transition" has been
        the term of choice <a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a><a class='info' href='#RFC5211'>[RFC5211]<span> (</span><span class='info'>Curran, J., &ldquo;An Internet Transition Plan,&rdquo; July&nbsp;2008.</span><span>)</span></a>, and the tools for interoperability have been
        called "transition mechanisms". There is some perception or
        conventional wisdom that adoption of IPv6 is being impeded by the
        deficiency of tools to facilitate interoperability of nodes or
        networks that are constrained (in some way, fully or partially) from
        full operation in one of the address families. In addition, it is
        apparent that transition will involve a period of coexistence; the
        only real question is how long that will last.
</p>
<p>Thus, coexistence is an integral part of the transition plan, not
        in conflict with it, but there will be a balancing act. It starts out
        being a way for early adopters to easily exploit the bigger IPv4
        Internet, and ends up being a way for late/never adopters to hang on
        with IPv4 (at their own expense, with minimal impact or visibility to
        the Internet). One way to look at solutions is that cost incentives
        (both monetary cost and the operational overhead for the end user)
        should encourage IPv6 and discourage IPv4. That way natural market
        forces will keep the transition moving - especially as the legacy
        IPv4-only stuff ages out of use. There will come a time to set a date
        after which no one is obligated to carry native IPv4 but it would be
        premature to attempt to do so yet. The end goal should not be to
        eliminate IPv4 by fiat, but rather render it redundant through
        ubiquitous IPv6 deployment. IPv4 may never go away completely, but
        rational plans should move the costs of maintaining IPv4 to those who
        insist on using it after wide adoption of IPv6.
</p>
<a name="uses"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Expected uses of translation</h3>

<p>There are several potential uses of translation. They are all
        easily described in terms of "interoperation between a set of systems
        that only communicate using IPv4 and a set of systems that only
        communicate using IPv6", but the differences at a detail level make
        them interesting. At minimum, these include:</p>
<ul class="text">
<li>Connection of IPv4-only islands to an IPv6-only network
</li>
<li>Connection of IPv6-only islands to an IPv4-only network
</li>
<li>Connecting IPv4-only devices with IPv6-only devices regardless of
            network type
</li>
<li>Connections between IPv4-only networks and IPv6-only networks, especially
            as a service within a large network such as an enterprise or ISP
            network or between peer networks.
</li>
</ul>

<a name="v4island"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5.1"></a><h3>1.5.1.&nbsp;
Connection of IPv4-only islands to an IPv6-only network</h3>

<p>While the basic issue is the same, there are at least two
          interesting special cases of this: connecting a small pool of legacy
          equipment with a view to eventual obsolescence, and connecting a
          legacy network with a view to eventual transition.
</p><br /><hr class="insert" />
<a name="case1"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+----+ +----+ +----+              +----+
|IPv6| |IPv6| |IPv6| +----------+ |IPv4|
|Host| |Host| |Host| |Translator| |Host|
+--+-+ +--+-+ +--+-+ +-+------+-+ +--+-+
   |      |      |     |      |      |
---+------+------+-----+-    -+------+--
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Printer pool or other legacy equipment&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the first case, <a class='info' href='#case1'>Figure&nbsp;1<span> (</span><span class='info'>Printer pool or other legacy equipment</span><span>)</span></a>, one might have a
          pool of equipment (printers, perhaps) that is IPv4-capable, but
          either the network it serves or some equipment in that network is
          IPv6-only. One pools the IPv4-only devices behind a translator,
          which enables IPv6-only systems to connect to the IPv4-only equipment. If the
          network is dual stack and only some of the equipment is IPv6-only,
          the translator should be a function of a router, and the router
          should provide normal IPv4 routing services as well as IPv6-&gt;IPv4
          translation.
</p><br /><hr class="insert" />
<a name="case2"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
        ----------
     ///          \\\
    //    IPv6      \\              192.168.1.0/24
  //      ISP         \\    +------+2001:db8:0:1::0/64
 |/                    \|   |      +---------------
 |  Allocates           |   |      |
|   2001:db8::/60 to     |  |CPE   |192.168.2.0/24
|   Customer             |  |Router|2001:db8:0:2::0/64
|                        +--+      +---------------
|   Doesn't know it,     |  |      |
 |  but sees customer   |   |      |192.168.3.0/24
 |\ IPv4 as            /|   |      |2001:db8:0:3::0/64
  \\2001:db8::a.b.c.d //    |      +---------------
    \\              //      +------+
     \\\          ///
        ----------     LIR prefix is 2001:db8::0/96
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Customer dual stack network&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#case2'>Figure&nbsp;2<span> (</span><span class='info'>Customer dual stack network</span><span>)</span></a> creates transition options to a
          customer network connected to an IPv6-only ISP, or some equivalent
          relationship. The customer might internally be using traditional
          IPv4 with NAT services, and the ISP might change its connection to
          an IPv6-only network and encourage it to transition. If the ISP
          assigns a /60 prefix to a SOHO, for example, the CPE router in the
          SOHO could distribute several dual stack subnets internally, one for
          wireless and one for each of several fixed LANs (the entertainment
          system, his office, her office, etc). One of the /64 prefixes would
          be dedicated to representing the SOHO's IPv4 addresses in the ISP or
          the IPv4 network beyond it, and the other prefixes for the various
          internal subnets. Internally, the subnets might carry prefix pairs
          192.168.n.0/24 and 2001:db8:0.n::/64 for n in 1..15 (1..0xF), and
          externally might appear as 2001:db8:0:n::/64 for the IPv6 subnets
          and 2001:db8::192.168.n.0/120 for the IPv4 devices. Note that to
          connect to an IPv4-only network beyond, RFC 1918 addresses would have to
          be statefully mapped using traditional IPv4 mechanisms somewhere; if
          this is done by the ISP, collusion on address mapping is required,
          and the case in <a class='info' href='#iviservice'>Section&nbsp;1.5.4<span> (</span><span class='info'>ISP-supported connections between IPv4-only networks and IPv6-only networks</span><span>)</span></a> is probably a
          better choice.
</p>
<p>In this environment, the key issue is that one wants a prefix
          that enables the entire <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> address space
          to be embedded in a single /64 prefix, with the assumption that any
          routing structure behind the translator is managed by IPv4
          routing.
</p>
<a name="v6island"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5.2"></a><h3>1.5.2.&nbsp;
Connection of IPv6-only islands to an IPv4-only network</h3>

<p>To be completed
</p>
<a name="v4v6connect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5.3"></a><h3>1.5.3.&nbsp;
Connecting IPv4-only devices with IPv6-only devices</h3>

<p>To be completed
</p>
<a name="iviservice"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5.4"></a><h3>1.5.4.&nbsp;
ISP-supported connections between IPv4-only networks and IPv6-only networks</h3>

<p>In this case (see <a class='info' href='#cloud'>Figure&nbsp;3<span> (</span><span class='info'>Service provider translation with multiple interchange points</span><span>)</span></a>) we presume that a
          service provider or equivalent is offering a service in a network in
          which IPv4 routing is not supported, but customers are allocated
          relatively large pools of general IPv6 addresses, suitable for
          clients of IPv4 or IPv6 hosts, and relatively small pools of
          addresses mapped to global IPv4 addresses that are intended to be
          accessible to IPv4 peers and clients through translation.
          Presumably, there are a number of such customers, and the
          administration wishes to use normal routing to manage the issues. As
          a carrier offering, there is also a need for stateless
          translation.
</p><br /><hr class="insert" />
<a name="cloud"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
     --------          --------
   //  IPv4  \\      //  IPv6  \\
  /   Domain   \    /   Domain   \
 /             +----+      +--+   \
|              |XLAT|      |S3|    |  Sn: Servers
| +--+         +----+      +--+    |  Hn: Clients
| |S1|         +----+              |
| +--+         |DNS |      +--+    |  XLAT: translator
 \     +--+    +----+      |H3|   /   DNS:  DNS Server
  \    |H1|    /    \      +--+  /
   \   +--+   /      \          /
  /            \    /            \
 /             +----+             \
| +--+         |XLAT|     +--+     |
| |S2|         +----+     |S4|     |
| +--+         +----+     +--+     |
|      +--+    |DNS |       +--+   |
 \     |H2|    +----+       |H4|  /
  \    +--+    /    \       +--+ /
   \\        //      \\        //
     --------          --------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Service provider translation with multiple interchange points&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Since <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> specifies that IPv6 prefixes
          are 64 bits or shorter apart from host routes, one wishes to
          allocate each customer a /64 mapped to a few IPv4 addresses and a
          shorter prefix for his general use. The customer's CPE advertises
          the two prefixes into the IPv6 routing domain to attract relevant
          traffic. The translator advertises the mapped equivalent of an IPv4
          default route into the IPv6 domain to attract all other traffic to
          it, for translation into the IPv4 routing domain. It also advertises
          an appropriate IPv4 prefix aggregating the mapped prefixes into the
          IPv4 domain to attract traffic intended for these customers.
</p>
<p>In this case, the LIR prefix MUST be within /32../63; a /64 puts
          the entire IPv4 address space into the host part, which is
          equivalent to the case in <a class='info' href='#v4island'>Section&nbsp;1.5.1<span> (</span><span class='info'>Connection of IPv4-only islands to an IPv6-only network</span><span>)</span></a>, and a
          prefix shorter than /32 wastes space with no redeeming argument. In
          general, the LIR prefix should be 64 bits less the length of IPv4
          prefixes it allocates to its IPv4-mapped customers. For example, if
          it is allocating a mapped IPv4 /24 to each customer, the LIR prefix
          used for mapping between IPv4 and IPv6 addresses should be a /40,
          and the least significant bits in the IPv4 address form the host
          part of the address.
</p>
<a name="proposal"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Framework</h3>

<p>Having laid out the preferred transition model and the options for
      implementing it (<a class='info' href='#why'>Section&nbsp;1.1<span> (</span><span class='info'>Why translation?</span><span>)</span></a>), defined terms(),
      considered the requirements (<a class='info' href='#requirements'>Section&nbsp;1.3<span> (</span><span class='info'>Translation objectives</span><span>)</span></a>),
      considered the transition model (<a class='info' href='#plan'>Section&nbsp;1.4<span> (</span><span class='info'>Transition Plan</span><span>)</span></a>), and
      considered the kinds of networks the facility would support (<a class='info' href='#uses'>Section&nbsp;1.5<span> (</span><span class='info'>Expected uses of translation</span><span>)</span></a>), we now turn to a framework for IPv4/IPv6
      translation. This framework has three main parts: </p>
<ul class="text">
<li>The recommended address format
</li>
<li>The functional components of a translation solution, which
          include 
<ul class="text">
<li>A DNS Application Layer Gateway,
</li>
<li>An optional stateless translator, and
</li>
<li>An optional stateful translator.
</li>
</ul>
</li>
<li>The operational characteristics of the solution.
</li>
</ul>

<a name="address"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Mapped Address Format</h3>
<br /><hr class="insert" />
<a name="mappedAddress"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
0  8  16 24 32 40 48 56 64                    127
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|  LIR Prefix  | IPv4 addr |  entirely 0        |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|&lt;-----prefix part ----&gt;|&lt;---   host part   ---&gt;|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Mapped Address Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>As shown in <a class='info' href='#mappedAddress'>Figure&nbsp;4<span> (</span><span class='info'>Mapped Address Format</span><span>)</span></a>, the mapped
        address format has three components:</p>
<blockquote class="text"><dl>
<dt>bits 0..n-1:</dt>
<dd>An LIR-specified prefix, either 32..63
            bits long or 96 bits long,
</dd>
<dt>bits n..n+31</dt>
<dd>An embedded IPv4 address. Except in the
            case of a 96 bit prefix, this address intentionally straddles the
            boundary between <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>'s 64 bit "subnet"
            locator and its 64 bit host identifier. The intention is that the
            /64 be used in routing and the bits in the host part be used for
            host identification as described in the address architecture.
</dd>
<dt>bits n+32..127:</dt>
<dd>Entirely zero; note that if n=96,
            this is null.
</dd>
</dl></blockquote>

<p>The length of the LIR-specified prefix is itself specified by the
        LIR to achieve its objectives. There are some obvious values that
        might be popular, including /40, /44, and /96, but there is no
        requirement than any of them be used; this is left to the operator's
        discretion.
</p>
<a name="components"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Translation components</h3>

<p>As noted in <a class='info' href='#uses'>Section&nbsp;1.5<span> (</span><span class='info'>Expected uses of translation</span><span>)</span></a>,translation involves
        several components. An IPv4 client or peer must be able to determine
        the address of its server by obtaining an A record from DNS even if
        the server is IPv6-only - only has an IPv6 stack, or is in an
        IPv6-only network. Similarly, an IPv6 client or peer must be able to
        determine the address of its server by obtaining an AAAA record from
        DNS even if the server is IPv4-only - only has an IPv4 stack, or is in
        an IPv4-only network. Given the address, the client/peer must be able
        to initiate a connection to the server/peer, and the server/peer must
        be able to reply. It would be very nice if this scaled to the size of
        regional networks with straightforward operational practice.
</p>
<p>To that end, we describe four subsystems:</p>
<ul class="text">
<li>A Domain Name System Translator
</li>
<li>A stateless IPv4/IPv6 translator
</li>
<li>A stateful IPv4/IPv6 translator
</li>
<li>Application Layer Gateways for some applications
</li>
</ul>

<a name="dns"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
DNS Application Layer Gateway</h3>

<p>
</p>
<p><a class='info' href='#DNS'>[DNS]<span> (</span><span class='info'>Bagnulo, M., Ed., &ldquo;Domain Name System Translator -           draft-bagnulo-behave-dns64,&rdquo; October&nbsp;2008.</span><span>)</span></a> describes the mechanisms by which a
          DNS Translator is intended to operate. It is designed to operate on
          the basis of known but fixed state: the resource records, and
          therefore the names and addresses, that it translates are known to
          the network outside of the translator, but the process of serving
          them to applications does not interact with the translator in any
          way.
</p>
<p>There are at least three possible implementations of a DNS
          Translator: </p>
<blockquote class="text"><dl>
<dt>Static records:</dt>
<dd>One could literally program DNS
              with corresponding A and AAAA records. This is most appropriate
              for stub services such as access to a legacy printer pool.
</dd>
<dt>Dynamic Translation of static records:</dt>
<dd>In more
              general operation, the expected behavior is for the application
              to request both A and AAAA records, and for an A record to be
              (retrieved and) translated by the DNS translator if and only if
              no reachable AAAA record exists. This has ephemeral issues with
              cached translations, which can be dealt with by caching only the
              source record and forcing it to be translated whenever
              accessed.
</dd>
<dt>Static or Dynamic Translation of Dynamic DNS records:</dt>
<dd>In
              Dynamic DNS usage, a system could potentially report the
              translation of a name using a Mapped IPv4 Address, or using both
              a Mapped IPv4 Address and some other address. The DNS translator
              has several options; it could store a AAAA record for the Mapped
              IPv4 Address and depend on translation of that for A records
              inline, it could store both an A and a AAAA record, or (when
              there is another IPv6 address as well which is stored as the
              AAAA record) it could store only the A record.
</dd>
</dl></blockquote>

<a name="stateless"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Stateless Translation - mapped addresses</h3>

<p><a class='info' href='#XLAT'>[XLAT]<span> (</span><span class='info'>Li, X., Ed., Bao, C., Ed., and F. Baker, Ed., &ldquo;IP/ICMP Translation Algorithm -           draft-baker-behave-v4v6-translation,&rdquo; October&nbsp;2008.</span><span>)</span></a> describes and defines the behavior of
          a stateless translator. This is an optional facility; one could
          implement or deploy only the stateful mode described in <a class='info' href='#stateful'>Section&nbsp;2.2.3<span> (</span><span class='info'>Stateful translation - unmapped IPv6 address</span><span>)</span></a>. Stateless translation enables IPv4-only
          clients and peers to initiate connections to IPv6-only servers or
          peers equipped with Mapped IPv4 Addresses, as described in <a class='info' href='#cloud'>Figure&nbsp;3<span> (</span><span class='info'>Service provider translation with multiple interchange points</span><span>)</span></a>. It also enables scalable coordination of
          IPv4-only stubs of larger enterprise or ISP IPv6-only networks as
          described in <a class='info' href='#case2'>Figure&nbsp;2<span> (</span><span class='info'>Customer dual stack network</span><span>)</span></a>.
</p>
<p>In addition, since <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>address
          selection would select a Mapped IPv4 Address when it is available,
          stateless translation enables IPv6 clients and peers with Mapped
          IPv4 Addresses to open connections with IPv4 servers and peers in a
          scalable fashion, supporting aysnchronous routes.
</p>
<a name="stateful"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Stateful translation - unmapped IPv6 address</h3>

<p><a class='info' href='#XLAT'>[XLAT]<span> (</span><span class='info'>Li, X., Ed., Bao, C., Ed., and F. Baker, Ed., &ldquo;IP/ICMP Translation Algorithm -           draft-baker-behave-v4v6-translation,&rdquo; October&nbsp;2008.</span><span>)</span></a> also describes and defines the
          behavior of the data plane component of a stateful translator. <a class='info' href='#I-D.bagnulo-behave-nat64'>[I&#8209;D.bagnulo&#8209;behave&#8209;nat64]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers,&rdquo; March&nbsp;2009.</span><span>)</span></a> describes the management
          of the state tables necessitated by stateful translation. Like
          stateful translation, this is an optional facility; one could
          implement or deploy only the stateful mode described in <a class='info' href='#stateless'>Section&nbsp;2.2.2<span> (</span><span class='info'>Stateless Translation - mapped addresses</span><span>)</span></a>. Stateful translation is defined to
          enable IPv6 clients and peers without Mapped IPv4 Addresses to
          connect to IPv4-only servers and peers.
</p>
<p>Stateful translation could be defined to enable IPv4 clients and
          peers to connect to IPv6-only servers and peers without Mapped IPv4
          Addresses. This is far more complex, however, and is out of scope in
          the present work.
</p>
<a name="other"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.4"></a><h3>2.2.4.&nbsp;
Translation gateway technologies</h3>

<p>In addition, some applications require special support. An
          example is FTP. FTP's active mode doesn't work well across NATs
          without extra support such as SOCKS. Across NATs, it generally uses
          passive mode. However, the designers of FTP inexplicably wrote
          different and incompatible passive mode implementations for IPv4 and
          IPv6 networks. Hence, either they need to fix FTP, or a translator
          must be written for the application.
</p>
<p>Other applications may be similarly broken.
</p>
<a name="ops"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Translation in operation</h3>

<p>
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Unsolved problems</h3>

<p>Just say "multicast"; this framework could support multicast, but
        at this point does not. This is a place for future work.
</p>
<p>As noted, IPv4 client/peer access to IPv6 servers and peers lacking
        Mapped IPv4 Addresses is not solved.
</p>
<p>Interoperation between IPv4-only clients and IPv6-only clients is
        not supported, and is not believed to be needed.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
IANA Considerations</h3>

<p>This memo requires no parameter assignment by the IANA.
</p>
<p>Note to RFC Editor: This section will have served its purpose if it
      correctly tells IANA that no new assignments or registries are required,
      or if those assignments or registries are created during the RFC
      publication process. From the author's perspective, it may therefore be
      removed upon publication as an RFC at the RFC Editor's discretion.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>One "security" issue has been raised, with an address format that was
      considered and rejected for that reason. At this point, the editor knows
      of no other security issues raised by the address format that are not
      already applicable to the addressing architecture in general.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Acknowledgements</h3>

<p>This is under development by a large group of people. Those who have
      posted to the list during the discussion include Andrew Sullivan, Andrew
      Yourtchenko, Brian Carpenter, Dan Wing, Ed Jankiewicz, Fred Baker,
      Hiroshi Miyata, Iljitsch van Beijnum, John Schnizlein, Kevin Yin, Magnus
      Westerlund, Marcelo Bagnulo Braun, Margaret Wasserman, Masahito Endo,
      Phil Roberts, Philip Matthews, Remi Denis-Courmont, Remi Despres, and
      Xing Li.
</p>
<p>The appendix is largely derived from Hiroshi Miyata's analysis, which
      is in turn based on documents by many of those just named.
</p>
<p>Ed Jankiewicz described the transition plan.
</p>
<p>The definition of a "Local Internet Registry" came from the
      Wikipedia, and was slightly expanded to cover the present case.
      (EDITOR'S QUESTION: Would it be better to describe this as an
      "operator-defined prefix"?)
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DNS">[DNS]</a></td>
<td class="author-text">Bagnulo, M., Ed., &ldquo;Domain Name System Translator -
          draft-bagnulo-behave-dns64,&rdquo; October&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bagnulo-behave-nat64">[I-D.bagnulo-behave-nat64]</a></td>
<td class="author-text">Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-behave-nat64-03.txt">NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers</a>,&rdquo; draft-bagnulo-behave-nat64-03 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-behave-nat64-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4291.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XLAT">[XLAT]</a></td>
<td class="author-text"><a href="mailto:xing@cernet.edu.cn">Li, X., Ed.</a>, <a href="mailto:congxiao@cernet.edu.cn">Bao, C., Ed.</a>, and F. Baker, Ed., &ldquo;IP/ICMP Translation Algorithm -
          draft-baker-behave-v4v6-translation,&rdquo; October&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.baker-behave-ivi">[I-D.baker-behave-ivi]</a></td>
<td class="author-text">Li, X., Bao, C., Baker, F., and K. Yin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-baker-behave-ivi-01.txt">IVI Update to SIIT and NAT-PT</a>,&rdquo; draft-baker-behave-ivi-01 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-baker-behave-ivi-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.durand-softwire-dual-stack-lite">[I-D.durand-softwire-dual-stack-lite]</a></td>
<td class="author-text">Durand, A., Droms, R., Haberman, B., and J. Woodyatt, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-durand-softwire-dual-stack-lite-01.txt">Dual-stack lite broadband deployments post IPv4 exhaustion</a>,&rdquo; draft-durand-softwire-dual-stack-lite-01 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-durand-softwire-dual-stack-lite-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-v6ops-addcon">[I-D.ietf-v6ops-addcon]</a></td>
<td class="author-text">Velde, G., Popoviciu, C., Chown, T., Bonness, O., and C. Hahn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-v6ops-addcon-10.txt">IPv6 Unicast Address Assignment Considerations</a>,&rdquo; draft-ietf-v6ops-addcon-10 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-v6ops-addcon-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.miyata-v6ops-snatpt">[I-D.miyata-v6ops-snatpt]</a></td>
<td class="author-text">Miyata, H. and M. Endo, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-miyata-v6ops-snatpt-02.txt">sNAT-PT: Simplified Network Address Translation - Protocol Translation</a>,&rdquo; draft-miyata-v6ops-snatpt-02 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-miyata-v6ops-snatpt-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.xli-behave-ivi">[I-D.xli-behave-ivi]</a></td>
<td class="author-text">Li, X., Bao, C., Chen, M., Zhang, H., and J. Wu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-xli-behave-ivi-07.txt">The CERNET IVI Translation Design and Deployment for the IPv4/IPv6 Coexistence and Transition</a>,&rdquo; draft-xli-behave-ivi-07 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-xli-behave-ivi-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1918">[RFC1918]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2765">[RFC2765]</a></td>
<td class="author-text"><a href="mailto:nordmark@sun.com">Nordmark, E.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2765">Stateless IP/ICMP Translation Algorithm (SIIT)</a>,&rdquo; RFC&nbsp;2765, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2765.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2766">[RFC2766]</a></td>
<td class="author-text"><a href="mailto:george.tsirtsis@bt.com">Tsirtsis, G.</a> and <a href="mailto:srisuresh@yahoo.com">P. Srisuresh</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2766">Network Address Translation - Protocol Translation (NAT-PT)</a>,&rdquo; RFC&nbsp;2766, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2766.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3056">[RFC3056]</a></td>
<td class="author-text">Carpenter, B. and K. Moore, &ldquo;<a href="http://tools.ietf.org/html/rfc3056">Connection of IPv6 Domains via IPv4 Clouds</a>,&rdquo; RFC&nbsp;3056, February&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3142">[RFC3142]</a></td>
<td class="author-text">Hagino, J. and K. Yamamoto, &ldquo;<a href="http://tools.ietf.org/html/rfc3142">An IPv6-to-IPv4 Transport Relay Translator</a>,&rdquo; RFC&nbsp;3142, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3142.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3484">[RFC3484]</a></td>
<td class="author-text">Draves, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3484">Default Address Selection for Internet Protocol version 6 (IPv6)</a>,&rdquo; RFC&nbsp;3484, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3484.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3879">[RFC3879]</a></td>
<td class="author-text">Huitema, C. and B. Carpenter, &ldquo;<a href="http://tools.ietf.org/html/rfc3879">Deprecating Site Local Addresses</a>,&rdquo; RFC&nbsp;3879, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3879.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4192">[RFC4192]</a></td>
<td class="author-text">Baker, F., Lear, E., and R. Droms, &ldquo;<a href="http://tools.ietf.org/html/rfc4192">Procedures for Renumbering an IPv6 Network without a Flag Day</a>,&rdquo; RFC&nbsp;4192, September&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4192.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4193">[RFC4193]</a></td>
<td class="author-text">Hinden, R. and B. Haberman, &ldquo;<a href="http://tools.ietf.org/html/rfc4193">Unique Local IPv6 Unicast Addresses</a>,&rdquo; RFC&nbsp;4193, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4193.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4213">[RFC4213]</a></td>
<td class="author-text">Nordmark, E. and R. Gilligan, &ldquo;<a href="http://tools.ietf.org/html/rfc4213">Basic Transition Mechanisms for IPv6 Hosts and Routers</a>,&rdquo; RFC&nbsp;4213, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4213.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4380">[RFC4380]</a></td>
<td class="author-text">Huitema, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4380">Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)</a>,&rdquo; RFC&nbsp;4380, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4380.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4862">[RFC4862]</a></td>
<td class="author-text">Thomson, S., Narten, T., and T. Jinmei, &ldquo;<a href="http://tools.ietf.org/html/rfc4862">IPv6 Stateless Address Autoconfiguration</a>,&rdquo; RFC&nbsp;4862, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4862.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4864">[RFC4864]</a></td>
<td class="author-text">Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;<a href="http://tools.ietf.org/html/rfc4864">Local Network Protection for IPv6</a>,&rdquo; RFC&nbsp;4864, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4941">[RFC4941]</a></td>
<td class="author-text">Narten, T., Draves, R., and S. Krishnan, &ldquo;<a href="http://tools.ietf.org/html/rfc4941">Privacy Extensions for Stateless Address Autoconfiguration in IPv6</a>,&rdquo; RFC&nbsp;4941, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4941.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4966">[RFC4966]</a></td>
<td class="author-text">Aoun, C. and E. Davies, &ldquo;<a href="http://tools.ietf.org/html/rfc4966">Reasons to Move the Network Address Translator - Protocol Translator (NAT-PT) to Historic Status</a>,&rdquo; RFC&nbsp;4966, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4966.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5211">[RFC5211]</a></td>
<td class="author-text">Curran, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5211">An Internet Transition Plan</a>,&rdquo; RFC&nbsp;5211, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5211.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5214">[RFC5214]</a></td>
<td class="author-text">Templin, F., Gleeson, T., and D. Thaler, &ldquo;<a href="http://tools.ietf.org/html/rfc5214">Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)</a>,&rdquo; RFC&nbsp;5214, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5214.txt">TXT</a>).</td></tr>
</table>

<a name="addresses"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Address proposals</h3>

<p>This appendix summarizes and analyzes the several proposals that have
      been made for a mapped IPv4 address. These prefixes fall into two broad
      categories: those that embed the IPv4 address into a well-known prefix,
      and those that embed it into a prefix defined by the network operator.
      <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> define
      different well-known prefixes, and <a class='info' href='#I-D.bagnulo-behave-nat64'>[I&#8209;D.bagnulo&#8209;behave&#8209;nat64]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers,&rdquo; March&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.baker-behave-ivi'>[I&#8209;D.baker&#8209;behave&#8209;ivi]<span> (</span><span class='info'>Li, X., Bao, C., Baker, F., and K. Yin, &ldquo;IVI Update to SIIT and NAT-PT,&rdquo; September&nbsp;2008.</span><span>)</span></a> define different forms of
      operator-defined prefixes.
</p>
<a name="wellknown"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Well-known address formats</h3>

<p><a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> and <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>
        define two slightly different formats of address that map between IPv4
        and IPv6. In both cases, there is a defined 96 bit prefix, and the
        IPv4 address is inserted into bits 96..127 of the IPv6 address.
</p>
<p><a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>'s address formats are as follows:
        </p>
<blockquote class="text"><dl>
<dt>IPv4-mapped:</dt>
<dd>An address of the form 0::ffff:a.b.c.d
            which refers to a node that is not IPv6-capable. In addition to
            its use in the API this protocol uses IPv4-mapped addresses in
            IPv6 packets to refer to an IPv4 node.
</dd>
<dt>IPv4-compatible:</dt>
<dd>An address of the form 0::0:a.b.c.d
            which refers to an IPv6/IPv4 node that supports automatic
            tunneling. Such addresses are not used in this protocol.
</dd>
<dt>IPv4-translated:</dt>
<dd>An address of the form
            0::ffff:0:a.b.c.d which refers to an IPv6-enabled node. Note that
            the prefix 0::ffff:0:0:0/96 is chosen to checksum to zero to avoid
            any changes to the transport protocol's pseudo header
            checksum.
</dd>
</dl></blockquote>
<br /><hr class="insert" />
<a name="address4291"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
|                80 bits               | 16 |      32 bits        |
+--------------------------------------+--------------------------+
|0000..............................0000|0000|    IPv4 address     |
+--------------------------------------+----+---------------------+
                    IPv4-Compatible IPv6 address
|                80 bits               | 16 |      32 bits        |
+--------------------------------------+--------------------------+
|0000..............................0000|FFFF|    IPv4 address     |
+--------------------------------------+----+---------------------+
                     IPv4-mapped IPv6 address
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: RFC 4291 Deprecated IPv4-mapped address formats&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="wellknownBenefit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Benefits of a well-known address</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Address Mapping:</dt>
<dd>The Well-Known Prefix allows
              automatic IPv6 address mapping to IPv4. One Well-Known Prefix
              can represent entire IPv4 network address.
</dd>
<dt>Address Selection:</dt>
<dd>It is straightforward to ensure
              that an application prefers native addressing to mapped
              addressing in selecting an address for its peer or server, as
              the <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> tables can come configured
              that way from the manufacturer. <br />
 It
              will choose its source address by <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>
              rules, which prefer the most similar prefix first. Hence, a
              system with a mapped address communicating through a translator
              will prefer its own mapped address as a source.
</dd>
<dt>Synthetic Address Detection:</dt>
<dd>If the application
              wants to know whether the address has been synthesized, this is
              straightforward.
</dd>
</dl></blockquote>

<a name="wellknownIssues"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Issues in using a well-known address</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Routing</dt>
<dd>In interdomain routing, there can be
              problems similar to those considered in <a class='info' href='#RFC3879'>[RFC3879]<span> (</span><span class='info'>Huitema, C. and B. Carpenter, &ldquo;Deprecating Site Local Addresses,&rdquo; September&nbsp;2004.</span><span>)</span></a>. For example, consider two routing
              administrations that interconnect using IPv6 and each offer
              independent <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> IPv4 domains. If an
              IPv4 client of one administration accesses an IPv6 server in the
              other network, the replies will be routed to the other network's
              <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> domain.
</dd>
<dt>Scability of discontiguous IPv4 domains:</dt>
<dd>Using a
              standard prefix for all IPv4 space means that all IPv4 access is
              through that system or through the topologically nearest
              instance of them. If the IPv4 address space is fragmented, and
              especially if it is duplicated as is done with <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> space, it is impossible to distinguish
              the access points in the IPv6 network.
</dd>
<dt>Control:</dt>
<dd>Even in intradomain routing, control
              issues can arise in routing if there is more than one
              translator.
</dd>
</dl></blockquote>

<a name="wellknownConfiguration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
Configuration of a well-known address</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Host:</dt>
<dd>To use DNS re-writing function, the IPv6
              node should be configured to send DNS query to appropriate DNS
              server somehow. But it is same as ordinary DNS configuration.
              Therefore, no special configuration is required for both IPv6
              and IPv4 hosts.
</dd>
<dt>Router:</dt>
<dd>No special configuration is required of
              routers.
</dd>
<dt>Gateway:</dt>
<dd>Each gateway needs to know the Well-Known
              Prefix, whether that means configuration of the prefix or simply
              configuration of the translation function. The Gateway must also
              be configured to advertise the Well-Known Prefix in the IPv6
              network and the relevant prefix(es) in the IPv4 network. This
              must be performed once for each gateway. If the addresses are
              mapped in statically, each mapping must be configured in the
              appropriate gateway. This configuration must be performed
              [number of mapped prefixes] * [number of sharing gateway]
              times.
</dd>
<dt>DNS</dt>
<dd>The DNS re-writing function must be configured
              with the Well-Known Prefix to synthesize AAAA records from A
              records for IPv6 clients, but it may be configured by default.
              This configuration must be performed [number of Local Prefix]
              times.
</dd>
</dl></blockquote>

<a name="wellknownApplicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.4"></a><h3>A.1.4.&nbsp;
Applicability of a well-known address</h3>

<p></p>
<ul class="text">
<li>Small scale translation (Home Network).
</li>
<li>Less redundant translation service (no load balancing).
</li>
<li>Stub IPv6 network.
</li>
</ul>

<p>Sample configurations include:</p>
<blockquote class="text">
<p>To provide the access from IPv6 client in stub IPv6 network
              to global IPv4 server, place the gateway at the edge of IPv6
              stub site.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="stub6_global4"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
(IPv6 stub network)                          (IPv4 global network)
[IPv6 Client]----&gt;---[Gateway]-----&gt;----+------------[IPv4 Server]
                                        |
                                        +------------[IPv4 Server]]]
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: IPv6 to global IPv4 (Client Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>To provide the access from IPv6 client in stub IPv6 network
              to private/global IPv4 server (IPv6 stub network attached to a
              private IPv4 network), place the gateway at the edge of IPv6
              stub network.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="stub6_private4"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>

(IPv6 stub network)                          (IPv4 private network)
[IPv6 Client]----&gt;---[Gateway]-----&gt;----+------------[IPv4 Server]
                                        |
                                      [NAT]
                                        |
                                        +------------[IPv4 Server]
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: IPv6 to global IPv4 (Client Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="operator"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Network operator specified prefixes</h3>

<p>Two forms of network operator specified addresses have been
        proposed, one of them in several minor variations. In short, both have
        the network operator specify a prefix into which an IPv4 address is
        embedded, either in bits 96..127 or following a shorter prefix.
</p>
<p>Since one is a special case of the other (the LIR prefix is 96 bits
        as opposed to being variable), it would be tempting to comment on the
        two together. The operational similarities will be great, and the
        differences will revolve around the economics of the prefix that the
        IPv4 address is embedded into But to make them clear, we will review
        them separately.
</p>
<a name="ivi"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
The IVI prefix</h3>

<p>The <a class='info' href='#I-D.xli-behave-ivi'>IVI Address<span> (</span><span class='info'>Li, X., Bao, C., Chen, M., Zhang, H., and J. Wu, &ldquo;The CERNET IVI Translation Design and Deployment for the IPv4/IPv6 Coexistence and Transition,&rdquo; January&nbsp;2010.</span><span>)</span></a> [I&#8209;D.xli&#8209;behave&#8209;ivi] <a class='info' href='#I-D.baker-behave-ivi'>[I&#8209;D.baker&#8209;behave&#8209;ivi]<span> (</span><span class='info'>Li, X., Bao, C., Baker, F., and K. Yin, &ldquo;IVI Update to SIIT and NAT-PT,&rdquo; September&nbsp;2008.</span><span>)</span></a>, shown in <a class='info' href='#iviAddress'>Figure&nbsp;8<span> (</span><span class='info'>IVI Address Format</span><span>)</span></a>, has a variable length prefix specified
          by the operator followed by the IPv4 address, and the remainder
          filled with zero. Observing <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>'s
          requirement that an operator-specified prefix should have 64 bits of
          subnet locator and 64 bits of host interface identifier, IVI
          suggests that the operator divide the mapped IPv4 prefix into a
          subnet part and a host part, and assign a prefix from its allocation
          that with the subnet part fills 64 bits.
</p><br /><hr class="insert" />
<a name="iviAddress"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
0  8  16 24 32 40 48 56 64                    127
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|  LIR Prefix  | IPv4 addr |  entirely 0        |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|&lt;-----prefix part ----&gt;|&lt;---   host part   ---&gt;|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: IVI Address Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The impact of the variability of the LIR Prefix has to do with
          service offerings. If a network operator wishes to offer customers a
          general IPv6 prefix such as a /48 plus a smaller IPv4-mapped set of
          addresses for IPv4-accessible servers, such as an IPv4 /24, he might
          literally design a service in which each customer gets a general /48
          prefix and an IPv4-mapped /64 prefix. To accomplish this, the
          operator would allocate a /40 for the LIR prefix and embed the IPv4
          address space into it. His Advertised IPv4 Prefix would aggregate
          the Mapped IPv4 Prefixes that he in turn assigns to his customers.
          If, however, he wanted to assign smaller units, such as /28s to each
          customer, he would allocate a shorter prefix such as a /36 as the
          LIR Prefix.
</p>
<p>There are clear trade-offs here; the point is to enable the
          network operator to optimize them for the service he wants to
          offer.
</p>
<a name="iviBenefit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.1"></a><h3>A.2.1.1.&nbsp;
Benefits of an operator-specified /32../64 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Address Mapping:</dt>
<dd>A Mapped IPv4 Address format
                allows a stateless IPv6 address mapping between an IPv4
                address and its mapped IPv6 counterpart. One such prefix can
                represent the entire IPv4 address space, and if desired
                multiple prefixes can represent multiple instances of it or
                accesses to it.
</dd>
<dt>Address Selection:</dt>
<dd><a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> selection rules select the source
                address most similar to the destination address in question,
                which is to say matching the longest prefix. In general, one
                would expect a system with an address of this type to prefer
                IPv6 source addresses derived from IPv4 addresses when they
                are available.
</dd>
<dt>Synthetic Address Detection:</dt>
<dd>If the <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> tables in a host are configured with
                the administration's translation prefix, a policy can be made
                to prefer native IPv4 to translation, or to prefer any other
                IPv6 address to a translated address.
</dd>
<dt>Managing Multiple Gateways:</dt>
<dd>The administration
                has the option of using the same prefix on multiple gateways,
                or of using different prefixes. Differing administrations will
                almost assuredly use different prefixes. This enables the
                administration to distinguish between distinct address spaces
                such as separate instances of the <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> address space. It also enables
                multiple gateways to be used to interconnect between public
                IPv4 and IPv6 networks without having to manage the state
                maintained by such translation gateways.
</dd>
<dt>Scalability:</dt>
<dd>Due to the ability to support
                multiple gateways between the same two domains statelessly and
                the ability to identify multiple instances of the same IPv4
                address space when appropriate, a network operator specified
                prefix is scalable through normal routing structures.
</dd>
<dt>Flexibility</dt>
<dd>Since the prefix choice is under the
                network's control, routing is managed relatively easily.
</dd>
<dt>TCP/UDP Checksums:</dt>
<dd>These prefixes were chosen to
                make it unnecessary to adjust TCP/UDP checksums.
</dd>
</dl></blockquote>

<a name="iviIssues"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.2"></a><h3>A.2.1.2.&nbsp;
Issues in using an operator-specified /32../64 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Synthetic Address Detection:</dt>
<dd>By default, hosts
                are unlikely to come configured with the administration's
                translation prefix in their <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>
                tables, and so are unlikely to be able to distinguish such
                addresses from other IPv6 addresses.
</dd>
<dt>Private address spaces</dt>
<dd>Multiple small (and
                perhaps overlapping) address spaces are readily supported in
                what might be called a network model. However, these consume
                much larger blocks of IPv6 address space than the appliance
                model of a Local Prefix (<a class='info' href='#localPrefix'>Appendix&nbsp;A.2.2<span> (</span><span class='info'>Network operator specified /96 prefixes</span><span>)</span></a>)
                does.
</dd>
<dt>IPv4 Address Efficiency:</dt>
<dd>As noted above, IVI is
                less efficient than the NAT64 model in enumerating small IPv4
                islands, and having a prefix per network operator is less
                efficient on a global basis than having a single well-known
                prefix.
</dd>
<dt>Routing:</dt>
<dd>If one uses both stateless and stateful
                translation in the same network, assigning a normal IPv6
                prefix to all systems and additionally mapped addresses to
                servers, then one needs two routes, one for each prefix.
                Reducing this burden requires either the total use of stateful
                translation, disabling IPv4 clients access to IPv6 servers, or
                total use of stateless translation, meaning that one
                effectively assigns an IPv4 address to every host.
</dd>
<dt>Service model:</dt>
<dd>One would generally expect an IVI
                address to be used in an ISP service, as it requires a 40 bit
                prefix assigned by the operator in most cases. It could be
                used with a <a class='info' href='#RFC4193'>ULA<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> [RFC4193] in an edge
                network at the cost of losing global routability.
</dd>
<dt>TCP/UDP checksums</dt>
<dd>Using an operator-specified
                prefix requires the translator to adjust TCP and UDP
                checksums.
</dd>
</dl></blockquote>

<a name="iviConfiguration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.3"></a><h3>A.2.1.3.&nbsp;
Configuration of an operator-specified /32../64 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Host assignment:</dt>
<dd>In general, one would expect a
                mapped IPv4 address to be assigned in the same way that IPv4
                addresses are assigned; this would call for the use of DHCPv6
                or manual configuration.
</dd>
<dt>Router:</dt>
<dd>If one or more hosts on a LAN are
                assigned mapped IPv4 addresses, one or more routers on the LAN
                needs configuration of the corresponding Mapped IPv4 Prefix,
                and to have that advertised as a route in the IPv6 domain.
</dd>
<dt>Gateway:</dt>
<dd>The gateway needs to advertise three
                prefixes: 
<ul class="text">
<li>The Advertised IPv4 Prefix is advertised into the IPv4
                    domain to attract traffic that needs translation to
                    IPv6.
</li>
<li>The Overlay IPv4 Prefix, if stateful translation is in
                    use, is advertised into the IPv4 domain to attract traffic
                    using that translation facility.
</li>
<li>The LIR Prefix is advertised into the IPv6 domain to
                    attract traffic that needs translation to IPv4.
</li>
</ul>
</dd>
<dt>DNS:</dt>
<dd>The DNS re-writing function must be
                configured with the LIR Prefix to synthesize the AAAA records
                for IPv6 nodes when appropriate. <br />
 The
                DNS server needs to be configured with the information to
                develop A records when appropriate. This may be accomplished
                using Dynamic DNS or manual configuration. This may mean
                configuration of IPv4 A records that get translated to AAAA
                records, or configuration of IPv6 AAAA records that are
                recognized by the DNS server.
</dd>
</dl></blockquote>

<a name="iviApplicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.4"></a><h3>A.2.1.4.&nbsp;
Applicability of an operator-specified /32../64 prefix</h3>

<p></p>
<ul class="text">
<li>The IVI address is appropriate to large scale, ISP grade,
                translation, while the NAT64 address is more flexible.
</li>
<li>Highly redundant translation service.
</li>
<li>Places where IPv4 clients need to access IPv6 servers.
</li>
<li>Places where IPv6 clients and peers need to access IPv4
                servers and peers.
</li>
</ul>

<a name="localPrefix"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2"></a><h3>A.2.2.&nbsp;
Network operator specified /96 prefixes</h3>

<p><a class='info' href='#I-D.bagnulo-behave-nat64'>NAT64<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers,&rdquo; March&nbsp;2009.</span><span>)</span></a> [I&#8209;D.bagnulo&#8209;behave&#8209;nat64] and <a class='info' href='#I-D.miyata-v6ops-snatpt'>SNATPT<span> (</span><span class='info'>Miyata, H. and M. Endo, &ldquo;sNAT-PT: Simplified Network Address Translation - Protocol Translation,&rdquo; September&nbsp;2008.</span><span>)</span></a> [I&#8209;D.miyata&#8209;v6ops&#8209;snatpt] each specify an
          address that, like the well-known addresses of <a class='info' href='#wellknown'>Appendix&nbsp;A.1<span> (</span><span class='info'>Well-known address formats</span><span>)</span></a> and the "Dummy Address" of <a class='info' href='#RFC2766'>[RFC2766]<span> (</span><span class='info'>Tsirtsis, G. and P. Srisuresh, &ldquo;Network Address Translation - Protocol Translation (NAT-PT),&rdquo; February&nbsp;2000.</span><span>)</span></a> and <a class='info' href='#RFC3142'>[RFC3142]<span> (</span><span class='info'>Hagino, J. and K. Yamamoto, &ldquo;An IPv6-to-IPv4 Transport Relay Translator,&rdquo; June&nbsp;2001.</span><span>)</span></a>, has 96
          bits of operator-specified prefix and the IPv4 address in bits
          96..127. This is shown in <a class='info' href='#localAddress'>Figure&nbsp;9<span> (</span><span class='info'>NAT64 Address Format</span><span>)</span></a>. In
          some proposals, the "IDENT" field is always zero, and in others it
          enumerates different instances of the IPv4 address space.
</p><br /><hr class="insert" />
<a name="localAddress"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                                          1             1
          1         2       6         7   9             2
0123456789012345678901234...01234567890...01234567890...012345678
+------------------------//-----+------//-------+----//---------+
|            IPv6 Prefix        |     IDENT     | IPv4 Address  |
|               64 bit          |     32 bit    |     32 bit    |
+------------------------//-----+------//-------+----//---------+
|                               |               |
|&lt;-----------PREFIX64----------&gt;|&lt;-identifier--&gt;|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: NAT64 Address Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>A similar address format, with an "IDENT" based on the IANA OUI,
          is used by <a class='info' href='#RFC5214'>ISATAP<span> (</span><span class='info'>Templin, F., Gleeson, T., and D. Thaler, &ldquo;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP),&rdquo; March&nbsp;2008.</span><span>)</span></a> [RFC5214]; if a
          globally-unique "IDENT" field is selected, it needs to differ from
          that value.
</p>
<a name="localBenefit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2.1"></a><h3>A.2.2.1.&nbsp;
Benefits of an operator-specified /96 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Address Mapping:</dt>
<dd>A Mapped IPv4 Address format
                allows a stateless IPv6 address mapping between an IPv4
                address and its mapped IPv6 counterpart. One such prefix can
                represent the entire IPv4 address space, and if desired
                multiple prefixes can represent multiple instances of it or
                accesses to it.
</dd>
<dt>Address Selection:</dt>
<dd><a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> selection rules select the source
                address most similar to the destination address in question,
                which is to say matching the longest prefix. In general, one
                would expect a system with an address of this type to prefer
                IPv6 source addresses derived from IPv4 addresses when they
                are available.
</dd>
<dt>Synthetic Address Detection:</dt>
<dd>If the <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> tables in a host are configured with
                the administration's translation prefix, a policy can be made
                to prefer native IPv4 to translation, or to prefer any other
                IPv6 address to a translated address.
</dd>
<dt>Private address spaces</dt>
<dd>Multiple small (and
                perhaps overlapping) address spaces are readily supported in
                what might be called an appliance model; for example, if SOHOs
                are using IPv4 internally, the IPv6 ISP can give a /64 to each
                and manage them easily.
</dd>
<dt>Managing Multiple Gateways:</dt>
<dd>The administration
                has the option of using the same prefix on multiple gateways,
                or of using different prefixes. This approach enables multiple
                gateways to be used to interconnect between IPv4 and IPv6
                networks without having to manage the state maintained by such
                translation gateways.
</dd>
<dt>Scalability:</dt>
<dd>Due to the ability to support
                multiple gateways between the same two domains statelessly and
                the ability to identify multiple instances of the same IPv4
                address space when appropriate, a network operator specified
                prefix is scalable through normal routing structures.
</dd>
<dt>Flexibility</dt>
<dd>Since the prefix choice is under the
                network's control, routing is managed relatively easily.
</dd>
</dl></blockquote>

<a name="localIssues"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2.2"></a><h3>A.2.2.2.&nbsp;
Issues in using an operator-specified /96 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Synthetic Address Detection:</dt>
<dd>By default, hosts
                are unlikely to come configured with the administration's
                translation prefix in their <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>
                tables, and so are unlikely to be able to distinguish such
                addresses from other IPv6 addresses.
</dd>
<dt>Routing:</dt>
<dd>If one uses both stateless and stateful
                translation in the same network, assigning a normal IPv6
                prefix to all systems and additionally mapped addresses to
                servers, then one needs two routes, one for each prefix.
                Reducing this burden requires either the total use of stateful
                translation, disabling IPv4 clients access to IPv6 servers, or
                total use of stateless translation, meaning that one
                effectively assigns an IPv4 address to every host.
</dd>
<dt>Service model:</dt>
<dd>One would generally expect an IVI
                address to be used in an ISP service, as it requires a 40 bit
                prefix assigned by the operator in most cases. It could be
                used with a <a class='info' href='#RFC4193'>ULA<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> [RFC4193] in an edge
                network at the cost of losing global routability. The NAT64
                address, on the other hand, has no such issue.
</dd>
<dt>Synthetic Address Detection:</dt>
<dd>It is difficult to
                identify a mapped IPv4 address without knowledge that the
                mapping algorithm is used with a specific prefix.
</dd>
<dt>Address Configuration:</dt>
<dd>Since IPv4 addresses are
                allocated by DHCP servers or manually, it is inappropriate to
                mix Local Prefix IPv4-mapped addresses with <a class='info' href='#RFC4862'>Address Autoconfiguration<span> (</span><span class='info'>Thomson, S., Narten, T., and T. Jinmei, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4862] <a class='info' href='#RFC4941'>[RFC4941]<span> (</span><span class='info'>Narten, T., Draves, R., and S. Krishnan, &ldquo;Privacy Extensions for Stateless Address Autoconfiguration in IPv6,&rdquo; September&nbsp;2007.</span><span>)</span></a> in the same prefix. This may not be
                obvious to a provider that thinks of itself as simply
                assigning a /64 IPv6 prefix to the SOHO (regarding which see
                <a class='info' href='#I-D.ietf-v6ops-addcon'>[I&#8209;D.ietf&#8209;v6ops&#8209;addcon]<span> (</span><span class='info'>Velde, G., Popoviciu, C., Chown, T., Bonness, O., and C. Hahn, &ldquo;IPv6 Unicast Address Assignment Considerations,&rdquo; September&nbsp;2008.</span><span>)</span></a>).
</dd>
<dt>Routing</dt>
<dd>Routing is readily handled in the IPv4
                network. However, if routing of IPv4-mapped prefixes is
                desired in the IPv6 network, we are forced to use prefixes in
                the neighborhood of /96../128. Apart from routing host
                addresses, <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> frowns on this,
                preferring routing prefixes to be 64 bits or shorter and
                leaving a 64 bit host ID.
</dd>
<dt>TCP/UDP Checksums:</dt>
<dd>Using an operator-specified
                prefix requires the translator to adjust TCP and UDP
                checksums.
</dd>
</dl></blockquote>

<a name="localConfiguration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2.3"></a><h3>A.2.2.3.&nbsp;
Configuration of an operator-specified /96 prefix</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Host assignment:</dt>
<dd>In general, one would expect a
                mapped IPv4 address to be assigned in the same way that IPv4
                addresses are assigned; this would call for the use of DHCPv6
                or manual configuration.
</dd>
<dt>Router:</dt>
<dd>If one or more hosts on a LAN are
                assigned mapped IPv4 addresses, one or more routers on the LAN
                needs configuration of the corresponding Mapped IPv4 Prefix,
                and to have that advertised as a route in the IPv6 domain.
</dd>
<dt>Gateway:</dt>
<dd>The gateway needs to advertise two
                prefixes: 
<ul class="text">
<li>The Advertised IPv4 Prefix is advertised into the IPv4
                    domain to attract traffic that needs translation to
                    IPv6.
</li>
<li>The LIR Prefix is advertised into the IPv6 domain to
                    attract traffic that needs translation to IPv4.
</li>
</ul>
</dd>
<dt>DNS:</dt>
<dd>The DNS re-writing function must be
                configured with the LIR Prefix to synthesize the AAAA records
                for IPv6 nodes when appropriate. <br />
 The
                DNS server needs to be configured with the information to
                develop A records when appropriate. This may be accomplished
                using Dynamic DNS or manual configuration. This may mean
                configuration of IPv4 A records that get translated to AAAA
                records, or configuration of IPv6 AAAA records that are
                recognized by the DNS server.
</dd>
</dl></blockquote>

<a name="localApplicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2.4"></a><h3>A.2.2.4.&nbsp;
Applicability of an operator-specified /96 prefix</h3>

<p></p>
<ul class="text">
<li>Local Prefixes are appropriate to small networks that have
                little internal IPv6 structure, such as server pools or SOHO
                clients. The structure in the IPv4 network is as with any IPv4
                network, making this appropriate to medium sized IPv4
                domains.
</li>
<li>Highly redundant translation service.
</li>
<li>Places where IPv4 clients need to access IPv6 servers.
</li>
<li>Places where IPv6 clients and peers need to access IPv4
                servers and peers.
</li>
</ul>

<p>Sample configurations include:
</p>
<p></p>
<blockquote class="text">
<p>Place the gateway at the edge of IPv6 stub site.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="client_side_gateway"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
(IPv6 stub network)                          (IPv4 global network)
[IPv6 Client]----&gt;---[Gateway]-----&gt;----+------------[IPv4 Server]
                                        |
                                        +------------[IPv4 Server]
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: IPv6 to global IPv4 (Client Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>Place the gateway in front of IPv4 server.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="server_side_gateway"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
(IPv6 global network)                        (IPv4 global network)
[IPv6 Client]---------+------&gt;------[Gateway]----&gt;---[IPv4 Server]
                      |
[IPv6 Client]---------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: IPv6 to global IPv4 (Server Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>to provide the access from IPv6 client to private IPv4
                server, place the gateway in front of IPv4 private
                network.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="private_ipv4"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
(IPv6 global network)                       (IPv4 private network)
[IPv6 Client]---------+------&gt;------[Gateway]----&gt;---[IPv4 Server]
                      |
[IPv6 Client]---------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: IPv6 to private IPv4 (Server Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>To provide the access from IPv4 client to IPv6 server by
                static 1:1 mapping, place the gateway at the edge of IPv4 stub
                site.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="ipv4_to_ipv6"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
(IPv6 global network)                       (IPv4 private network)
[IPv6 Server]---------+------&lt;------[Gateway]---&lt;----[IPv4 Client]
                      |
[IPv6 Server]---------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: Private IPv4 to IPv6 (Client Side Gateway)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fred Baker (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Barbara, California  93117</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-526-4257</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+1-413-473-2403</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fred@cisco.com">fred@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
