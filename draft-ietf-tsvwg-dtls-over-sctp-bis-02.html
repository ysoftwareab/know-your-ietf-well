<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</title>
<meta content="Magnus Westerlund" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Claudio Porfiri" name="author">
<meta content="
       This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol to protect user messages sent over the
   Stream Control Transmission Protocol (SCTP). It is an improved
   update of the existing rfc6083. 
       DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and replay protection for applications that
   use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery. 
       Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document intends
   to obsolete RFC 6083 and removes the 16 kB limitation due to DTLS
   on user message size by defining a secure user message
   fragmentation so that multiple DTLS records can be used to protect
   a single user message. It further updates the DTLS versions to use,
   as well as the HMAC algorithms for SCTP-AUTH, and simplifies secure
   implementation by some stricter requirements on the establishment
   procedures. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="draft-ietf-tsvwg-dtls-over-sctp-bis-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-tsvwg-dtls-over-sctp-bis-02-sh_pktrg.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS over SCTP</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tsvwg-dtls-over-sctp-bis-02</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6083" class="eref">6083</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Porfiri</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol to protect user messages sent over the
   Stream Control Transmission Protocol (SCTP). It is an improved
   update of the existing rfc6083.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and replay protection for applications that
   use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document intends
   to obsolete RFC 6083 and removes the 16 kB limitation due to DTLS
   on user message size by defining a secure user message
   fragmentation so that multiple DTLS records can be used to protect
   a single user message. It further updates the DTLS versions to use,
   as well as the HMAC algorithms for SCTP-AUTH, and simplifies secure
   implementation by some stricter requirements on the establishment
   procedures.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  TSVWG Working Group mailing list (tsvwg@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis">https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-comparison-with-tls-for-sct" class="xref">Comparison with TLS for SCTP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-changes-from-rfc-6083" class="xref">Changes from RFC 6083</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-dtls-version" class="xref">DTLS Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-abbreviations" class="xref">Abbreviations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-dtls-considerations" class="xref">DTLS Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-version-of-dtls" class="xref">Version of DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-cipher-suites-and-cryptogra" class="xref">Cipher Suites and Cryptographic Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-message-sizes" class="xref">Message Sizes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-replay-protection" class="xref">Replay Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-path-mtu-discovery" class="xref">Path MTU Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-retransmission-of-messages" class="xref">Retransmission of Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-sctp-considerations" class="xref">SCTP Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-mapping-of-dtls-records" class="xref">Mapping of DTLS Records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-dtls-connection-handling" class="xref">DTLS Connection Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-payload-protocol-identifier" class="xref">Payload Protocol Identifier Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-stream-usage" class="xref">Stream Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-chunk-handling" class="xref">Chunk Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-sctp-auth-hash-function" class="xref">SCTP-AUTH Hash Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-parallel-dtls-connections" class="xref">Parallel DTLS connections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-renegotiation-and-keyupdate" class="xref">Renegotiation and KeyUpdate</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="xref">4.8.1</a>.  <a href="#name-dtls-12-considerations" class="xref">DTLS 1.2 Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="xref">4.8.2</a>.  <a href="#name-dtls-13-considerations" class="xref">DTLS 1.3 Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-dtls-epochs" class="xref">DTLS Epochs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.1">
                    <p id="section-toc.1-1.4.2.9.2.1.1"><a href="#section-4.9.1" class="xref">4.9.1</a>.  <a href="#name-dtls-12-considerations-2" class="xref">DTLS 1.2 Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.2">
                    <p id="section-toc.1-1.4.2.9.2.2.1"><a href="#section-4.9.2" class="xref">4.9.2</a>.  <a href="#name-dtls-13-considerations-2" class="xref">DTLS 1.3 Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="xref">4.10</a>. <a href="#name-handling-of-endpoint-pair-s" class="xref">Handling of Endpoint-Pair Shared Secrets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.1">
                    <p id="section-toc.1-1.4.2.10.2.1.1"><a href="#section-4.10.1" class="xref">4.10.1</a>.  <a href="#name-dtls-12-considerations-3" class="xref">DTLS 1.2 Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.2">
                    <p id="section-toc.1-1.4.2.10.2.2.1"><a href="#section-4.10.2" class="xref">4.10.2</a>.  <a href="#name-dtls-13-considerations-3" class="xref">DTLS 1.3 Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11">
                <p id="section-toc.1-1.4.2.11.1"><a href="#section-4.11" class="xref">4.11</a>. <a href="#name-shutdown" class="xref">Shutdown</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-dtls-over-sctp-service" class="xref">DTLS over SCTP Service</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-adaptation-layer-indication" class="xref">Adaptation Layer Indication in INIT/INIT-ACK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-dtls-over-sctp-initializati" class="xref">DTLS over SCTP Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-client-use-case" class="xref">Client Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-server-use-case" class="xref">Server Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-rfc-6083-fallback" class="xref">RFC 6083 Fallback</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-socket-api-considerations" class="xref">Socket API Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-socket-option-to-get-the-hm" class="xref">Socket Option to Get the HMAC Identifier being Sent (SCTP_SEND_HMAC_IDENT)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-exposing-the-hmac-identifie" class="xref">Exposing the HMAC Identifiers being Received</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-socket-option-to-expose-hma" class="xref">Socket Option to Expose HMAC Identifier Usage (SCTP_EXPOSE_HMAC_IDENT_CHANGES)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-tls-exporter-label" class="xref">TLS Exporter Label</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-sctp-adaptation-layer-indic" class="xref">SCTP Adaptation Layer Indication Code Point</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-cryptographic-consideration" class="xref">Cryptographic Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-downgrade-attacks" class="xref">Downgrade Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-authentication-and-policy-d" class="xref">Authentication and Policy Decisions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-pervasive-monitoring" class="xref">Pervasive Monitoring</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-motivation-for-changes" class="xref">Motivation for Changes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="overview">
<section id="section-1.1">
        <h3 id="name-overview">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.1-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol, as defined in DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, and
   DTLS 1.3 <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, over the Stream Control
   Transmission Protocol (SCTP), as defined in <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span> with
   Authenticated Chunks for SCTP (SCTP-AUTH) <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This specification provides mutual authentication of endpoints,
   confidentiality, integrity protection, and replay protection of
   user messages for applications that use SCTP as their transport
   protocol.  Thus, it allows client/server applications to communicate
   in a way that is designed to give communications privacy and to
   prevent eavesdropping and detect tampering or message
   forgery. DTLS/SCTP uses DTLS for mutual authentication, key
   exchange with perfect forward secrecy for SCTP-AUTH, and
   confidentiality of user messages. DTLS/SCTP use SCTP and SCTP-AUTH
   for integrity protection and replay protection of user messages.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. DTLS/SCTP supports:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">preservation of message boundaries.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">a large number of unidirectional and bidirectional streams.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">ordered and unordered delivery of SCTP user messages.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">the partial reliability extension as defined in <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span>.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.5">the dynamic address reconfiguration extension as defined in
    <span>[<a href="#RFC5061" class="xref">RFC5061</a>]</span>.<a href="#section-1.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.6">User messages of a size up to 2^64-1.<a href="#section-1.1-4.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">The method described in this document requires that the SCTP
implementation supports the optional feature of fragmentation of SCTP
user messages as defined in <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>. The implementation is
required to have an SCTP API (for example the one described in
<span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>) that supports partial user message delivery and also
recommended that I-DATA chunks as defined in <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> is used to
efficiently implement and support larger user messages.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">To simplify implementation and reduce the risk for security holes,
limitations have been defined such that STARTTLS as specified in
<span>[<a href="#RFC3788" class="xref">RFC3788</a>]</span> is no longer supported.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<div id="comparison-with-tls-for-sctp">
<section id="section-1.1.1">
          <h4 id="name-comparison-with-tls-for-sct">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-comparison-with-tls-for-sct" class="section-name selfRef">Comparison with TLS for SCTP</a>
          </h4>
<p id="section-1.1.1-1">TLS, from which DTLS was derived, is designed to run on top of a
byte-stream-oriented transport protocol providing a reliable, in-
sequence delivery. TLS over SCTP as described in <span>[<a href="#RFC3436" class="xref">RFC3436</a>]</span> has
some serious limitations:<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.1-2.1">It does not support the unordered delivery of SCTP user messages.<a href="#section-1.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.2">It does not support partial reliability as defined in
 <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span>.<a href="#section-1.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.3">It only supports the usage of the same number of streams in both
    directions.<a href="#section-1.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.4">It uses a TLS connection for every bidirectional stream, which
    requires a substantial amount of resources and message exchanges
    if a large number of streams is used.<a href="#section-1.1.1-2.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="changes-from-rfc-6083">
<section id="section-1.1.2">
          <h4 id="name-changes-from-rfc-6083">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-changes-from-rfc-6083" class="section-name selfRef">Changes from RFC 6083</a>
          </h4>
<p id="section-1.1.2-1">The DTLS over SCTP solution defined in RFC 6083 had the following
limitations:<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-2.1">The maximum user message size is 2^14 (16384) bytes, which is a single
    DTLS record limit.<a href="#section-1.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-2.2">DTLS 1.0 has been deprecated for RFC 6083 requiring at least DTLS
1.2 <span>[<a href="#RFC8996" class="xref">RFC8996</a>]</span>. This creates additional limitation as discussed in
<a href="#DTLS-version" class="xref">Section 1.2</a>.<a href="#section-1.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.2-3">This update that replaces RFC 6083 defines the following changes:<a href="#section-1.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-4.1">Removes the limitations on user messages sizes by defining a
   secure fragmentation mechanism.<a href="#section-1.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.2">Enable DTLS key-change without draining<a href="#section-1.1.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.3">Mandates that more modern DTLS version are required (DTLS 1.2 or
   1.3)<a href="#section-1.1.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.4">Mandates support of modern HMAC algorithm (SHA-256) in the SCTP
   authentication extension <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-1.1.2-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.5">Recommends support of <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> to enable interleaving of large
   SCTP user messages to avoid scheduling issues.<a href="#section-1.1.2-4.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.6">Applies stricter requirements on always using DTLS for all user
   messages in the SCTP association.<a href="#section-1.1.2-4.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.7">Requires that SCTP-AUTH is applied to all SCTP Chunks that can be
   authenticated.<a href="#section-1.1.2-4.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.8">Requires support of partial delivery of user messages.<a href="#section-1.1.2-4.8" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="DTLS-version">
<section id="section-1.2">
        <h3 id="name-dtls-version">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-dtls-version" class="section-name selfRef">DTLS Version</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.2-1.1">The number of renegotiations in DTLS 1.2 is limited to 65534 compared to
unlimited in DTLS 1.0.<a href="#section-1.2-1.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-2">Using DTLS 1.2 instead of using DTLS 1.0 limits the lifetime of a DTLS
connection and the data volume which can be transferred over a DTLS
connection.  This is caused by:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-3.1">The number of renegotiations in DTLS 1.2 is limited to 65534
compared to unlimited in DTLS 1.0.<a href="#section-1.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.2">While the AEAD limits in DTLS 1.3 does not formally apply to DTLS
1.2 the mathematical limits apply equally well to DTLS 1.2.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-4">DTLS 1.3 comes with a large number of significant changes.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-5.1">Renegotiations are not supported and instead partly replaced by
KeyUpdates. The number of KeyUpdates is limited to 2^64.<a href="#section-1.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-5.2">Strict AEAD significantly limits on how much many packets can be
sent before rekeying.<a href="#section-1.2-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-6">Many applications using DTLS/SCTP are of semi-permanent nature and use
SCTP associations with expected lifetimes of months or even years, and
where there is a significant cost of bringing down the SCTP
association in order to restart it. Such DTLS/SCTP usages that
need:<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.1">Periodic re-authentication of both endpoints (not only the DTLS
client).<a href="#section-1.2-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-7.2">Periodic rerunning of Diffie-Hellman key-exchange to provide
Perfect Forward Secrecy (PFS) to reduce the impact any key-reveal.<a href="#section-1.2-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-7.3">Perform SCTP-AUTH re-keying.<a href="#section-1.2-7.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-8">At the time of publication DTLS 1.3 does not support any of these,
where DTLS 1.2 renegotiation functionality can provide this
functionality in the context of DTLS/SCTP. To address these
requirements from semi-permanent applications, this document use
several overlapping DTLS connections with either DTLS 1.2 or
1.3. Having uniform procedures reduces the impact when upgrading from
1.2 to 1.3 and avoids using the renegotiation mechanism which is
disabled by default in many DTLS implementations.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
<p id="section-1.2-9">To address known vulnerabilities in DTLS 1.2 this document describes
and mandates implementation constraints on ciphers and protocol
options. The DTLS 1.2 renegotiation mechanism is forbidden to be used
as it creates need for additional mechanism to handle race conditions
and interactions between using DTLS connections in parallel.<a href="#section-1.2-9" class="pilcrow">¶</a></p>
<p id="section-1.2-10">In the rest of the document, unless the version of DTLS is
specifically called out the text applies to both versions of DTLS.<a href="#section-1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">This document uses the following terms:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Association:  An SCTP association.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">Connection:  An DTLS connection. It is uniquely
identified by a connection identifier.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">Stream: A unidirectional stream of an SCTP association.  It is uniquely
identified by a stream identifier.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="abbreviations">
<section id="section-1.4">
        <h3 id="name-abbreviations">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<p id="section-1.4-1">AEAD:  Authenticated Encryption with Associated Data<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">DTLS:  Datagram Transport Layer Security<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">HMAC: Keyed-Hash Message Authentication Code<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">MTU:  Maximum Transmission Unit<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">PFS:  Perfect Forward Secrecy<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<p id="section-1.4-6">PPID:  Payload Protocol Identifier<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">SCTP:  Stream Control Transmission Protocol<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<p id="section-1.4-8">SCTP-AUTH: Authenticated Chunks for SCTP<a href="#section-1.4-8" class="pilcrow">¶</a></p>
<p id="section-1.4-9">TCP:  Transmission Control Protocol<a href="#section-1.4-9" class="pilcrow">¶</a></p>
<p id="section-1.4-10">TLS:  Transport Layer Security<a href="#section-1.4-10" class="pilcrow">¶</a></p>
<p id="section-1.4-11">ULP:  Upper Layer Protocol<a href="#section-1.4-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
   capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-considerations">
<section id="section-3">
      <h2 id="name-dtls-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dtls-considerations" class="section-name selfRef">DTLS Considerations</a>
      </h2>
<div id="version-of-dtls">
<section id="section-3.1">
        <h3 id="name-version-of-dtls">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-of-dtls" class="section-name selfRef">Version of DTLS</a>
        </h3>
<p id="section-3.1-1">This document defines the usage of either DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, or DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>.
   Earlier versions of DTLS MUST NOT be used (see <span>[<a href="#RFC8996" class="xref">RFC8996</a>]</span>).
   DTLS 1.3 is RECOMMENDED for security and performance reasons.
   It is expected that DTLS/SCTP as described in this document will work with
   future versions of DTLS.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cipher-suites-and-cryptographic-parameters">
<section id="section-3.2">
        <h3 id="name-cipher-suites-and-cryptogra">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cipher-suites-and-cryptogra" class="section-name selfRef">Cipher Suites and Cryptographic Parameters</a>
        </h3>
<p id="section-3.2-1">For DTLS 1.2, the cipher suites forbidden by <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span> MUST NOT
   be used. For all versions of DTLS, cryptographic parameters giving
   confidentiality and Perfect Forward Secrecy (PFS) MUST be used.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Msg-size">
<section id="section-3.3">
        <h3 id="name-message-sizes">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-message-sizes" class="section-name selfRef">Message Sizes</a>
        </h3>
<p id="section-3.3-1">DTLS/SCTP, automatically fragments and reassembles user
   messages. This specification defines how to fragment the user
   messages into DTLS records, where each DTLS record allows a
   maximum of 2^14 protected bytes. Each DTLS record adds some
   overhead, thus using records of maximum possible size are
   recommended to minimize the transmitted overhead. DTLS 1.3
   has much less overhead than DTLS 1.2 per record.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The sequence of DTLS records is then fragmented into DATA or I-DATA
   Chunks to fit the path MTU by SCTP. The largest possible user
   messages using the mechanism defined in this specification is
   2^64-1 bytes.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The security operations and reassembly process requires that the
   protected user message, i.e., with DTLS record overhead, is buffered
   in the receiver. This buffer space will thus put a limit on the
   largest size of plain text user message that can be transferred
   securely. However, by mandating the use of the partial delivery of
   user messages from SCTP and assuming that no two messages received
   on the same stream are interleaved (as it is the case when using
   the API defined in <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>) the required buffering prior to
   DTLS processing can be limited to a single DTLS record per used
   incoming stream. This enables the DTLS/SCTP implementation to
   provide the Upper Layer Protocol (ULP) with each DTLS record's
   content when it has been decrypted and its integrity been verified
   enabling partial user message delivery to the ULP. Implementations
   can trade-off buffer memory requirements in the DTLS layer with
   transport overhead by using smaller DTLS records.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The DTLS/SCTP implementation is expected to behave very similar to
   just SCTP when it comes to handling of user messages and dealing
   with large user messages and their reassembly and
   processing. Making it the ULP responsible for handling any resource
   contention related to large user messages.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-protection">
<section id="section-3.4">
        <h3 id="name-replay-protection">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-replay-protection" class="section-name selfRef">Replay Protection</a>
        </h3>
<p id="section-3.4-1">SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> does not have explicit replay
   protection. However, the combination of SCTP-AUTH's protection of
   DATA or I-DATA chunks and SCTP user message handling will prevent
   third party attempts to inject or replay SCTP packets resulting in
   impact on the received protected user message. In fact, this
   document's solution is dependent on SCTP-AUTH and SCTP to prevent
   reordering, duplication, and removal of the DTLS records within
   each protected user message.  This includes detection of changes to
   what DTLS records start and end the SCTP user message, and removal of
   DTLS records before an increment to the epoch.  Without SCTP-AUTH,
   these would all have required explicit handling.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">DTLS optionally supports record replay detection. Such replay
   detection could result in the DTLS layer dropping valid messages
   received outside of the DTLS replay window. As DTLS/SCTP provides
   replay protection even without DTLS replay protection, the replay
   detection of DTLS MUST NOT be used.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-mtu-discovery">
<section id="section-3.5">
        <h3 id="name-path-mtu-discovery">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-path-mtu-discovery" class="section-name selfRef">Path MTU Discovery</a>
        </h3>
<p id="section-3.5-1">DTLS Path MTU Discovery MUST NOT be used.  Since SCTP provides Path
   MTU discovery and fragmentation/reassembly for user messages, and
   according to <a href="#Msg-size" class="xref">Section 3.3</a>, DTLS can send maximum sized DTLS
   Records.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retransmission-of-messages">
<section id="section-3.6">
        <h3 id="name-retransmission-of-messages">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-retransmission-of-messages" class="section-name selfRef">Retransmission of Messages</a>
        </h3>
<p id="section-3.6-1">SCTP provides a reliable and in-sequence transport service for DTLS
   messages that require it.  See <a href="#Stream-Usage" class="xref">Section 4.4</a>.  Therefore, DTLS
   procedures for retransmissions MUST NOT be used.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sctp-considerations">
<section id="section-4">
      <h2 id="name-sctp-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sctp-considerations" class="section-name selfRef">SCTP Considerations</a>
      </h2>
<div id="Mapping-DTLS">
<section id="section-4.1">
        <h3 id="name-mapping-of-dtls-records">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-mapping-of-dtls-records" class="section-name selfRef">Mapping of DTLS Records</a>
        </h3>
<p id="section-4.1-1">The SCTP implementation MUST support fragmentation of user messages
   using DATA <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>, and optionally I-DATA <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> chunks.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">DTLS/SCTP works as a shim layer between the user message API and
   SCTP. The fragmentation works similar as the DTLS fragmentation of
   handshake messages.  On the sender side a user message fragmented
   into fragments m0, m1, m2, each no larger than 2^14 = 16384
   bytes.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>
   m0 | m1 | m2 | ... = user_message
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1-4">The resulting fragments are protected with DTLS and the records are
   concatenated<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>
   user_message' = DTLS( m0 ) | DTLS( m1 ) | DTLS( m2 ) ...
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">The new user_message', i.e., the protected user message, is the input
   to SCTP.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">On the receiving side DTLS is used to decrypt the individual
   records. There are three failure cases an implementation needs to
   detect and then act on:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-8">
<li id="section-4.1-8.1">Failure in decryption and integrity verification process of any
   DTLS record. Due to SCTP-AUTH preventing delivery of injected or
   corrupt fragments of the protected user message this should only
   occur in case of implementation errors or internal hardware
   failures or the necessary security context has been prematurely
   discarded.<a href="#section-4.1-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-8.2">In case the SCTP layer indicates an end to a user message,
   e.g., when receiving a MSG_EOR in a recvmsg() call when using the
   API described in <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>, and the last buffered DTLS record
   length field does not match, i.e., the DTLS record is incomplete.<a href="#section-4.1-8.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-8.3">Unable to perform the decryption processes due to lack of
   resources, such as memory, and have to abandon the user message
   fragment. This specification is defined such that the needed
   resources for the DTLS/SCTP operations are bounded for a given
   number of concurrent transmitted SCTP streams or unordered user
   messages.<a href="#section-4.1-8.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.1-9">The above failure cases all result in the receiver failing to
   recreate the full user message. This is a failure of the transport
   service that is not possible to recover from in the DTLS/SCTP layer
   and the sender could believe the complete message have been
   delivered. This error MUST NOT be ignored, as SCTP lacks any
   facility to declare a failure on a specific stream or user message,
   the DTLS connection and the SCTP association SHOULD be
   terminated. A valid exception to the termination of the SCTP
   association is if the receiver is capable of notifying the ULP
   about the failure in delivery and the ULP is capable of recovering
   from this failure.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">Note that if the SCTP extension for Partial Reliability (PR-SCTP)
   <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span> is used for a user message, user message may be
   partially delivered or abandoned. These failures are not a reason
   for terminating the DTLS connection and SCTP association.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">The DTLS Connection ID MUST be negotiated
   (<span>[<a href="#I-D.ietf-tls-dtls-connection-id" class="xref">I-D.ietf-tls-dtls-connection-id</a>]</span> or Section 9 of
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>). If DTLS 1.3 is used, the length field in
   the record layer MUST be included. A 16-bit sequence number SHOULD
   be used rather than 8-bit to minimize issues with DTLS record
   sequence number wrapping.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">The ULP may use multiple messages simultanous, and the progress and
   delivery of these messages are progressing indepentely, thus the
   recieving DTLS/SCTP implementation may not receive records in order
   in case of packet loss. Assuming that the sender will send the DTLS
   records in order the DTLS records where created (which may not be
   certain in some implementations), then there is a risk that DTLS
   sequence number have wrapped if the amount of data in flight is
   more than the sequence number covers.  Thus, for 8-bit sequence
   number space with 16384 bytes records the receiver window only
   needs to be 256*16384 = 4,194,304 bytes for this risk to defintely
   exist. While a 16-bit sequence number should not have any sequence
   number wraps for receiver windows up to 1 Gbyte. The DTLS/SCTP may
   not be tightly integrated and the DTLS records may not be requested
   to be sent in strict sequence order, in these case additional
   guard ranges are needed.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">Also, if smaller DTLS records are used, this limit will be
   correspondingly reduced. The DTLS/SCTP Sender needs to choose
   sequence number length and DTLS Record size so that the product is
   larger than the used receiver window, preferably twice as
   large. Receiver implementations that are offering receiver windows
   larger than the product 65536*16384 bytes MUST be capable of
   handling sequence number wraps through trial decoding with a lower
   values in the higher bits of the extended sequence number.<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1-14">Section 4 of <span>[<a href="#I-D.ietf-tls-dtls-connection-id" class="xref">I-D.ietf-tls-dtls-connection-id</a>]</span> states "If,
   however, an implementation chooses to receive different lengths of
   CID, the assigned CID values must be self-delineating since there
   is no other mechanism available to determine what connection (and
   thus, what CID length) is in use.". As this solution requires
   multiple connection IDs, using a zero-length CID will be highly
   problematic as it could result in that any DTLS records with a zero
   length CID ends up in another DTLS connection context, and there
   fail the decryption and integrity verification. And in that case to
   avoid losing the DTLS record, it would have to be forwarded to the
   zero-length CID using DTLS Connection and decryption and validation
   must be tried. Resulting in higher resource utilization. Thus, it
   is RECOMMENDED to not use the zero length CID values and instead
   use a single common length for the CID values. A single byte should
   be sufficient, as reuse of old CIDs is possible as long as the
   implementation ensure they are not used in near time to the
   previous usage.<a href="#section-4.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-connection-handling">
<section id="section-4.2">
        <h3 id="name-dtls-connection-handling">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-dtls-connection-handling" class="section-name selfRef">DTLS Connection Handling</a>
        </h3>
<p id="section-4.2-1">A DTLS connection MUST be established at the beginning of the SCTP
   association. All DTLS connections are terminated when the SCTP
   association is terminated. A DTLS connection MUST NOT span multiple
   SCTP associations.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As it is required to establish the DTLS connection at the beginning
   of the SCTP association, either of the peers should never send any
   SCTP user messages that are not protected by DTLS. So, the case that
   an endpoint receives data that is not either DTLS messages on Stream
   0 or protected user messages in the form of a sequence of DTLS
   Records on any stream is a protocol violation. The receiver MAY
   terminate the SCTP association due to this protocol violation.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Whenever a mutual authentication, updated security parameters,
   rerun of Diffie-Hellman key-exchange , or SCTP-AUTH rekeying is
   needed, a new DTLS connection is instead setup in parallel with the
   old connection (i.e., there may be up to two simultaneous DTLS
   connections within one association).<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload-protocol-identifier-usage">
<section id="section-4.3">
        <h3 id="name-payload-protocol-identifier">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-payload-protocol-identifier" class="section-name selfRef">Payload Protocol Identifier Usage</a>
        </h3>
<p id="section-4.3-1">SCTP Payload Protocol Identifiers are assigned by IANA.
   Application protocols using DTLS over SCTP SHOULD register and use
   a separate Payload Protocol Identifier (PPID) and SHOULD NOT reuse
   the PPID that they registered for running directly over SCTP.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Using the same PPID does not harm as long as the application can
   determine whether or not DTLS is used.  However, for protocol
   analyzers, for example, it is much easier if a separate PPID is used.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">This means, in particular, that there is no specific PPID for DTLS.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Stream-Usage">
<section id="section-4.4">
        <h3 id="name-stream-usage">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-stream-usage" class="section-name selfRef">Stream Usage</a>
        </h3>
<p id="section-4.4-1">DTLS records with a content type different from "application_data"
   (e.g., "handshake", "alert", ...) MUST be transported on stream 0 with
   unlimited reliability and with the ordered delivery feature.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">DTLS records of content type "application_data", which carries the
   protected user messages MAY be sent in SCTP messages on any stream,
   including stream 0. On stream 0 the DTLS record containing the part
   of protected message, as well as any DTLS messages that aren't
   record protocol will be mixed, thus the additional head of line
   blocking can occur. Therefore, applications are RECOMMENDED to send
   its protected user messages using multiple streams, and on other
   streams than stream 0.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-handling">
<section id="section-4.5">
        <h3 id="name-chunk-handling">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-chunk-handling" class="section-name selfRef">Chunk Handling</a>
        </h3>
<p id="section-4.5-1">DATA chunks of SCTP MUST be sent in an authenticated way as
   described in SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.  All other chunks that can be
   authenticated, i.e., all chunk types that can be listed in the Chunk
   List Parameter <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>, MUST also be sent in an authenticated
   way.  This makes sure that an attacker cannot modify the stream in
   which a message is sent or affect the ordered/unordered delivery of
   the message.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If PR-SCTP as defined in <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span> is used, FORWARD-TSN chunks
   MUST also be sent in an authenticated way as described in
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.  This makes sure that it is not possible for an
   attacker to drop messages and use forged FORWARD-TSN, SACK, and/or
   SHUTDOWN chunks to hide this dropping.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">I-DATA chunk type as defined in <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> is RECOMMENDED to be
   supported to avoid some of the down sides that large user messages
   have on blocking transmission of later arriving high priority user
   messages. However, the support is not mandated and negotiated
   independently from DTLS/SCTP. If I-DATA chunks are used, then
   they MUST be sent in an authenticated way as described in
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-auth-hash-function">
<section id="section-4.6">
        <h3 id="name-sctp-auth-hash-function">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-sctp-auth-hash-function" class="section-name selfRef">SCTP-AUTH Hash Function</a>
        </h3>
<p id="section-4.6-1">When using DTLS/SCTP, the SHA-256 Message Digest Algorithm MUST be
   supported in the SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> implementation. SHA-1 MUST
   NOT be used when using DTLS/SCTP. <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> requires support and
   inclusion of SHA-1 in the HMAC-ALGO parameter, thus, to meet
   both requirements the HMAC-ALGO parameter will include both SHA-256
   and SHA-1 with SHA-256 listed prior to SHA-1 to indicate the
   preference.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parallel-dtls-connections">
<section id="section-4.7">
        <h3 id="name-parallel-dtls-connections">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-parallel-dtls-connections" class="section-name selfRef">Parallel DTLS connections</a>
        </h3>
<p id="section-4.7-1">To enable SCTP-AUTH re-rekeying, periodic authentication of both
   endpoints, and force attackers to dynamic key extraction
   <span>[<a href="#RFC7624" class="xref">RFC7624</a>]</span>, DTLS/SCTP per this specification defines the usage of
   parallel DTLS connections over the same SCTP association. This
   solution ensures that there are no limitations to the lifetime of
   the SCTP association due to DTLS, it also avoids dependency on
   version specific DTLS mechanisms such as renegotiation in DTLS 1.2,
   which is disabled by default in many DTLS implementations, or
   post-handshake messages in DTLS 1.3, which does not allow mutual
   endpoint re-authentication or re-keying of SCTP-AUTH. Parallel DTLS
   connections enable opening a new DTLS connection performing a
   handshake, while the existing DTLS connection is kept in place. On
   handshake completion switch to the security context of the new DTLS
   connection and then ensure delivery of all the SCTP chunks using
   the old DTLS connections security context. When that has been
   achieved close the old DTLS connection and discard the related
   security context.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">As specified in <a href="#Mapping-DTLS" class="xref">Section 4.1</a> the usage of DTLS connection ID is
   required to ensure that the receiver can correctly identify the
   DTLS connection and its security context when performing its
   de-protection operations. There is also only a single SCTP-AUTH key
   exported per DTLS connection ensuring that there is clear mapping
   between the DTLS connection ID and the SCTP-AUTH security context for
   each key-id.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">Application writers should be aware that establishing a new DTLS
   connections may result in changes of security parameters.  See
   <a href="#sec-Consideration" class="xref">Section 8</a> for security considerations regarding rekeying.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">A DTLS/SCTP Endpoint MUST NOT have more than two DTLS connections
   open at the same time. Either of the endpoints MAY initiate a new
   DTLS connection by performing a full DTLS handshake. As either
   endpoint can initiate a DTLS handshake on either side at the same
   time, either endpoint may receive a DTLS ClientHello when it has
   sent its own ClientHello. In this case the ClientHello from the
   endpoint that had the DTLS Client role in the establishment of the
   existing DTLS connection shall be continued to be processed and the
   other dropped.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">When performing the DTLS handshake the endpoint MUST verify that
   the peer identifies using the same identity as in the previous DTLS
   connection.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">When the DTLS handshake has been completed, a new SCTP-AUTH key
   will be exported per <a href="#handling-endpoint-secret" class="xref">Section 4.10</a> and the new DTLS
   connection MUST be used for the DTLS protection operation of any
   future protected SCTP message. The endpoint is RECOMMENDED to use
   the security context of the new DTLS connection for any DTLS
   protection operation occurring after the completed handshake. The
   new SCTP-AUTH key SHALL be used for any SCTP message being sent
   after the DTLS handshake has completed. There is a possibility to
   use the new SCTP-AUTH key for any SCTP packets part of an SCTP
   message that was initiated but not yet fully transmitted prior to
   the completion of the new DTLS handshake, however the API defined
   in <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> is not supporting this.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">The SCTP endpoint will indicate to its peer when the previous DTLS
   connection and its context are no longer needed for receiving any
   more data from this endpoint. This is done by having DTLS to send a
   DTLS close_notify alert. The endpoint MUST NOT send the
   close_notify until the following two conditions are fulfilled:<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.7-8">
<li id="section-4.7-8.1">All SCTP packets containing part of any DTLS record or message
protected using the security context of this DTLS connection
have been acknowledged in a non-renegable way.<a href="#section-4.7-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.7-8.2">All SCTP packets using the SCTP-AUTH key associated with the
security context of this DTLS connection have been acknowledged
in a non-renegable way.<a href="#section-4.7-8.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.7-9">There is a very basic way of determining the above conditions for
   an implementation that enables using the new DTLS connection's
   security context for all future DTLS records protected and enabling
   the associated new SCTP-AUTH key at the same time and not use the
   old context for any future protection operations. Mark the time
   when the first SCTP chunk has been sent that is part of the first
   (partial) SCTP message send call that uses the new security
   context. That SCTP chunk and thus all previous chunks using the
   older security context must have been delivered to the peer before
   the Endpoint Failure Detection (See Section 8.1 of <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>
   would trigger and terminate the SCTP association. Calculate the
   upper limit for this timeout period, which is dependent on two
   configurable parameters. The maximum endpoint failure timeout
   period is the product of the 'Association.Max.Retrans' and RTO.Max
   parameters. For the default values per <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span> that would be 10
   attempts time with an RTO.Max = 60 s, i.e., 10 minutes.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
<p id="section-4.7-10">For SCTP implementations exposing APIs like <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> where it is
   not possible to change the SCTP-AUTH key for a partial SCTP message
   initiated before the change of security context will be forced to
   track the SCTP messages and determine when all using the old
   security context has been transmitted. This maybe be impossible to
   do completely reliable without tighter integration between the
   DTLS/SCTP layer and the SCTP implementation. This type of
   implementations also has an implicit limitation in how large SCTP
   messages it can support. Each SCTP message needs have completed
   delivery and enabling closing of the previous DTLS connection prior
   to the need to create yet another DTLS connection. Thus, SCTP
   messages can't be larger than that the transmission completes in
   less than the duration between the rekeying or re-authentications
   needed for this SCTP association.<a href="#section-4.7-10" class="pilcrow">¶</a></p>
<p id="section-4.7-11">When the DTLS/SCTP implementation are more tightly integrated with
   the SCTP stack or have a fuller API that enable the DTLS/SCTP
   implementation to know when the SCPT messages have been delivered
   it will be able to close down the old DTLS connection in a timelier
   fashion, thus supporting more frequent rekeying etc. if needed.<a href="#section-4.7-11" class="pilcrow">¶</a></p>
<p id="section-4.7-12">The consequences of sending a DTLS close_notify alert in the old
   DTLS connection prior to the receiver having received the data can
   result in failure case 1 described in <a href="#Mapping-DTLS" class="xref">Section 4.1</a>, which likely
   result in SCTP association termination.<a href="#section-4.7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="renegotiation-and-keyupdate">
<section id="section-4.8">
        <h3 id="name-renegotiation-and-keyupdate">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-renegotiation-and-keyupdate" class="section-name selfRef">Renegotiation and KeyUpdate</a>
        </h3>
<p id="section-4.8-1">DTLS 1.2 renegotiation enables rekeying (with ephemeral Diffie-
   Hellman) of DTLS as well as mutual reauthentication inside an DTLS
   1.2 connection. Renegotiation has been removed from DTLS 1.3 and
   partly replaced with post-handshake messages such as KeyUpdate. The
   parallel DTLS connection solution was specified due to lack of
   necessary features with DTLS 1.3 considered needed for long lived
   SCTP associations, such as rekeying (with ephemeral Diffie-Hellman)
   as well as mutual reauthentication.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">This specification do not allow usage of DTLS 1.2 renegotiation to
   avoid race conditions and corner cases in the interaction between
   the parallel DTLS connection mechanism and the keying of
   SCTP-AUTH. In addtion renegotiation is also disabled in
   implementation, as well as dealing with the epoch change reliable
   have similar or worse applicaiton impact.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">This specification also recommends against using DTLS 1.3 KeyUpdate
   and instead rely on parallel DTLS connections. For DTLS 1.3 there
   isn't feature parity. It also have the issue that a DTLS
   implementation following the RFC may assume a too limited window
   for SCTP where the previous epoch's security context is maintained
   and thus changes to epoch handling (<a href="#epoch" class="xref">Section 4.9</a>) are necessary. Thus,
   unless the below specified more application impacting draining is
   used there exist risk of losing data that the sender will have
   assumed has been reliably delivered.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<div id="dtls-12-considerations">
<section id="section-4.8.1">
          <h4 id="name-dtls-12-considerations">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-dtls-12-considerations" class="section-name selfRef">DTLS 1.2 Considerations</a>
          </h4>
<p id="section-4.8.1-1">The endpoint MUST NOT use DTLS 1.2 renegotiation.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13-considerations">
<section id="section-4.8.2">
          <h4 id="name-dtls-13-considerations">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-dtls-13-considerations" class="section-name selfRef">DTLS 1.3 Considerations</a>
          </h4>
<p id="section-4.8.2-1">Before sending a KeyUpdate message, the DTLS endpoint MUST ensure
   that all DTLS messages have been acknowledged by the SCTP peer in a
   non-revokable way.  After sending the KeyUpdate message, it stops
   sending DTLS messages until the corresponding Ack message has been
   processed.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">Prior to processing a received KeyUpdate message, all other received
   SCTP user messages that are buffered in the SCTP layer and can be
   delivered to the DTLS layer MUST be read and processed by DTLS.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="epoch">
<section id="section-4.9">
        <h3 id="name-dtls-epochs">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-dtls-epochs" class="section-name selfRef">DTLS Epochs</a>
        </h3>
<p id="section-4.9-1">In general, DTLS implementations SHOULD discard records from earlier epochs.
   However, in the context of a reliable communication this is not appropriate.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<div id="dtls-12-considerations-1">
<section id="section-4.9.1">
          <h4 id="name-dtls-12-considerations-2">
<a href="#section-4.9.1" class="section-number selfRef">4.9.1. </a><a href="#name-dtls-12-considerations-2" class="section-name selfRef">DTLS 1.2 Considerations</a>
          </h4>
<p id="section-4.9.1-1">Epochs will not be used as renegotiation is disallowed.<a href="#section-4.9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13-considerations-1">
<section id="section-4.9.2">
          <h4 id="name-dtls-13-considerations-2">
<a href="#section-4.9.2" class="section-number selfRef">4.9.2. </a><a href="#name-dtls-13-considerations-2" class="section-name selfRef">DTLS 1.3 Considerations</a>
          </h4>
<p id="section-4.9.2-1">The procedures of Section 4.2.1 of <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> are irrelevant.
   When receiving DTLS packets using epoch n, no DTLS packets from earlier
   epochs are received.<a href="#section-4.9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="handling-endpoint-secret">
<section id="section-4.10">
        <h3 id="name-handling-of-endpoint-pair-s">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-handling-of-endpoint-pair-s" class="section-name selfRef">Handling of Endpoint-Pair Shared Secrets</a>
        </h3>
<p id="section-4.10-1">SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> is keyed using Endpoint-Pair Shared
   Secrets. In SCTP associations where DTLS is used, DTLS is used to
   establish these secrets. The endpoints MUST NOT use another
   mechanism for establishing shared secrets for SCTP-AUTH.
   The endpoint-pair shared secret for Shared Key Identifier 0 is
   empty and MUST be used when establishing the first DTLS connection.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<p id="section-4.10-2">The initial DTLS connection will be used to establish a new shared
   secret as specified per DTLS version below, and which MUST use
   shared key identifier 1. After sending the DTLS Finished message,
   the active SCTP-AUTH key MUST be switched to the new one. Once the
   initial Finished message from the peer has been processed by DTLS,
   the SCTP-AUTH key with Shared Key Identifier 0 MUST be removed.<a href="#section-4.10-2" class="pilcrow">¶</a></p>
<p id="section-4.10-3">When a subsequent DTLS connection is setup, a new a 64-byte shared
   secret is derived using the TLS-Exporter. The shared secret
   identifiers form a sequence. If the previous shared secret used
   Shared Key Identifier n, the new one MUST use Shared Key Identifier
   n+1, unless n= 65535, in which case the new Shared Key Identifier
   is 1.<a href="#section-4.10-3" class="pilcrow">¶</a></p>
<p id="section-4.10-4">After sending the DTLS Finished message, the active SCTP-AUTH key
   MUST be switched to the new one. When the endpoint has both sent
   and received a closeNotify on the old DTLS connection then the
   endpoint SHALL remove shared secret(s) related to old DTLS
   connection.<a href="#section-4.10-4" class="pilcrow">¶</a></p>
<div id="dtls-12-considerations-2">
<section id="section-4.10.1">
          <h4 id="name-dtls-12-considerations-3">
<a href="#section-4.10.1" class="section-number selfRef">4.10.1. </a><a href="#name-dtls-12-considerations-3" class="section-name selfRef">DTLS 1.2 Considerations</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.10.1-1">
<pre>
Whenever a new DTLS connection is established, a 64-byte
endpoint-pair shared secret is derived using the TLS-Exporter
described in {{RFC5705}}.
</pre><a href="#section-4.10.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.10.1-2">The 64-byte shared secret MUST be provided to the SCTP stack as
   soon as the computation is possible.  The exporter MUST use the
   label given in <a href="#IANA-Consideration" class="xref">Section 7</a> and no context.<a href="#section-4.10.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13-considerations-2">
<section id="section-4.10.2">
          <h4 id="name-dtls-13-considerations-3">
<a href="#section-4.10.2" class="section-number selfRef">4.10.2. </a><a href="#name-dtls-13-considerations-3" class="section-name selfRef">DTLS 1.3 Considerations</a>
          </h4>
<p id="section-4.10.2-1">When the exporter_secret can be computed, a 64-byte shared secret
   is derived from it and provided as a new endpoint-pair shared
   secret by using the TLS-Exporter described in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-4.10.2-1" class="pilcrow">¶</a></p>
<p id="section-4.10.2-2">The 64-byte shared secret MUST be provided to the SCTP stack as
   soon as the computation is possible.  The exporter MUST use the
   label given in Section <a href="#IANA-Consideration" class="xref">Section 7</a> and no context.<a href="#section-4.10.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="shutdown">
<section id="section-4.11">
        <h3 id="name-shutdown">
<a href="#section-4.11" class="section-number selfRef">4.11. </a><a href="#name-shutdown" class="section-name selfRef">Shutdown</a>
        </h3>
<p id="section-4.11-1">To prevent DTLS from discarding DTLS user messages while it is
   shutting down, a CloseNotify message MUST only be sent after all
   outstanding SCTP user messages have been acknowledged by the SCTP
   peer in a non-revokable way.<a href="#section-4.11-1" class="pilcrow">¶</a></p>
<p id="section-4.11-2">Prior to processing a received CloseNotify, all other received SCTP
   user messages that are buffered in the SCTP layer MUST be read and
   processed by DTLS.<a href="#section-4.11-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Negotiation">
<section id="section-5">
      <h2 id="name-dtls-over-sctp-service">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dtls-over-sctp-service" class="section-name selfRef">DTLS over SCTP Service</a>
      </h2>
<p id="section-5-1">The adoption of DTLS over SCTP according to the current description
   is meant to add to SCTP the option for transferring encrypted data.
   When DTLS over SCTP is used, all data being transferred MUST be
   protected by chunk authentication and DTLS encrypted.  Chunks that
   need to be received in an authenticated way will be specified
   in the CHUNK list parameter according to <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.
   Error handling for authenticated chunks is according to <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="adaptation-layer-indication-in-initinit-ack">
<section id="section-5.1">
        <h3 id="name-adaptation-layer-indication">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-adaptation-layer-indication" class="section-name selfRef">Adaptation Layer Indication in INIT/INIT-ACK</a>
        </h3>
<p id="section-5.1-1">At the initialization of the association, a sender of the INIT or
   INIT ACK chunk that intends to use DTLS/SCTP as specified in this
   specification MUST include an Adaptation Layer Indication Parameter
   with the IANA assigned value TBD (<a href="#sec-IANA-ACP" class="xref">Section 7.2</a>) to inform its
   peer that it is able to support DTLS over SCTP per this
   specification.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DTLS-init">
<section id="section-5.2">
        <h3 id="name-dtls-over-sctp-initializati">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-dtls-over-sctp-initializati" class="section-name selfRef">DTLS over SCTP Initialization</a>
        </h3>
<p id="section-5.2-1">Initialization of DTLS/SCTP requires all the following options to
   be part of the INIT/INIT-ACK handshake:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">RANDOM: defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">CHUNKS: list of permitted chunks, defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">HMAC-ALGO: defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">ADAPTATION-LAYER-INDICATION: defined in <span>[<a href="#RFC5061" class="xref">RFC5061</a>]</span><a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">When all the above options are present, the Association will start
   with support of DTLS/SCTP.  The set of options indicated are the
   DTLS/SCTP Mandatory Options.  No data transfer is permitted before
   DTLS handshake is complete. Chunk bundling is permitted according
   to <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>. The DTLS handshake will enable authentication of
   both the peers and also have the declare their support message
   size.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">The extension described in this document is given by the following
   message exchange.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-8">
<pre>
   --- INIT[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] ---&gt;
   &lt;- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] -
   ------------------------ COOKIE-ECHO ------------------------&gt;
   &lt;------------------------ COOKIE-ACK -------------------------
   ---------------- AUTH; DATA[DTLS Handshake] -----------------&gt;
                               ...
                               ...
   &lt;--------------- AUTH; DATA[DTLS Handshake] ------------------
</pre><a href="#section-5.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="client-use-case">
<section id="section-5.3">
        <h3 id="name-client-use-case">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-client-use-case" class="section-name selfRef">Client Use Case</a>
        </h3>
<p id="section-5.3-1">When a client initiates an SCTP Association with DTLS protection,
   i.e., the SCTP INIT containing DTSL/SCTP Mandatory Options, it can
   receive an INIT-ACK also containing DTLS/SCTP Mandatory Options, in
   that case the Association will proceed as specified in the previous
   <a href="#DTLS-init" class="xref">Section 5.2</a> section.  If the peer replies with an INIT-ACK not
   containing all DTLS/SCTP Mandatory Options, the client SHOULD reply
   with an SCTP ABORT.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-use-case">
<section id="section-5.4">
        <h3 id="name-server-use-case">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-server-use-case" class="section-name selfRef">Server Use Case</a>
        </h3>
<p id="section-5.4-1">If a SCTP Server supports DTLS/SCTP, i.e., per this specification,
   when receiving an INIT chunk with all DTLS/SCTP Mandatory Options
   it will reply with an INIT-ACK also containing all the DTLS/SCTP
   Mandatory Options, following the sequence for DTLS initialization
   <a href="#DTLS-init" class="xref">Section 5.2</a> and the related traffic case.  If a SCTP Server that
   supports DTLS and configured to use it, receives an INIT chunk
   without all DTLS/SCTP Mandatory Options, it SHOULD reply with an
   SCTP ABORT.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Fallback">
<section id="section-5.5">
        <h3 id="name-rfc-6083-fallback">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-rfc-6083-fallback" class="section-name selfRef">RFC 6083 Fallback</a>
        </h3>
<p id="section-5.5-1">This section discusses how an endpoint supporting this
   specification can fallback to follow the DTLS/SCTP behavior in RFC6083.
   It is recommended to define a setting that represents the
   policy to allow fallback or not. However, the possibility to use
   fallback is based on the ULP can operate using user messages that
   are no longer than 16384 bytes and where the security issues can be
   mitigated or considered acceptable. Fallback is NOT RECOMMEND to be
   enabled as it enables downgrade attacks to weaker algorithms and versions
   of DTLS.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">An SCTP endpoint that receives an INIT chunk or an INIT-ACK chunk that does
   not contain the SCTP-Adaptation-Indication parameter with the  DTLS/SCTP
   adaptation layer codepoint, see <a href="#sec-IANA-ACP" class="xref">Section 7.2</a>, may in certain cases
   potentially perform a fallback to RFC 6083 behavior.
   However, the fallback attempt should only be performed if policy says that
   is acceptable.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">If fallback is allowed, it is possible that the client will send
   plain text user messages prior to DTLS handshake as it is allowed
   per RFC 6083.  So that needs to be part of the consideration for a
   policy allowing fallback.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="socket-api">
<section id="section-6">
      <h2 id="name-socket-api-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-socket-api-considerations" class="section-name selfRef">Socket API Considerations</a>
      </h2>
<p id="section-6-1">This section describes how the socket API defined in <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> is extended
   to provide a way for the application to observe the HMAC algorithms used for
   sending and receiving of AUTH chunks.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Please note that this section is informational only.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A socket API implementation based on <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> is, by means of the
   existing SCTP_AUTHENTICATION_EVENT event, extended to provide the event
   notification whenever a new HMAC algorithm is used in a received AUTH chunk.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Furthermore, two new socket options for the level IPPROTO_SCTP and the
   name SCTP_SEND_HMAC_IDENT and SCTP_EXPOSE_HMAC_IDENT_CHANGES are defined
   as described below.
   The first socket option is used to query the HMAC algorithm used for sending
   AUTH chunks.
   The second enables the monitoring of HMAC algorithms used in received
   AUTH chunks via the SCTP_AUTHENTICATION_EVENT event.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Support for the SCTP_SEND_HMAC_IDENT and SCTP_EXPOSE_HMAC_IDENT_CHANGES
   socket options also need to be added to the function sctp_opt_info().<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="socket-option-to-get-the-hmac-identifier-being-sent-sctpsendhmacident">
<section id="section-6.1">
        <h3 id="name-socket-option-to-get-the-hm">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-socket-option-to-get-the-hm" class="section-name selfRef">Socket Option to Get the HMAC Identifier being Sent (SCTP_SEND_HMAC_IDENT)</a>
        </h3>
<p id="section-6.1-1">During the SCTP association establishment a HMAC Identifier is selected
   which is used by an SCTP endpoint when sending AUTH chunks.
   An application can access the result of this selection by using this
   read-only socket option, which uses the level IPPROTO_SCTP and the name
   SCTP_SEND_HMAC_IDENT.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The following structure is used to access HMAC Identifier used for sending
   AUTH chunks:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-3">
<pre>
struct sctp_assoc_value {
    sctp_assoc_t assoc_id;
    uint32_t assoc_value;
};
</pre><a href="#section-6.1-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-4">
          <dt id="section-6.1-4.1">
assoc_id:  </dt>
          <dd style="margin-left: 1.5em" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">This parameter is ignored for one-to-one style sockets.
For one-to-many style sockets, the application fills in an association
identifier.
It is an error to use SCTP_{FUTURE|CURRENT|ALL}_ASSOC in assoc_id.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-4.3">
assoc_value:  </dt>
          <dd style="margin-left: 1.5em" id="section-6.1-4.4">
            <p id="section-6.1-4.4.1">This parameter contains the HMAC Identifier used for sending AUTH chunks.<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="API-SCTP-AUTHENTICATION-EVENT">
<section id="section-6.2">
        <h3 id="name-exposing-the-hmac-identifie">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-exposing-the-hmac-identifie" class="section-name selfRef">Exposing the HMAC Identifiers being Received</a>
        </h3>
<p id="section-6.2-1">Section 6.1.8 of <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> defines the SCTP_AUTHENTICATION_EVENT event,
   which uses the following structure:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
struct sctp_authkey_event {
    uint16_t auth_type;
    uint16_t auth_flags;
    uint32_t auth_length;
    uint16_t auth_keynumber;
    uint32_t auth_indication;
    sctp_assoc_t auth_assoc_id;
};
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">This document updates this structure to<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-4">
<pre>
struct sctp_authkey_event {
    uint16_t auth_type;
    uint16_t auth_flags;
    uint32_t auth_length;
    uint16_t auth_identifier; /* formerly auth_keynumber */
    uint32_t auth_indication;
    sctp_assoc_t auth_assoc_id;
};
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">by renaming auth_keynumber to auth_identifier.
   auth_identifier just replaces auth_keynumber in the context of <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>.
   In addition to that, the SCTP_AUTHENTICATION_EVENT event is extended to
   also indicate when a new HMAC Identifier is received and such reporting is
   explicitly enabled as described in <a href="#API-SCTP-EXPOSE-HMAC-IDENT-CHANGES" class="xref">Section 6.3</a>.
   In this case auth_indication is SCTP_AUTH_NEW_HMAC and the new
   HMAC identifier is reported in auth_identifier.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="API-SCTP-EXPOSE-HMAC-IDENT-CHANGES">
<section id="section-6.3">
        <h3 id="name-socket-option-to-expose-hma">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-socket-option-to-expose-hma" class="section-name selfRef">Socket Option to Expose HMAC Identifier Usage (SCTP_EXPOSE_HMAC_IDENT_CHANGES)</a>
        </h3>
<p id="section-6.3-1">This options allows the application to enable and disable the reception of
   SCTP_AUTHENTICATION_EVENT events when a new HMAC Identifiers has been
   received in an AUTH chunk (see <a href="#API-SCTP-AUTHENTICATION-EVENT" class="xref">Section 6.2</a>).
   This read/write socket option uses the level IPPROTO_SCTP and the name
   SCTP_EXPOSE_HMAC_IDENT_CHANGES.
   It is needed to provide backwards compatibility and the default is that
   these events are not reported.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The following structure is used to enable or disable the reporting of newly
   received HMAC Identifiers in AUTH chunks:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-3">
<pre>
struct sctp_assoc_value {
    sctp_assoc_t assoc_id;
    uint32_t assoc_value;
};
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4">
          <dt id="section-6.3-4.1">
assoc_id:  </dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.2">
            <p id="section-6.3-4.2.1">This parameter is ignored for one-to-one style sockets.
For one-to-many style sockets, the application may fill in an association
identifier or SCTP_{FUTURE|CURRENT|ALL}_ASSOC.<a href="#section-6.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.3">
assoc_value:  </dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.4">
            <p id="section-6.3-4.4.1">Newly received HMAC Identifiers are reported if, and only if, this
parameter is non-zero.<a href="#section-6.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="IANA-Consideration">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-exporter-label">
<section id="section-7.1">
        <h3 id="name-tls-exporter-label">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-tls-exporter-label" class="section-name selfRef">TLS Exporter Label</a>
        </h3>
<p id="section-7.1-1">RFC 6083 defined a TLS Exporter Label registry as described in
   <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span>. IANA is requested to update the reference for the
   label "EXPORTER_DTLS_OVER_SCTP" to this specification.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-IANA-ACP">
<section id="section-7.2">
        <h3 id="name-sctp-adaptation-layer-indic">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-sctp-adaptation-layer-indic" class="section-name selfRef">SCTP Adaptation Layer Indication Code Point</a>
        </h3>
<p id="section-7.2-1"><span>[<a href="#RFC5061" class="xref">RFC5061</a>]</span> defined a IANA registry for Adaptation Code Points to
   be used in the Adaptation Layer Indication parameter. The registry
   was at time of writing located:
   https://www.iana.org/assignments/sctp-parameters/sctp-parameters.xhtml#sctp-parameters-27
   IANA is requested to assign one Adaptation Code Point for DTLS/SCTP
   per the below proposed entry in <a href="#iana-ACP" class="xref">Table 1</a>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<span id="name-adaptation-code-point"></span><div id="iana-ACP">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-adaptation-code-point" class="selfRef">Adaptation Code Point</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Code Point (32-bit number)</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS/SCTP</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.2-3">RFC-Editor Note: Please replace [RFC-TBD] with the RFC number given to
this specification.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-Consideration">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">The security considerations given in <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>,
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>, and <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span> also apply to this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="cryptographic-considerations">
<section id="section-8.1">
        <h3 id="name-cryptographic-consideration">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cryptographic-consideration" class="section-name selfRef">Cryptographic Considerations</a>
        </h3>
<p id="section-8.1-1">Over the years, there have been several serious attacks on earlier
   versions of Transport Layer Security (TLS), including attacks on
   its most commonly used ciphers and modes of operation.  <span>[<a href="#RFC7457" class="xref">RFC7457</a>]</span>
   summarizes the attacks that were known at the time of publishing
   and BCP 195 <span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span> <span>[<a href="#RFC8996" class="xref">RFC8996</a>]</span> provide recommendations for
   improving the security of deployed services that use TLS.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">When DTLS/SCTP is used with DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, DTLS 1.2 MUST be
   configured to disable options known to provide insufficient
   security. HTTP/2 <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span> gives good minimum requirements based
   on the attacks that where publicly known in 2015. DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> only define strong algorithms without major
   weaknesses at the time of publication. Many of the TLS registries
   have a "Recommended" column. Parameters not marked as "Y" are NOT
   RECOMMENDED to support. DTLS 1.3 is preferred over DTLS 1.2 being a
   newer protocol that addresses known vulnerabilities and only
   defines strong algorithms without known major weaknesses at the
   time of publication.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">DTLS 1.3 requires rekeying before algorithm specific AEAD limits
   have been reached. The AEAD limits equations are equally valid for
   DTLS 1.2 and SHOULD be followed for DTLS/SCTP, but are not mandated
   by the DTLS 1.2 specification.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">HMAC-SHA-256 as used in SCTP-AUTH has a very large tag length and
   very good integrity properties.  The SCTP-AUTH key can be used
   longer than the current algorithms in the TLS record layer. The
   SCTP-AUTH key is rekeyed when a new DTLS connection is set up at
   which point a new SCTP-AUTH key is derived using the TLS-Exporter.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">DTLS/SCTP is in many deployments replacing IPsec. For IPsec, NIST
   (US), BSI (Germany), and ANSSI (France) recommends very frequent
   re-run of Diffie-Hellman to provide Perfect Forward Secrecy and
   force attackers to dynamic key extraction <span>[<a href="#RFC7624" class="xref">RFC7624</a>]</span>. ANSSI writes
   "It is recommended to force the periodic renewal of the keys, e.g.,
   every hour and every 100 GB of data, in order to limit the impact
   of a key compromise." <span>[<a href="#ANSSI-DAT-NT-003" class="xref">ANSSI-DAT-NT-003</a>]</span>.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">For many DTLS/SCTP deployments the SCTP association is expected to
   have a very long lifetime of months or even years. For associations
   with such long lifetimes there is a need to frequently
   re-authenticate both client and server. TLS Certificate lifetimes
   significantly shorter than a year are common which is shorter than
   many expected DTLS/SCTP associations.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">SCTP-AUTH re-rekeying, periodic authentication of both endpoints,
   and frequent re-run of Diffie-Hellman to force attackers to dynamic
   key extraction is in DTLS/SCTP per this specification achieved by
   setting up new DTLS connections over the same SCTP
   association. Implementations SHOULD set up new connections
   frequently to force attackers to dynamic key
   extraction. Implementations MUST set up new connections before any
   of the certificates expire. It is RECOMMENDED that all negotiated
   and exchanged parameters are the same except for the timestamps in
   the certificates. Clients and servers MUST NOT accept a change of
   identity during the setup of a new connections, but MAY accept
   negotiation of stronger algorithms and security parameters, which
   might be motivated by new attacks.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">When using DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, AEAD limits and forward secrecy can be
   achieved by sending post-handshake KeyUpdate messages, which triggers
   rekeying of DTLS. Such symmetric rekeying gives significantly less protection
   against key leakage than re-running Diffie-Hellman.  After leakage
   of application_traffic_secret_N, a passive attacker can passively
   eavesdrop on all future application data sent on the connection
   including application data encrypted with
   application_traffic_secret_N+1, application_traffic_secret_N+2,
   etc. Note that KeyUpdate does not update the exporter_secret.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<p id="section-8.1-9">Allowing new connections can enable denial-of-service attacks.
   The endpoints SHOULD limit the frequency of new connections.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<p id="section-8.1-10">When DTLS/SCTP is used with DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, the TLS Session
   Hash and Extended Master Secret Extension <span>[<a href="#RFC7627" class="xref">RFC7627</a>]</span> MUST be used to
   prevent unknown key-share attacks where an attacker establishes the
   same key on several connections. DTLS 1.3 always prevents these
   kinds of attacks. The use of SCTP-AUTH then cryptographically binds
   new connections to the old connection. This together with mandatory
   mutual authentication (on the DTLS layer) and a requirement to not
   accept new identities mitigates MITM attacks that have plagued
   renegotiation <span>[<a href="#TRISHAKE" class="xref">TRISHAKE</a>]</span>.<a href="#section-8.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="downgrade-attacks">
<section id="section-8.2">
        <h3 id="name-downgrade-attacks">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-downgrade-attacks" class="section-name selfRef">Downgrade Attacks</a>
        </h3>
<p id="section-8.2-1">A peer supporting DTLS/SCTP according to this specification,
   DTLS/SCTP according to <span>[<a href="#RFC6083" class="xref">RFC6083</a>]</span> and/or SCTP without DTLS may be
   vulnerable to downgrade attacks where on on-path attacker
   interferes with the protocol setup to lower or disable security. If
   possible, it is RECOMMENDED that the peers have a policy only
   allowing DTLS/SCTP according to this specification.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-policy-decisions">
<section id="section-8.3">
        <h3 id="name-authentication-and-policy-d">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-authentication-and-policy-d" class="section-name selfRef">Authentication and Policy Decisions</a>
        </h3>
<p id="section-8.3-1">DTLS/SCTP MUST be mutually authenticated. Authentication is the process
   of establishing the identity of a user or system and verifying that
   the identity is valid. DTLS only provides proof of possession of a key.
   DTLS/SCTP MUST perform identity authentication. It is RECOMMENDED that
   DTLS/SCTP is used with certificate-based authentication. When certificates are
   used the applicatication using DTLS/SCTP is reposible for certificate policies,
   certificate chain validation, and identity authentication (HTTPS does
   for example match the hostname with a subjectAltName of type dNSName). The
   application using DTLS/SCTP MUST define what the identity is and how it is
   encoded and the client and server MUST use the same identity format.
   Guidance on server certificate validation can be found in <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>.
   All security decisions MUST be based on the peer's authenticated
   identity, not on its transport layer identity.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">It is possible to authenticate DTLS endpoints based on IP addresses
   in certificates. SCTP associations can use multiple IP addresses
   per SCTP endpoint. Therefore, it is possible that DTLS records will
   be sent from a different source IP address or to a different
   destination IP address than that originally authenticated. This is
   not a problem provided that no security decisions are made based on
   the source or destination IP addresses.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-8.4">
        <h3 id="name-privacy-considerations">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-8.4-1"><span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span> suggests that the privacy considerations of IETF
   protocols be documented.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">For each SCTP user message, the user also provides a stream
   identifier, a flag to indicate whether the message is sent ordered
   or unordered, and a payload protocol identifier.  Although
   DTLS/SCTP provides privacy for the actual user message, the other
   three information fields are not confidentiality protected.  They
   are sent as cleartext because they are part of the SCTP DATA
   chunk header.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">It is RECOMMENDED that DTLS/SCTP is used with certificate based
   authentication in DTLS 1.3 <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> to provide
   identity protection. DTLS/SCTP MUST be used with a key exchange
   method providing Perfect Forward Secrecy. Perfect Forward Secrecy
   significantly limits the amount of data that can be compromised due
   to key compromise.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pervasive-monitoring">
<section id="section-8.5">
        <h3 id="name-pervasive-monitoring">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-pervasive-monitoring" class="section-name selfRef">Pervasive Monitoring</a>
        </h3>
<p id="section-8.5-1">As required by <span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>, work on IETF protocols needs to
   consider the effects of pervasive monitoring and mitigate them when
   possible.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Pervasive Monitoring is widespread surveillance of users.  By
   encrypting more information including user identities, DTLS 1.3
   offers much better protection against pervasive monitoring.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">Massive pervasive monitoring attacks relying on key exchange
   without forward secrecy has been reported. By mandating perfect
   forward secrecy, DTLS/SCTP effectively mitigate many forms of
   passive pervasive monitoring and limits the amount of compromised
   data due to key compromise.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5-4">An important mitigation of pervasive monitoring is to force
   attackers to do dynamic key exfiltration instead of static key
   exfiltration. Dynamic key exfiltration increases the risk of
   discovery for the attacker <span>[<a href="#RFC7624" class="xref">RFC7624</a>]</span>. DTLS/SCTP per this
   specification encourages implementations to frequently set up new
   DTLS connections over the same SCTP association to force attackers
   to do dynamic key exfiltration.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5">In addition to the privacy attacks discussed above, surveillance on
   a large scale may enable tracking of a user over a wider
   geographical area and across different access networks.  Using
   information from DTLS/SCTP together with information gathered from
   other protocols increase the risk of identifying individual users.<a href="#section-8.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-9">
      <h2 id="name-contributors">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-9-1">Michael Tuexen contributed as co-author to the intitial versions
   this draft. Michael's contributions include:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">The use of the Adaptation Layer Indication.<a href="#section-9-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-2.2">Socket API extension<a href="#section-9-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-2.3">Many editorial improvements.<a href="#section-9-2.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="section-10">
      <h2 id="name-acknowledgments">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-10-1">The authors of RFC 6083 which this document is based on are
   Michael Tuexen, Eric Rescorla, and Robin Seggelmann.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The RFC 6083 authors thanked Anna Brunstrom, Lars Eggert, Gorry
   Fairhurst, Ian Goldberg, Alfred Hoenes, Carsten Hohendorf, Stefan
   Lindskog, Daniel Mentz, and Sean Turner for their invaluable
   comments.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The authors of this document want to thank GitHub user vanrein for
   their contribution.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3758">[RFC3758]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Ramalho, M.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Conrad</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"</span>, <span class="seriesInfo">RFC 3758</span>, <span class="seriesInfo">DOI 10.17487/RFC3758</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3758">https://www.rfc-editor.org/info/rfc3758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4960">[RFC4960]</dt>
        <dd>
<span class="refAuthor">Stewart, R., Ed.</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 4960</span>, <span class="seriesInfo">DOI 10.17487/RFC4960</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4960">https://www.rfc-editor.org/info/rfc4960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7627">[RFC7627]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K., Ed.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Pironti, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">M. Ray</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension"</span>, <span class="seriesInfo">RFC 7627</span>, <span class="seriesInfo">DOI 10.17487/RFC7627</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8260">[RFC8260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Loreto, S.</span>, and <span class="refAuthor">R. Seggelmann</span>, <span class="refTitle">"Stream Schedulers and User Message Interleaving for the Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 8260</span>, <span class="seriesInfo">DOI 10.17487/RFC8260</span>, <time datetime="2017-11" class="refDate">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8260">https://www.rfc-editor.org/info/rfc8260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8996">[RFC8996]</dt>
        <dd>
<span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time datetime="2021-04-30" class="refDate">30 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt">https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls-connection-id">[I-D.ietf-tls-dtls-connection-id]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifiers for DTLS 1.2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls-connection-id-13</span>, <time datetime="2021-06-22" class="refDate">22 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tls-dtls-connection-id-13.txt">https://www.ietf.org/archive/id/draft-ietf-tls-dtls-connection-id-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3436">[RFC3436]</dt>
        <dd>
<span class="refAuthor">Jungmaier, A.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">M. Tuexen</span>, <span class="refTitle">"Transport Layer Security over Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 3436</span>, <span class="seriesInfo">DOI 10.17487/RFC3436</span>, <time datetime="2002-12" class="refDate">December 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3436">https://www.rfc-editor.org/info/rfc3436</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3788">[RFC3788]</dt>
        <dd>
<span class="refAuthor">Loughney, J.</span>, <span class="refAuthor">Tuexen, M., Ed.</span>, and <span class="refAuthor">J. Pastor-Balbas</span>, <span class="refTitle">"Security Considerations for Signaling Transport (SIGTRAN) Protocols"</span>, <span class="seriesInfo">RFC 3788</span>, <span class="seriesInfo">DOI 10.17487/RFC3788</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3788">https://www.rfc-editor.org/info/rfc3788</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5061">[RFC5061]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Maruyama, S.</span>, and <span class="refAuthor">M. Kozuka</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration"</span>, <span class="seriesInfo">RFC 5061</span>, <span class="seriesInfo">DOI 10.17487/RFC5061</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5061">https://www.rfc-editor.org/info/rfc5061</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6458">[RFC6458]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Poon, K.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">V. Yasevich</span>, <span class="refTitle">"Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6458</span>, <span class="seriesInfo">DOI 10.17487/RFC6458</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6458">https://www.rfc-editor.org/info/rfc6458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7624">[RFC7624]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Hardie, T.</span>, <span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">D. Borkmann</span>, <span class="refTitle">"Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement"</span>, <span class="seriesInfo">RFC 7624</span>, <span class="seriesInfo">DOI 10.17487/RFC7624</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7624">https://www.rfc-editor.org/info/rfc7624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSSI-DAT-NT-003">[ANSSI-DAT-NT-003]</dt>
        <dd>
<span class="refAuthor">Agence nationale de la sécurité des systèmes d'information, .</span>, <span class="refTitle">"Recommendations for securing networks with IPsec"</span>, <span class="seriesInfo">ANSSI Technical Report DAT-NT-003 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;">&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TRISHAKE">[TRISHAKE]</dt>
      <dd>
<span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Fournet, C.</span>, <span class="refAuthor">Pironti, A.</span>, and <span class="refAuthor">P. Strub</span>, <span class="refTitle">"["Triple Handshakes and Cookie Cutters", "Breaking and Fixing Authentication over TLS"]"</span>, <span class="seriesInfo">IEEE Symposium on Security &amp; Privacy </span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="&lt;https://hal.inria.fr/hal-01102259/file/triple-handshakes-and-cookie-cutters-oakland14.pdf&gt;">&lt;https://hal.inria.fr/hal-01102259/file/triple-handshakes-and-cookie-cutters-oakland14.pdf&gt;</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="motivation-for-changes">
<section id="appendix-A">
      <h2 id="name-motivation-for-changes">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-motivation-for-changes" class="section-name selfRef">Motivation for Changes</a>
      </h2>
<p id="appendix-A-1">This document proposes a number of changes to RFC 6083 that have
various different motivations:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Supporting Large User Messages: RFC 6083 allowed only user messages
   that could fit within a single DTLS record. 3GPP has run into this
   limitation where they have at least four SCTP using protocols (F1,
   E1, Xn, NG-C) that can potentially generate messages over the size
   of 16384 bytes.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">New Versions: Almost 10 years has passed since RFC 6083 was written,
   and significant evolution has happened in the area of DTLS and
   security algorithms. Thus DTLS 1.3 is the newest version of DTLS
   and also the SHA-1 HMAC algorithm of RFC 4895 is getting towards
   the end of usefulness. Use of DTLS 1.3 with long lived associations
   require parallel DTLS connections. Thus, this document mandates usage of
   relevant versions and algorithms.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">Clarifications: Some implementation experiences have been gained that
   motivates additional clarifications on the specification.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">Avoid unsecured messages prior to DTLS handshake have completed.<a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.2">Make clear that all messages are encrypted after DTLS handshake.<a href="#appendix-A-5.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Claudio Porfiri</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:claudio.porfiri@ericsson.com" class="email">claudio.porfiri@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
