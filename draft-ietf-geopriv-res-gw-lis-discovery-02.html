<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Location Information Server (LIS) Discovery using IP address and Reverse DNS </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions used in this document">
<link href="#rfc.section.3" rel="Chapter" title="3 Problem Statement">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Residential Gateway">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Residential Gateway Security Features">
<link href="#rfc.section.4" rel="Chapter" title="4 IP-based DNS Solution">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Identification of IP Addresses">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Domain Name Selection">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 When To Use This Method">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Private Address Spaces">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Necessary Assumptions and Restrictions">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Failure Modes">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Deployment Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IAB Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The residential gateway is a device that has become an integral part of home networking equipment. Discovering a Location Information Server (LIS) is a necessary part of acquiring location information for location-based services. However, discovering a LIS when a residential gateway is present poses a configuration challenge, requiring a method that is able to work around the obstacle presented by the gateway. " />
  <meta name="description" content="The residential gateway is a device that has become an integral part of home networking equipment. Discovering a Location Information Server (LIS) is a necessary part of acquiring location information for location-based services. However, discovering a LIS when a residential gateway is present poses a configuration challenge, requiring a method that is able to work around the obstacle presented by the gateway. " />
  <meta name="keywords" content="Internet-Draft, HELD, LIS, Discovery, NAT, Residential Gateway" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">GEOPRIV</td>
<td class="right">M. Thomson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Andrew Corporation</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">R.P. Bellis</td>
</tr>
<tr>
<td class="left">Expires: March 15, 2012</td>
<td class="right">Nominet UK</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 12, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Location Information Server (LIS) Discovery using IP address and Reverse DNS <br />
  <span class="filename"></span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The residential gateway is a device that has become an integral part of home networking equipment. Discovering a Location Information Server (LIS) is a necessary part of acquiring location information for location-based services. However, discovering a LIS when a residential gateway is present poses a configuration challenge, requiring a method that is able to work around the obstacle presented by the gateway. </p>
<p>This document describes a solution to this problem. The solution provides alternative domain names as input to the LIS discovery process based on the network addresses assigned to a Device. </p>
<p>The IETF has been notified of intellectual property rights claimed in regard to some or all of the specification contained in this document.  For more information consult the online list of claimed rights.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 15, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions used in this document</a>
</li>
<li>3.   <a href="#rfc.section.3">Problem Statement</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Residential Gateway</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Residential Gateway Security Features</a>
</li>
<li>4.   <a href="#rfc.section.4">IP-based DNS Solution</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Identification of IP Addresses</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Domain Name Selection</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">When To Use This Method</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Private Address Spaces</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Necessary Assumptions and Restrictions</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Failure Modes</a>
</li>
<li>4.7.   <a href="#rfc.section.4.7">Deployment Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IAB Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">A Location Information Server (LIS) is a service provided by an access network. The LIS uses knowledge of the access network topology and other information to generate location for Devices. Devices within an access network are able to acquire location information from a LIS. </p>
<p id="rfc.section.1.p.2">The relationship between a Device and an access network might be transient. Configuration of the correct LIS at the Device ensures that accurate location information is available.  Without location information, some network services are not available. </p>
<p id="rfc.section.1.p.3">The configuration of a LIS address on a Device requires some automated configuration process. This is particularly relevant when it is considered that Devices might move between different access networks. <a href="#RFC5986">LIS Discovery</a> <cite title="NONE">[RFC5986]</cite> describes a method that employs the Dynamic Host Configuration Protocol (<a href="#RFC2131">DHCPv4</a> <cite title="NONE">[RFC2131]</cite>, <a href="#RFC3315">DHCPv6</a> <cite title="NONE">[RFC3315]</cite>) as input to U-NAPTR <a href="#RFC4848">[RFC4848]</a> discovery. </p>
<p id="rfc.section.1.p.4">A residential gateway, or home router, provides a range of networking functions for Devices within the network it serves. In most cases, these functions effectively prevent the successful use of DHCP for LIS discovery. </p>
<p id="rfc.section.1.p.5">The drawback with DHCP is that universal deployment of a new option takes a considerable amount of time. Often, networking equipment needs to be updated in order to support the new option. Of particular concern are the millions of residential gateway devices used to provide Internet access to homes and businesses. While <a href="#RFC5986">[RFC5986]</a> describes functions that can be provided by residential gateways to support LIS discovery, gateways built before the publication of this specification do not (and cannot) provide these functions. </p>
<p id="rfc.section.1.p.6">This document explores the problem of configuring Devices with a LIS address when a residential gateway is interposed between the Device and access network. <a href="#ps">Section 3</a> defines the problem and <a href="#ip-dns">Section 4</a> describes a method for determining a domain name that can be used for discovery of the LIS. </p>
<p id="rfc.section.1.p.7">In some cases, the solution described in this document is based on a <a href="#RFC3424">UNilateral Self-Address Fixing (UNSAF)</a> <cite title="NONE">[RFC3424]</cite> method. For those cases, this solution is considered transitional until such time as the recommendations for residential gateways in <a href="#RFC5986">[RFC5986]</a> are more widely deployed. Considerations relating to UNSAF applications are described in <a href="#iab">Section 7</a>. </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions" id="conventions">Conventions used in this document</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>. </p>
<p id="rfc.section.2.p.2">This document uses terminology established in <a href="#RFC3693">[RFC3693]</a> and <a href="#RFC5012">[RFC5012]</a>. </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#ps" id="ps">Problem Statement</a>
</h1>
<p><a href="#topo">Figure 1</a> shows a simplified network topology for fixed wire-line Internet access. This arrangement is typical when wired Internet access is provided. The diagram shows two network segments: the access network provided by an internet service provider (ISP), and the residential network served by the residential gateway. </p>
<p id="rfc.section.3.p.2">There are a number of variations on this arrangement, as documented in Section 3.1 of <a href="#RFC5687">[RFC5687]</a>. In each of these variations the goal of LIS discovery is to identify the LIS in the access network. </p>
<div id="#rfc.figure.1"></div>
<div id="#topo"></div>
<pre>
                 ________
               (/        \)
              (( Internet ))
               (\________/)
                    |
                    |
              .- - -|- - - - - - - - - - - -.
             (      |                        )
            (   +--------+       +-------+    )
  Access    (   | Access |. . . .|  LIS  |    )
  Network   (   |  Node  |       |       |    )
   (ISP)    (   +--------+       +-------+    )
             (       \               \       )
              `- - - -\- - - - - - - -\- - -'
                       \               \
                        \               |
               .- - - - -\- - - - - - - + -.
              (           \             |   )
             (      +-------------+     :    )
             (      | Residential |     |    )
 Residential (      |   Gateway   |     :    )
   Network   (      +-------------+     |    )
             (         /        \      /     )
             (        /          \    /      )
             (   +--------+    +--------+    )
             (   | Device |    | Device |    )
             (   +--------+    +--------+    )
              (                             )
               `- - - - - - - - - - - - - -'
   </pre>
<p id="rfc.section.3.p.3">A particularly important characteristic of this arrangement is the relatively small area served by the residential gateway. Given a small enough area, it is reasonable to delegate the responsibility for providing Devices within the residential network with location information to the ISP. The ISP is able to provide location information that identifies the residence, which should be adequate for a wide range of purposes. </p>
<p id="rfc.section.3.p.4">A residential network that covers a larger area might require a dedicated LIS, a case that is outside the scope of this document. </p>
<p id="rfc.section.3.p.5">The goal of LIS discovery is to identify a LIS that is able to provide the Device with accurate location information. In the network topology described, this means identifying the LIS in the access network. The residential gateway is a major obstacle in achieving this goal. </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Residential Gateway</h1>
<p id="rfc.section.3.1.p.1">A residential gateway can encompass several different functions including: modem, Ethernet switch, wireless access point, router, network address translation (NAT), DHCP server, DNS relay and firewall. Of the common functions provided, the NAT function of a residential gateway has the greatest impact on LIS discovery. </p>
<p id="rfc.section.3.1.p.2">An ISP is typically parsimonious about their IP address allocations; each customer is allocated a limited number of IP addresses. Therefore, NAT is an extremely common function of gateways. NAT enables the use of multiple Devices within the residential network.  However NAT also means that Devices within the residence are not configured by the ISP directly. </p>
<p id="rfc.section.3.1.p.3">When it comes to discovering a LIS, the fact that Devices are not configured by the ISP causes a significant problem. Configuration is the ideal method of conveying the information necessary for discovery. Devices attached to residential gateways are usually given a generic configuration that includes no information about the ISP network. For instance, DNS configuration typically points to a DNS relay on the gateway device. This approach ensures that the local network served by the gateway is able to operate without a connection to the ISP, but it also means that Devices are effectively ignorant of the ISP network. </p>
<p><a href="#RFC5986">[RFC5986]</a> describes several methods that can be applied by a residential gateway to assist Devices in acquiring location information. For instance, the residential gateway could forward LIS address information to hosts within the network it serves. Such an active involvement in the discovery process only works for new residential gateway devices that implement these recommendations. </p>
<p id="rfc.section.3.1.p.5">Where residential gateways already exist, direct involvement of the gateway in LIS discovery requires that the residential gateway be updated or replaced. The cost of replacement is difficult to justify to the owner of the gateway, especially when it is considered that the gateway still fills its primary function: Internet access. </p>
<p id="rfc.section.3.1.p.6">Existing residential gateways have proven to be quite reliable devices, some operating continuously for many years without failure. As a result, there are many operational gateways that are of a considerable age, some well outside the period of manufacturer support. Updating the software in such devices is not feasible in many cases. Even if software updates were made available, many residential gateways cannot be updated remotely, inevitably leading to some proportion that is not updated. </p>
<p id="rfc.section.3.1.p.7">This document therefore describes a method which can be used by Devices to discover their LIS without any assistance from the network.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Residential Gateway Security Features</h1>
<p id="rfc.section.3.2.p.1">A network firewall function is often provided by residential gateways as a security measure. Security features like intrusion detection systems help protect users from attacks. Amongst these protections is a port filter that prevents both inbound and outbound traffic on certain TCP and UDP ports. Therefore, any solution needs to consider the likelihood of traffic being blocked. </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#ip-dns" id="ip-dns">IP-based DNS Solution</a>
</h1>
<p><a href="#RFC5986">LIS discovery</a> <cite title="NONE">[RFC5986]</cite> uses a DNS-based Dynamic Delegation Discovery Service (DDDS) system as the basis of discovery. Input to this process is a domain name. Use of DHCP for acquiring the domain name is specified, but alternative methods of acquisition are permitted. </p>
<p id="rfc.section.4.p.2">This document specifies a means for a device to discover several alternative domain names that can be used as input to the DDDS process. These domain names are based on the IP address of the Device. Specifically, the domain names are a portion of the reverse DNS trees - either the <samp>.in-addr.arpa.</samp> or <samp>.ip6.arpa.</samp> tree. </p>
<p id="rfc.section.4.p.3">A Device might be reachable at one of a number of IP addresses. In the process described, a Device first identifies each IP address that it is potentially reachable from. From each of these addresses, the Device then selects up to three domain names for use in discovery.  These domain names are then used as input to the DDDS process. </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Identification of IP Addresses</h1>
<p id="rfc.section.4.1.p.1">A Device identifies a set of potential IP addresses that currently result in packets being routed to it. These are ordered by proximity, with those addresses that are used in adjacent network segments being favoured over those used in public or remote networks. The first addresses in the set are those that are assigned to local network interfaces. </p>
<p id="rfc.section.4.1.p.2">A Device can use the Session Traversal Utilities for NAT (STUN) <a href="#RFC5389">[RFC5389]</a> to determine its public reflexive transport address. The host uses the <samp>Binding Request</samp> message and the resulting <samp>XOR-MAPPED-ADDRESS</samp> parameter that is returned in the response. </p>
<p id="rfc.section.4.1.p.3">Alternative methods for determining other IP addresses MAY be used by the host. <a href="#UPnP-IGD-WANIPConnection1">Universal Plug and Play (UPnP)</a> <cite title="NONE">[UPnP-IGD-WANIPConnection1]</cite> and <a href="#I-D.cheshire-nat-pmp">NAT Port Mapping Protocol (NAT-PMP)</a> <cite title="NONE">[I-D.cheshire-nat-pmp]</cite> are both able to provide the external address of a residential gateway device when enabled. These as well as proprietary methods for determining other addresses might also be available.  Because there is no assurance that these methods will be supported by any access network these methods are not mandated. Note also that in some cases, methods that rely on the view of the network from the residential gateway device could reveal an address in a private address range (see <a href="#assumptions">Section 4.5</a>). </p>
<p id="rfc.section.4.1.p.4">In many instances, the IP address produced might be from a private address range. For instance, the address on a local network interface could be from a private range allocated by the residential gateway. In other cases, methods that rely on the view of the network (UPnP, NAT-PMP) from the residential gateway device could reveal an address in a private address range if the access network also uses NAT. For a private IP address, the derived domain name is only usable where the DNS server used contains data for the corresponding private IP address range. </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Domain Name Selection</h1>
<p id="rfc.section.4.2.p.1">The domain name selected for each resulting IP address is the name that would be used for a reverse DNS lookup. The domain name derived from an IP version 4 address is in the <samp>.in-addr.arpa.</samp> tree and follows the construction rules in Section 3.5 of <a href="#RFC1035">[RFC1035]</a>. The domain name derived from an IP version 6 address is in the <samp>.ip6.arpa.</samp> tree and follows the construction rules in Section 2.5 of <a href="#RFC3596">[RFC3596]</a>. </p>
<p id="rfc.section.4.2.p.2">Additional domain names are added to allow for a single record to cover a larger set of addresses. If the search on the domain derived from the full IP address does not produce a NAPTR record with the desired service tag (e.g., <samp>LIS:HELD</samp>), a similar search is repeated based on a shorter domain name, using a part of the IP address: </p>

<ul>
<li>For IP version 4, the resulting domain name SHOULD be shortened successively by one and two labels and the query repeated. This corresponds to a search on a /24 or /16 network prefix. This allows for fewer DNS records in the case where a single access network covering an entire /24 or /16 network is served by the same LIS. </li>
<li>For IP version 6, the resulting domain SHOULD be shortened sucessively by 16, 18, 20 and 24 labels and the query repeated. This corresponds to a search on a /64, /56, /48 or /32 network prefix.</li>
</ul>

<p> DNS queries on other prefixes than those listed above SHOULD NOT be performed to limit the number of DNS queries performed by Devices. If no LIS is discovered by this method, no more than four U-NAPTR resolutions are invoked for each IP address. </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> When To Use This Method</h1>
<p id="rfc.section.4.3.p.1">The DHCP method described in <a href="#RFC5986">[RFC5986]</a> SHOULD be attempted on all local network interfaces before attempting this method. This method is employed either because DHCP is unavailable, when the DHCP server does not provide a value for the access network domain name option, or if a request to the resulting LIS results in a HELD <samp>notLocatable</samp> error or equivalent. </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#private-address" id="private-address">Private Address Spaces</a>
</h1>
<p id="rfc.section.4.4.p.1">Addresses from a private use address space can be used as input to this method.  In many cases, this applies to addresses defined in <a href="#RFC1918">[RFC1918]</a>, though other address ranges could have limited reachability where this advice also applies.  This is only possible if a DNS server with a view of the same address space is used. Public DNS servers cannot provide useful records for private addresses. </p>
<p id="rfc.section.4.4.p.2">Using an address from a private space in discovery can provide a more specific answer if the DNS server has records for that space. <a href="#privatespace">Figure 2</a> shows a network configuration where addresses from an ISP network could better indicate the correct LIS.  Records in DNS B can be provided for the 10.0.0.0/8 range, potentially dividing that range so that a more local LIS can be selected.  </p>
<div id="#rfc.figure.2"></div>
<div id="#privatespace"></div>
<pre>
  _____        ________
 ( DNS ).....(/        \)      Public
 (__A__)    (( Internet ))     Address
             (\________/)      Space
                   |
                 [NAT]
  _____       _____|_____
 ( DNS )....(/           \)    Private
 (__B__)   (( ISP Network ))   Address Space
            (\___________/)    (e.g. 10.0.0.0/8)
                   |
               [Gateway]
               ____|____
             (/         \)     Private
            (( Residence ))    Address Space
             (\_________/)     (e.g. 192.168.0.0/16)
   </pre>
<p id="rfc.section.4.4.p.3">The goal of automatic DNS configuration is usually to select a local DNS, which suits configurations like the one shown.  However, use of public DNS or STUN servers means that a public IP address is likely to be found.  For STUN in particular, selecting a public server minimizes the need for reconfiguration when a Device moves.  Adding records for the public address space used by an access network ensures that the discovery process succeeds when a public address is used. </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#assumptions" id="assumptions">Necessary Assumptions and Restrictions</a>
</h1>
<p id="rfc.section.4.5.p.1">When used by a Device for LIS discovery this is an UNSAF application and is subject to the limitations described in <a href="#iab">Section 7</a>. </p>
<p id="rfc.section.4.5.p.2">It is not necessary that the IP address used is unique to the Device, only that the address can be somehow related to the Device or the access network that serves the Device.  This allows a degree of flexibility in determining this value, although <a href="#security">security considerations</a> <cite title="NONE">[security]</cite> might require that the address be verified to limit the chance of falsification. </p>
<p id="rfc.section.4.5.p.3">This solution assumes that the public reflexive transport address used by a Device is in some way controlled by the access network provider, or some other related party. This implies that the corresponding <samp>.in-addr.arpa.</samp> or <samp>.ip6.arpa.</samp> record can be updated by that entity to include a useful value for the LIS address. </p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> Failure Modes</h1>
<p id="rfc.section.4.6.p.1">Successful use of private addresses relies on a DNS server that has records for the address space that is used.  Using a public IP address increases the likelihood of this.  This document relies on STUN to provide the Device with a public reflexive transport address. Configuration of STUN server is necessary to ensure that this is successful. </p>
<p id="rfc.section.4.6.p.2">Alternative methods for discovering external IP addresses are possible, including UPnP and NAT-PMP. These methods might not be supported by the residential gateway and cannot be relied upon in all cases. </p>
<p id="rfc.section.4.6.p.3">In cases where a virtual private network (VPN) or other tunnel is used, the entity providing a public IP address might not be able to provide the Device with location information. It is assumed that this entity is able to identify this problem and indicate this to the Device (using the <samp>notLocatable</samp> HELD error, or similar). This problem is described in more detail in <a href="#RFC5985">[RFC5985]</a>. </p>
<h1 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> Deployment Considerations</h1>
<p id="rfc.section.4.7.p.1">An access network provider SHOULD provide NAPTR records for each public IP address that is used for Devices within the access network. If the access network provider uses NAT, any DNS internal to that NAT SHOULD also include records for the private address range. </p>
<p id="rfc.section.4.7.p.2">NAPTR records can be provided for individual IP addresses. To limit the proliferation of identical records, a single record can be placed at a the higher nodes of the tree (corresponding to /24 and /16 for IPv4; /64, /48 and /32 for IPv6). A record at a higher point in the tree (those with a shorter prefix) applies to all addresses lower in the tree (those with a longer prefix); records at the lower point override those at higher points, allowing for exceptions to be provided for at the lower point. </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">[RFC Editor: please remove this section prior to publication.]</p>
<p id="rfc.section.5.p.2">This document has no IANA actions.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">The security considerations described in <a href="#RFC5986">[RFC5986]</a> apply to the discovery process as a whole.  The primary security concern is with the potential for an attacker to impersonate a LIS.  </p>
<p id="rfc.section.6.p.2">The added ability for a third party to discover the identity of a LIS does not add any concerns, since the identity of a LIS is considered public information.  </p>
<p id="rfc.section.6.p.3">In addition to existing considerations, this document introduces further security considerations relating to the identification of the IP address.  It is possible that an attacker could attempt to provide a falsified IP addresses in an attempt to subvert the rest of the process. </p>
<p><a href="#RFC5389">[RFC5389]</a> describes attacks where an attacker is able to ensure that a Device receives a falsified reflexive address. Even if the STUN server is trusted, an attacker might be able to ensure that a falsified address is provided to the Device. </p>
<p id="rfc.section.6.p.5">This attack is an effective means of denial of service, or a means to provide a deliberately misleading service. Notably, any LIS that is identified based on a falsified IP address could still be a valid LIS for the given IP address, just not one that is useful for providing the Device with location information. In this case, the LIS provides a HELD <samp>notLocatable</samp> error, or an equivalent. If the falsified IP address is under the control of the attacker, it is possible that misleading (but verifiable) DNS records could indicate a malicious LIS that provides false location information. </p>
<p id="rfc.section.6.p.6">In all cases of falsification, the best remedy is to perform some form of independent verification of the result. No specific mechanism is currently available to prevent attacks based on falsification of reflexive addresses; it is suggested that Devices attempt to independently verify that the reflexive transport address provided is accurate.</p>
<p id="rfc.section.6.p.7">Use of private address space effectively prevents use of the usual set of trust anchors for DNSSEC. Only a DNS server that is able to see the same private address space can provide useful records. A Device that relies on DNS records in the private address space portion of the <samp>.in-addr.arpa.</samp> or <samp>.ip6.arpa.</samp> trees MUST either use an alternative trust anchor for these records or rely on other means of ensuring the veracity of the DNS records. </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#iab" id="iab">IAB Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The IAB has studied the problem of <a href="#RFC3424">Unilateral Self-Address Fixing (UNSAF)</a> <cite title="NONE">[RFC3424]</cite>, which is the general process by which a client attempts to determine its address in another realm on the other side of a NAT through a collaborative protocol reflection mechanism, such as STUN. </p>
<p id="rfc.section.7.p.2">This section only applies to the use of this method of LIS discovery by Devices and does not apply to its use for third-party LIS discovery.</p>
<p id="rfc.section.7.p.3">The IAB requires that protocol specifications that define UNSAF mechanisms document a set of considerations. </p>

<ol>
<li>Precise definition of a specific, limited-scope problem that is to be solved with the UNSAF proposal. <br><br> <a href="#ps">Section 3</a> describes the limited scope of the problem addressed in this document. </li>
<li>Description of an exit strategy/transition plan. <br><br> <a href="#RFC5986">[RFC5986]</a> describes behaviour that residential gateways require in order for this short term solution to be rendered unnecessary. When implementations of the recommendations in LIS discovery are widely available, this UNSAF mechanism can be made obsolete.</li>
<li>Discussion of specific issues that may render systems more "brittle". <br><br> A description of the necessary assumptions and limitations of this solution are included in <a href="#assumptions">Section 4.5</a>. <br><br> Use of STUN for discovery of a reflexive transport address is inherently brittle in the presence of multiple NATs or address realms. In particular, brittleness is added by the requirement of using a DNS server that is able to view the address realm that contains the IP address in question. If address realms use overlapping addressing space, then there is a risk that the DNS server provides information that is not useful to the Device. </li>
<li>Identify requirements for longer term, sound technical solutions; contribute to the process of finding the right longer term solution. <br><br> A longer term solution is already provided in <a href="#RFC5986">[RFC5986]</a>.  However, that solution relies on widespread deployment. The UNSAF solution provided here is provided as an interim solution that enables LIS access for Devices that are not able to benefit from deployment of the recommendations in <a href="#RFC5986">[RFC5986]</a>. </li>
<li>Discussion of the impact of the noted practical issues with existing deployed NATs and experience reports. <br><br> The UNSAF mechanism depends on the experience in deployment of <a href="#RFC5389">STUN</a> <cite title="NONE">[RFC5389]</cite>. On the whole, existing residential gateway devices are able to provide access to STUN and DNS service reliably, although regard should be given to the size of the DNS response (see <a href="#RFC5625">[RFC5625]</a>). </li>
</ol>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3424">[RFC3424]</b></td>
<td class="top">
<a>Daigle, L.</a>, <a>IAB</a>, "<a href="http://tools.ietf.org/html/rfc3424">IAB Considerations for UNilateral Self-Address Fixing (UNSAF) Across Network Address Translation</a>", RFC 3424, November 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3596">[RFC3596]</b></td>
<td class="top">
<a>Thomson, S.</a>, <a>Huitema, C.</a>, <a>Ksinant, V.</a> and <a>M. Souissi</a>, "<a href="http://tools.ietf.org/html/rfc3596">DNS Extensions to Support IP Version 6</a>", RFC 3596, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5985">[RFC5985]</b></td>
<td class="top">
<a>Barnes, M.</a>, "<a href="http://tools.ietf.org/html/rfc5985">HTTP-Enabled Location Delivery (HELD)</a>", RFC 5985, September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5986">[RFC5986]</b></td>
<td class="top">
<a>Thomson, M.</a> and <a>J. Winterbottom</a>, "<a href="http://tools.ietf.org/html/rfc5986">Discovering the Local Location Information Server (LIS)</a>", RFC 5986, September 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1918">[RFC1918]</b></td>
<td class="top">
<a href="mailto:yakov@cisco.com" title="Cisco systems">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com" title="Chrysler Corporation">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net" title="RIPE Network Coordination Centre">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net" title="RIPE Network Coordination Centre">Groot, G.</a> and <a href="mailto:lear@sgi.com" title="Silicon Graphics, Inc.">E. Lear</a>, "<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>", BCP 5, RFC 1918, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2131">[RFC2131]</b></td>
<td class="top">
<a href="mailto:droms@bucknell.edu" title="Computer Science Department">Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>", RFC 2131, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3693">[RFC3693]</b></td>
<td class="top">
<a>Cuellar, J.</a>, <a>Morris, J.</a>, <a>Mulligan, D.</a>, <a>Peterson, J.</a> and <a>J. Polk</a>, "<a href="http://tools.ietf.org/html/rfc3693">Geopriv Requirements</a>", RFC 3693, February 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4848">[RFC4848]</b></td>
<td class="top">
<a>Daigle, L.</a>, "<a href="http://tools.ietf.org/html/rfc4848">Domain-Based Application Service Location Using URIs and the Dynamic Delegation Discovery Service (DDDS)</a>", RFC 4848, April 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5012">[RFC5012]</b></td>
<td class="top">
<a>Schulzrinne, H.</a> and <a>R. Marshall</a>, "<a href="http://tools.ietf.org/html/rfc5012">Requirements for Emergency Context Resolution with Internet Technologies</a>", RFC 5012, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5389">[RFC5389]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Mahy, R.</a>, <a>Matthews, P.</a> and <a>D. Wing</a>, "<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>", RFC 5389, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5687">[RFC5687]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>H. Schulzrinne</a>, "<a href="http://tools.ietf.org/html/rfc5687">GEOPRIV Layer 7 Location Configuration Protocol: Problem Statement and Requirements</a>", RFC 5687, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sipcore-location-conveyance">[I-D.ietf-sipcore-location-conveyance]</b></td>
<td class="top">
<a>Polk, J</a>, <a>Rosen, B</a> and <a>J Peterson</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sipcore-location-conveyance-09">Location Conveyance for the Session Initiation Protocol</a>", Internet-Draft draft-ietf-sipcore-location-conveyance-09, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="UPnP-IGD-WANIPConnection1">[UPnP-IGD-WANIPConnection1]</b></td>
<td class="top">
<a>UPnP Forum</a>, "<a>Internet Gateway Device (IGD) Standardized Device Control Protocol V 1.0: WANIPConnection:1 Service Template Version 1.01 For UPnP Version 1.0 </a>", DCP 05-001, Nov 2001.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.cheshire-nat-pmp">[I-D.cheshire-nat-pmp]</b></td>
<td class="top">
<a>Cheshire, S</a>, "<a href="http://tools.ietf.org/html/draft-cheshire-nat-pmp-03">NAT Port Mapping Protocol (NAT-PMP)</a>", Internet-Draft draft-cheshire-nat-pmp-03, April 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6155">[RFC6155]</b></td>
<td class="top">
<a>Winterbottom, J.</a>, <a>Thomson, M.</a>, <a>Tschofenig, H.</a> and <a>R. Barnes</a>, "<a href="http://tools.ietf.org/html/rfc6155">Use of Device Identity in HTTP-Enabled Location Delivery (HELD)</a>", RFC 6155, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5625">[RFC5625]</b></td>
<td class="top">
<a>Bellis, R.</a>, "<a href="http://tools.ietf.org/html/rfc5625">DNS Proxy Implementation Guidelines</a>", BCP 152, RFC 5625, August 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Thomson</span> 
	  <span class="n hidden">
		<span class="family-name">Thomson</span>
	  </span>
	</span>
	<span class="org vcardline">Andrew Corporation</span>
	<span class="adr">
	  <span>PO Box U40</span>

	  <span class="vcardline">
		<span class="locality">Wollongong University Campus</span>,  
		<span class="region">NSW</span> 
		<span class="code">2500</span>
	  </span>
	  <span class="country-name vcardline">AU</span>
	</span>
	<span class="vcardline">Phone: +61 2 4221 2915</span>

<span class="vcardline">EMail: <a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></span>

<span class="vcardline">URI: <a href="http://www.andrew.com/">http://www.andrew.com/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ray Bellis</span> 
	  <span class="n hidden">
		<span class="family-name">Bellis</span>
	  </span>
	</span>
	<span class="org vcardline">Nominet UK</span>
	<span class="adr">
	  <span>Edmund Halley Road</span>

	  <span class="vcardline">
		<span class="locality">Oxford</span>,  
		<span class="region"></span>
		<span class="code">OX4 4DQ</span>
	  </span>
	  <span class="country-name vcardline">United Kingdom</span>
	</span>
	<span class="vcardline">Phone: +44 1865 332211</span>

<span class="vcardline">EMail: <a href="mailto:ray.bellis@nominet.org.uk">ray.bellis@nominet.org.uk</a></span>

<span class="vcardline">URI: <a href="http://www.nominet.org.uk/">http://www.nominet.org.uk/</a></span>

  </address>
</div>

</body>
</html>