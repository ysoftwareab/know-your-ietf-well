<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="robots" content="index,follow" />

        <link rel="icon" href="./css/images/rfc.png" type="image/png" />
        <link rel="shortcut icon" href="./css/images/rfc.png" type="image/png" />
        <title>rfc5025</title>
    
        <link rel="stylesheet" type="text/css" href="./css/errata-base.css"/>
        <link rel="stylesheet" type="text/css" href="./css/errata-color.css" title="Default: Basic Colors"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-monochrome.css" title="Monochrome"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-printer.css" title="Printer"/>

        <script src="./css/errata.js"></script>
    </head>
    <body>
        <div class='Verified-headnote-styling'>
<span style="font-weight: bold;">This is a purely informative rendering of an RFC that includes verified errata.  This rendering may not be used as a reference.</span>
<br/>
<br/>
The following 'Verified' errata have been incorporated in this document:
 <a href='#btn_2544'>EID 2544</a>
</div>

        <pre>
Network Working Group                                       J. Rosenberg
Request for Comments: 5025                                         Cisco
Category: Standards Track                                  December 2007


                     Presence Authorization Rules

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   Authorization is a key function in presence systems.  Authorization
   policies, also known as authorization rules, specify what presence
   information can be given to which watchers, and when.  This
   specification defines an Extensible Markup Language (XML) document
   format for expressing presence authorization rules.  Such a document
   can be manipulated by clients using the XML Configuration Access
   Protocol (XCAP), although other techniques are permitted.

Table of Contents

   1. Introduction ....................................................2
   2. Terminology .....................................................3
   3. Structure of Presence Authorization Documents ...................3
      3.1. Conditions .................................................4
           3.1.1. Identity ............................................4
                  3.1.1.1. Acceptable Forms of Authentication .........4
                  3.1.1.2. Computing a URI for the Watcher ............5
           3.1.2. Sphere ..............................................6
      3.2. Actions ....................................................7
           3.2.1. Subscription Handling ...............................7
      3.3. Transformations ............................................9
           3.3.1. Providing Access to Data Component Elements .........9
                  3.3.1.1. Device Information .........................9
                  3.3.1.2. Person Information ........................10
                  3.3.1.3. Service Information .......................11
           3.3.2. Providing Access to Presence Attributes ............12
                  3.3.2.1. Provide Activities ........................12
                  3.3.2.2. Provide Class .............................12
                  3.3.2.3. Provide DeviceID ..........................13
                  3.3.2.4. Provide Mood ..............................13
                  3.3.2.5. Provide Place-is ..........................13

                  3.3.2.6. Provide Place-type ........................13
                  3.3.2.7. Provide Privacy ...........................13
                  3.3.2.8. Provide Relationship ......................14
                  3.3.2.9. Provide Sphere ............................14
                  3.3.2.10. Provide Status-Icon ......................14
                  3.3.2.11. Provide Time-Offset ......................14
                  3.3.2.12. Provide User-Input .......................14
                  3.3.2.13. Provide Note .............................15
                  3.3.2.14. Provide Unknown Attribute ................15
                  3.3.2.15. Provide All Attributes ...................16
   4. When to Apply the Authorization Policies .......................17
   5. Implementation Requirements ....................................17
   6. Example Document ...............................................18
   7. XML Schema .....................................................19
   8. Schema Extensibility ...........................................21
   9. XCAP Usage .....................................................22
      9.1. Application Unique ID .....................................22
      9.2. XML Schema ................................................22
      9.3. Default Namespace .........................................22
      9.4. MIME Type .................................................22
      9.5. Validation Constraints ....................................22
      9.6. Data Semantics ............................................22
      9.7. Naming Conventions ........................................23
      9.8. Resource Interdependencies ................................23
      9.9. Authorization Policies ....................................23
   10. Security Considerations .......................................23
   11. IANA Considerations ...........................................24
      11.1. XCAP Application Usage ID ................................24
      11.2. URN Sub-Namespace Registration ...........................25
      11.3. XML Schema Registrations .................................25
   12. Acknowledgements ..............................................26
   13. References ....................................................26
      13.1. Normative References .....................................26
      13.2. Informative References ...................................27

1.  Introduction

   The Session Initiation Protocol (SIP) for Instant Messaging and
   Presence (SIMPLE) specifications allow a user, called a watcher, to
   subscribe to another user, called a presentity [17], in order to
   learn their presence information [18].  This subscription is handled
   by a presence agent.  However, presence information is sensitive, and
   a presence agent needs authorization from the presentity prior to
   handing out presence information.  As such, a presence authorization
   document format is needed.  This specification defines a format for
   such a document, called a presence authorization document.

   [8] specifies a framework for representing authorization policies,
   and is applicable to systems such as geo-location and presence.  This
   framework is used as the basis for presence authorization documents.
   In the framework, an authorization policy is a set of rules.  Each
   rule contains conditions, actions, and transformations.  The
   conditions specify under what conditions the rule is to be applied to
   presence server processing.  The actions element tells the server
   what actions to take.  The transformations element indicates how the
   presence data is to be manipulated before being presented to that
   watcher, and as such, defines a privacy filtering operation. [8]
   identifies a small number of specific conditions common to presence
   and location services, and leaves it to other specifications, such as
   this one, to fill in usage specific details.

   A presence authorization document can be manipulated by clients using
   several means.  One such mechanism is the XML Configuration Access
   Protocol (XCAP) [2].  This specification defines the details
   necessary for using XCAP to manage presence authorization documents.

2.  Terminology

   In this document, the key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;,
   &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;,
   and &quot;OPTIONAL&quot; are to be interpreted as described in RFC 2119 [1] and
   indicate requirement levels for compliant implementations.

3.  Structure of Presence Authorization Documents

   A presence authorization document is an XML document, formatted
   according to the schema defined in [8].  Presence authorization
   documents inherit the MIME type of common policy documents,
   application/auth-policy+xml.  As described in [8], this document is
   composed of rules that contain three parts - conditions, actions, and
   transformations.  Each action or transformation, which is also called
   a permission, has the property of being a positive grant of
   information to the watcher.  As a result, there is a well-defined
   mechanism for combining actions and transformations obtained from
   several sources.  This mechanism is privacy safe, since the lack of
   any action or transformation can only result in less information
   being presented to a watcher.

   This section defines the new conditions, actions, and transformations
   defined by this specification.

3.1.  Conditions

3.1.1.  Identity

   Although the &lt;identity&gt; element is defined in [8], that specification
   indicates that the specific usages of the framework document need to
   define details that are protocol and usage specific.  In particular,
   it is necessary for a usage of the common policy framework to:

   o  Define acceptable means of authentication.

   o  Define the procedure for representing the identity of the WR
      (Watcher/Requestor) as a URI or Internationalized Resource
      Identifier (IRI) [13].

   This sub-section defines those details for systems based on [18].  It
   does so in general terms, so that the recommendations defined here
   apply to existing and future authentication mechanisms in SIP.

3.1.1.1.  Acceptable Forms of Authentication

   When used with SIP, a request is considered authenticated if one of
   the following is true:


   The watcher proves its identity to the server through a form of
   cryptographic authentication, including authentication based on a
   shared secret or a certificate, and that authentication yields an
   identity for the watcher.

   The request comes from a sender that is asserting the identity of the
   watcher, and:

   1.  the assertion includes a claim that the asserting party used a
      form of cryptographic authentication (as defined above) to
      determine the identity of the watcher, and

   2.  the server trusts that assertion, and

   3.  the assertion provides an identity in the form of a URI.

   Based on this definition, examples of valid authentication techniques
   include SIP [5], digest authentication [4], cryptographically
   verified identity assertions (RFC 4474 [15]), and identity assertions
   made in closed network environments (RFC 3325 [16]).

   However, the anonymous authentication described on page 194 of RFC
   3261 [5] is not considered a valid mechanism for authentication

   because it does not produce an identity for the watcher.  However, an
   anonymous From header field, when used in conjunction with RFC 4474
   [15], is considered an acceptable mechanism for authentication, since
   it still implies that the asserting node performed authentication
   that produced the identity of the watcher.

3.1.1.2.  Computing a URI for the Watcher

   Computing the URI for the watcher depends on whether the identity is
   being ascertained through authentication or through an asserted
   identity.

   If an identity assertion is being utilized, the asserted identity
   itself (which is in the form of a URI for acceptable forms of
   identity assertion) is utilized as the URI.  If the identity
   assertion mechanism asserts multiple URIs for the watcher, then each
   of them is used for the comparisons outlined in [8], and if any of
   them match a &lt;one&gt; or &lt;except&gt; element, the watcher is considered a
   match.

   If an identity is being determined directly by a cryptographic
   authentication, that authentication must produce a URI, or must
   produce some form of identifier that can be linked, through
   provisioning, to a URI that is bound to that identifier.

   For example, in the case of SIP Digest authentication, the
   authentication process produces a username scoped within a realm.
   That username and realm are bound to an Address of Record (AOR)
   through provisioning, and the resulting AOR is used as the watcher
   URI.  Consider the following &quot;user record&quot; in a database:

   SIP AOR: sip:alice@example.com
   digest username: ali
   digest password: f779ajvvh8a6s6
   digest realm: example.com

   If the presence server receives a SUBSCRIBE request, challenges it
   with the realm set to &quot;example.com&quot;, and the subsequent SUBSCRIBE
   contains an Authorization header field with a username of &quot;ali&quot; and a
   digest response generated with the password &quot;f779ajvvh8a6s6&quot;, the
   identity used in matching operations is &quot;sip:alice@example.com&quot;.

   In SIP systems, it is possible for a user to have aliases - that is,
   there are multiple SIP AORs &quot;assigned&quot; to a single user.  In terms of
   this specification, there is no relationship between those aliases.
   Each would look like a different user.  This will be the consequence
   for systems where the watcher is in a different domain than the
   presentity.  However, even if the watcher and presentity are in the

   same domain, and the presence server knows that there are aliases for
   the watcher, these aliases are not mapped to each other or used in
   any way.

   SIP also allows for anonymous requests.  If a request is anonymous
   because the watcher utilized an authentication mechanism that does
   not provide an identity to the presence server (such as the SIP
   digest &quot;anonymous&quot; username), the request is considered
   unauthenticated (as discussed above) and will match only an empty
   &lt;identity&gt; element.  If a request is anonymous because it contains a
   Privacy header field [14], but still contains an asserted identity
   meeting the criteria defined above, that identity is utilized, and
   the fact that the request was anonymous has no impact on the identity
   processing.

   It is important to note that SIP frequently uses both SIP URI and tel
   URI [12] as identifiers, and to make matters more confusing, a SIP
   URI can contain a phone number in its user part, in the same format
   used in a tel URI.  A WR identity that is a SIP URI with a phone
   number will NOT match the &lt;one&gt; and &lt;except&gt; conditions whose &#x27;id&#x27; is
   a tel URI with the same number.  The same is true in the reverse.  If
   the WR identity is a tel URI, this will not match a SIP URI in the
   &lt;one&gt; or &lt;except&gt; conditions whose user part is a phone number.  URIs
   of different schemes are never equivalent.

3.1.2.  Sphere

   The &lt;sphere&gt; element is defined in [8].  However, each application
   making use of the common policy specification needs to determine how
   the presence server computes the value of the &lt;sphere&gt; to be used in
   the evaluation of the condition.

   To compute the value of &lt;sphere&gt;, the presence agent examines all
   published presence documents for the presentity.  If at least one of
   them includes the &lt;sphere&gt; element [9] as part of the person data
   component [10], and all of those containing the element have the same
   value for it, which is the value used for the &lt;sphere&gt; in presence
   policy processing.  If, however, the &lt;sphere&gt; element was not present
   in any of the published documents, or it was present but had
   inconsistent values, its value is considered undefined in terms of
   presence policy processing.

   Care must be taken in using &lt;sphere&gt; as a condition for determining
   the subscription handling.  Since the value of &lt;sphere&gt; changes
   dynamically, a state change can cause a subscription to be suddenly
   terminated.  The watcher has no way to know, aside from polling, when
   their subscription would be reinstated as the value of &lt;sphere&gt;

   changes.  For this reason, &lt;sphere&gt; is primarily useful for matching
   on rules that define transformations.

3.2.  Actions

3.2.1.  Subscription Handling

   The &lt;sub-handling&gt; element specifies the subscription authorization
   decision that the server should make.  It also specifies whether or
   not the presence document for the watcher should be constructed using
   &quot;polite blocking&quot;.  Usage of polite blocking and the subscription
   authorization decision are specified jointly since proper privacy
   handling requires a correlation between them.  As discussed in [8],
   since the combination algorithm runs independently for each
   permission, if correlations exist between permissions, they must be
   merged into a single variable.  That is what is done here.  The
   &lt;sub-handling&gt; element is an enumerated Integer type.  The defined
   values are:

   block:  This action tells the server to reject the subscription,
      placing it in the &quot;terminated&quot; state.  It has the value of zero,
      and it represents the default value.  No value of the &lt;sub-
      handling&gt; element can ever be lower than this.  Strictly speaking,
      it is not necessary for a rule to include an explicit block
      action, since the default in the absence of any action will be
      block.  However, it is included for completeness.

   confirm:  This action tells the server to place the subscription in
      the &quot;pending&quot; state, and await input from the presentity to
      determine how to proceed.  It has a value of ten.

   polite-block:  This action tells the server to place the subscription
      into the &quot;active&quot; state, and to produce a presence document that
      indicates that the presentity is unavailable.  A reasonable
      document would exclude device and person information elements, and
      include only a single service whose basic status is set to closed
      [3].  This action has a value of twenty.

   allow:  This action tells the server to place the subscription into
      the &quot;active&quot; state.  This action has a value of thirty.

      NOTE WELL: Placing a value of block for this element does not
      guarantee that a subscription is denied!  If any matching rule has
      any other value for this element, the subscription will receive
      treatment based on the maximum of those other values.  This is
      based on the combining rules defined in [8].

   Future specifications that wish to define new types of actions MUST
   define an entirely new action (separate from &lt;sub-handling&gt;), and
   define their own set of values for that action.  A document could
   contain both &lt;sub-handling&gt; and a subscription handling action
   defined by a future specification; in that case, since each action is
   always a positive grant of information, the resulting action is the
   least restrictive one across both elements.

   The exact behavior of a presence server upon a change in the sub-
   handling value can be described by utilizing the subscription
   processing state machine in Figure 1 of RFC 3857 [6].

   If the &lt;sub-handling&gt; permission changes value to &quot;block&quot;, this
   causes a &quot;rejected&quot; event to be generated into the subscription state
   machine for all affected subscriptions.  This will cause the state
   machine to move into the &quot;terminated&quot; state, resulting in the
   transmission of a NOTIFY to the watcher with a Subscription-State
   header field with value &quot;terminated&quot; and a reason of &quot;rejected&quot; [7],
   which terminates their subscription.  If a new subscription arrives
   later on, and the value of &lt;sub-handling&gt; that applies to that
   subscription is &quot;block&quot;, the subscription processing follows the
   &quot;subscribe, policy=reject&quot; branch from the &quot;init&quot; state, and a 403
   response to the SUBSCRIBE is generated.

   If the &lt;sub-handling&gt; permission changes value to &quot;confirm&quot;, the
   processing depends on the states of the affected subscriptions.
   Unfortunately, the state machine in RFC 3857 does not define an event
   corresponding to an authorization decision of &quot;pending&quot;.  If the
   subscription is in the &quot;active&quot; state, it moves back into the
   &quot;pending&quot; state.  This causes a NOTIFY to be sent, updating the
   Subscription-State [7] to &quot;pending&quot;.  No reason is included in the
   Subscription-State header field (none are defined to handle this
   case).  No further documents are sent to this watcher.  There is no
   change in state if the subscription is in the &quot;pending&quot;, &quot;waiting&quot;,
   or &quot;terminated&quot; states.  If a new subscription arrives later on, and
   the value of &lt;sub-handling&gt; that applies to that subscription is
   &quot;confirm&quot;, the subscription processing follows the &quot;subscribe, no
   policy&quot; branch from the &quot;init&quot; state, and a 202 response to the
   SUBSCRIBE is generated, followed by a NOTIFY with Subscription-State
   of &quot;pending&quot;.  No presence document is included in that NOTIFY.

   If the &lt;sub-handling&gt; permission changes value from &quot;blocked&quot; or
   &quot;confirm&quot; to &quot;polite-block&quot; or &quot;allow&quot;, this causes an &quot;approved&quot;
   event to be generated into the state machine for all affected
   subscriptions.  If the subscription was in the &quot;pending&quot; state, the
   state machine will move to the &quot;active&quot; state, resulting in the
   transmission of a NOTIFY with a Subscription-State header field of
   &quot;active&quot;, and the inclusion of a presence document in that NOTIFY.

   If the subscription was in the &quot;waiting&quot; state, it will move into the
   &quot;terminated&quot; state.  If a new subscription arrives later on, and the
   value of &lt;sub-handling&gt; that applies to that subscription is
   &quot;polite-block&quot; or &quot;allow&quot;, the subscription processing follows the
   &quot;subscribe, policy=accept&quot; branch from the &quot;init&quot; state, and a 200 OK
   response to the SUBSCRIBE is generated, followed by a NOTIFY with
   Subscription-State of &quot;active&quot; with a presence document in the body
   of the NOTIFY.

3.3.  Transformations

   The transformations defined here are used to drive the behavior of
   the privacy filtering operation.  Each transformation defines the
   visibility a watcher is granted to a particular component of the
   presence document.  One group of transformations grants visibility to
   person, device, and service data elements based on identifying
   information for those elements.  Another group of transformations
   provides access to particular data elements in the presence document.

3.3.1.  Providing Access to Data Component Elements

   The transformations in this section provide access to person, device,
   and service data component elements.  Once access has been granted to
   such an element, access to specific presence attributes for that
   element is controlled by the permissions defined in Section 3.3.2.

3.3.1.1.  Device Information

   The &lt;provide-devices&gt; permission allows a watcher to see &lt;device&gt;
   information present in the presence document.  It is a set variable.
   Each member of the set provides a way to identify a device or group
   of devices.  This specification defines three types of elements in
   the set - &lt;class&gt;, which identifies a device occurrence by class;
   &lt;deviceID&gt;, which identifies a device occurrence by device ID; and
   &lt;occurrence-id&gt;, which identifies a device occurrence by occurrence
   ID.  The device ID and occurrence ID are defined in [10].  Each
   member of the set is identified by its type (class, deviceID, or
   occurrence-id) and value (value of the class, value of the deviceID,
   or value of the occurrence-id).

   For example, consider the following &lt;provide-devices&gt; element:

   &lt;provide-devices&gt;
     &lt;deviceID&gt;urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6&lt;/deviceID&gt;
     &lt;class&gt;biz&lt;/class&gt;
   &lt;/provide-devices&gt;

   This set has two members.  This is combined with a &lt;provide-devices&gt;
   element from a different rule:

   &lt;provide-devices&gt;
     &lt;class&gt;home&lt;/class&gt;
     &lt;class&gt;biz&lt;/class&gt;
   &lt;/provide-devices&gt;

   The result of the set combination (using the union operation) is a
   set with three elements:

   &lt;provide-devices&gt;
     &lt;class&gt;home&lt;/class&gt;
     &lt;class&gt;biz&lt;/class&gt;
     &lt;deviceID&gt;urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6&lt;/deviceID&gt;
   &lt;/provide-devices&gt;

   The &lt;provide-devices&gt; element can also take on the special value
   &lt;all-devices&gt;, which is a short-hand notation for all device
   occurrences present in the presence document.

   Permission is granted to see a particular device occurrence if one of
   the device identifiers in the set identifies that device occurrence.
   If a &lt;class&gt; permission is granted to the watcher, and the &lt;class&gt; of
   the device occurrence matches the value of the &lt;class&gt; permission
   based on case-sensitive equality, the device occurrence is included
   in the presence document.  If a &lt;deviceID&gt; permission is granted to
   the watcher, and the &lt;deviceID&gt; of the device occurrence matches the
   value of the &lt;deviceID&gt; permission based on URI equivalence, the
   device occurrence is included in the presence document.  If an
   &lt;occurrence-id&gt; permission is granted to the watcher, and the
   &lt;occurrence-id&gt;  of the device occurrence matches the value of the
   &lt;occurrence-id&gt; permission based on case-sensitive equality, the
   device occurrence is included in the presence document.  In addition,
   a device occurrence is included in the presence document if the
   &lt;all-devices&gt; permission was granted to the watcher.

3.3.1.2.  Person Information

   The &lt;provide-persons&gt; permission allows a watcher to see the &lt;person&gt;
   information present in the presence document.  It is a set variable.
   Each member of the set provides a way to identify a person
   occurrence.  This specification defines two types of elements in the
   set - &lt;class&gt;, which identifies a person occurrence by class, and
   &lt;occurrence-id&gt;, which identifies an occurrence by its occurrence ID.
   Each member of the set is identified by its type (class or
   occurrence-id) and value (value of the class or value of the
   occurrence-id).  The &lt;provide-persons&gt; element can also take on the

   special value &lt;all-persons&gt;, which is a short-hand notation for all
   person occurrences present in the presence document.  The set
   combination is done identically to the &lt;provide-devices&gt; element.

   Permission is granted to see a particular person occurrence if one of
   the person identifiers in the set identifies that person occurrence.
   If a &lt;class&gt; permission is granted to the watcher, and the &lt;class&gt; of
   the person occurrence matches the value of the &lt;class&gt; permission
   based on case-sensitive equality, the person occurrence is included
   in the presence document.  If an &lt;occurrence-id&gt; permission is
   granted to the watcher, and the &lt;occurrence-id&gt; of the person
   occurrence matches the value of the &lt;occurrence-id&gt; permission based
   on case-sensitive equality, the person occurrence is included in the
   presence document.  In addition, a person occurrence is included in
   the presence document if the &lt;all-persons&gt; permission was granted to
   the watcher.

3.3.1.3.  Service Information

   The &lt;provide-services&gt; permission allows a watcher to see service
   information present in &lt;tuple&gt; elements in the presence document.
   Like &lt;provide-devices&gt;, it is a set variable.  Each member of the set
   provides a way to identify a service occurrence.  This specification
   defines four types of elements in the set - &lt;class&gt;, which identifies
   a service occurrence by class; &lt;occurrence-id&gt;, which identifies a
   service by its occurrence ID; &lt;service-uri&gt;, which identifies a
   service by its service URI; and &lt;service-uri-scheme&gt;, which
   identifies a service by its service URI scheme.  Each member of the
   set is identified by its type (class, occurrence-id, service-uri, or
   service-uri-scheme) and value (value of the class, value of the
   occurrence-id, value of the service-uri, or value of the service-
   uri-scheme).  The &lt;provide-services&gt; element can also take on the
   special value &lt;all-services&gt;, which is a short-hand notation for all
   service occurrences present in the presence document.  The set
   combination is done identically to the &lt;provide-persons&gt; element.

   Permission is granted to see a particular service occurrence if one
   of the service identifiers in the set identifies that service
   occurrence.  If a &lt;class&gt; permission is granted to the watcher, and
   the &lt;class&gt; of the service occurrence matches the value of the
   &lt;class&gt; permission based on case-sensitive equality, the service
   occurrence is included in the presence document.  If a &lt;service-uri&gt;
   permission is granted to the watcher, and the &lt;service-uri&gt; of the
   service occurrence matches the value of the &lt;service-uri&gt; permission
   based on URI equivalence, the service occurrence is included in the
   presence document.  If an &lt;occurrence-id&gt; permission is granted to
   the watcher, and the &lt;occurrence-id&gt; of the service occurrence
   matches the value of the &lt;occurrence-id&gt; permission based on case-

   sensitive equality, the service occurrence is included in the
   presence document.  If a &lt;service-uri-scheme&gt; permission is granted
   to the watcher, and the scheme of the service URI for the service
   occurrence matches the value of &lt;service-uri-scheme&gt; based on case-
   sensitive equality, the service occurrence is included in the
   presence document.  In addition, a service occurrence is included in
   the presence document if the &lt;all-services&gt; permission was granted to
   the watcher.

3.3.2.  Providing Access to Presence Attributes

   The permissions of Section 3.3.1 provide coarse-grained access to
   presence data by allowing or blocking specific services or devices,
   and allowing or blocking person information.

   Once person, device, or service information is included in the
   document, the permissions in this section define which presence
   attributes are reported there.  Certain information is always
   reported.  In particular, the &lt;contact&gt;, &lt;service-class&gt; [9], &lt;basic&gt;
   status, and &lt;timestamp&gt; elements in all &lt;tuple&gt; elements, if present,
   are provided to watchers.  The &lt;timestamp&gt; element in all &lt;person&gt;
   elements, if present, is provided to watchers.  The &lt;timestamp&gt; and
   &lt;deviceID&gt; elements in all &lt;device&gt; elements, if present, are
   provided to all watchers.

3.3.2.1.  Provide Activities

   This permission controls access to the &lt;activities&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-activities&gt;, and it is a Boolean type.  If its value is
   TRUE, then the &lt;activities&gt; element in the person data element is
   reported to the watcher.  If FALSE, this presence attribute is
   removed if present.

3.3.2.2.  Provide Class

   This permission controls access to the &lt;class&gt; element defined in
   [9].  The name of the element providing this permission is &lt;provide-
   class&gt;, and it is a Boolean type.  If its value is TRUE, then any
   &lt;class&gt; element in a person, service, or device data element is
   reported to the watcher.  If FALSE, this presence attribute is
   removed if present.

3.3.2.3.  Provide DeviceID

   This permission controls access to the &lt;deviceID&gt; element in a
   &lt;tuple&gt; element, as defined in [9].  The name of the element
   providing this permission is &lt;provide-deviceID&gt;, and it is a Boolean
   type.  If its value is TRUE, then the &lt;deviceID&gt; element in the
   service data element is reported to the watcher.  If FALSE, this
   presence attribute is removed if present.  Note that the &lt;deviceID&gt;
   in a device data element is always included, and not controlled by
   this permission.

3.3.2.4.  Provide Mood

   This permission controls access to the &lt;mood&gt; element defined in [9].
   The name of the element providing this permission is &lt;provide-mood&gt;,
   and it is a Boolean type.  If its value is TRUE, then the &lt;mood&gt;
   element in the person data element is reported to the watcher.  If
   FALSE, this presence attribute is removed if present.

3.3.2.5.  Provide Place-is

   This permission controls access to the &lt;place-is&gt; element defined in
   [9].  The name of the element providing this permission is &lt;provide-
   place-is&gt;, and it is a Boolean type.  If its value is TRUE, then the
   &lt;place-is&gt; element in the person data element is reported to the
   watcher.  If FALSE, this presence attribute is removed if present.

3.3.2.6.  Provide Place-type

   This permission controls access to the &lt;place-type&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-place-type&gt;, and it is a Boolean type.  If its value is
   TRUE, then the &lt;place-type&gt; element in the person data element is
   reported to the watcher.  If FALSE, this presence attribute is
   removed if present.

3.3.2.7.  Provide Privacy

   This permission controls access to the &lt;privacy&gt; element defined in
   [9].  The name of the element providing this permission is &lt;provide-
   privacy&gt;, and it is a Boolean type.  If its value is TRUE, then the
   &lt;privacy&gt; element in the person or service data element is reported
   to the watcher.  If FALSE, this presence attribute is removed if
   present.

3.3.2.8.  Provide Relationship

   This permission controls access to the &lt;relationship&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-relationship&gt;, and it is a Boolean type.  If its value is
   TRUE, then the &lt;relationship&gt; element in the service data element is
   reported to the watcher.  If FALSE, this presence attribute is
   removed if present.

3.3.2.9.  Provide Sphere

   This permission controls access to the &lt;sphere&gt; element defined in
   [9].  The name of the element providing this permission is &lt;provide-
   sphere&gt;, and it is a Boolean type.  If its value is TRUE, then the
   &lt;sphere&gt; element in the person data element is reported to the
   watcher.  If FALSE, this presence attribute is removed if present.

3.3.2.10.  Provide Status-Icon

   This permission controls access to the &lt;status-icon&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-status-icon&gt;, and it is a Boolean type.  If its value is
   TRUE, then any &lt;status-icon&gt; element in the person or service data
   element is reported to the watcher.  If FALSE, this presence
   attribute is removed if present.

3.3.2.11.  Provide Time-Offset

   This permission controls access to the &lt;time-offset&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-time-offset&gt;, and it is a Boolean type.  If its value is
   TRUE, then the &lt;time-offset&gt; element in the person data element is
   reported to the watcher.  If FALSE, this presence attribute is
   removed if present.

3.3.2.12.  Provide User-Input

   This permission controls access to the &lt;user-input&gt; element defined
   in [9].  The name of the element providing this permission is
   &lt;provide-user-input&gt;, and it is an enumerated integer type.  Its
   value defines what information is provided to watchers in person,
   device, or service data elements:

   false:  This value indicates that the &lt;user-input&gt; element is removed
      from the document.  It is assigned the numeric value of 0.

   <span class="Verified-inline-styling" id='inline-2544'>   bare:  This value indicates that the &lt;user-input&gt; element is to be <button id="btn_2544" target="expand_2544" onclick='hideFunction("expand_2544")'>Expand</button>
      retained.  However, any &quot;idle-threshold&quot; and &quot;last-input&quot; attributes
      are to be removed.  This value is assigned the numeric value of
      10.
</span id__locate=2544>
<div class="nodeCloseClass" id='expand_2544'><div class='Verified-endnote-styling' id='eid2544'>
<pre>
<b><i><a href='https://www.rfc-editor.org/errata/eid2544'>EID 2544</a> (Verified) is as follows:</i></b>

<b>Section:</b> 3.3.2.12

<b>Original Text:</b>

   bare:  This value indicates that the &lt;user-input&gt; element is to be
      retained.  However, any &quot;idle-threshold&quot; and &quot;since&quot; attributes
      are to be removed.  This value is assigned the numeric value of
      10.

<b>Corrected Text:</b>

   bare:  This value indicates that the &lt;user-input&gt; element is to be
      retained.  However, any &quot;idle-threshold&quot; and &quot;last-input&quot; attributes
      are to be removed.  This value is assigned the numeric value of
      10.
</pre>
<b>Notes:</b><br/>
&lt;user-input&gt; does not have a &quot;since&quot; attribute defined.
</div>
</div>
   thresholds:  This value indicates that the &lt;user-input&gt; element is to
      be retained.  However, only the &quot;idle-threshold&quot; attribute is to
      be retained.  This value is assigned the numeric value of 20.

   full:  This value indicates that the &lt;user-input&gt; element is to be
      retained, including any attributes.  This value is assigned the
      numeric value of 30.

3.3.2.13.  Provide Note

   This permission controls access to the &lt;note&gt; element defined in [3]
   for &lt;tuple&gt; and [10] for &lt;person&gt; and &lt;device&gt;.  The name of the
   element providing this permission is &lt;provide-note&gt;, and it is a
   Boolean type.  If its value is TRUE, then any &lt;note&gt; elements in the
   person, service, or device data elements are reported to the watcher.
   If FALSE, this presence attribute is removed if present.

   This permission has no bearing on any &lt;note&gt; values present within
   &lt;activities&gt;, &lt;mood&gt;, &lt;place-is&gt;, &lt;place-type&gt;, &lt;privacy&gt;,
   &lt;relationship&gt;, or &lt;service-class&gt; elements.  Notes within these
   elements are essentially values for their respective elements, and
   are present if the respective element is permitted in the presence
   document.  For example, if an &lt;activities&gt; element is present in a
   presence document, and there is a &lt;note&gt; value for it, that note is
   present in the document sent to the watcher if the &lt;provide-
   activities&gt; permission is given, regardless of whether the &lt;provide-
   note&gt; permission is given.

3.3.2.14.  Provide Unknown Attribute

   It is important that systems be allowed to include proprietary or new
   presence information and that users be able to set permissions for
   that information, without requiring an upgrade of the presence server
   and authorization system.  For this reason, the &lt;provide-unknown-
   attribute&gt; permission is defined.  This permission indicates that the
   unknown presence attribute with the given name and namespace
   (supplied as mandatory attributes of the &lt;provide-unknown-attribute&gt;
   element) should be included in the document.  Its type is Boolean.

   The value of the name attribute MUST be an unqualified element name
   (meaning that a namespace prefix MUST NOT be included), and the value
   of the ns attribute MUST be a namespace URI.  The two are combined to
   form a qualified element name, which will be matched to all unknown

   child elements of the Presence Information Data Format (PIDF)
   &lt;tuple&gt;, &lt;device&gt;, or &lt;person&gt; elements with the same qualified name.
   In this context, &quot;unknown&quot; means that the presence server is not
   aware of any schemas that define authorization policies for that
   element.  By definition, this will exclude the &lt;provide-unknown-
   attribute&gt; rule from being applied to any of the presence status
   extensions defined by RPID, since authorization policies for those
   are defined here.

   Another consequence of this definition is that the interpretation of
   the &lt;provide-unknown-attribute&gt; element can change should the
   presence server be upgraded.  For example, consider a server that,
   prior to the upgrade, had an authorization document that used
   &lt;provide-unknown-attribute&gt; with a value of TRUE for some attribute,
   say foo.  This attribute was from a namespace and schema unknown to
   the server, and so the attribute was provided to watchers.  However,
   after upgrade, the server is now aware of a new namespace and schema
   for a permission that grants access to the foo attribute.  Now, the
   &lt;provide-unknown-attribute&gt; permission for the foo attribute will be
   ignored, resulting in a removal of those elements from presence
   documents sent to watchers.  The system remains privacy safe, but
   behavior might not be as expected.  Developers of systems that allow
   clients to set policies are advised to check the capabilities of the
   server (using the mechanism described in Section 8) before uploading
   a new authorization document, to make sure that the behavior will be
   as expected.

3.3.2.15.  Provide All Attributes

   This permission grants access to all presence attributes in all of
   the person, device, and tuple elements that are present in the
   document (the ones present in the document are determined by the
   &lt;provide-persons&gt;, &lt;provide-devices&gt;, and &lt;provide-services&gt;
   permissions).  It is effectively a macro that expands into a set of
   provide-activities, provide-class, provide-deviceID, provide-mood,
   provide-place-is, provide-place-type, provide-privacy, provide-
   relationship, provide-sphere, provide-status-icon, provide-time-
   offset, provide-user-input, provide-note, and provide-unknown-
   attribute permissions such that each presence attribute in the
   document has a permission for it.  This implies that, so long as an
   entire person, service, or device occurrence is provided, every
   single presence attribute, including ones not known to the server
   and/or defined in future presence document extensions, is granted to
   the watcher.

4.  When to Apply the Authorization Policies

   This specification does not mandate at what point in the processing
   of presence data the privacy filtering aspects of the authorization
   policy are applied.  However, they must be applied such that the
   final presence document sent to the watcher is compliant to the
   privacy policy described in the authorization documents that apply to
   the user (there can be more than one; the rules for combining them
   are described in [8]).  More concretely, if the presence document
   sent to a watcher is D, and the privacy filtering operation applied
   do a presence document x is F(x), then D MUST have the property that
   D = F(D).  In other words, further applications of the privacy
   filtering operation would not result in any further changes of the
   presence document, making further application of the filtering
   operation a no-op.  A corollary of this is that F(F(D)) = D for all
   D.

   The subscription processing aspects of the document get applied by
   the server when it decides to accept or reject the subscription.

5.  Implementation Requirements

   The rules defined by the document in this specification form a
   &quot;contract&quot; of sorts between a client that creates this document and
   the server that executes the policies it contains.  Consequently,
   presence servers implementing this specification MUST support all of
   the conditions, actions, and transformations defined in this
   specification.  If servers were to implement a subset of these,
   clients would need a mechanism to discover which subset is supported.
   No such mechanism is defined.

   It is RECOMMENDED that clients support all of the actions,
   transformations, and conditions defined in this specification.  If a
   client supports a subset, it is possible that a user might manipulate
   their authorization rules from a different client, supporting a
   different subset, and store those results on the server.  When the
   user goes back to the first client and views their presence
   authorization rules there, the client may not be able to properly
   render or manipulate the document retrieved from the server, since it
   may contain conditions, actions, or transformations not supported by
   the client.  The only reason that this normative requirement is not a
   MUST is that there are valid conditions in which a user manipulates
   their presence authorization rules from a single client, in which
   case this problem does not occur.

   This specification makes no normative recommendations on the
   mechanism used to transport presence authorization documents from

   clients to their servers.  Although Section 9 defines how to utilize
   XCAP, XCAP is not normatively required by this specification.

6.  Example Document

   The following presence authorization document specifies permissions
   for the user &quot;user@example.com&quot;.  The watcher is allowed to access
   presence information (the &#x27;allow&#x27; value for &lt;sub-handling&gt;).  They
   will be granted access to the presence data of all services whose
   contact URI schemes are sip and mailto.  Person information is also
   provided.  However, since there is no &lt;provide-devices&gt;, no device
   information will be given to the watcher.  Within the service and
   person information provided to the watcher, the &lt;activities&gt; element
   will be shown, as will the &lt;user-input&gt; element.  However, any
   &quot;idle-threshold&quot; and &quot;since&quot; attributes in the &lt;user-input&gt; element
   will be removed.  Finally, the presence attribute &lt;foo&gt; will be shown
   to the watcher.  Any other presence attributes will be removed.

   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
   &lt;cr:ruleset xmlns=&quot;urn:ietf:params:xml:ns:pres-rules&quot;
    xmlns:pr=&quot;urn:ietf:params:xml:ns:pres-rules&quot;
    xmlns:cr=&quot;urn:ietf:params:xml:ns:common-policy&quot;&gt;
    &lt;cr:rule id=&quot;a&quot;&gt;
     &lt;cr:conditions&gt;
      &lt;cr:identity&gt;
       &lt;cr:one id=&quot;sip:user@example.com&quot;/&gt;
      &lt;/cr:identity&gt;
     &lt;/cr:conditions&gt;
     &lt;cr:actions&gt;
      &lt;pr:sub-handling&gt;allow&lt;/pr:sub-handling&gt;
     &lt;/cr:actions&gt;
     &lt;cr:transformations&gt;
      &lt;pr:provide-services&gt;
        &lt;pr:service-uri-scheme&gt;sip&lt;/pr:service-uri-scheme&gt;
        &lt;pr:service-uri-scheme&gt;mailto&lt;/pr:service-uri-scheme&gt;
      &lt;/pr:provide-services&gt;
      &lt;pr:provide-persons&gt;
        &lt;pr:all-persons/&gt;
      &lt;/pr:provide-persons&gt;
      &lt;pr:provide-activities&gt;true&lt;/pr:provide-activities&gt;
      &lt;pr:provide-user-input&gt;bare&lt;/pr:provide-user-input&gt;
       &lt;pr:provide-unknown-attribute
        ns=&quot;urn:vendor-specific:foo-namespace&quot;
        name=&quot;foo&quot;&gt;true&lt;/pr:provide-unknown-attribute&gt;
     &lt;/cr:transformations&gt;
    &lt;/cr:rule&gt;
   &lt;/cr:ruleset&gt;

7.  XML Schema

   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
   &lt;xs:schema targetNamespace=&quot;urn:ietf:params:xml:ns:pres-rules&quot;
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;
    xmlns:cr=&quot;urn:ietf:params:xml:ns:common-policy&quot;
    xmlns:pr=&quot;urn:ietf:params:xml:ns:pres-rules&quot;
    elementFormDefault=&quot;qualified&quot; attributeFormDefault=&quot;unqualified&quot;&gt;
    &lt;xs:import namespace=&quot;urn:ietf:params:xml:ns:common-policy&quot;/&gt;
    &lt;xs:simpleType name=&quot;booleanPermission&quot;&gt;
     &lt;xs:restriction base=&quot;xs:boolean&quot;/&gt;
    &lt;/xs:simpleType&gt;
    &lt;xs:element name=&quot;service-uri-scheme&quot; type=&quot;xs:token&quot;/&gt;
    &lt;xs:element name=&quot;class&quot; type=&quot;xs:token&quot;/&gt;
    &lt;xs:element name=&quot;occurrence-id&quot; type=&quot;xs:token&quot;/&gt;
    &lt;xs:element name=&quot;service-uri&quot; type=&quot;xs:anyURI&quot;/&gt;
    &lt;xs:complexType name=&quot;provideServicePermission&quot;&gt;
     &lt;xs:choice&gt;
      &lt;xs:element name=&quot;all-services&quot;&gt;
       &lt;xs:complexType/&gt;
      &lt;/xs:element&gt;
      &lt;xs:sequence minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;
       &lt;xs:choice&gt;
        &lt;xs:element ref=&quot;pr:service-uri&quot;/&gt;
        &lt;xs:element ref=&quot;pr:service-uri-scheme&quot;/&gt;
        &lt;xs:element ref=&quot;pr:occurrence-id&quot;/&gt;
        &lt;xs:element ref=&quot;pr:class&quot;/&gt;
        &lt;xs:any namespace=&quot;##other&quot; processContents=&quot;lax&quot;/&gt;
       &lt;/xs:choice&gt;
      &lt;/xs:sequence&gt;
     &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:element name=&quot;provide-services&quot;
     type=&quot;pr:provideServicePermission&quot;/&gt;
    &lt;xs:element name=&quot;deviceID&quot; type=&quot;xs:anyURI&quot;/&gt;
    &lt;xs:complexType name=&quot;provideDevicePermission&quot;&gt;
     &lt;xs:choice&gt;
      &lt;xs:element name=&quot;all-devices&quot;&gt;
       &lt;xs:complexType/&gt;
      &lt;/xs:element&gt;
      &lt;xs:sequence minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;
       &lt;xs:choice&gt;
        &lt;xs:element ref=&quot;pr:deviceID&quot;/&gt;
        &lt;xs:element ref=&quot;pr:occurrence-id&quot;/&gt;
        &lt;xs:element ref=&quot;pr:class&quot;/&gt;
        &lt;xs:any namespace=&quot;##other&quot; processContents=&quot;lax&quot;/&gt;
       &lt;/xs:choice&gt;
      &lt;/xs:sequence&gt;

     &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:element name=&quot;provide-devices&quot;
     type=&quot;pr:provideDevicePermission&quot;/&gt;
    &lt;xs:complexType name=&quot;providePersonPermission&quot;&gt;
     &lt;xs:choice&gt;
      &lt;xs:element name=&quot;all-persons&quot;&gt;
       &lt;xs:complexType/&gt;
      &lt;/xs:element&gt;
      &lt;xs:sequence minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;
       &lt;xs:choice&gt;
        &lt;xs:element ref=&quot;pr:occurrence-id&quot;/&gt;
        &lt;xs:element ref=&quot;pr:class&quot;/&gt;
        &lt;xs:any namespace=&quot;##other&quot; processContents=&quot;lax&quot;/&gt;
       &lt;/xs:choice&gt;
      &lt;/xs:sequence&gt;
     &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:element name=&quot;provide-persons&quot;
     type=&quot;pr:providePersonPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-activities&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-class&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-deviceID&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-mood&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-place-is&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-place-type&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-privacy&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-relationship&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-status-icon&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-sphere&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-time-offset&quot;
     type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-user-input&quot;&gt;
     &lt;xs:simpleType&gt;
      &lt;xs:restriction base=&quot;xs:string&quot;&gt;
       &lt;xs:enumeration value=&quot;false&quot;/&gt;
       &lt;xs:enumeration value=&quot;bare&quot;/&gt;
       &lt;xs:enumeration value=&quot;thresholds&quot;/&gt;

       &lt;xs:enumeration value=&quot;full&quot;/&gt;
      &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
    &lt;/xs:element&gt;
    &lt;xs:element name=&quot;provide-note&quot; type=&quot;pr:booleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;sub-handling&quot;&gt;
     &lt;xs:simpleType&gt;
      &lt;xs:restriction base=&quot;xs:token&quot;&gt;
       &lt;xs:enumeration value=&quot;block&quot;/&gt;
       &lt;xs:enumeration value=&quot;confirm&quot;/&gt;
       &lt;xs:enumeration value=&quot;polite-block&quot;/&gt;
       &lt;xs:enumeration value=&quot;allow&quot;/&gt;
      &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
    &lt;/xs:element&gt;
    &lt;xs:complexType name=&quot;unknownBooleanPermission&quot;&gt;
     &lt;xs:simpleContent&gt;
      &lt;xs:extension base=&quot;pr:booleanPermission&quot;&gt;
       &lt;xs:attribute name=&quot;name&quot; type=&quot;xs:string&quot; use=&quot;required&quot;/&gt;
       &lt;xs:attribute name=&quot;ns&quot; type=&quot;xs:string&quot; use=&quot;required&quot;/&gt;
      &lt;/xs:extension&gt;
     &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:element name=&quot;provide-unknown-attribute&quot;
     type=&quot;pr:unknownBooleanPermission&quot;/&gt;
    &lt;xs:element name=&quot;provide-all-attributes&quot;&gt;
     &lt;xs:complexType/&gt;
    &lt;/xs:element&gt;
   &lt;/xs:schema&gt;

8.  Schema Extensibility

   It is anticipated that future changes to this specification are
   accomplished through extensions that define new types of permissions.
   These extensions MUST exist within a different namespace.
   Furthermore, the schema defined above and the namespace for elements
   defined within it MUST NOT be altered by future specifications.
   Changes in the basic schema, or in the interpretation of elements
   within that schema, may result in violations of user privacy due to
   misinterpretation of documents.

   When extensions are made to the set of permissions, it becomes
   necessary for the agent constructing the permission document
   (typically a SIP user agent, though not necessarily) to know which
   permissions are supported by the server.  This allows the agent to
   know how to build a document that results in the desired behavior,
   since unknown permissions would be ignored by the server.  To handle
   this, when presence authorization documents are transported using

   XCAP, the XCAP capabilities document stored at the server SHOULD
   contain the namespaces for the permissions supported by the presence
   server.  This way, an agent can query for this list prior to
   constructing a document.

9.  XCAP Usage

   The following section defines the details necessary for clients to
   manipulate presence authorization documents from a server using XCAP.

9.1.  Application Unique ID

   XCAP requires application usages to define a unique application usage
   ID (AUID) in either the IETF tree or a vendor tree.  This
   specification defines the &quot;pres-rules&quot; AUID within the IETF tree, via
   the IANA registration in Section 11.

9.2.  XML Schema

   XCAP requires application usages to define a schema for their
   documents.  The schema for presence authorization documents is in
   Section 7.

9.3.  Default Namespace

   XCAP requires application usages to define the default namespace for
   their URIs.  The default namespace is urn:ietf:params:xml:ns:pres-
   rules.

9.4.  MIME Type

   XCAP requires application usages to define the MIME type for
   documents they carry.  Presence authorization documents inherit the
   MIME type of common policy documents, application/auth-policy+xml.

9.5.  Validation Constraints

   There are no additional constraints defined by this specification.

9.6.  Data Semantics

   Semantics of a presence authorization document are discussed in
   Section 3.

9.7.  Naming Conventions

   When a presence agent receives a subscription for some user foo
   within a domain, it will look for all documents within http://[xcap
   root]/pres-rules/users/foo, and use all documents found beneath that
   point to guide authorization policy.  If only a single document is
   used, it SHOULD be called &quot;index&quot;.

9.8.  Resource Interdependencies

   There are no additional resource interdependencies defined by this
   application usage.

9.9.  Authorization Policies

   This application usage does not modify the default XCAP authorization
   policy, which is that only a user can read, write, or modify their
   own documents.  A server can allow privileged users to modify
   documents that they don&#x27;t own, but the establishment and indication
   of such policies are outside the scope of this document.

10.  Security Considerations

   Presence authorization policies contain very sensitive information.
   They indicate which other users are &quot;liked&quot; or &quot;disliked&quot; by a user.
   As such, when these documents are transported over a network, they
   SHOULD be encrypted.

   Modification of these documents by an attacker can disrupt the
   service seen by a user, often in subtle ways.  As a result, when
   these documents are transported, the transport SHOULD provide
   authenticity and message integrity.

   In the case where XCAP is used to transfer the document, both clients
   and servers MUST implement HTTP over Transport Layer Security (TLS)
   and HTTP Digest authentication.  Sites SHOULD authenticate clients
   using digest authentication over TLS, and sites SHOULD define the
   root services URI as an https URI.

   Authorization documents themselves exist for the purposes of
   providing a security function - privacy.  The SIP presence
   specifications [18] require the usage of an authorization function
   prior to the granting of presence information, and this specification
   meets that need.  Presence authorization documents inherit the
   privacy properties of the common policy format on which they are
   based.  This format has been designed to be privacy-safe, which means
   that failure of the presence server to obtain or understand an
   authorization document can never reveal more information than is

   desired about the user, only less.  This is a consequence of the fact
   that all permissions are positive grants of information, and not
   negative grants.

   A consequence of this design is that the results of combining several
   authorization documents can be non-obvious to end users.  For
   example, if one authorization document grants permission for all
   users from the example.com domain to see their presence, and another
   document blocks joe@example.com, the combination of these will still
   provide presence to joe@example.com.  Designers of user interfaces
   are encouraged to carefully pay attention to the results of combining
   multiple rules.

   Another concern is cases where a user sets their privacy preferences
   from one client, uploads their presence authorization document to a
   server, and then modifies them from a different client.  If the
   clients support different subsets of the document format, users may
   be confused about what information is being revealed.  Clients
   retrieving presence authorization documents from a server SHOULD
   render, to the users, information about rules that they do not
   understand, so that users can be certain what rules are in place.

11.  IANA Considerations

   There are several IANA considerations associated with this
   specification.

11.1.  XCAP Application Usage ID

   This section registers an XCAP Application Usage ID (AUID) according
   to the IANA procedures defined in [2].

      Name of the AUID: pres-rules

      Description: Presence rules are documents that describe the
      permissions that a presentity [17] has granted to users that seek
      to watch their presence.

11.2.  URN Sub-Namespace Registration

   This section registers a new XML namespace, per the guidelines in
   [11]

      URI: The URI for this namespace is
      urn:ietf:params:xml:ns:pres-rules.

      Registrant Contact: IETF, SIMPLE working group (simple@ietf.org),
      Jonathan Rosenberg (jdrosen@jdrosen.net).

      XML:

      BEGIN

      &lt;?xml version=&quot;1.0&quot;?&gt;
      &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML Basic 1.0//EN&quot;
       &quot;http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd&quot;&gt;
      &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
      &lt;head&gt;
        &lt;meta http-equiv=&quot;content-type&quot;
           content=&quot;text/html;charset=iso-8859-1&quot;/&gt;
        &lt;title&gt;Presence Rules Namespace&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;h1&gt;Namespace for Permission Statements&lt;/h1&gt;
        &lt;h2&gt;urn:ietf:params:xml:ns:pres-rules&lt;/h2&gt;
      &lt;p&gt;See &lt;a href=&quot;http://www.rfc-editor.org/rfc/rfc5025.txt&quot;&gt;
      RFC5025&lt;/a&gt;.&lt;/p&gt;
      &lt;/body&gt;
      &lt;/html&gt;
      END

11.3.  XML Schema Registrations

   This section registers an XML schema per the procedures in [11].

      URI: urn:ietf:params:xml:schema:pres-rules.

      Registrant Contact: IETF, SIMPLE working group (simple@ietf.org),
      Jonathan Rosenberg (jdrosen@jdrosen.net).

      The XML for this schema can be found as the sole content of
      Section 7.

12.  Acknowledgements

   The author would like to thank Richard Barnes, Jari Urpalainen, Jon
   Peterson, and Martin Hynar for their comments.

13.  References

13.1.  Normative References

   [1]  Bradner, S., &quot;Key words for use in RFCs to Indicate Requirement
        Levels&quot;, BCP 14, RFC 2119, March 1997.

   [2]  Rosenberg, J., &quot;The Extensible Markup Language (XML)
        Configuration Access Protocol (XCAP)&quot;, RFC 4825, May 2007.

   [3]  Sugano, H., Fujimoto, S., Klyne, G., Bateman, A., Carr, W., and
        J. Peterson, &quot;Presence Information Data Format (PIDF)&quot;, RFC
        3863, August 2004.

   [4]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
        Leach, P., Luotonen, A., and L. Stewart, &quot;HTTP Authentication:
        Basic and Digest Access Authentication&quot;, RFC 2617, June 1999.

   [5]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M., and E. Schooler, &quot;SIP:
        Session Initiation Protocol&quot;, RFC 3261, June 2002.

   [6]  Rosenberg, J., &quot;A Watcher Information Event Template-Package for
        the Session Initiation Protocol (SIP)&quot;, RFC 3857, August 2004.

   [7]  Roach, A., &quot;Session Initiation Protocol (SIP)-Specific Event
        Notification&quot;, RFC 3265, June 2002.

   [8]  Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk,
        J., and J. Rosenberg, &quot;Common Policy: A Document Format for
        Expressing Privacy Preferences&quot;, RFC 4745, February 2007.

   [9]  Schulzrinne, H., Gurbani, V., Kyzivat, P., and J. Rosenberg,
        &quot;RPID: Rich Presence Extensions to the Presence Information Data
        Format (PIDF)&quot;, RFC 4480, July 2006.

   [10] Rosenberg, J., &quot;A Data Model for Presence&quot;, RFC 4479, July 2006.

   [11] Mealling, M., &quot;The IETF XML Registry&quot;, BCP 81, RFC 3688, January
        2004.

   [12] Schulzrinne, H., &quot;The tel URI for Telephone Numbers&quot;, RFC 3966,
        December 2004.

   [13] Duerst, M. and M. Suignard, &quot;Internationalized Resource
        Identifiers (IRIs)&quot;, RFC 3987, January 2005.

   [14] Peterson, J., &quot;A Privacy Mechanism for the Session Initiation
        Protocol (SIP)&quot;, RFC 3323, November 2002.

13.2.  Informative References

   [15] Peterson, J. and C. Jennings, &quot;Enhancements for Authenticated
        Identity Management in the Session Initiation Protocol (SIP)&quot;,
        RFC 4474, August 2006.

   [16] Jennings, C., Peterson, J., and M. Watson, &quot;Private Extensions
        to the Session Initiation Protocol (SIP) for Asserted Identity
        within Trusted Networks&quot;, RFC 3325, November 2002.

   [17] Day, M., Rosenberg, J., and H. Sugano, &quot;A Model for Presence and
        Instant Messaging&quot;, RFC 2778, February 2000.

   [18] Rosenberg, J., &quot;A Presence Event Package for the Session
        Initiation Protocol (SIP)&quot;, RFC 3856, August 2004.

Author&#x27;s Address

   Jonathan Rosenberg
   Cisco
   Edison, NJ
   US

   EMail: jdrosen@cisco.com
   URI:   http://www.jdrosen.net

Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   &quot;AS IS&quot; basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


        </re>
        
    </body>
</html>
