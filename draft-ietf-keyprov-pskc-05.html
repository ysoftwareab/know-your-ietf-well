<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Portable Symmetric Key Container (PSKC)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Portable Symmetric Key Container (PSKC)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">keyprov</td><td class="header">P. Hoyer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">ActivIdentity</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Pei</td></tr>
<tr><td class="header">Expires: July 12, 2010</td><td class="header">VeriSign</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Machani</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Diversinet</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 08, 2010</td></tr>
</table></td></tr></table>
<h1><br />Portable Symmetric Key Container (PSKC)<br />draft-ietf-keyprov-pskc-05</h1>

<h3>Abstract</h3>

<p>This document specifies a symmetric key format for transport and provisioning of
				symmetric keys to different types of crypto modules. For example, One Time Password (OTP) shared secrets or symmetric
				cryptographic keys to strong authentication devices. A standard key transport format enables enterprises to
				deploy best-of-breed solutions combining components from different vendors into the
				same infrastructure. 
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 12, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Key Words<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Versions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Namespace Identifiers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.3.1.</a>&nbsp;
Defined Identifiers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">1.3.2.</a>&nbsp;
Referenced Identifiers<br />
<a href="#anchor7">2.</a>&nbsp;
Terminology<br />
<a href="#anchor8">3.</a>&nbsp;
Portable Key Container Entities Overview and Relationships<br />
<a href="#basics">4.</a>&nbsp;
&lt;KeyContainer&gt; Element: The Basics<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KeyElement">4.1.</a>&nbsp;
&lt;Key&gt;: Embedding Keying Material and Key Related Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Transmission of supplementary Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DeviceInfoElement">4.2.1.</a>&nbsp;
&lt;DeviceInfo&gt; Element: Unique Device Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CryptoModuleInfoElement">4.2.2.</a>&nbsp;
&lt;CryptoModuleInfo&gt; Element: CryptoModule Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserIdElement">4.2.3.</a>&nbsp;
&lt;UserId&gt; Element: User Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AlgorithmParametersElement">4.2.4.</a>&nbsp;
&lt;AlgorithmParameters&gt; Element: Supplementary Information for OTP and CR Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.3.</a>&nbsp;
Transmission of Key Derivation Values<br />
<a href="#policy">5.</a>&nbsp;
Key Policy<br />
<a href="#EncryptionKeyDescription">6.</a>&nbsp;
Key Protection Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SymmetricKeyProtectionDescription">6.1.</a>&nbsp;
Encryption based on Pre-Shared Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MACMethodDescription">6.1.1.</a>&nbsp;
MAC Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.2.</a>&nbsp;
Encryption based on Passphrase-based Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AsymmetricKeyProtectionDescription">6.3.</a>&nbsp;
Encryption based on Asymmetric Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">6.4.</a>&nbsp;
Padding of Encrypted Values for Non-Padded Encryption Algorithms<br />
<a href="#anchor13">7.</a>&nbsp;
Digital Signature<br />
<a href="#bulk">8.</a>&nbsp;
Bulk Provisioning<br />
<a href="#anchor14">9.</a>&nbsp;
Extensibility<br />
<a href="#profiles">10.</a>&nbsp;
PSKC Algorithm Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#hotp">10.1.</a>&nbsp;
HOTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pin">10.2.</a>&nbsp;
KEYPROV-PIN<br />
<a href="#schema">11.</a>&nbsp;
XML Schema<br />
<a href="#iana">12.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">12.1.</a>&nbsp;
Content-type registration for 'application/pskc+xml'<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">12.2.</a>&nbsp;
XML Schema Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">12.3.</a>&nbsp;
URN Sub-Namespace Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SymmetricKeyAlgorithmIdentifierRegistry">12.4.</a>&nbsp;
PSKC Algorithm Profile Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">12.5.</a>&nbsp;
PSKC Version Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">12.6.</a>&nbsp;
Key Usage Registry<br />
<a href="#anchor20">13.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">13.1.</a>&nbsp;
Payload Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">13.2.</a>&nbsp;
Payload Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">13.3.</a>&nbsp;
Payload Authenticity<br />
<a href="#anchor24">14.</a>&nbsp;
Contributors<br />
<a href="#anchor25">15.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">16.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">16.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">16.2.</a>&nbsp;
Informative References<br />
<a href="#anchor28">Appendix&nbsp;A.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">A.1.</a>&nbsp;
Online Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">A.1.1.</a>&nbsp;
Transport of keys from Server to Cryptographic Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">A.1.2.</a>&nbsp;
Transport of keys from Cryptographic Module to Cryptographic Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">A.1.3.</a>&nbsp;
Transport of keys from Cryptographic Module to Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">A.1.4.</a>&nbsp;
Server to server Bulk import/export of keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">A.2.</a>&nbsp;
Offline Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">A.2.1.</a>&nbsp;
Server to server Bulk import/export of keys<br />
<a href="#anchor36">Appendix&nbsp;B.</a>&nbsp;
Requirements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>With increasing use of symmetric key based systems, such as encryption of data at rest, or systems used for strong authentication, such as those
				based on one-time-password (OTP) and challenge response (CR) mechanisms, there is a need for
				vendor interoperability and a standard format for importing and exporting
				(provisioning) symmetric keys. For instance, traditionally, vendors of authentication servers and
				service providers have used proprietary formats for importing and exporting these
				keys into their systems, thus making it hard to use tokens from two different vendors.
</p>
<p>This document defines a standardized XML-based key container, called Portable
				Symmetric Key Container (PSKC), for transporting symmetric keys and key related meta data. The document also specifies the information elements that are required when the symmetric key is utilized for specific purposes, such as the initial counter in the MAC-Based One Time Password (HOTP)  <a class='info' href='#HOTP'>[HOTP]<span> (</span><span class='info'>MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;HOTP: An HMAC-Based One Time Password Algorithm,&rdquo; December&nbsp;2005.</span><span>)</span></a> algorithm. It also requests the creation of an IANA registry for algorithm profiles where algorithms, their meta-data and PSKC transmission profile can be recorded for centralised standardised reference. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Key Words</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
						NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
						described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>, &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Versions</h3>

<p>There is a provision made in the syntax for an explicit version
   number.  Only version "1.0" is currently specified.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Namespace Identifiers</h3>

<p>This document uses Uniform Resource Identifiers  <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifiers (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> to identify
   resources, algorithms, and semantics.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3.1"></a><h3>1.3.1.&nbsp;
Defined Identifiers</h3>

<p>   The XML namespace <a class='info' href='#XMLNS'>[XMLNS]<span> (</span><span class='info'>, &ldquo;Namespaces in XML,&rdquo; January&nbsp;1999.</span><span>)</span></a> URI for Version 1.0 of PSKC is:
</p>
<p>xmlns:pskc="urn:ietf:params:xml:ns:keyprov:pskc"
</p>
<p> References to qualified elements in the PSKC schema defined herein
   use the prefix "pskc".
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3.2"></a><h3>1.3.2.&nbsp;
Referenced Identifiers</h3>

<p>The PSKC syntax presented in this document relies on
   algorithm identifiers and elements defined in the XML Signature <a class='info' href='#XMLDSIG'>[XMLDSIG]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; February&nbsp;2002.</span><span>)</span></a>
   namespace:
</p>
<p>xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
</p>
<p> References to the XML Signature namespace
   are represented by the prefix "ds".
</p>
<p>PSKC also relies on
   algorithm identifiers and elements defined in the XML Encryption <a class='info' href='#XMLENC'>[XMLENC]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; December&nbsp;2002.</span><span>)</span></a>
   namespace:
</p>
<p>xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
</p>
<p> References to the XML Encryption namespace
   are represented by the prefix "xenc".
</p>
<p>When protecting keys in transport with passphrase-based keys, PSKC also relies on
   the derived key element defined in the XML Encryption Version 1.1 <a class='info' href='#XMLENC11'>[XMLENC11]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing Version 1.1.,&rdquo; July&nbsp;2009.</span><span>)</span></a>
   namespace:
</p>
<p>xmlns:xenc11="http://www.w3.org/2009/xmlenc11#""
</p>
<p> References to the XML Encryption Version 1.1 namespace
   are represented by the prefix "xenc11".
</p>
<p>When protecting keys in transport with passphrase-based keys, PSKC also relies on
   algorithm identifiers and elements defined in the PKCS#5 <a class='info' href='#PKCS5'>[PKCS5]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; March&nbsp;1999.</span><span>)</span></a>
   namespace:
</p>
<p>xmlns:pkcs5= "http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#"
</p>
<p> References to the PKCS#5 namespace
   are represented by the prefix "pkcs5".
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>NOTE: In subsequent sections of the document we highlight **mandatory** XML elements
				and attributes. Optional elements and attributes are not explicitly indicated, i.e.,
				if it does not say mandatory it is optional. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Portable Key Container Entities Overview and Relationships</h3>

<p>The portable key container is based on an XML schema definition and contains the
				following main conceptual entities: </p>
<ol class="text">
<li>KeyContainer entity - representing the container that carries a number of KeyPackages
</li>
<li>KeyPackage entity - representing the package of at most one key and its related provisioning endpoint or current usage endpoint, such as a physical or virtual device and a specific CryptoModule
</li>
<li>DeviceInfo entity - representing the information about the device and
						criteria to uniquely identify the device
</li>
<li>CryptoModuleInfo entity - representing the information about the CryptoModule where the keys reside or are provisioned to
</li>
<li>Key entity - representing the key transported or provisioned
</li>
<li>Data entity - representing a list of meta-data related to the key, where the element name is the name of the meta-data and its associated value is either in encrypted form (for example for Data element &lt;Secret&gt;) or plaintext (for example the Data element &lt;Counter&gt;) 
</li>
</ol><p>
			
</p>
<p><a class='info' href='#er'>Figure&nbsp;1<span> (</span><span class='info'>PSKC data elements relationship diagram</span><span>)</span></a> shows the high-level structure of the PSKC data elements. <br /><hr class="insert" />
<a name="er"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   -----------------
   | KeyContainer  |
   |---------------|
   | EncryptionKey |
   | Signature	   |
   | ...           |
   -----------------
           |
           |
          /|\ 1..n
   ----------------        ----------------
   | KeyPackage   |    0..1| DeviceInfo   |
   |--------------|--------|--------------|
   |              |--      | SerialNumber |
   ----------------  |     | Manufacturer |
           |         |     | ....         |
           |         |     ----------------
          /|\ 0..1   |
   ----------------  |     --------------------
   | Key          |  | 0..1| CryptoModuleInfo |
   |--------------|   -----|------------------|
   | Id           |        | Id               |
   | Algorithm    |        |....              |
   | UserId       |        --------------------
   | Policy       |
   | ....         |
   ----------------
           |
           |
          /|\ 0..n
       --------------------------------------- -  -
       |                     |              |
   ------------------  ----------------  -------- - -
   | Data:Secret    |  | Data:Counter |  | Data:other
   |----------------|  |--------------|  |-- - -
   | EncryptedValue |  | PlainValue   |
   | ValueMAC       |  ----------------
   ------------------


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: PSKC data elements relationship diagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 The following sections describe in detail all the entities and related XML
				schema elements and attributes.
</p>
<a name="basics"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
&lt;KeyContainer&gt; Element: The Basics</h3>

<p>In its most basic form, a PSKC document uses the top-level element
				&lt;KeyContainer&gt; and a single &lt;KeyPackage&gt; element to
				carry key information.
</p>
<p>The following example shows such a simple PSKC document. We will use it to describe
				the structure of the &lt;KeyContainer&gt; element and its child elements.
					<br /><hr class="insert" />
<a name="example-simple"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1.0"
    Id="exampleID1"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;KeyPackage&gt;
        &lt;Key Id="12345678"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer-A&lt;/Issuer&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNA==
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Basic PSKC Key Container Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<p>The attributes of the &lt;KeyContainer&gt; element have the following
				semantics: </p>
<blockquote class="text"><dl>
<dt>'Version:'</dt>
<dd>The 'Version' attribute is used to identify the version
						of the PSKC schema version. This specification defines the initial version
						("1.0") of the PSKC schema. This attribute MUST be included.
</dd>
<dt>'Id:'</dt>
<dd>The 'Id' attribute carries a unique identifier for the
						container. As such, it helps to identify a specific key container in cases when multiple containers are embedded in larger xml documents. 
</dd>
</dl></blockquote><p>
			
</p>
<a name="KeyElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
&lt;Key&gt;: Embedding Keying Material and Key Related Information</h3>

<p>The following attributes of the &lt;Key&gt; element MUST be included at a
					minimum: </p>
<blockquote class="text"><dl>
<dt>'Id':</dt>
<dd>This attribute carries a globally unique identifier
							for the symmetric key. The identifier is defined as a string of
							alphanumeric characters.
</dd>
<dt>'Algorithm':</dt>
<dd>This attribute contains a unique identifier
							for the PSKC algorithm profile. This profile associates specific
							semantics to the elements and attributes contained in the
							&lt;Key&gt; element. This document describes profiles for open standards algorithms in <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>.  Additional profiles are defined in the following information draft <a class='info' href='#PSKC-ALGORITHM-PROFILES'>[PSKC&#8209;ALGORITHM&#8209;PROFILES]<span> (</span><span class='info'>Hoyer, P., Pei, M., Machani, S., and A. Doherty, &ldquo;Additional Portable Symmetric Key Container (PSKC) Algorithm Profiles,&rdquo; December&nbsp;2008.</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
				
</p>
<p>The &lt;Key&gt; element has a number of optional child elements. An
					initial set is described below: </p>
<blockquote class="text"><dl>
<dt>&lt;Issuer&gt;:</dt>
<dd>This element represents the name of
							the party that issued the key. For example, a bank "Foobar Bank Inc."
							issuing hardware tokens to their retail banking users may set this
							element to "Foobar Bank Inc.".
</dd>
<dt>&lt;FriendlyName&gt;:</dt>
<dd> A human readable name for the
							secret key for easier reference. This element serves informational
							purposes only.
</dd>
<dt>&lt;AlgorithmParameters&gt;:</dt>
<dd> This element carries parameters that influence the result of the algorithmic computation, for example response truncation and format in OTP and CR algorithms. A more detailed
							discussion of the element can be found in <a class='info' href='#AlgorithmParametersElement'>Section&nbsp;4.2.4<span> (</span><span class='info'>&lt;AlgorithmParameters&gt; Element: Supplementary Information for OTP and CR Algorithms</span><span>)</span></a>. 
</dd>
<dt>&lt;Data&gt;:</dt>
<dd>This element carries data about and
							related to the key. The following child elements are defined for the
							&lt;Data&gt; element: <br />

							
<blockquote class="text"><dl>
<dt>&lt;Secret&gt;:</dt>
<dd>This element carries the value
									of the key itself in a binary representation.
</dd>
<dt>&lt;Counter&gt;:</dt>
<dd>This element contains the
									event counter for event based OTP algorithms.
</dd>
<dt>&lt;Time&gt;:</dt>
<dd>This element contains the time
									for time based OTP algorithms. (If time interval is used, this
									element carries the number of time intervals passed from a
									specific start point, normally algorithm dependent).
</dd>
<dt>&lt;TimeInterval&gt;:</dt>
<dd>This element carries the
									time interval value for time based OTP algorithms.
</dd>
<dt>&lt;TimeDrift&gt;:</dt>
<dd>This element contains the
									device clock drift value for time-based OTP algorithms. The
									value indicates the number of seconds that the device clock may
									drift each day. 
</dd>
</dl></blockquote> All the elements listed above (and those defined in the
							future) obey a simple structure in that they MUST support child elements
							to convey the data value in either plaintext or encrypted format: 
<blockquote class="text"><dl>
<dt>Plaintext:</dt>
<dd>The &lt;PlainValue> element carries
									plaintext value that is typed, for example to xs:integer.
</dd>
<dt>Encrypted:</dt>
<dd>The &lt;EncryptedValue> element
									carries encrypted value.
</dd>
<dt>ValueMAC:</dt>
<dd>The &lt;ValueMAC> element
									is populated with a MAC generated from the encrypted
							value in case the encryption algorithm does not support integrity
							checks. The example shown at <a class='info' href='#example-simple'>Figure&nbsp;2<span> (</span><span class='info'>Basic PSKC Key Container Example</span><span>)</span></a> illustrates the usage of the
							&lt;Data&gt; element with two child elements, namely
							&lt;Secret&gt; and &lt;Counter&gt;. Both elements carry
							plaintext value within the &lt;PlainValue> child element. 
</dd>
</dl></blockquote>  
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Transmission of supplementary Information</h3>

<p>A PSKC document can contain a number of additional information regarding device
					identification, cryptomodule identification, user identification and parameters for usage with
					OTP and CR algorithms. The following example, see <a class='info' href='#example-suppl'>Figure&nbsp;3<span> (</span><span class='info'>PSKC Key Container Example with Supplementary Data</span><span>)</span></a>, is used as a reference for the subsequent sub-sections. <br /><hr class="insert" />
<a name="example-suppl"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1.0"
    Id="exampleID1"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
            &lt;UserId&gt;DC=example-bank,DC=net&lt;/UserId&gt;
        &lt;/DeviceInfo&gt;
        &lt;CryptoModuleInfo&gt;
            &lt;Id&gt;CM_ID_001&lt;/Id&gt;
        &lt;/CryptoModuleInfo&gt;
        &lt;Key Id="12345678"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;UserId&gt;UID=jsmith,DC=example-bank,DC=net&lt;/UserId&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: PSKC Key Container Example with Supplementary Data&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<a name="DeviceInfoElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
&lt;DeviceInfo&gt; Element: Unique Device Identification</h3>

<p>The &lt;DeviceInfo&gt; element uniquely identifies the device the
						&lt;KeyPackage&gt; is provisioned to. Since devices can come in different
						form factors, such as hardware tokens, smart-cards, soft tokens in a mobile
						phone or as a PC, this element allows different child element combinations to be used.
						When combined, the values of the child elements MUST uniquely identify the device. For example,
						for hardware tokens the combination of &lt;SerialNo&gt; and
						&lt;Manufacturer&gt; elements uniquely identifies a device but the
						&lt;SerialNo&gt; element alone is insufficient since two different
						token manufacturers might issue devices with the same serial number (similar
						to the Issuer Distinguished Name and serial number of a certificate). 
</p>
<p>The &lt;DeviceInfo&gt; element has the following child elements:
							</p>
<blockquote class="text"><dl>
<dt>&lt;Manufacturer&gt;:</dt>
<dd>This element indicates the
								manufacturer of the device.
</dd>
<dt>&lt;SerialNo&gt;:</dt>
<dd>This element contains the serial
								number of the device.
</dd>
<dt>&lt;Model&gt;:</dt>
<dd>This element describes the model of
								the device (e.g., one-button-HOTP-token-V1).
</dd>
<dt>&lt;IssueNo&gt;:</dt>
<dd>This element contains the issue
								number in case devices with the same serial number that are
								distinguished by different issue numbers.
</dd>
<dt>&lt;DeviceBinding&gt;:</dt>
<dd>This element allows a provisioning server to ensure that the key is
    going to be loaded into the device for which the key provisioning
    request was approved. The device is bound to the request using a device
    identifier, e.g., an International Mobile Equipment Identity (IMEI) for the phone, or an identifier for a class of
    identifiers, e.g., those for which the keys are protected by a  Trusted Platform Module (TPM).

</dd>
<dt>&lt;StartDate&gt;: and &lt;ExpiryDate&gt;:</dt>
<dd>These two elements indicate the start and end date of a device
								(such as the one on a payment card, used when issue numbers are not
								printed on cards). The date MUST be expressed in UTC form with no
								timezone component. Implementations SHOULD NOT rely on time
								resolution finer than milliseconds and MUST NOT generate time
								instants that specify leap seconds.
</dd>
</dl></blockquote><p> Depending on the device type certain child elements of the
						&lt;DeviceInfo&gt; element MUST be included in order to
						uniquely identify a device. This document does not enumerate the different
						device types and therefore does not list the elements that are mandatory for
						each type of device. 
</p>
<a name="CryptoModuleInfoElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
&lt;CryptoModuleInfo&gt; Element: CryptoModule Identification</h3>

<p>The &lt;CryptoModuleInfo&gt; element identifies the cryptographic module to which the
       symmetric keys are or have been provisioned to. This allows the identification of the specific cases where a device MAY contain more than one crypto module (e.g. a PC hosting a TPM and a connected token).
</p>
<p>The &lt;CryptoModuleInfo&gt; element has a single child element that MUST be included: </p>
<blockquote class="text"><dl>
<dt>&lt;Id&gt;:</dt>
<dd> This element carries a unique identifier for the
						CryptoModule and is implementation specific. As such, it helps to identify a specific CryptoModule to which the key is being or was proivisioned.
</dd>
</dl></blockquote><p> 
					
</p>
<a name="UserIdElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
&lt;UserId&gt; Element: User Identification</h3>

<p>The &lt;UserId&gt; element identifies the user using a distinguished
						name, as defined in <a class='info' href='#RFC4514'>[RFC4514]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): String Representation of 						Distinguished Names,&rdquo; June&nbsp;2006.</span><span>)</span></a>. For example:
						UID=jsmith,DC=example,DC=net.
</p>
<p>Although the syntax of the user identifier is defined, there are no semantics
						associated with this element, i.e., there are no checks enforcing that only
						a specific user can use this key. As such, this element is for informational
						purposes only.
</p>
<p>This element may appear in two places, namely as a child element of the
						&lt;Key&gt; element where it indicates the user with whom the key is
						associated with and as a child element of the &lt;DeviceInfo&gt;
						element where it indicates the user the device is associated with. 
</p>
<a name="AlgorithmParametersElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
&lt;AlgorithmParameters&gt; Element: Supplementary Information for OTP and CR Algorithms</h3>

<p>The &lt;AlgorithmParameters&gt; element is a child element of the
						&lt;Key&gt; element and this document defines two child elements:
						&lt;ChallengeFormat&gt; and &lt;ResponseFormat&gt;
</p>
<p>
						</p>
<blockquote class="text"><dl>
<dt>&lt;ChallengeFormat&gt;:</dt>
<dd><br />

								The &lt;ChallengeFormat&gt; element defines the
								characteristics of the challenge in a CR usage scenario whereby the
								following attributes are defined: 
<blockquote class="text"><dl>
<dt>'Encoding':</dt>
<dd> This attribute, which MUST be included, defines the
										encoding of the challenge accepted by the device and MUST be
										one of the following values: 
<blockquote class="text"><dl>
<dt>DECIMAL</dt>
<dd> Only numerical digits
</dd>
<dt>HEXADECIMAL</dt>
<dd>Hexadecimal response
</dd>
<dt>ALPHANUMERIC</dt>
<dd>All letters and numbers (case
												sensitive)
</dd>
<dt>BASE64</dt>
<dd>Base 64 encoded
</dd>
<dt>BINARY</dt>
<dd>Binary data
</dd>
</dl></blockquote>
									
</dd>
<dt>'CheckDigit':</dt>
<dd> This attribute indicates
										whether a device needs to check the appended Luhn check
										digit, as defined in <a class='info' href='#LUHN'>[LUHN]<span> (</span><span class='info'>Luhn, H., &ldquo;Luhn algorithm,&rdquo; August&nbsp;1960.</span><span>)</span></a>, contained in a
										challenge. This is only valid if the 'Encoding'
										attribute is 'DECIMAL'. A value of TRUE indicates that the
										device will check the appended Luhn check digit in a
										provided challenge. A value of FALSE indicates that the device
										will not check the appended Luhn check digit in the challenge.
</dd>
<dt>'Min':</dt>
<dd> This attribute defines the
										minimum size of the challenge accepted by the device for CR
										mode and MUST be included. If the 'Encoding' attribute is 'DECIMAL',
										'HEXADECIMAL' or 'ALPHANUMERIC' this value indicates the
										minimum number of digits/characters. If the 'Encoding'
										attribute is 'BASE64' or 'BINARY', this value indicates the
										minimum number of bytes of the unencoded value.
</dd>
<dt>'Max':</dt>
<dd>This attribute defines the
										maximum size of the challenge accepted by the device for CR
										mode and MUST be included. If the 'Encoding' attribute is 'DECIMAL',
										'HEXADECIMAL' or 'ALPHANUMERIC' this value indicates the
										maximum number of digits/characters. If the 'Encoding'
										attribute is 'BASE64' or 'BINARY', this value indicates the
										maximum number of bytes of the unencoded value.
</dd>
</dl></blockquote>
							
</dd>
<dt>&lt;ResponseFormat&gt;:</dt>
<dd>
								<br />
 The &lt;ResponseFormat&gt; element
								defines the characteristics of the result of a computation and
								defines the format of the OTP or the response to a challenge. For
								cases where the key is a PIN value, this element contains the format
								of the PIN itself (e.g., DECIMAL, length 4 for a 4 digit PIN). The
								following attributes are defined: 
<blockquote class="text"><dl>
<dt>'Encoding':</dt>
<dd>This attribute defines the
										encoding of the response generated by the device, it MUST be included and MUST be
										one of the following values: DECIMAL, HEXADECIMAL,
										ALPHANUMERIC, BASE64, or BINARY.
</dd>
<dt>'CheckDigit':</dt>
<dd>This attribute indicates
										whether the device needs to append a Luhn check digit, as
										defined in <a class='info' href='#LUHN'>[LUHN]<span> (</span><span class='info'>Luhn, H., &ldquo;Luhn algorithm,&rdquo; August&nbsp;1960.</span><span>)</span></a>, to the response. This is
										only valid if the 'Encoding' attribute is 'DECIMAL'. If the
										value is TRUE then the device will append a Luhn check digit
										to the response. If the value is FALSE, then the device will
										not append a Luhn check digit to the response.
</dd>
<dt>'Length':</dt>
<dd>This attribute defines the
										length of the response generated by the device and MUST be included. If the
										'Encoding' attribute is 'DECIMAL', 'HEXADECIMAL' or
										'ALPHANUMERIC' this value indicates the number of
										digits/characters. If the 'Encoding' attribute is 'BASE64'
										or 'BINARY', this value indicates the number of bytes of the
										unencoded value.
</dd>
</dl></blockquote>
							
</dd>
</dl></blockquote><p>
					
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Transmission of Key Derivation Values</h3>

<p>&lt;KeyProfileId> element, which is a child element of the
					&lt;Key&gt; element, carries a unique identifier used between the
					sending and receiving parties to establish a set of key attribute values that are
					not transmitted within the container but agreed between the two parties out of
					band. This element will then represent the unique reference to a set of
					key attribute values. (For example, a smart card application personalisation profile
					id related to specific attribute values present on a smart card application, that have influence
					when computing a response.).
</p>
<p>For example, in the case of MasterCard's Chip Authentication Program 
						<a class='info' href='#CAP'>[CAP]<span> (</span><span class='info'>MasterCard International, &ldquo;Chip Authentication Program Functional Architecture,&rdquo; September&nbsp;2004.</span><span>)</span></a>, the sending and the receiving party would agree that KeyProfileId='1' represents a certain set of values (e.g., Internet Authentication Flag IAF set to a specific value). During transmission of the KeyContainer, these values would not be transmitted as key
					attributes but only referred to via the &lt;KeyProfileId&gt; element set
					to the specific agreed profile (in this case '1'). The receiving party
					can then associate all relevant key attributes contained in
					the out of band agreed profile with the imported keys. Often this methodology is
					used between a manufacturing service, run by company A and the validation service run by company B, to avoid repeated transmission
					of the same set of key attribute values.
</p>
<p>The &lt;KeyReference> element contains a reference to an external key to be used with a
					key derivation scheme and no specific key value (secret) is transported but only the
					reference to the external master key is used (e.g., the PKCS#11 key label).
</p>
<p>
					<br /><hr class="insert" />
<a name="example-key-derivation-values"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1.0" Id="exampleID1"
     xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;CryptoModuleInfo&gt;
            &lt;Id&gt;CM_ID_001&lt;/Id&gt;
        &lt;/CryptoModuleInfo&gt;
        &lt;Key Id="12345678"
         Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;KeyProfileId&gt;keyProfile1&lt;/KeyProfileId&gt;
            &lt;KeyReference&gt;MasterKeyLabel
            &lt;/KeyReference&gt;
            &lt;Data&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;KeyUsage&gt;OTP&lt;/KeyUsage&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Example of a PSKC Document transmitting a HOTP key via key derivation values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 The key value will be derived using the value of the
					&lt;SerialNo&gt; element, values agreed between the sending and the receiving parties and identified by the KeyProfile 'keyProfile1' and an externally agreed key referenced by the label
					'MasterKeyLabel'. 
</p>
<a name="policy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Key Policy</h3>

<p>This section illustrates the functionality of the &lt;Policy&gt; element
				within PSKC that allows a key usage and key PIN protection policy to be attached to a specific key and its related meta data. This
				element is a child element of the &lt;Key&gt; element.
</p>
<p>If the &lt;Policy&gt; element contains child elements or values within
				elements/attributes that are not understood by the recipient of the PSKC document
				then the recipient MUST assume that key usage is not permitted. This statement
				ensures that the lack of understanding of certain extensions does not lead to
				unintended key usage. 
</p>
<p>We will start our description with an example that expands the example shown in <a class='info' href='#example-suppl'>Figure&nbsp;3<span> (</span><span class='info'>PSKC Key Container Example with Supplementary Data</span><span>)</span></a>. <br /><hr class="insert" />
<a name="example-pin"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer
    Version="1.0" Id="exampleID1"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;CryptoModuleInfo&gt;
            &lt;Id&gt;CM_ID_001&lt;/Id&gt;
        &lt;/CryptoModuleInfo&gt;
        &lt;Key Id="12345678"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;PINPolicy MinLength="4" MaxLength="4"
                    PINKeyId="123456781" PINEncoding="DECIMAL"
                    PINUsageMode="Local"/&gt;
                &lt;KeyUsage&gt;OTP&lt;/KeyUsage&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;CryptoModuleInfo&gt;
            &lt;Id&gt;CM_ID_001&lt;/Id&gt;
        &lt;/CryptoModuleInfo&gt;
        &lt;Key Id="123456781"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#pin"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="4" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNA==&lt;/PlainValue&gt;
                &lt;/Secret&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Non-Encrypted HOTP Secret Key protected by PIN&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<p>This document defines the following Policy child elements: </p>
<blockquote class="text"><dl>
<dt>&lt;StartDate&gt; and &lt;ExpiryDate&gt;:</dt>
<dd>These
						two elements denote the validity period of a key. It MUST be ensured that
						the key is only used between the start and the end date (inclusive). The
						value MUST be expressed in UTC form, with no time zone component.
						Implementations SHOULD NOT rely on time resolution finer than milliseconds
						and MUST NOT generate time instants that specify leap seconds. When this
						element is absent the current time is assumed as the start time.
</dd>
<dt>&lt;NumberOfTransactions&gt;:</dt>
<dd>The value in this element
						indicates the maximum number of times a key carried within
						the PSKC document can be used by an application after having received it.. When this element is omitted then there is
						no restriction regarding the number of times a key can be used. 
</dd>
<dt>&lt;KeyUsage&gt;:</dt>
<dd> The &lt;KeyUsage&gt; element
						puts constraints on the intended usage of the key. The recipient of the PSKC
						document MUST enforce the key usage. Currently, the following tokens are
						registered by this document: 
<blockquote class="text"><dl>
<dt>OTP:</dt>
<dd> The key MUST only be used for OTP generation.
</dd>
<dt>CR:</dt>
<dd> The key MUST only be used for Challenge/Response
								purposes.
</dd>
<dt>Encrypt:</dt>
<dd>The key MUST only be used for data encryption
								purposes.
</dd>
<dt>Integrity:</dt>
<dd>The key MUST only be used to generate a keyed
								message digest for data integrity or authentication purposes.
</dd>
<dt>Verify:</dt>
<dd>The key MUST only be used to verify a keyed message digest for data integrity or authentication purposes. (this is the vice versa of Integrity) 
</dd>
<dt>Unlock:</dt>
<dd> The key MUST only be used for an inverse
								challenge response in the case where a user has locked the device by
								entering a wrong PIN too many times (for devices with PIN-input
								capability).
</dd>
<dt>Decrypt:</dt>
<dd>The key MUST only be used for data decryption
								purposes.
</dd>
<dt>KeyWrap:</dt>
<dd>The key MUST only be used for key wrap purposes.
</dd>
<dt>Unwrap:</dt>
<dd>The key MUST only be used for key unwrap purposes.
</dd>
<dt>Derive:</dt>
<dd>The key MUST only be used with a key derivation
								function to derive a new key (see also Section 8.2.4 of <a class='info' href='#NIST800-57'>[NIST800&#8209;57]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;NIST Special Publication 800-57, Recommendation for Key Management  Part 						1: General (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a>).
</dd>
<dt>Generate:</dt>
<dd>The key MUST only be used to generate a new key
								based on a random number and the previous value of the key (see also
								Section 8.1.5.2.1 of<a class='info' href='#NIST800-57'>[NIST800&#8209;57]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;NIST Special Publication 800-57, Recommendation for Key Management  Part 						1: General (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a>).
</dd>
</dl></blockquote> The element MAY also be repeated to allow several key usages to be
						expressed. When this element is absent then no key usage constraint is
						assumed, i.e., the key MAY be utilized for every usage. 
</dd>
<dt>&lt;PINPolicy&gt;:</dt>
<dd> The &lt;PINPolicy&gt; element
						allows policy about the PIN usage to be associated with the key. The
						following attributes are specified: 
<blockquote class="text"><dl>
<dt>'PINKeyId':</dt>
<dd>This attribute contains the unique key id of
								the key held within this container that contains the value of the
								PIN that protects the key.
</dd>
<dt>'PINUsageMode':</dt>
<dd>This mandatory attribute indicates the way
								the PIN is used during the usage of the key. The following values
								are defined: 
<blockquote class="text"><dl>
<dt>Local:</dt>
<dd>This value indicates that the PIN is
										checked locally on the device before allowing the key to be
										used in executing the algorithm.
</dd>
<dt>Prepend:</dt>
<dd>This value indicates that the PIN is
										prepended to the algorithm response hence it MUST be checked by
										the party validating the response.
</dd>
<dt>Append:</dt>
<dd>This value indicates that the PIN is
										appended to the algorithm response hence it MUST be checked by
										the party validating the response.
</dd>
<dt>Algorithmic:</dt>
<dd>This value indicates that the PIN is
										used as part of the algorithm computation.
</dd>
</dl></blockquote>
							
</dd>
<dt>'MaxFailedAttempts':</dt>
<dd> This attribute indicates the maximum
								number of times the PIN may be entered wrongly before it MUST NOT be
								possible to use the key anymore. 
</dd>
<dt>'MinLength':</dt>
<dd> This attribute indicates the minimum length
								of a PIN that can be set to protect the associated key. It MUST NOT be
								possible to set a PIN shorter than this value. If the 'PINFormat'
								attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
								indicates the number of digits/characters. If the 'PINFormat'
								attribute is 'BASE64' or 'BINARY', this value indicates the number
								of bytes of the unencoded value.
</dd>
<dt>'MaxLength':</dt>
<dd> This attribute indicates the maximum length
								of a PIN that can be set to protect this key. It MUST NOT be
								possible to set a PIN longer than this value. If the 'PINFormat'
								attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
								indicates the number of digits/characters. If the 'PINFormat'
								attribute is 'BASE64' or 'BINARY', this value indicates the number
								of bytes of the unencoded value. 
</dd>
<dt>'PINEncoding':</dt>
<dd>This attribute indicates the encoding of
								the PIN and MUST be one of the values: DECIMAL, HEXADECIMAL,
								ALPHANUMERIC, BASE64, or BINARY.
</dd>
</dl></blockquote> If the 'PinUsageMode' attribute is set to "Local" then the device
						MUST enforce the restriction indicated in the 'MaxFailedAttempts',
						'MinLength', 'MaxLength' and 'PINEncoding' attribute, otherwise it MUST be
						enforced on the server side. 
</dd>
</dl></blockquote><p>
			
</p>
<a name="EncryptionKeyDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Key Protection Methods</h3>

<p>With the functionality described in the previous sections, information related to keys
				had to be transmitted in clear text. With the help of the
				&lt;EncryptionKey&gt; element, which is a child element of the
				&lt;KeyContainer&gt; element, it is possible to encrypt keys and associated
				information. The level of encryption is applied to the value of individual elements
				and the applied encryption algorithm MUST be the same for all encrypted elements. Keys are protected using the following methods: pre-shared keys, passphrase-based
				keys, and asymmetric keys. When encryption algorithms are used that make use of Initialisation Vectors (IV), for example AES128-CBC, then a random IV value MUST be generated for each value to be encrypted and it MUST be prepended to the resulting encrypted value as specified in <a class='info' href='#XMLENC'>[XMLENC]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="SymmetricKeyProtectionDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Encryption based on Pre-Shared Keys</h3>

<p><a class='info' href='#example-encr-psk'>Figure&nbsp;6<span> (</span><span class='info'>AES-128-CBC Encrypted Pre-Shared Secret Key with HMAC-SHA1</span><span>)</span></a> shows an example that illustrates the
					encryption of the content of the &lt;Secret&gt; element using
					AES128-CBC and PKCS5 Padding. The plaintext value of &lt;Secret&gt; is
					'3132333435363738393031323334353637383930'. The name of the pre-shared secret is
					"Pre-shared-key", as set in the &lt;KeyName&gt; element (which is a child
					element of the &lt;EncryptionKey&gt; element). The value of the encryption key used
					is '12345678901234567890123456789012'.
</p>
<p> The IV for the MAC key is '11223344556677889900112233445566' and the IV for the HOTP key is '000102030405060708090a0b0c0d0e0f'.
					
</p>
<p>As AES128-CBC does not provide
					integrity checks a keyed MAC is applied to the encrypted value using a MAC key and a MAC
					algorithm as declared in the &lt;MACMethod&gt; element (in our example
					"http://www.w3.org/2000/09/xmldsig#hmac-sha1" is used as the algorithm and the value of the MAC key is randomly generated, in our case '1122334455667788990011223344556677889900', and encrypted with the above encryption key). The result of the keyed
					MAC computation is placed in the &lt;ValueMAC&gt; child element of &lt;Secret&gt;. 
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-psk"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1.0"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"&gt;
    &lt;EncryptionKey&gt;
        &lt;ds:KeyName&gt;Pre-shared-key&lt;/ds:KeyName&gt;
    &lt;/EncryptionKey&gt;
    &lt;MACMethod Algorithm="http://www.w3.org/2000/09/xmldsig#hmac-sha1"&gt;
        &lt;MACKey&gt;
            &lt;xenc:EncryptionMethod
            Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/&gt;
            &lt;xenc:CipherData&gt;
                &lt;xenc:CipherValue&gt;
    ESIzRFVmd4iZABEiM0RVZgKn6WjLaTC1sbeBMSvIhRejN9vJa2BOlSaMrR7I5wSX
                &lt;/xenc:CipherValue&gt;
            &lt;/xenc:CipherData&gt;
        &lt;/MACKey&gt;
    &lt;/MACMethod&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;CryptoModuleInfo&gt;
            &lt;Id&gt;CM_ID_001&lt;/Id&gt;
        &lt;/CryptoModuleInfo&gt;
        &lt;Key Id="12345678"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;EncryptedValue&gt;
                        &lt;xenc:EncryptionMethod
            Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/&gt;
                        &lt;xenc:CipherData&gt;
                            &lt;xenc:CipherValue&gt;
    AAECAwQFBgcICQoLDA0OD+cIHItlB3Wra1DUpxVvOx2lef1VmNPCMl8jwZqIUqGv
                            &lt;/xenc:CipherValue&gt;
                        &lt;/xenc:CipherData&gt;
                    &lt;/EncryptedValue&gt;
                    &lt;ValueMAC&gt;Su+NvtQfmvfJzF6bmQiJqoLRExc=
                    &lt;/ValueMAC&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: AES-128-CBC Encrypted Pre-Shared Secret Key with HMAC-SHA1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<p>When protecting the payload with pre-shared keys implementations MUST set the
					name of the specific pre-shared key in the &lt;KeyName&gt; element
					inside the &lt;EncryptionKey&gt; element. When the encryption method uses 
					a CBC mode that requires an explicit initialization vector (IV), the IV MUST be passed by
					prepending it to the encrypted value.
</p>
<p>For systems implementing PSKC it is RECOMMENDED to support AES-128-CBC (with the
					URI of http://www.w3.org/2001/04/xmlenc#aes128-cbc) and KW-AES128 (with the URI
					of http://www.w3.org/2001/04/xmlenc#kw-aes128). Please note that KW-AES128
					requires that the key to be protected must be a multiple of 8 bytes in length. Hence, if
					keys of a different length have to be protected then the usage of the key wrap
					algorithm with padding, as described in <a class='info' href='#AESKWPAD'>[AESKWPAD]<span> (</span><span class='info'>Housley, R. and M. Dworkin, &ldquo;Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm,&rdquo; March&nbsp;2009.</span><span>)</span></a> is RECOMMENDED. Some of the encryption algorithms that can optionally be implemented are:
</p>
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Algorithm      | Uniform Resource Locator (URL)
---------------+-------------------------------------------------------
AES192-CBC     | http://www.w3.org/2001/04/xmlenc#aes192-cbc
AES256-CBC     | http://www.w3.org/2001/04/xmlenc#aes256-cbc
TripleDES-CBC  | http://www.w3.org/2001/04/xmlenc#tripledes-cbc
Camellia128    | http://www.w3.org/2001/04/xmldsig-more#camellia128
Camellia192    | http://www.w3.org/2001/04/xmldsig-more#camellia192
Camellia256    | http://www.w3.org/2001/04/xmldsig-more#camellia256
KW-AES128      | http://www.w3.org/2001/04/xmlenc#kw-aes128
KW-AES192      | http://www.w3.org/2001/04/xmlenc#kw-aes192
KW-AES256      | http://www.w3.org/2001/04/xmlenc#kw-aes256
KW-TripleDES   | http://www.w3.org/2001/04/xmlenc#kw-tripledes
KW-Camellia128 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia128
KW-Camellia192 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia192
KW-Camellia256 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia256
</pre></div><p>

				
</p>
<a name="MACMethodDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
MAC Method</h3>

<p> When algorithms without integrity checks are used, such as AES-128-CBC, a keyed
					MAC value MUST be placed in the &lt;ValueMAC&gt; element of the &lt;Data&gt; element. In this
					case the MAC algorithm type MUST be set in the &lt;MACMethod&gt;
					element of the &lt;KeyContainer&gt; element. The MAC key MUST be a randomly generated key
					by the sender, be pre-agreed between the receiver and the sender, or be set by the application
					protocol that carries the PSKC document. It is RECOMMENDED that the sender generates a random MAC key.
					When the sender generates such a random MAC key, the MAC key material MUST be encrypted 
					with the same encryption key specified in &lt;EncryptionKey&gt; element of the key container. The 
					encryption method and encrypted value MUST be set respectively in the &lt;EncryptionMethod&gt; element
					and the &lt;CipherData&gt; element of the &lt;MACKey&gt; element in the &lt;MACMethod&gt; element. 
					The &lt;MACKeyReference&gt; element of the &lt;MACMethod&gt; element MAY be used to indicate 
					a pre-shared MAC key or a provisioning protocol derived MAC key.

					For systems implementing PSKC it is RECOMMENDED to implement the HMAC-SHA1 (with the URI of
					'http://www.w3.org/2000/09/xmldsig#hmac-sha1'). Some of the MAC algorithms that can optionally be implemented are:
</p>
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Algorithm      | Uniform Resource Locator (URL)
---------------+-----------------------------------------------------
HMAC-SHA224    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha224
HMAC-SHA256    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha256
HMAC-SHA384    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha384
HMAC-SHA512    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha512
</pre></div><p>

				
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Encryption based on Passphrase-based Keys</h3>

<p><a class='info' href='#example-encr-passwd'>Figure&nbsp;7<span> (</span><span class='info'>Example of a PSKC Document using Encryption based on Passphrase-based Keys</span><span>)</span></a> shows an example that illustrates the
					encryption of the content of the &lt;Secret&gt; element using
					passphrase based key derivation (PBKDF2) to derive the encryption key as defined in <a class='info' href='#PKCS5'>[PKCS5]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; March&nbsp;1999.</span><span>)</span></a>. When using passphrase based key derivation, the &lt;DerivedKey&gt; element defined in XML Encryption v1.1 <a class='info' href='#XMLENC11'>[XMLENC11]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing Version 1.1.,&rdquo; July&nbsp;2009.</span><span>)</span></a> MUST be used to specify the passphrased-based 
				key. A &lt;DerivedKey&gt; element is set as the child element of &lt;EncryptionKey&gt; element of the key container.
</p>
<p>
				The &lt;DerivedKey&gt; element is used to specify the key derivation function and related parameters. 
				The encryption algorithm, in this example AES-128-CBC ( URI 'http://www.w3.org/2001/04/xmlenc#aes128-cbc'),  MUST be set in the 'Algorithm' attribute of &lt;EncryptionMethod&gt; element used inside the encrypted data elements.
</p>
<p>When PBKDF2 is used, the  'Algorithm' attribute of the &lt;xenc11:KeyDerivationMethod&gt; element MUST be set to the URI 'http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5#pbkdf2'. The  
			   &lt;xenc11:KeyDerivationMethod&gt; element MUST include the &lt;PBKDF2-params> child element to indicate the 
			   PBKDF2 parameters, such as salt and iteration count.
</p>
<p>When the encryption method uses a CBC mode that uses an explicit initialization vector (IV) other than a
              derived one, the IV MUST be passed by prepending it to the encrypted value.
</p>
<p>In the example below, the following data is used. </p>
<blockquote class="text"><dl>
<dt>Password:       </dt>
<dd>qwerty
</dd>
<dt>Salt:                 </dt>
<dd>0x123eff3c4a72129c
</dd>
<dt>Iteration Count:</dt>
<dd>1000
</dd>
<dt>MAC Key:        </dt>
<dd>0xbdaab8d648e850d25a3289364f7d7eaaf53ce581
</dd>
<dt>OTP Secret:     </dt>
<dd>12345678901234567890
</dd>
</dl></blockquote><p> The derived encryption key is "0x651e63cd57008476af1ff6422cd02e41". The initialization
					vector (IV) is "0xa13be8f92db69ec992d99fd1b5ca05f0". This key is also used to encrypt the randomly 
					chosen MAC key. A different IV can be used, say, "0xd864d39cbc0cdc8e1ee483b9164b9fa0" in the example. 
					The encryption with algorithm "AES-128-CBC" follows the specification defined in <a class='info' href='#XMLENC'>[XMLENC]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; December&nbsp;2002.</span><span>)</span></a>. 
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-passwd"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;pskc:KeyContainer
  xmlns:pskc="urn:ietf:params:xml:ns:keyprov:pskc"
  xmlns:xenc11="http://www.w3.org/2009/xmlenc11#"
  xmlns:pkcs5=
  "http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#"
  xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Version="1.0"&gt;
    &lt;pskc:EncryptionKey&gt;
        &lt;xenc11:DerivedKey&gt;
            &lt;xenc11:KeyDerivationMethod
              Algorithm=
 "http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#pbkdf2"&gt;
                &lt;pkcs5:PBKDF2-params&gt;
                    &lt;Salt&gt;
                        &lt;Specified&gt;Ej7/PEpyEpw=&lt;/Specified&gt;
                    &lt;/Salt&gt;
                    &lt;IterationCount&gt;1000&lt;/IterationCount&gt;
                    &lt;KeyLength&gt;16&lt;/KeyLength&gt;
                    &lt;PRF/&gt;
                &lt;/pkcs5:PBKDF2-params&gt;
            &lt;/xenc11:KeyDerivationMethod&gt;
            &lt;xenc:ReferenceList&gt;
                &lt;xenc:DataReference URI="#ED"/&gt;
            &lt;/xenc:ReferenceList&gt;
            &lt;xenc11:MasterKeyName&gt;My Password 1&lt;/xenc11:MasterKeyName&gt;
        &lt;/xenc11:DerivedKey&gt;
    &lt;/pskc:EncryptionKey&gt;
    &lt;pskc:MACMethod
        Algorithm="http://www.w3.org/2000/09/xmldsig#hmac-sha1"&gt;
        &lt;pskc:MACKey&gt;
            &lt;xenc:EncryptionMethod
            Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/&gt;
            &lt;xenc:CipherData&gt;
                &lt;xenc:CipherValue&gt;
2GTTnLwM3I4e5IO5FkufoOEiOhNj91fhKRQBtBJYluUDsPOLTfUvoU2dStyOwYZx
                &lt;/xenc:CipherValue&gt;
            &lt;/xenc:CipherData&gt;
        &lt;/pskc:MACKey&gt;
    &lt;/pskc:MACMethod&gt;
    &lt;pskc:KeyPackage&gt;
        &lt;pskc:DeviceInfo&gt;
            &lt;pskc:Manufacturer&gt;TokenVendorAcme&lt;/pskc:Manufacturer&gt;
            &lt;pskc:SerialNo&gt;987654321&lt;/pskc:SerialNo&gt;
        &lt;/pskc:DeviceInfo&gt;
        &lt;pskc:CryptoModuleInfo&gt;
            &lt;pskc:Id&gt;CM_ID_001&lt;/pskc:Id&gt;
        &lt;/pskc:CryptoModuleInfo&gt;
        &lt;pskc:Key Algorithm=
        "urn:ietf:params:xml:ns:keyprov:pskc#hotp" Id="123456"&gt;
            &lt;pskc:Issuer&gt;Example-Issuer&lt;/pskc:Issuer&gt;
            &lt;pskc:AlgorithmParameters&gt;
                &lt;pskc:ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/pskc:AlgorithmParameters&gt;
            &lt;pskc:Data&gt;
                &lt;pskc:Secret&gt;
                &lt;pskc:EncryptedValue Id="ED"&gt;
                    &lt;xenc:EncryptionMethod
                        Algorithm=
"http://www.w3.org/2001/04/xmlenc#aes128-cbc"/&gt;
                        &lt;xenc:CipherData&gt;
                            &lt;xenc:CipherValue&gt;
      oTvo+S22nsmS2Z/RtcoF8Hfh+jzMe0RkiafpoDpnoZTjPYZu6V+A4aEn032yCr4f
                        &lt;/xenc:CipherValue&gt;
                    &lt;/xenc:CipherData&gt;
                    &lt;/pskc:EncryptedValue&gt;
                    &lt;pskc:ValueMAC&gt;LP6xMvjtypbfT9PdkJhBZ+D6O4w=
                    &lt;/pskc:ValueMAC&gt;
                &lt;/pskc:Secret&gt;
            &lt;/pskc:Data&gt;
        &lt;/pskc:Key&gt;
    &lt;/pskc:KeyPackage&gt;
&lt;/pskc:KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Example of a PSKC Document using Encryption based on Passphrase-based Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<a name="AsymmetricKeyProtectionDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Encryption based on Asymmetric Keys</h3>

<p>When using asymmetric keys to encrypt child elements of the &lt;Data&gt;
					element information about the certificate being used MUST be stated in the
					&lt;X509Data&gt; element, which is a child element of the
					&lt;EncryptionKey&gt; element. The encryption algorithm MUST be
					indicated in the 'Algorithm' attribute of the &lt;EncryptionMethod&gt;
					element. In the example shown in <a class='info' href='#example-encr-asymm'>Figure&nbsp;8<span> (</span><span class='info'>Example of a PSKC Document using Encryption based on Asymmetric Keys</span><span>)</span></a> the
					algorithm is set to "http://www.w3.org/2001/04/xmlenc#rsa_1_5".
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-asymm"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;KeyContainer
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
    id="KC0001"
    Version="1.0"&gt;
    &lt;EncryptionKey&gt;
        &lt;ds:X509Data&gt;
&lt;ds:X509Certificate&gt;MIIB5zCCAVCgAwIBAgIESZp/vDANBgkqhkiG9w0BAQUFADA4M
Q0wCwYDVQQKEwRJRVRGMRMwEQYDVQQLEwpLZXlQcm92IFdHMRIwEAYDVQQDEwlQU0tDIF
Rlc3QwHhcNMDkwMjE3MDkxMzMyWhcNMTEwMjE3MDkxMzMyWjA4MQ0wCwYDVQQKEwRJRVR
GMRMwEQYDVQQLEwpLZXlQcm92IFdHMRIwEAYDVQQDEwlQU0tDIFRlc3QwgZ8wDQYJKoZI
hvcNAQEBBQADgY0AMIGJAoGBALCWLDa2ItYJ6su80hd1gL4cggQYdyyKK17btt/aS6Q/e
DsKjsPyFIODsxeKVV/uA3wLT4jQJM5euKJXkDajzGGOy92+ypfzTX4zDJMkh61SZwlHNJ
xBKilAM5aW7C+BQ0RvCxvdYtzx2LTdB+X/KMEBA7uIYxLfXH2Mnub3WIh1AgMBAAEwDQY
JKoZIhvcNAQEFBQADgYEAe875m84sYUJ8qPeZ+NG7REgTvlHTmoCdoByU0LBBLotUKuqf
rnRuXJRMeZXaaEGmzY1kLonVjQGzjAkU4dJ+RPmiDlYuHLZS41Pg6VMwY+03lhk6I5A/w
4rnqdkmwZX/NgXg06alnc2pBsXWhL4O7nk0S2ZrLMsQZ6HcsXgdmHo=
&lt;/ds:X509Certificate&gt;
        &lt;/ds:X509Data&gt;
    &lt;/EncryptionKey&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key
            Id="MBK000000001"
            Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Example-Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="6" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;EncryptedValue&gt;
                        &lt;xenc:EncryptionMethod
             Algorithm="http://www.w3.org/2001/04/xmlenc#rsa_1_5"/&gt;
                        &lt;xenc:CipherData&gt;
&lt;xenc:CipherValue&gt;hJ+fvpoMPMO9BYpK2rdyQYGIxiATYHTHC7e/sPLKYo5/r1v+4
xTYG3gJolCWuVMydJ7Ta0GaiBPHcWa8ctCVYmHKfSz5fdeV5nqbZApe6dofTqhRwZK6
Yx4ufevi91cjN2vBpSxYafvN3c3+xIgk0EnTV4iVPRCR0rBwyfFrPc4=
&lt;/xenc:CipherValue&gt;
                        &lt;/xenc:CipherData&gt;
                    &lt;/EncryptedValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Example of a PSKC Document using Encryption based on Asymmetric Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<p>For systems implementing PSKC it is RECOMMENDED to implement the RSA-1.5 algorithm, identified by the URI 'http://www.w3.org/2001/04/xmlenc#rsa-1_5'.
</p>
<p>Some of the asymmetric encryption algorithms that can optionally be implemented are:
</p>
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Algorithm         | Uniform Resource Locator (URL)
------------------+-------------------------------------------------
RSA-OAEP-MGF1P    | http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p
</pre></div><p>

				
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Padding of Encrypted Values for Non-Padded Encryption Algorithms</h3>

<p>Padding of encrypted values (for example the key secret value) is required when key protection algorithms are used that do not support embedded padding and the value to be encrypted is not a multiple of the encryption algorithm cypher block length.
</p>
<p>For example, when transmitting a HOTP key (20 bytes long) protected with the AES algorithm in CBC mode (8 byte block cypher), padding is required since 20 bytes are not a multiple of the 8 byte block length.
</p>
<p>In these cases, for systems implementing PSKC it is RECOMMENDED to pad the value before encryption using PKCS5 padding as described in <a class='info' href='#PKCS5'>[PKCS5]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
					
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Digital Signature</h3>

<p>PSKC allows a digital signature to be added to the XML document, as a child element
				of the &lt;KeyContainer&gt; element. The description of the XML digital
				signature can be found in <a class='info' href='#XMLDSIG'>[XMLDSIG]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; February&nbsp;2002.</span><span>)</span></a>.
</p>
<p>
				<br /><hr class="insert" />
<a name="example-dsig"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
    Version="1.0"&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;0755225266&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key Id="123"
        Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Example-Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="6" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
    &lt;Signature&gt;
        &lt;ds:SignedInfo&gt;
            &lt;ds:CanonicalizationMethod
             Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;
            &lt;ds:SignatureMethod
             Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;
            &lt;ds:Reference URI="#Device"&gt;
                &lt;ds:DigestMethod
             Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
                &lt;ds:DigestValue&gt;
                    j6lwx3rvEPO0vKtMup4NbeVu8nk=
                &lt;/ds:DigestValue&gt;
            &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;
            j6lwx3rvEPO0vKtMup4NbeVu8nk=
        &lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
            &lt;ds:X509Data&gt;
                &lt;ds:X509IssuerSerial&gt;
                    &lt;ds:X509IssuerName&gt;
                        CN=Example.com,C=US
                    &lt;/ds:X509IssuerName&gt;
                    &lt;ds:X509SerialNumber&gt;
                        12345678
                    &lt;/ds:X509SerialNumber&gt;
                &lt;/ds:X509IssuerSerial&gt;
            &lt;/ds:X509Data&gt;
        &lt;/ds:KeyInfo&gt;
    &lt;/Signature&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Digital Signature Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<a name="bulk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Bulk Provisioning</h3>

<p>The functionality of bulk provisioning can be accomplished by repeating the
				&lt;KeyPackage&gt; element multiple times within the
				&lt;KeyContainer&gt; element indicating that multiple keys are provided to
				different devices or cryptomodules. The &lt;EncryptionKey&gt; element then applies to all
				&lt;KeyPackage&gt; elements. When provisioning multiple keys to the same device the &lt;KeyPackage&gt; element is repeated but the enclosed &lt;DeviceInfo&gt; element will contain the same sub-elements that uniquely identify the single device (for example the keys for the device identified by SerialNo='9999999' in the example below).
</p>
<p><a class='info' href='#example-bulk'>Figure&nbsp;10<span> (</span><span class='info'>Bulk Provisioning Example</span><span>)</span></a> shows an example utilizing these capabilities.
</p>
<p>
				<br /><hr class="insert" />
<a name="example-bulk"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1.0"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key Id="1"
        Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-05-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-05-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;123456&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key Id="2"
        Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-05-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-05-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;9999999&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key Id="3"
        Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-03-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-03-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
    &lt;KeyPackage&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;9999999&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key Id="4"
        Algorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;AlgorithmParameters&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/AlgorithmParameters&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-04-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-04-30T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/KeyPackage&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Bulk Provisioning Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Extensibility</h3>

<p>This section lists a few common extension points provided by PSKC: 
</p>
<p>
				</p>
<blockquote class="text"><dl>
<dt>New PSKC Version:</dt>
<dd>Whenever it is necessary to define a new version
						of this document then a new version number has to be allocated to refer to
						the new specification version. The version number is carried inside the
						'Algorithm' attribute, as described in <a class='info' href='#basics'>Section&nbsp;4<span> (</span><span class='info'>&lt;KeyContainer&gt; Element: The Basics</span><span>)</span></a>, and rules
						for extensibililty are defined in <a class='info' href='#iana'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</dd>
<dt>New XML Elements:</dt>
<dd>The usage of the XML schema and the available
						extension points allows new XML elements to be added. Depending of type of
						XML elements different ways for extensibility are offered. In some places
						the &lt;Extensions&gt; element can be used and elsewhere the
						"&lt;xs:any namespace="##other" processContents="lax" minOccurs="0"
						maxOccurs="unbounded"/&gt;" XML extension point is utilized.
</dd>
<dt>New XML Attributes:</dt>
<dd>The XML schema allows new XML attributes to be
						added where XML extension points have been defined (see
						"&lt;xs:anyAttribute namespace="##other"/&gt;" in <a class='info' href='#schema'>Section&nbsp;11<span> (</span><span class='info'>XML Schema</span><span>)</span></a>).
</dd>
<dt>New PSKC Algorithm Profiles:</dt>
<dd>This document defines two PSKC
						algorithm profiles, see <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>. The following informational document describes additional profiles <a class='info' href='#PSKC-ALGORITHM-PROFILES'>[PSKC&#8209;ALGORITHM&#8209;PROFILES]<span> (</span><span class='info'>Hoyer, P., Pei, M., Machani, S., and A. Doherty, &ldquo;Additional Portable Symmetric Key Container (PSKC) Algorithm Profiles,&rdquo; December&nbsp;2008.</span><span>)</span></a>.  Further PSKC algorithm
						profiles can be registered as described in <a class='info' href='#SymmetricKeyAlgorithmIdentifierRegistry'>Section&nbsp;12.4<span> (</span><span class='info'>PSKC Algorithm Profile Registry</span><span>)</span></a>.
</dd>
<dt>Algorithm URIs:</dt>
<dd>
						<a class='info' href='#EncryptionKeyDescription'>Section&nbsp;6<span> (</span><span class='info'>Key Protection Methods</span><span>)</span></a> defines how keys and related data
						can be protected. A number of algorithms can be used. The use of new
						algorithms can be used by pointing to a new algorithm URI. 
</dd>
<dt>Policy:</dt>
<dd>
						<a class='info' href='#policy'>Section&nbsp;5<span> (</span><span class='info'>Key Policy</span><span>)</span></a> defines policies that can be attached to a key and
						keying related data. The &lt;Policy&gt; element is one such item
						that allows to restrict the use of the key to certain functions, such as
						"OTP usage only". Further values may be registered as described in <a class='info' href='#iana'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
			
</p>
<a name="profiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
PSKC Algorithm Profile</h3>

<a name="hotp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
HOTP</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> HOTP 
</dd>
<dt>Class:</dt>
<dd> OTP 
</dd>
<dt>URN:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc#hotp
</dd>
<dt>Algorithm Definition:</dt>
<dd> http://www.ietf.org/rfc/rfc4226.txt 
</dd>
<dt>Identifier Definition:</dt>
<dd> (this RFC) 
</dd>
<dt>Registrant Contact:</dt>
<dd> IESG 
</dd>
<dt>Profiling:</dt>
<dd>
							
<blockquote class="text">
<p>The &lt;KeyPackage> element MUST be present and the
									&lt;ResponseFormat> element, which is a child element of the
									&lt;AlgorithmParameters&gt; element, MUST be used to
									indicate the OTP length and the value format.
</p>
<p>The &lt;Counter&gt; element (see <a class='info' href='#KeyElement'>Section&nbsp;4.1<span> (</span><span class='info'>&lt;Key&gt;: Embedding Keying Material and Key Related Information</span><span>)</span></a>) MUST be provided as meta-data for the
									key. 
</p>
<p>The following additional constraints apply: </p>
<ul class="text">
<li>The value of the &lt;Secret> element MUST contain key
											material with a length of at least 16 octets (128 bits),
											if it is present.
</li>
<li>The &lt;ResponseFormat> element MUST have the
											'Format' attribute set to "DECIMAL", and the 'Length'
											attribute MUST indicate a length value between 6 and 9 (inclusive).
</li>
<li>The &lt;PINPolicy> element MAY be present but the
											'PINUsageMode' attribute cannot be set to "Algorithmic".
										
</li>
</ul>
								

<p>An example can be found in <a class='info' href='#example-suppl'>Figure&nbsp;3<span> (</span><span class='info'>PSKC Key Container Example with Supplementary Data</span><span>)</span></a>. 
</p>
</blockquote>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="pin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
KEYPROV-PIN</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> KEYPROV-PIN 
</dd>
<dt>Class:</dt>
<dd> Symmetric static credential comparison 
</dd>
<dt>URN:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc#pin
</dd>
<dt>Algorithm Definition:</dt>
<dd> (this document) 
</dd>
<dt>Identifier Definition</dt>
<dd> (this document) 
</dd>
<dt>Registrant Contact:</dt>
<dd> IESG 
</dd>
<dt>Profiling:</dt>
<dd>
							
<blockquote class="text">
<p>The &lt;Usage> element MAY be present but no attribute of the
									&lt;Usage> element is required. The &lt;ResponseFormat>
									element MAY be used to indicate the PIN value format.
</p>
<p>The &lt;Secret&gt; element (see <a class='info' href='#KeyElement'>Section&nbsp;4.1<span> (</span><span class='info'>&lt;Key&gt;: Embedding Keying Material and Key Related Information</span><span>)</span></a>) MUST be provided. 
</p>
<p>See the example in <a class='info' href='#example-pin'>Figure&nbsp;5<span> (</span><span class='info'>Non-Encrypted HOTP Secret Key protected by PIN</span><span>)</span></a>
								
</p>
</blockquote>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
XML Schema</h3>

<p>This section defines the XML schema for PSKC. 
</p>
<p>
				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
     xmlns:pskc="urn:ietf:params:xml:ns:keyprov:pskc"
     xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
     xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
     targetNamespace="urn:ietf:params:xml:ns:keyprov:pskc"
     elementFormDefault="qualified"
     attributeFormDefault="unqualified"&gt;
     &lt;xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
          schemaLocation=
"http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/
          xmldsig-core-schema.xsd"/&gt;
     &lt;xs:import namespace="http://www.w3.org/2001/04/xmlenc#"
          schemaLocation=
"http://www.w3.org/TR/2002/REC-xmlenc-core-20021210/xenc-schema.xsd"/&gt;
     &lt;xs:import namespace="http://www.w3.org/XML/1998/namespace"/&gt;
     &lt;xs:complexType name="KeyContainerType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="EncryptionKey"
                    type="ds:KeyInfoType" minOccurs="0"/&gt;
               &lt;xs:element name="MACMethod"
                    type="pskc:MACMethodType" minOccurs="0"/&gt;
               &lt;xs:element name="KeyPackage"
                    type="pskc:KeyPackageType" maxOccurs="unbounded"/&gt;
               &lt;xs:element name="Signature"
                    type="ds:SignatureType" minOccurs="0"/&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType"
                    minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
          &lt;xs:attribute name="Version"
               type="pskc:VersionType" use="required"/&gt;
          &lt;xs:attribute name="Id"
               type="xs:ID" use="optional"/&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:simpleType name="VersionType" final="restriction"&gt;
          &lt;xs:restriction base="xs:string"&gt;
               &lt;xs:pattern value="\d{1,2}\.\d{1,3}"/&gt;
          &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
     &lt;xs:complexType name="KeyType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="Issuer"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="AlgorithmParameters"
                    type="pskc:AlgorithmParametersType"
                    minOccurs="0"/&gt;
               &lt;xs:element name="KeyProfileId"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="KeyReference"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="FriendlyName"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="Data"
                    type="pskc:KeyDataType" minOccurs="0"/&gt;
               &lt;xs:element name="UserId"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="Policy"
                    type="pskc:PolicyType" minOccurs="0"/&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType" minOccurs="0"
                    maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
          &lt;xs:attribute name="Id"
               type="xs:string" use="required"/&gt;
          &lt;xs:attribute name="Algorithm"
               type="pskc:KeyAlgorithmType" use="optional"/&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="PolicyType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="StartDate"
                    type="xs:dateTime" minOccurs="0"/&gt;
               &lt;xs:element name="ExpiryDate"
                    type="xs:dateTime" minOccurs="0"/&gt;
               &lt;xs:element name="PINPolicy"
                    type="pskc:PINPolicyType" minOccurs="0"/&gt;
               &lt;xs:element name="KeyUsage"
                    type="pskc:KeyUsageType"
                    minOccurs="0" maxOccurs="unbounded"/&gt;
               &lt;xs:element name="NumberOfTransactions"
                    type="xs:nonNegativeInteger" minOccurs="0"/&gt;
               &lt;xs:any namespace="##other"
                    minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="KeyDataType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="Secret"
                    type="pskc:binaryDataType" minOccurs="0"/&gt;
               &lt;xs:element name="Counter"
                    type="pskc:longDataType" minOccurs="0"/&gt;
               &lt;xs:element name="Time"
                    type="pskc:intDataType" minOccurs="0"/&gt;
               &lt;xs:element name="TimeInterval"
                    type="pskc:intDataType" minOccurs="0"/&gt;
               &lt;xs:element name="TimeDrift"
                    type="pskc:intDataType" minOccurs="0"/&gt;
               &lt;xs:any namespace="##other"
                    processContents="lax"
                    minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="binaryDataType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:choice&gt;
                    &lt;xs:element name="PlainValue"
                         type="xs:base64Binary"/&gt;
                    &lt;xs:element name="EncryptedValue"
                         type="xenc:EncryptedDataType"/&gt;
               &lt;/xs:choice&gt;
               &lt;xs:element name="ValueMAC"
                    type="xs:base64Binary" minOccurs="0"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="intDataType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:choice&gt;
                    &lt;xs:element name="PlainValue" type="xs:int"/&gt;
                    &lt;xs:element name="EncryptedValue"
                         type="xenc:EncryptedDataType"/&gt;
               &lt;/xs:choice&gt;
               &lt;xs:element name="ValueMAC"
                    type="xs:base64Binary" minOccurs="0"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="stringDataType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:choice&gt;
                    &lt;xs:element name="PlainValue" type="xs:string"/&gt;
                    &lt;xs:element name="EncryptedValue"
                         type="xenc:EncryptedDataType"/&gt;
               &lt;/xs:choice&gt;
               &lt;xs:element name="ValueMAC"
                    type="xs:base64Binary" minOccurs="0"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="longDataType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:choice&gt;
                    &lt;xs:element name="PlainValue" type="xs:long"/&gt;
                    &lt;xs:element name="EncryptedValue"
                         type="xenc:EncryptedDataType"/&gt;
               &lt;/xs:choice&gt;
               &lt;xs:element name="ValueMAC"
                    type="xs:base64Binary" minOccurs="0"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="PINPolicyType"&gt;
          &lt;xs:attribute name="PINKeyId"
               type="xs:string" use="optional"/&gt;
          &lt;xs:attribute name="PINUsageMode"
               type="pskc:PINUsageModeType"/&gt;
          &lt;xs:attribute name="MaxFailedAttempts"
               type="xs:unsignedInt" use="optional"/&gt;
          &lt;xs:attribute name="MinLength"
               type="xs:unsignedInt" use="optional"/&gt;
          &lt;xs:attribute name="MaxLength"
               type="xs:unsignedInt" use="optional"/&gt;
          &lt;xs:attribute name="PINEncoding"
               type="pskc:ValueFormatType" use="optional"/&gt;
          &lt;xs:anyAttribute namespace="##other"/&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:simpleType name="PINUsageModeType"&gt;
          &lt;xs:restriction base="xs:string"&gt;
               &lt;xs:enumeration value="Local"/&gt;
               &lt;xs:enumeration value="Prepend"/&gt;
               &lt;xs:enumeration value="Append"/&gt;
               &lt;xs:enumeration value="Algorithmic"/&gt;
          &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
     &lt;xs:simpleType name="KeyUsageType"&gt;
          &lt;xs:restriction base="xs:string"&gt;
               &lt;xs:enumeration value="OTP"/&gt;
               &lt;xs:enumeration value="CR"/&gt;
               &lt;xs:enumeration value="Encrypt"/&gt;
               &lt;xs:enumeration value="Integrity"/&gt;
               &lt;xs:enumeration value="Verify"/&gt;
               &lt;xs:enumeration value="Unlock"/&gt;
               &lt;xs:enumeration value="Decrypt"/&gt;
               &lt;xs:enumeration value="KeyWrap"/&gt;
               &lt;xs:enumeration value="Unwrap"/&gt;
               &lt;xs:enumeration value="Derive"/&gt;
               &lt;xs:enumeration value="Generate"/&gt;
          &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
     &lt;xs:complexType name="DeviceInfoType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="Manufacturer"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="SerialNo"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="Model"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="IssueNo"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="DeviceBinding"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="StartDate"
                    type="xs:dateTime" minOccurs="0"/&gt;
               &lt;xs:element name="ExpiryDate"
                    type="xs:dateTime" minOccurs="0"/&gt;
               &lt;xs:element name="UserId"
                    type="xs:string" minOccurs="0"/&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType" minOccurs="0"
                    maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="CryptoModuleInfoType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="Id" type="xs:string"/&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType" minOccurs="0"
                    maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="KeyPackageType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:element name="DeviceInfo"
                    type="pskc:DeviceInfoType" minOccurs="0"/&gt;
               &lt;xs:element name="CryptoModuleInfo"
                    type="pskc:CryptoModuleInfoType" minOccurs="0"/&gt;
               &lt;xs:element name="Key"
                    type="pskc:KeyType" minOccurs="0"/&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType" minOccurs="0"
                    maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="AlgorithmParametersType"&gt;
          &lt;xs:choice&gt;
               &lt;xs:element name="ChallengeFormat" minOccurs="0"&gt;
                    &lt;xs:complexType&gt;
                         &lt;xs:attribute name="Encoding"
                              type="pskc:ValueFormatType"
						      use="required"/&gt;
                         &lt;xs:attribute name="Min"
                              type="xs:unsignedInt" use="required"/&gt;
                         &lt;xs:attribute name="Max"
                              type="xs:unsignedInt" use="required"/&gt;
                         &lt;xs:attribute name="CheckDigits"
                              type="xs:boolean" default="false"/&gt;
                    &lt;/xs:complexType&gt;
               &lt;/xs:element&gt;
               &lt;xs:element name="ResponseFormat" minOccurs="0"&gt;
                    &lt;xs:complexType&gt;
                         &lt;xs:attribute name="Encoding"
                              type="pskc:ValueFormatType"
						      use="required"/&gt;
                         &lt;xs:attribute name="Length"
                              type="xs:unsignedInt" use="required"/&gt;
                         &lt;xs:attribute name="CheckDigits"
                              type="xs:boolean" default="false"/&gt;
                    &lt;/xs:complexType&gt;
               &lt;/xs:element&gt;
               &lt;xs:element name="Extensions"
                    type="pskc:ExtensionsType" minOccurs="0"
                    maxOccurs="unbounded"/&gt;
          &lt;/xs:choice&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:complexType name="ExtensionsType"&gt;
          &lt;xs:sequence&gt;
               &lt;xs:any namespace="##other"
                    processContents="lax" maxOccurs="unbounded"/&gt;
          &lt;/xs:sequence&gt;
          &lt;xs:attribute name="definition"
               type="xs:anyURI" use="optional"/&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:simpleType name="KeyAlgorithmType"&gt;
          &lt;xs:restriction base="xs:anyURI"/&gt;
     &lt;/xs:simpleType&gt;
     &lt;xs:simpleType name="ValueFormatType"&gt;
          &lt;xs:restriction base="xs:string"&gt;
               &lt;xs:enumeration value="DECIMAL"/&gt;
               &lt;xs:enumeration value="HEXADECIMAL"/&gt;
               &lt;xs:enumeration value="ALPHANUMERIC"/&gt;
               &lt;xs:enumeration value="BASE64"/&gt;
               &lt;xs:enumeration value="BINARY"/&gt;
          &lt;/xs:restriction&gt;
     &lt;/xs:simpleType&gt;
     &lt;xs:complexType name="MACMethodType"&gt;
	   &lt;xs:sequence&gt;
		  &lt;xs:choice&gt;
			&lt;xs:element name="MACKey"
              type="xenc:EncryptedDataType" minOccurs="0"/&gt;
			&lt;xs:element name="MACKeyReference"
				type="xs:string" minOccurs="0"/&gt;
			&lt;/xs:choice&gt;
			&lt;xs:any namespace="##other"
           processContents="lax" minOccurs="0" maxOccurs="unbounded"/&gt;
       &lt;/xs:sequence&gt;
       &lt;xs:attribute name="Algorithm" type="xs:anyURI" use="required"/&gt;
	&lt;/xs:complexType&gt;
     &lt;xs:element name="KeyContainer"
          type="pskc:KeyContainerType"/&gt;
&lt;/xs:schema&gt;
</pre></div><p>

<p>
</p>
			

<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Content-type registration for 'application/pskc+xml'</h3>

<p>This specification requests the registration of a new MIME type according to the
					procedures of RFC 4288 <a class='info' href='#RFC4288'>[RFC4288]<span> (</span><span class='info'>Freed, N. and J. Klensin, &ldquo;Media Type Specifications and Registration Procedures,&rdquo; December&nbsp;2005.</span><span>)</span></a> and guidelines in RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>.
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>MIME media type name:</dt>
<dd>application 
</dd>
<dt>MIME subtype name:</dt>
<dd>pskc+xml 
</dd>
<dt>Mandatory parameters:</dt>
<dd>none 
</dd>
<dt>Optional parameters:</dt>
<dd>charset<br />
 Indicates
							the character encoding of enclosed XML. 
</dd>
<dt>Encoding considerations:</dt>
<dd> Uses XML, which can employ 8-bit
							characters, depending on the character encoding used. See RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>, Section 3.2.
</dd>
<dt>Security considerations:</dt>
<dd> This content type is designed to
							carry PSKC protocol payloads.
</dd>
<dt>Interoperability considerations:</dt>
<dd>None
</dd>
<dt>Published specification:</dt>
<dd>RFCXXXX [NOTE TO IANA/RFC-EDITOR:
							Please replace XXXX with the RFC number of this specification.] 
</dd>
<dt>Applications which use this media type:</dt>
<dd> This MIME type is
							being used as a symmetric key container format for transport and
							provisioning of symmetric keys (One Time Password (OTP) shared secrets
							or symmetric cryptographic keys) to different types of strong
							authentication devices. As such, it is used for key provisioning
							systems. 
</dd>
<dt>Additional information:</dt>
<dd>
							
<blockquote class="text"><dl>
<dt>Magic Number:</dt>
<dd>None 
</dd>
<dt>File Extension:</dt>
<dd>.pskcxml 
</dd>
<dt>Macintosh file type code:</dt>
<dd>'TEXT' 
</dd>
</dl></blockquote>
						
</dd>
<dt>Personal and email address for further information:</dt>
<dd>Philip
							Hoyer, Philip.Hoyer@actividentity.com 
</dd>
<dt>Intended usage:</dt>
<dd>LIMITED USE 
</dd>
<dt>Author:</dt>
<dd> This specification is a work item of the IETF KEYPROV
							working group, with mailing list address
							&lt;keyprov@ietf.org&gt;. 
</dd>
<dt>Change controller:</dt>
<dd> The IESG &lt;iesg@ietf.org&gt;
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
XML Schema Registration</h3>

<p> This section registers an XML schema as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:schema:keyprov:pskc
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF KEYPROV Working Group, Philip Hoyer
							(Philip.Hoyer@actividentity.com).
</dd>
<dt>XML Schema:</dt>
<dd>The XML schema to be registered is contained in
								<a class='info' href='#schema'>Section&nbsp;11<span> (</span><span class='info'>XML Schema</span><span>)</span></a>. Its first line is <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</pre></div> and its last line is<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;/xs:schema&gt;
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
URN Sub-Namespace Registration</h3>

<p> This section registers a new XML namespace,
					"urn:ietf:params:xml:ns:keyprov:pskc", per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>. 
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF KEYPROV Working Group, Philip Hoyer
							(Philip.Hoyer@actividentity.com).
</dd>
<dt>XML:</dt>
<dd>
							<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BEGIN
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
  "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="content-type"
        content="text/html;charset=iso-8859-1"/&gt;
  &lt;title&gt;PSKC Namespace&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Namespace for PSKC&lt;/h1&gt;
  &lt;h2&gt;urn:ietf:params:xml:ns:keyprov:pskc&lt;/h2&gt;
&lt;p&gt;See &lt;a href="[URL of published RFC]"&gt;RFCXXXX
    [NOTE TO IANA/RFC-EDITOR:
     Please replace XXXX with the RFC number of this
    specification.]&lt;/a&gt;.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
END
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="SymmetricKeyAlgorithmIdentifierRegistry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
PSKC Algorithm Profile Registry</h3>

<p> This specification requests the creation of a new IANA registry for PSKC
					algorithm profiles in accordance with the principles set out in <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226]. 
</p>
<p> As part of this registry IANA will maintain the following information: 
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> The name by which the PSKC algorithm profile is
							generally referred. 
</dd>
<dt>Class:</dt>
<dd> The type of PSKC algorithm profile registry entry
							being created, such as encryption, Message Authentication Code (MAC),
							One Time Password (OTP), Digest. 
</dd>
<dt>URN:</dt>
<dd> The URN to be used to identify the profile. 
</dd>
<dt>Identifier Definition:</dt>
<dd> IANA will be asked to add a pointer to
							the specification containing information about the PSKC algorithm
							profile registration. 
</dd>
<dt>Algorithm Definition:</dt>
<dd> A reference to the stable document in
							which the algorithm being used with the PSKC is defined. 
</dd>
<dt>Registrant Contact:</dt>
<dd> Contact information about the party
							submitting the registration request. 
</dd>
<dt>PSKC Profiling:</dt>
<dd> Information about PSKC XML elements and
							attributes being used (or not used) with this specific profile of PSKC.
						
</dd>
</dl></blockquote><p>
				
</p>
<p> PSKC algorithm profile identifier registrations are to be subject to Expert
					Review as per <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226]. Updates can be provided based 
					on expert approval only. Based on expert approval, it is possible to mark entries as
   "deprecated".  A designated expert will be appointed by the IESG.

</p>
<p> IANA is asked to add an initial value to the registry based on the PSKC HOTP
					algorithm profile described in <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>. 
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.5"></a><h3>12.5.&nbsp;
PSKC Version Registry</h3>

<p>IANA is requested to create a registry for PSKC version numbers. The registry has
					the following structure: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  PSKC Version              | Specification
+---------------------------+----------------
| 1.0                       | [This document]
</pre></div><p>

				
</p>
<p> Standards action is required to define new versions of PSKC. It is not
					envisioned to deprecate, delete, or modify existing PSKC versions. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.6"></a><h3>12.6.&nbsp;
Key Usage Registry</h3>

<p>IANA is requested to create a registry for key usage. A description of the
					'KeyUsage' element can be found in <a class='info' href='#policy'>Section&nbsp;5<span> (</span><span class='info'>Key Policy</span><span>)</span></a>. The registry has the
					following structure: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Key Usage Token           | Specification
+---------------------------+-------------------------------
| OTP                       | [Section 5 of this document]
| CR                        | [Section 5 of this document]
| Encrypt                   | [Section 5 of this document]
| Integrity                 | [Section 5 of this document]
| Verify                    | [Section 5 of this document]
| Unlock                    | [Section 5 of this document]
| Decrypt                   | [Section 5 of this document]
| KeyWrap                   | [Section 5 of this document]
| Unwrap                    | [Section 5 of this document]
| Derive                    | [Section 5 of this document]
| Generate                  | [Section 5 of this document]
+---------------------------+-------------------------------
</pre></div><p>

				
</p>
<p>Expert Review is required to define new key usage tokens. Each registration
					request has to provide a description of the semantic. Using the same procedure
					it is possible to deprecate, delete, or modify existing key usage tokens. A designated 
					expert will be appointed by the IESG.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Security Considerations</h3>

<p>The portable key container carries sensitive information (e.g., cryptographic keys)
				and may be transported across the boundaries of one secure perimeter to another. For
				example, a container residing within the secure perimeter of a back-end provisioning
				server in a secure room may be transported across the internet to an end-user device
				attached to a personal computer. This means that special care must be taken to
				ensure the confidentiality, integrity, and authenticity of the information contained
				within.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Payload Confidentiality</h3>

<p>By design, the container allows two main approaches to guaranteeing the
					confidentiality of the information it contains while transported. 
</p>
<p>First, the container key data payload may be encrypted.
</p>
<p>In this case no transport layer security is required. However, standard security
					best practices apply when selecting the strength of the cryptographic algorithm
					for payload encryption. 
					Symmetric cryptographic cipher should be used - the
					longer the cryptographic key, the stronger the protection. Please see <a class='info' href='#SymmetricKeyProtectionDescription'>Section&nbsp;6.1<span> (</span><span class='info'>Encryption based on Pre-Shared Keys</span><span>)</span></a> for recommendations of payload protection using symmetric cryptographic ciphers.
					 In cases where the exchange of key encryption keys
					between the sender and the receiver is not possible, asymmetric encryption of
					the secret key payload may be employed, see <a class='info' href='#AsymmetricKeyProtectionDescription'>Section&nbsp;6.3<span> (</span><span class='info'>Encryption based on Asymmetric Keys</span><span>)</span></a> . Similarly to symmetric key cryptography,
					the stronger the asymmetric key, the more secure the protection is. 
</p>
<p>If the payload is encrypted with a method that uses one of the password-based
					encryption methods provided above, the payload may be subjected to password
					dictionary attacks to break the encryption password and recover the information.
					Standard security best practices for selection of strong encryption passwords
					apply.
</p>
<p>Practical implementations should use PBESalt and PBEIterationCount when PBE
					encryption is used. Different PBESalt value per key container should be used for
					best protection.
</p>
<p>The second approach to protecting the confidentiality of the payload is based on
					using transport layer security. The secure channel established between the
					source secure perimeter (the provisioning server from the example above) and the
					target perimeter (the device attached to the end-user computer) utilizes
					encryption to transport the messages that travel across. No payload encryption
					is required in this mode. Secure channels that encrypt and digest each message
					provide an extra measure of security, especially when the signature of the
					payload does not encompass the entire payload. 
</p>
<p>Because of the fact that the plain text payload is protected only by the
					transport layer security, practical implementation must ensure protection
					against man-in-the-middle attacks. Validating the secure channel end-points is
					critically important for eliminating intruders that may compromise the
					confidentiality of the payload.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Payload Integrity</h3>

<p>The portable symmetric key container provides a mean to guarantee the integrity
					of the information it contains through digital signatures. For best security
					practices, the digital signature of the container should encompass the entire
					payload. This provides assurances for the integrity of all attributes. It also
					allows verification of the integrity of a given payload even after the container
					is delivered through the communication channel to the target perimeter and
					channel message integrity check is no longer possible. 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
Payload Authenticity</h3>

<p>The digital signature of the payload is the primary way of showing its
					authenticity. The recipient of the container may use the public key associated
					with the signature to assert the authenticity of the sender by tracing it back
					to a preloaded public key or certificate. Note that the digital signature of the
					payload can be checked even after the container has been delivered through the
					secure channel of communication.
</p>
<p>A weaker payload authenticity guarantee may be provided by the transport layer if
					it is configured to digest each message it transports. However, no authenticity
					verification is possible once the container is delivered at the recipient end.
					This approach may be useful in cases where the digital signature of the
					container does not encompass the entire payload. 
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Contributors</h3>

<p>We would like Hannes Tschofenig for his text contributions to this document.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Acknowledgements</h3>

<p> The authors of this draft would like to thank the following people for their
				feedback: Apostol Vassilev, Shuh Chang, Jon Martinson, Siddhart Bajaj, Stu Vaeth,
				Kevin Lewis, Philip Hallam-Baker, Andrea Doherty, Magnus Nystrom, Tim Moses, Anders
				Rundgren, Sean Turner and especially Robert Philpott. 
</p>
<p>We would like to thank Sean Turner for his draft review in January 2009. We would
				also like to thank Anders Rundgren for triggering the discussion regarding to the
				selection of encryption algorithms (KW-AES-128 vs. AES-128-CBC) and his input on the
				keyed message digest computation.
</p>
<p>This work is based on earlier work by the members of OATH (Initiative for Open
				AuTHentication), see <a class='info' href='#OATH'>[OATH]<span> (</span><span class='info'>, &ldquo;Initiative for Open AuTHentication,&rdquo; .</span><span>)</span></a>, to specify a format that can be freely
				distributed to the technical community.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="PKCS5">[PKCS5]</a></td>
<td class="author-text">RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; Version&nbsp;2.0, URL:&nbsp;http://www.rsasecurity.com/rsalabs/pkcs/, March&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">&ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4288">[RFC4288]</a></td>
<td class="author-text">Freed, N. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4288">Media Type Specifications and Registration Procedures</a>,&rdquo; BCP&nbsp;13, RFC&nbsp;4288, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4514">[RFC4514]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4514">Lightweight Directory Access Protocol (LDAP): String Representation of
						Distinguished Names</a>,&rdquo; RFC&nbsp;4514, June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLDSIG">[XMLDSIG]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; URL:&nbsp;http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/, W3C&nbsp;Recommendation, February&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLENC">[XMLENC]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; URL:&nbsp;http://www.w3.org/TR/xmlenc-core/, W3C&nbsp;Recommendation, December&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLENC11">[XMLENC11]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML Encryption Syntax and Processing Version 1.1.,&rdquo; URL:&nbsp;http://www.w3.org/TR/2009/WD-xmlenc-core1-20090730, W3C&nbsp;Recommendation, July&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AESKWPAD">[AESKWPAD]</a></td>
<td class="author-text">Housley, R. and M. Dworkin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-housley-aes-key-wrap-with-pad-02.txt">Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm</a>,&rdquo; March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="CAP">[CAP]</a></td>
<td class="author-text">MasterCard International, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2200.txt">Chip Authentication Program Functional Architecture</a>,&rdquo; September&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSKPP">[DSKPP]</a></td>
<td class="author-text">Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; Internet Draft&nbsp;Informational, URL:&nbsp;http://www.ietf.org/internet-drafts/draft-ietf-keyprov-dskpp-07.txt, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="HOTP">[HOTP]</a></td>
<td class="author-text">MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;<a href="http://tools.ietf.org/html/rfc4226">HOTP: An HMAC-Based One Time Password Algorithm</a>,&rdquo; RFC&nbsp;4226, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="LUHN">[LUHN]</a></td>
<td class="author-text">Luhn, H., &ldquo;<a href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=2950048">Luhn algorithm</a>,&rdquo; US Patent&nbsp;2950048, August&nbsp;1960 (<a href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=2950048">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST800-57">[NIST800-57]</a></td>
<td class="author-text">Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;NIST Special Publication 800-57, Recommendation for Key Management  Part
						1: General (Revised),&rdquo; NIST Special Publication&nbsp;800-57, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="OATH">[OATH]</a></td>
<td class="author-text">&ldquo;Initiative for Open AuTHentication,&rdquo; URL:&nbsp;http://www.openauthentication.org.</td></tr>
<tr><td class="author-text" valign="top"><a name="PSKC-ALGORITHM-PROFILES">[PSKC-ALGORITHM-PROFILES]</a></td>
<td class="author-text">Hoyer, P., Pei, M., Machani, S., and A. Doherty, &ldquo;Additional Portable Symmetric Key Container (PSKC) Algorithm Profiles,&rdquo; Internet Draft&nbsp;Informational, URL:&nbsp;http://tools.ietf.org/html/draft-hoyer-keyprov-pskc-algorithm-profiles-00, December&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text">Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifiers (URI): Generic Syntax</a>,&rdquo; RFC&nbsp;3986, January&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLNS">[XMLNS]</a></td>
<td class="author-text">&ldquo;Namespaces in XML,&rdquo; W3C Recommendation&nbsp;, URL:&nbsp;http://www.w3.org/TR/1999/REC-xml-names-19990114, January&nbsp;1999.</td></tr>
</table>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Use Cases</h3>

<p>This section describes a comprehensive list of use cases that inspired the
				development of this specification. These requirements were used to derive the
				primary requirement that drove the design. These requirements are covered in the
				next section.
</p>
<p>These use cases also help in understanding the applicability of this specification to
				real world situations.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Online Use Cases</h3>

<p>This section describes the use cases related to provisioning the keys using an
					online provisioning protocol such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Transport of keys from Server to Cryptographic Module</h3>

<p>For example, a mobile device user wants to obtain a symmetric key for use
						with a Cryptographic Module on the device. The Cryptographic Module from
						vendor A initiates the provisioning process against a provisioning system
						from vendor B using a standards-based provisioning protocol such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2009.</span><span>)</span></a>. The provisioning entity delivers one or more keys in a
						standard format that can be processed by the mobile device.
</p>
<p>For example, in a variation of the above, instead of the user's mobile phone,
						a key is provisioned in the user's soft token application on a laptop using
						a network-based online protocol. As before, the provisioning system delivers
						a key in a standard format that can be processed by the soft token on the
						PC.
</p>
<p>For example, the end-user or the key issuer wants to update or configure an
						existing key in the Cryptographic Module and requests a replacement key
						container. The container may or may not include a new key and may include
						new or updated key attributes such as a new counter value in HOTP key case,
						a modified response format or length, a new friendly name, etc.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Transport of keys from Cryptographic Module to Cryptographic Module</h3>

<p>For example, a user wants to transport a key from one Cryptographic Module to
						another. There may be two cryptographic modules, one on a computer one on a
						mobile phone, and the user wants to transport a key from the computer to the
						mobile phone. The user can export the key and related data in a standard
						format for input into the other Cryptographic Module.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
Transport of keys from Cryptographic Module to Server</h3>

<p>For example, a user wants to activate and use a new key and related data
						against a validation system that is not aware of this key. This key may be
						embedded in the Cryptographic Module (e.g. SD card, USB drive) that the user
						has purchased at the local electronics retailer. Along with the
						Cryptographic Module, the user may get the key on a CD or a floppy in a
						standard format. The user can now upload via a secure online channel or
						import this key and related data into the new validation system and start
						using the key.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.4"></a><h3>A.1.4.&nbsp;
Server to server Bulk import/export of keys</h3>

<p>From time to time, a key management system may be required to import or
						export keys in bulk from one entity to another. 
</p>
<p>For example, instead of importing keys from a manufacturer using a file, a
						validation server may download the keys using an online protocol. The keys
						can be downloaded in a standard format that can be processed by a validation
						system.
</p>
<p>For example, in a variation of the above, an Over-The-Air (OTA) key
						provisioning gateway that provisions keys to mobile phones may obtain key
						material from a key issuer using an online protocol. The keys are delivered
						in a standard format that can be processed by the key provisioning gateway
						and subsequently sent to the end-user's mobile phone.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Offline Use Cases</h3>

<p>This section describes the use cases relating to offline transport of keys from
					one system to another, using some form of export and import model. 
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
Server to server Bulk import/export of keys</h3>

<p>For example, Cryptographic Modules such as OTP authentication tokens, may
						have their symmetric keys initialized during the manufacturing process in
						bulk, requiring copies of the keys and algorithm data to be loaded into the
						authentication system through a file on portable media. The manufacturer
						provides the keys and related data in the form of a file containing records
						in standard format, typically on a CD. Note that the token manufacturer and
						the vendor for the validation system may be the same or different. Some
						crypto modules will allow local PIN management (the device will have a PIN
						pad) hence random initial PINs set at manufacturing should be transmitted
						together with the respective keys they protect.
</p>
<p>For example, an enterprise wants to port keys and related data from an
						existing validation system A into a different validation system B. The
						existing validation system provides the enterprise with a functionality that
						enables export of keys and related data (e.g. for OTP authentication tokens)
						in a standard format. Since the OTP tokens are in the standard format, the
						enterprise can import the token records into the new validation system B and
						start using the existing tokens. Note that the vendors for the two
						validation systems may be the same or different. 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Requirements</h3>

<p>This section outlines the most relevant requirements that are the basis of this work.
				Several of the requirements were derived from use cases described above. </p>
<blockquote class="text"><dl>
<dt>R1:</dt>
<dd>The format MUST support transport of multiple types of symmetric keys and
						related attributes for algorithms including HOTP, other OTP,
						challenge-response, etc.
</dd>
<dt>R2:</dt>
<dd>The format MUST handle the symmetric key itself as well of attributes that
						are typically associated with symmetric keys. Some of these attributes may
						be 
<ul class="text">
<li>Unique Key Identifier
</li>
<li>Issuer information
</li>
<li>Algorithm ID
</li>
<li>Algorithm mode
</li>
<li>Issuer Name
</li>
<li>Key friendly name
</li>
<li>Event counter value (moving factor for OTP algorithms)
</li>
<li>Time value
</li>
</ul>
					
</dd>
<dt>R3:</dt>
<dd>The format SHOULD support both offline and online scenarios. That is it
						should be serializable to a file as well as it should be possible to use
						this format in online provisioning protocols such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2009.</span><span>)</span></a>
</dd>
<dt>R4:</dt>
<dd>The format SHOULD allow bulk representation of symmetric keys
</dd>
<dt>R5:</dt>
<dd>The format SHOULD allow bulk representation of PINs related to specific keys
</dd>
<dt>R6:</dt>
<dd>The format SHOULD be portable to various platforms. Furthermore, it SHOULD be
						computationally efficient to process.
</dd>
<dt>R7:</dt>
<dd>The format MUST provide appropriate level of security in terms of data
						encryption and data integrity. 
</dd>
<dt>R8:</dt>
<dd>For online scenarios the format SHOULD NOT rely on transport level security
						(e.g., SSL/TLS) for core security requirements.
</dd>
<dt>R9:</dt>
<dd>The format SHOULD be extensible. It SHOULD enable extension points allowing
						vendors to specify additional attributes in the future.
</dd>
<dt>R10:</dt>
<dd>The format SHOULD allow for distribution of key derivation data without the
						actual symmetric key itself. This is to support symmetric key management
						schemes that rely on key derivation algorithms based on a pre-placed master
						key. The key derivation data typically consists of a reference to the key,
						rather than the key value itself.
</dd>
<dt>R11:</dt>
<dd>The format SHOULD allow for additional lifecycle management operations such
						as counter resynchronization. Such processes require confidentiality between
						client and server, thus could use a common secure container format, without
						the transfer of key material.
</dd>
<dt>R12:</dt>
<dd>The format MUST support the use of pre-shared symmetric keys to ensure
						confidentiality of sensitive data elements. 
</dd>
<dt>R13:</dt>
<dd>The format MUST support a password-based encryption (PBE) <a class='info' href='#PKCS5'>[PKCS5]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; March&nbsp;1999.</span><span>)</span></a> scheme to ensure security of sensitive data elements.
						This is a widely used method for various provisioning scenarios.
</dd>
<dt>R14:</dt>
<dd>The format SHOULD support asymmetric encryption algorithms such as RSA to
						ensure end-to-end security of sensitive data elements. This is to support
						scenarios where a pre-set shared key encryption key is difficult to use.
					
</dd>
</dl></blockquote><p>
			
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philip Hoyer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ActivIdentity, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">117 Waterloo Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">London, SE1  8UL</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+44 (0) 20 7960 0220</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:phoyer@actividentity.com">phoyer@actividentity.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mingliang Pei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VeriSign, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">487 E. Middlefield Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  94043</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 650 426 5173</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mpei@verisign.com">mpei@verisign.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salah Machani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Diversinet, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2225 Sheppard Avenue East</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 1801</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Toronto, Ontario  M2J 5C2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 416 756 2324 Ext. 321</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:smachani@diversinet.com">smachani@diversinet.com</a></td></tr>
</table>
</body></html>
