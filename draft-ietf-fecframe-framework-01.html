<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Forward Error Correction (FEC)
    Framework</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Forward Error Correction (FEC)
    Framework">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">FEC Framework Working Group</td><td class="header">M. Watson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Digital Fountain</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">November 17, 2007</td></tr>
<tr><td class="header">Expires: May 20, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Forward Error Correction (FEC)
    Framework<br />draft-ietf-fecframe-framework-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 20, 2008.</p>

<h3>Abstract</h3>

<p>This document describes for a framework for using forward error
      correction (FEC) codes with applications in public and private IP
      networks to provide protection against packet loss. The framework
      supports applying Forward Error Correction to arbitrary packet flows
      over unreliable transport and is primarily intended for real-time, or
      streaming, media. This framework can be used to define Content Delivery
      Protocols that provide Forward Error Correction for streaming media
      delivery or other packet flows. Content Delivery Protocols defined using
      this framework can support any FEC Scheme (and associated FEC codes)
      which is compliant with various requirements defined in this document.
      Thus, Content Delivery Protocols can be defined which are not specific
      to a particular FEC Scheme and FEC Schemes can be defined which are not
      specific to a particular Content Delivery Protocol.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Definitions/Abbreviations<br />
<a href="#anchor3">3.</a>&nbsp;
Requirements notation<br />
<a href="#anchor4">4.</a>&nbsp;
Architecture Overview<br />
<a href="#anchor5">5.</a>&nbsp;
Procedural overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
General<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#senderoperation">5.2.</a>&nbsp;
Sender Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#receiveroperation">5.3.</a>&nbsp;
Receiver Operation<br />
<a href="#anchor7">6.</a>&nbsp;
Protocol Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.1.</a>&nbsp;
General<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sourceblock">6.2.</a>&nbsp;
Structure of the source block<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sourcepackets">6.3.</a>&nbsp;
Packet format for FEC Source packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#repairpackets">6.4.</a>&nbsp;
Packet Format for FEC Repair packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.5.</a>&nbsp;
FEC Framework Configuration Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fecscheme">6.6.</a>&nbsp;
FEC Scheme requirements<br />
<a href="#TransportProtocols">7.</a>&nbsp;
Transport Protocols<br />
<a href="#anchor10">8.</a>&nbsp;
Congestion Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#normativecongestion">8.1.</a>&nbsp;
Normative requirements<br />
<a href="#anchor11">9.</a>&nbsp;
Security Considerations<br />
<a href="#iana">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor12">11.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Many applications have a requirement to transport a continuous stream
      of packetised data from a source (sender) to one or more destinations
      (receivers) over networks which do not provide guaranteed packet
      delivery. Primary examples are real-time, or streaming, media
      applications such as broadcast, multicast or on-demand audio, video or
      multimedia.
</p>
<p>Forward Error Correction is a well-known technique for improving
      reliability of packet transmission over networks which do not provide
      guaranteed packet delivery, especially in multicast and broadcast
      applications. The FEC Building Block defined in <a class='info' href='#RFC5052'>[RFC5052]<span> (</span><span class='info'>Watson, M., Luby, M., and L. Vicisano, &ldquo;Forward Error Correction (FEC) Building Block,&rdquo; August&nbsp;2007.</span><span>)</span></a> provides a framework for definition of Content
      Delivery Protocols (CDPs) for object delivery (including, primarily,
      file delivery) which make use of separately defined FEC Schemes. Any CDP
      defined according to the requirements of the FEC Building Block can then
      easily be used with any FEC Scheme which is also defined according to
      the requirements of the FEC Building Block. (Note that the term "Forward
      Erasure Correction" is sometimes used, 'erasures' being a type of error
      in which data is lost and this loss can be detected, rather than being
      received in corrupted form - the focus of this document is strictly on
      erasures, however the term Forward Error Correction is more widely
      used).
</p>
<p>This document defines a framework for the definition of CDPs which
      provide for FEC protection of arbitrary packet flows over unreliable
      transports such as UDP. As such, this document complements the FEC
      Building Block of <a class='info' href='#RFC5052'>[RFC5052]<span> (</span><span class='info'>Watson, M., Luby, M., and L. Vicisano, &ldquo;Forward Error Correction (FEC) Building Block,&rdquo; August&nbsp;2007.</span><span>)</span></a>, by providing for the
      case of arbitrary packet flows over unreliable transport, the same kind
      of framework as that document provides for object delivery. This
      document does not define a complete Content Delivery Protocol, but
      rather defines only those aspects that are expected to be common to all
      Content Delivery Protocols based on this framework.
</p>
<p>This framework does not define how the flows to be protected are
      determined, nor how the details of the protected flows and the FEC
      streams which protect them are communicated from sender to receiver. It
      is expected that any complete Content Delivery Protocol specification
      which makes use of this framework will address these signalling
      requirements. However, this document does specify the information which
      is required by the FEC Framework at the sender and receiver - for
      example details of the flows to be FEC protected, the flow(s) that will
      carry the FEC protection data and an opaque container for
      FEC-Scheme-specific information.
</p>
<p>FEC Schemes designed for use with this framework must fulfil a number
      of requirements defined in this document. Note that these requirements
      are different from those defined in <a class='info' href='#RFC5052'>[RFC5052]<span> (</span><span class='info'>Watson, M., Luby, M., and L. Vicisano, &ldquo;Forward Error Correction (FEC) Building Block,&rdquo; August&nbsp;2007.</span><span>)</span></a> for
      FEC Schemes for object delivery. However there is a great deal of
      commonality and FEC Schemes defined for object delivery may be easily
      adapted for use with the framework defined here.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Definitions/Abbreviations</h3>

<p></p>
<blockquote class="text"><dl>
<dt>'FEC'</dt>
<dd>Forward Error Correction.
</dd>
<dt>'AL-FEC'</dt>
<dd>Application Layer Forward Error
          Correction
</dd>
<dt>'FEC Framework'</dt>
<dd>A protocol framework for definition of
          Content Delivery Protocols using FEC, such as the framework defined
          in this document.
</dd>
<dt>'Source data flow'</dt>
<dd>The packet flow or flows to which
          FEC protection is to be applied.
</dd>
<dt>'Repair data flow'</dt>
<dd>The packet flow or flows carrying
          forward error correction data
</dd>
<dt>'Source protocol'</dt>
<dd>A protocol used for the source data
          flow being protected - e.g. RTP.
</dd>
<dt>'Transport protocol'</dt>
<dd>The protocol used for transport
          of the source data flow being protected - e.g. UDP, DCCP.
</dd>
<dt>'Transport payload'</dt>
<dd>Data used as the payload for the
          transport layer (e.g. UDP or DCCP packet payload)
</dd>
<dt>'Application protocol'</dt>
<dd>Control protocols used to
          establish and control the source data flow being protected - e.g.
          RTSP.
</dd>
<dt>'FEC Code'</dt>
<dd>An algorithm for encoding data such that
          the encoded data flow is resiliant to data loss or corruption.
</dd>
<dt>'FEC Scheme'</dt>
<dd>A specification which defines the
          additional protocol aspects required to use a particular FEC code
          with the FEC Framework, or (in the context of RMT), with the RMT FEC
          Building Block.
</dd>
<dt>'Source Block'</dt>
<dd>the group of source data packets which
          are to be FEC protected as a single block
</dd>
<dt>'Protection amount'</dt>
<dd>The relative increase in data sent
          due to the use of FEC.
</dd>
<dt>FEC Framework Configuration Information:</dt>
<dd>Information
          which controls the operation of the FEC Framework.
</dd>
<dt>FEC Payload ID:</dt>
<dd>Information which identifies the
          contents of a packet with respect to the FEC Scheme.
</dd>
<dt>Source FEC Payload ID:</dt>
<dd>An FEC Payload ID specifically
          for use with source packets.
</dd>
<dt>Repair FEC Payload ID:</dt>
<dd>An FEC Payload ID specifically
          for use with repair packets.
</dd>
<dt>Content Delivery Protocol (CDP):</dt>
<dd>A complete
          application protocol specification which, through the use of the
          framework defined in this document, is able to make use of FEC
          Schemes to provide Forward Error Correction capabilities.
</dd>
</dl></blockquote>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Architecture Overview</h3>

<p>The FEC Framework is described in terms of an additional protocol
      layer between the transport layer (e.g. UDP or DCCP) and Application and
      Transport Protocols running over this transport layer. Examples of such
      protocols are RTP, RTCP, etc. As such, the data path interface between
      the FEC Framework and both underlying and overlying layers can be
      thought of as being the same as the standard interface to the transport
      layer - i.e. the data exchanged consists of datagram payloads each
      associated with a single transport flow identified by the standard
      5-tuple { Source IP Address, Source Transport Port, Destination IP
      Address, Destination Transport Port, Transport Protocol }.
</p>
<p>The FEC Framework makes use of an FEC Scheme, in a similar sense to
      that defined in <a class='info' href='#RFC5052'>[RFC5052]<span> (</span><span class='info'>Watson, M., Luby, M., and L. Vicisano, &ldquo;Forward Error Correction (FEC) Building Block,&rdquo; August&nbsp;2007.</span><span>)</span></a> and uses the terminology
      of that document. The FEC Scheme provides FEC encoding and decoding and
      describes the protocol fields and or procedures used to identify packet
      payload data in the context of the FEC Scheme. The interface between the
      FEC Framework and an FEC Scheme, which is described in this document, is
      a logical one, which exists for specification purposes only. At an
      encoder, the FEC Framework passes groups of transport packet payloads to
      the FEC Scheme for FEC Encoding. The FEC Scheme returns FEC repair
      packet payloads, encoded FEC Payload ID information for each of the
      repair packets and, in some cases, encoded FEC Payload ID information
      for each of the source packets. At a decoder, the FEC Framework passes
      transport packet payloads (source and repair) to the FEC Scheme and the
      FEC Scheme returns additional recovered source packet payloads.
</p>
<p>This document defines certain FEC Framework Configuration Information
      which MUST be available to both sender and receiver(s). For example,
      this information includes the specification of the transport flows which
      are to be FEC protected, specification of the transport flow(s) which
      will carry the FEC protection (repair) data and the relationship(s)
      between these 'source' and 'repair' flows (i.e. which source flow(s) are
      protected by each repair flow. The FEC Framework Configuration
      Information also includes information fields which are specific to the
      FEC Scheme. This information is analagous to the FEC Object Transmission
      Information defined in <a class='info' href='#RFC5052'>[RFC5052]<span> (</span><span class='info'>Watson, M., Luby, M., and L. Vicisano, &ldquo;Forward Error Correction (FEC) Building Block,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
</p>
<p>The FEC Framework does not define how the FEC Framework Configuration
      Information for the stream is communicated from sender to receiver. This
      must be defined by any Content Delivery Protocol specification as
      described in the following sections.
</p>
<p>In this architecture we assume that the interface to the transport
      layer supports the concepts of payloads to be transported and
      identification transport flows on which those payloads are transported.
      Since this is an interface internal to the architecture, we do not
      specify this interface explicitly, except to say that transport flows
      which are distinct from the transport layer point of view (for example,
      distinct UDP flows as identified by the UDP source/destination
      ports/addresses) are also distinct on the interface between the
      transport layer and the FEC Framework.
</p>
<p>The architecture outlined above is illustrated in the <a class='info' href='#architecturefigure'>Figure&nbsp;1<span> (</span><span class='info'>FEC Framework Architecture</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="architecturefigure"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +--------------------------------------------+
  |                                            |
  |                 Application                |
  |                                            |
  +--------------------------------------------+
                         ^
                         |
                         v
+ - - - - - - -- - - - - - - - - - - - - - - - - +
|                                                |
  +--------------------------------------------+
| |                                            | |
  |            Application Layer               |
| |                                            | |
  +--------------------------------------------+
| +---------------------------------+     |      |
  |                                 |     |
| | Application/Transport  Protocol |     |      |
  |           (e.g. RTP)            |     |-Configuration/Coordination
| +---------------------------------+     |      |
                     ^                    |
|                    |  Transport flows   |      |
                     v                    v
| +--------------------------------------------+ |    +----------------+
  |                                            |      |                |
| |      FEC Framework (this document)         |------|   FEC Scheme   |
  |                                            |      |                |
| +--------------------------------------------+ |    +----------------+
                     ^
|                    |  Transport flows          |
                     v
| +--------------------------------------------+ |
  |                                            |
| |          Transport Layer (e.g. UDP)        | |
  |                                            |
  +--------------------------------------------+
| +--------------------------------------------+ |
  |                                            |
| |                  IP                        | |
  |                                            |
| +--------------------------------------------+ |
 Content Delivery Protocol
+ - - - - - - - - - - - - - - -  - - - - - - - - +</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: FEC Framework Architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Procedural overview</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
General</h3>

<p>The mechanism defined in this document does not place any
        restrictions on the source transport payloads which can be protected
        together, except that the source transport payload is carried over a
        supported transport protocol (See <a class='info' href='#TransportProtocols'>Section&nbsp;7<span> (</span><span class='info'>Transport Protocols</span><span>)</span></a>). The data may be from multiple
        transport flows that are protected jointly. The FEC framework handles
        the packet flows as a sequence of 'source blocks' each consisting of a
        set of source transport payloads, possibly from multiple flows which
        are to be protected together. For example, each source block may be
        constructed from those source transport payloads related to a
        particular segment in time of the flow.
</p>
<p>At the sender, the FEC Framework passes the payloads for a given
        block to the FEC Scheme for FEC encoding. The FEC Scheme performs the
        FEC encoding operation and returns the following information: </p>
<ul class="text">
<li>optionally, encoded FEC Payload IDs for each of the source
            payloads
</li>
<li>one or more FEC repair packet payloads
</li>
<li>encoded FEC Payload IDs for each of the repair packet
            payloads
</li>
</ul><p>The FEC framework then performs two operations: Firstly, it
        appends the FEC payload IDs, if provided, to each of the source
        transport payloads, and sends the resulting packets, known as 'FEC
        source packets', to the receiver and secondly it places the provided
        'FEC repair packet payloads' and corresponding 'FEC Repair Payload
        IDs' appropriately to construct 'FEC repair packets' and send them to
        the receiver. Note that FEC repair packets MAY be sent to a different
        multicast group or groups from the source packets.
</p>
<p>This document does not define how the sender determines which
        source transport payloads are included in which source blocks or the
        sending order and timing of FEC source and FEC repair packets. A
        specific Content Delivery Protocol MAY define this mapping or it MAY
        be left as implementation dependent at the sender. However, a CDP
        specification MUST define how a receiver determines the length of time
        it should wait to receive FEC repair packets for any given source
        block. The sequence of operations at the sender is described in more
        detail in <a class='info' href='#senderoperation'>Section&nbsp;5.2<span> (</span><span class='info'>Sender Operation</span><span>)</span></a>.
</p>
<p>At the receiver, original source transport payloads are recovered
        by the FEC Framework directly from any FEC Source packets received
        simply by removing the Source FEC Payload ID, if present. The receiver
        also passes the contents of the received FEC Source transport
        payloads, plus their FEC Payload IDs to the FEC Scheme for possible
        decoding.
</p>
<p>If any FEC source transport payloads related to a given source
        block have been lost, then the FEC Scheme may perform FEC decoding to
        recover the missing source transport payloads (assuming sufficient FEC
        Source and FEC Repair packets related to that source block have been
        received).
</p>
<p>Note that the receiver may need to buffer received source packets
        to allow time for the FEC Repair packets to arrive and FEC decoding to
        be performed before some or all of the received or recovered packets
        are passed to the application. If such a buffer is not provided, then
        the application must be able to deal with the severe re-ordering of
        packets that will be required. However, such buffering is Content
        Delivery Protocol and/or implementation-specific and is not specified
        here. The receiver operation is described in more detail in <a class='info' href='#receiveroperation'>Section&nbsp;5.3<span> (</span><span class='info'>Receiver Operation</span><span>)</span></a> 
</p>
<p>The FEC Source packets MUST contain information which identifies
        the source block and the position within the source block (in terms
        specific to the FEC Scheme) occupied by the packet. This information
        is known as the 'Source FEC Payload ID'. The FEC Scheme is responsible
        for defining and interpreting this information. This information MAY
        be encoded into a specific field within the FEC Source packet format
        defined in this specification, called the Explicit Source FEC Payload
        ID field. The exact contents and format of the Explicit Source FEC
        Payload ID field are defined by the FEC Scheme. Alternatively, the FEC
        Scheme MAY define how the Source FEC Payload ID is derived from other
        fields within the source packets. This document defines the way that
        the Explicit Source FEC Payload ID field is appended to source packets
        to form FEC Source packets.
</p>
<p>The FEC Repair packets MUST contain information which identifies
        the source block and the relationship between the contained repair
        payloads and the original source block. This is known as the 'Repair
        FEC Payload ID'. This information MUST be encoded into a specific
        field, the Repair FEC Payload ID field, the contents and format of
        which are defined by the FEC Scheme.
</p>
<p>The FEC Scheme MAY use different FEC Payload ID field formats for
        FEC Source packets and FEC Repair packets.
</p>
<a name="senderoperation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Sender Operation</h3>

<p>It is assumed that the sender has constructed or received original
        data packets for the session. These may be RTP, RTCP, MIKEY or indeed
        any other type of packet. The following operations, illustrated in
        <a class='info' href='#senderfigure'>Figure&nbsp;2<span> (</span><span class='info'>Sender operation</span><span>)</span></a> describe a possible way to
        generate compliant FEC Source packet and FEC repair packet streams:
        </p>
<blockquote class="text">
<p>1. Source transport payloads are provided by the
            application.
</p>
<p>2. A source block is constructed as specified in <a class='info' href='#sourceblock'>Section&nbsp;6.2<span> (</span><span class='info'>Structure of the source block</span><span>)</span></a>.
</p>
<p>3. The source block is passed to the FEC Scheme for FEC
            encoding. The Source FEC Payload ID information of each Source
            packet is determined by the FEC Scheme. If required by the FEC
            Scheme the Source FEC Payload ID is encoded into the Explicit
            Source FEC Payload ID field.
</p>
<p>4. The FEC Scheme performs FEC Encoding, generating repair
            packet payloads from a source block and a Repair FEC Payload ID
            field for each repair payload.
</p>
<p>5. The Explicit Source FEC Payload IDs (if used), Repair FEC
            Payload IDs and repair packet payloads are provided back from the
            FEC Scheme to the FEC Framework.
</p>
<p>6. The FEC Framework constructs FEC Source packets according to
            <a class='info' href='#sourcepackets'>Section&nbsp;6.3<span> (</span><span class='info'>Packet format for FEC Source packets</span><span>)</span></a> and FEC Repair packets
            according to <a class='info' href='#repairpackets'>Section&nbsp;6.4<span> (</span><span class='info'>Packet Format for FEC Repair packets</span><span>)</span></a>
</p>
<p>using the FEC Payload IDs and repair packet payloads provided
            by the FEC Scheme. 
</p>
<p>7. The FEC Source and FEC Repair packets are sent using normal
            transport layer procedures. The port(s) and multicast group(s) to
            be used for FEC Repair packets are defined in the FEC Framework
            Configuration Information. The FEC Source packets are sent using
            the same transport flow identification information as would have
            been used for the original source packets if the FEC Framework
            were not present (for example, in the UDP case, the UDP source and
            destination addresses and ports on the eventual IP FEC Source
            Packet will be the same whether or not the FEC Framework is
            applied). 
</p>
<p>
</p>
</blockquote>
<br /><hr class="insert" />
<a name="senderfigure"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +-------------------------------------+
  |                                     |
  |            Application              |
  |                                     |
  +-------------------------------------+
                     |
                     | (1) Source transport payloads
                     |
                     v
  +-------------------------------------+                                +---------------------+
  |           FEC Framework             |                                |                     |
  |                                     |-------------------------------&gt;|     FEC Scheme      |
  |   (2) Construct source blocks       |      (3) Source Block          |                     |
  |                                     |                                |  (4) FEC Encoding   |
  |   (6) Construct FEC source packets  |&lt;-------------------------------|                     |
  |       and FEC repair packets        | (5) Ex. Source FEC Payload Ids,|                     |
  +-------------------------------------+     Repair FEC Payload Ids,    +---------------------+
                     |                        Repair payloads
                     |
                     | (7) FEC Source packets and FEC repair packets
                     v
  +-------------------------------------+
  |                                     |
  |      Transport Layer (e.g. UDP)     |
  |                                     |
  +-------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Sender operation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="receiveroperation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Receiver Operation</h3>

<p>The following describes a possible receiver algorithm, illustrated
        in <a class='info' href='#receiverfigure'>Figure&nbsp;3<span> (</span><span class='info'>Receiver Operation</span><span>)</span></a>, when receiving an FEC source
        or repair packet: </p>
<blockquote class="text">
<p>1. FEC Source Packets and FEC Repair packets are received and
            passed to the FEC Framework. The type of packet (Source or Repair)
            and the transport flow to which it belongs (in the case of source
            packets ) is indicated by the transport flow information which
            identifies the flow at the transport layer (for example source and
            destination ports and addresses in the case of UDP).
</p>
<p>2. The FEC Framework extracts the Explicit Source FEC Payload
            ID field (if present) from FEC Source Packets and the Repair FEC
            Payload ID from FEC Repair Packets.
</p>
<p>3. The Explicit Source FEC Payload IDs (if present), Repair FEC
            Payload IDs, FEC Source payloads and FEC Repair payloads are
            passed to the FEC Scheme.
</p>
<p>4. The FEC Scheme uses the received FEC Payload IDs (and
            derived FEC Source Payload IDs in the case that the Explicit
            Source FEC Payload ID field is not used) to group source and
            repair packets into source blocks. If at least one source packet
            is missing from a source block, and at least one repair packet has
            been received for the same source block then FEC decoding may be
            performed in order to recover missing source payloads. The FEC
            Scheme determines whether source packets have been lost and
            whether enough data for decoding of any or all of the missing
            source payloads in the source block has been received.
</p>
<p>5. The FEC Scheme returns the source transport payload to the
            FEC Framework in the form of source blocks containing received and
            decoded source packets and indications of any source packets which
            were missing and could not be decoded.
</p>
<p>6. The FEC Framework passes the received and recovered source
            packet payloads to the application.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="receiverfigure"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>  +-------------------------------------+
  |                                     |
  |            Application              |
  |                                     |
  +-------------------------------------+
                   ^
                   | (6) Source transport payloads
                   |
                   |
  +-------------------------------------+                                +---------------------+
  |           FEC Framework             |                                |                     |
  |                                     |&lt;-------------------------------|     FEC Scheme      |
  |   (2) Extract FEC Payload IDs and   | (5) Source Transport Payloads  |                     |
  |       pass Payloads and Payload IDs |                                |  (4) FEC Decoding   |
  |       to FEC Scheme                 |-------------------------------&gt;|                     |
  |                                     | (3) Ex. FEC Source Payload IDs,|                     |
  +-------------------------------------+     FEC Repair Payload IDs,    +---------------------+
                     ^                        FEC Source Payloads,
                     |                        FEC Repair Payloads
                     |
                     | (1) FEC Source packets and FEC repair packets
                     |
  +--------------------------------------------+
  |                                            |
  |          Transport Layer (e.g. UDP)        |
  |                                            |
  +--------------------------------------------+</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Receiver Operation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Note that the above procedure may result in a situation in which
        not all original source packets are recovered.
</p>
<p>Source packets which are correctly received and those which are
        reconstructed MAY be delivered to the application out of order and in
        a different order from the order of arrival at the receiver.
        Alternatively, buffering and packet re-ordering MAY be required to
        re-order received and reconstructed source packets into the order they
        were placed into the source block, if that is necessary according to
        the application.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Protocol Specification</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
General</h3>

<p>This section specifies the protocol elements for the FEC Framework.
        Three components of the protocol are defined in this document and are
        described in the following sections: </p>
<blockquote class="text">
<p>1. Construction of a source block from source payloads. The FEC
            code will be applied to this source block to produce the repair
            payloads.
</p>
<p>2. A format for packets containing source data.
</p>
<p>3. A format for packets containing repair data.
</p>
</blockquote><p>The operation of the FEC Framework is governed by certain FEC
        Framework Configuation Information. This configuration information is
        also defined in this section. A complete protocol specification that
        uses this framework MUST specify the means to determine and
        communicate this information between sender and receiver.
</p>
<a name="sourceblock"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Structure of the source block</h3>

<p>The FEC Framework and FEC Scheme exchange source transport payload
        in the form of source blocks. A source block is generated by the FEC
        Framework from an ordered sequence of source transport payloads. The
        allocation of transport payloads to blocks is dependent on the
        application. Note that some source transport payloads may not be
        included in any block. For each source transport payload included in a
        source block, the following information is provided to the FEC Scheme:
        </p>
<ul class="text">
<li>A description of the source transport flow with which the
            transport payload is associated (See 6.5)
</li>
<li>The source transport payload itself
</li>
<li>The length of the source transport payload
</li>
</ul>

<p>
</p>
<a name="sourcepackets"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Packet format for FEC Source packets</h3>

<p>The packet format for FEC Source packets MUST be used to transport
        the payload of an original source packet. As depicted in <a class='info' href='#sourcepacketfigure'>Figure&nbsp;4<span> (</span><span class='info'>Structure of the FEC packet format for FEC Source packets</span><span>)</span></a>, it consists of the original
        packet, optionally followed by the Explicit Source FEC Payload ID
        field. The FEC Scheme determines whether the Explicit Source FEC
        Payload ID field is required. This determination is specific to each
        transport flow. 
</p><br /><hr class="insert" />
<a name="sourcepacketfigure"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+------------------------------------+
|             IP header              |
+------------------------------------+
|          Transport header          |
+------------------------------------+
|     Original transport Payload     |
+------------------------------------+
|   Explicit Source FEC Payload ID   |
+------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Structure of the FEC packet format for FEC Source packets&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The FEC Source packets MUST be sent using the same transport flow
        as would have been used for the original source packets if the FEC
        Framework were not present. The Original transport Payload field MUST
        be identical to the source transport payload. The transport payload of
        the FEC Source packet MUST consist of the Original Transport Payload
        followed by the Explicit Source FEC Payload ID field, if required.
</p>
<p>The Explicit Source FEC Payload ID field contains information
        required to associate the source packet with a source block and for
        the operation of the FEC algorithm and is defined by the FEC Scheme.
        The format of the Source FEC Payload ID field is defined by the FEC
        Scheme. Note that in the case that the FEC Scheme or CDP defines a
        means to derive the Source FEC Payload ID from other information in
        the packet (for example the a sequence number of some kind used by the
        application protocol), then the Source FEC Payload ID field is not
        included in the packet. In this case the original source packet and
        FEC Source Packet are identical.
</p>
<p>Since the addition of the Explicit Source FEC Payload ID increases
        the packet length, then in applications where avoidance of IP packet
        fragmentation is a goal, Content Delivery Protocols SHOULD consider
        the Explicit Source FEC Payload ID size when determining the size of
        source transport payloads that will be delivered using the FEC
        Framework.
</p>
<p>Note: The Explicit Source FEC Payload ID is placed at the end of
        the packet so that in the case that Robust Header Compression <a class='info' href='#RFC3095'>[RFC3095]<span> (</span><span class='info'>Bormann, C., Burmeister, C., Degermark, M., Fukushima, H., Hannu, H., Jonsson, L-E., Hakenberg, R., Koren, T., Le, K., Liu, Z., Martensson, A., Miyazaki, A., Svanbro, K., Wiebke, T., Yoshimura, T., and H. Zheng, &ldquo;RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed,&rdquo; July&nbsp;2001.</span><span>)</span></a> or other header compression mechanisms are
        used and in the case that a ROHC profile is defined for the protocol
        carried within the transport payload (for example RTP), then ROHC will
        still be applied for the FEC Source packets. Applications that may be
        used with this Framework should consider that FEC Schemes may add this
        Explicit Source FEC Payload ID and thereby increase the packet
        size.
</p>
<a name="repairpackets"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Packet Format for FEC Repair packets</h3>

<p>The packet format for FEC Repair packets is shown in <a class='info' href='#repairpacketfigure'>Figure&nbsp;5<span> (</span><span class='info'>Packet format for repair packets</span><span>)</span></a>. The transport payload consists of
        a Repair FEC Payload ID field followed by repair data generated in the
        FEC encoding process. <br /><hr class="insert" />
<a name="repairpacketfigure"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+------------------------------------+
|             IP header              |
+------------------------------------+
|          Transport header          |
+------------------------------------+
|       Repair FEC Payload ID        |
+------------------------------------+
|          Repair Symbols            |
+------------------------------------+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Packet format for repair packets&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p>The Repair FEC Payload ID field contains information required for
        the operation of the FEC algorithm at the receiver. This information
        is defined by the FEC Scheme. The format of the Repair FEC Payload ID
        field is defined by the FEC Scheme.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
FEC Framework Configuration Information</h3>

<p>The FEC Framework Configuration Information is information that the
        FEC Framework needs in order to apply FEC protection to the transport
        flows. A complete Content Delivery Protocol specification that uses
        the framework specified here MUST include details of how this
        information is derived and communicated between sender and
        receiver.
</p>
<p>The FEC Framework Configuration Information includes identification
        of a set of source packet flows. For example, in the case of UDP, each
        packet flow is uniquely identified by a tuple { Source IP Address,
        Destination IP Address, Source UDP port, Destination UDP port }. Note
        that in some applications some of these fields may be wildcarded, so
        that the flow is identified by a subset of the fields and in
        particular in many applications the limited tuple { Destination IP
        Address, Destination UDP port } is sufficient.
</p>
<p>A single instance of the FEC Framework provides FEC protection for
        all packets of a specified set of source packet flows, by means of one
        or more packet flows consisting of repair packets. The FEC Framework
        Configuation Information includes, for each instance of the FEC
        Framework: </p>
<blockquote class="text">
<p>1. Identification of the packet flow(s) carrying FEC Repair
            packets, known as the FEC repair flow(s).
</p>
<p>2. For each source packet flow protected by the FEC repair
            flow(s): </p>
<blockquote class="text">
<p>a. Defintion of the packet flow carrying source packets
                (for example, by means of a tuple as describe above for
                UDP).
</p>
<p>b. An integer identifier for this flow definition (i.e.
                tuple). This identifier MUST be unique amongst all source
                packet flows which are protected by the same FEC repair
                flow.
</p>
</blockquote>

<p>3. The FEC Encoding ID, identifying the FEC Scheme
</p>
<p>4. The length of the Explicit Source FEC Payload Id, in
            bytes
</p>
<p>5. An opaque container for FEC-Scheme-specific information
</p>
</blockquote>

<p>Multiple instances of the FEC Framework, with separate and
        independent FEC Framework Configuration Information, may be present at
        a sender or receiver. A single instance of the FEC Framework protects
        all packets of all the source packet flows identified in (2) above
        i.e. all packets sent on those flows MUST be FEC Source packets as
        defined in <a class='info' href='#sourcepackets'>Section&nbsp;6.3<span> (</span><span class='info'>Packet format for FEC Source packets</span><span>)</span></a>. A single source
        packet flow may be protected by multiple instances of the FEC
        Framework.
</p>
<p>The integer flow identifier identified in 2(b) is a "shorthand" to
        identify source flows between the FEC Framework and the FEC Scheme.
        The reason for defining this as an integer, and including it in the
        FEC Framework Configuration Information is so that the FEC Scheme at
        the sender and receiver may use it to identify the source flow with
        which a recovered packet is associated. The integer flow identifier
        may therefore take the place of the complete flow description (e.g.
        UDP 4-tuple).
</p>
<p>Whether and how this flow identifier is used is defined by the FEC
        Scheme. Since source packets are directly associated with a flow by
        virtue of their packet headers, this identifier need not be carried in
        source packets. Since repair packets may provide protection for
        multiple source flows, this flow identifier would likely not be
        carried directly in repair packets. However, the flow identifier
        associated with a particular source packet may be recovered from the
        repair packets as part of an FEC decoding operation. Integer flow
        identifiers SHOULD be allocated starting from zero and increasing by
        one for each flow.
</p>
<p>A single FEC repair flow provides repair packets for a single
        instance of the FEC Framework. Other packets MUST NOT be sent within
        this flow i.e. all packets in the FEC repair flow MUST be FEC repair
        packets as defined in <a class='info' href='#repairpackets'>Section&nbsp;6.4<span> (</span><span class='info'>Packet Format for FEC Repair packets</span><span>)</span></a> and MUST
        relate to the same FEC Framework instance.
</p>
<a name="fecscheme"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
FEC Scheme requirements</h3>

<p>In order to be used with this framework, an FEC Scheme MUST be
        capable of processing data arranged into blocks of source transport
        packet payloads (source blocks). 
</p>
<p>A specification for a new FEC scheme MUST include the following
        things: </p>
<ol class="text">
<li>The FEC Encoding ID value that uniquely identifies the FEC
            scheme. This value MUST be registered with IANA as described in
            <a class='info' href='#iana'>Section&nbsp;10<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</li>
<li>The type, semantics and encoding format of the Repair FEC
            Payload ID.
</li>
<li>The type, semantics and encoding format of the FEC
            Scheme-specific FEC Framework Configuration Information.
</li>
<li>A full specification of the FEC code. <br />
<br />
This specification MUST precisely define the
            valid FEC-Scheme-Specific FEC Framework Configuration Information
            values, the valid FEC Payload ID values and the valid packet
            payload sizes (where packet payload refers to the space - not
            necessarily contiguous - within a packet dedicated to carrying
            encoding symbol bytes). <br />
<br />
Furthermore,
            given a source block as defined in <a class='info' href='#sourceblock'>Section&nbsp;6.2<span> (</span><span class='info'>Structure of the source block</span><span>)</span></a>, valid values of the
            FEC-Scheme-Specific FEC Framework Configuration Information, a
            valid Repair FEC Payload ID value and a valid packet payload size,
            the specification MUST uniquely define the values of the encoding
            symbol bytes to be included in the repair packet payload of a
            packet with the given Repair FEC Payload ID value.<br />
<br />
A common and simple way to specify the FEC code
            to the required level of detail is to provide a precise
            specification of an encoding algorithm which, given a source
            block, valid values of the FEC-Scheme-Specific FEC Framework
            Configuration Information, a valid Repair FEC Payload ID value and
            a valid packet payload size as input produces the exact value of
            the encoding symbol bytes as output.
</li>
<li>A description of practical encoding and decoding
            algorithms.<br />
<br />
 This description need not be
            to the same level of detail as for the encoding above, however it
            must be sufficient to demonstrate that encoding and decoding of
            the code is both possible and practical.
</li>
</ol>

<p>FEC scheme specifications MAY additionally define the following:
        </p>
<ol class="text">
<li>Type, semantics and encoding format of an Explicit Source FEC
            Payload ID.
</li>
</ol>

<p>Whenever an FEC scheme specification defines an 'encoding format'
        for an element, this must be defined in terms of a sequence of bytes
        which can be embedded within a protocol. The length of the encoding
        format MUST either be fixed or it must be possible to derive the
        length from examining the encoded bytes themselves. For example, the
        initial bytes may include some kind of length indication.
</p>
<p>FEC scheme specifications SHOULD use the terminology defined in
        this document and SHOULD follow the following format: </p>
<blockquote class="text"><dl>
<dt>1. Introduction</dt>
<dd>&lt;describe the use-cases addressed
            by this FEC scheme&gt;<br />

</dd>
<dt>2. Formats and Codes</dt>
<dd>
<blockquote class="text"><dl>
<dt>2.1 Source FEC Payload ID(s)</dt>
<dd>&lt;Either, define
                the type and format of the Explicit Source FEC Payload ID, or
                define how Source FEC Payload ID information is derived from
                source packets&gt;<br />

</dd>
<dt>2.2 Repair FEC Payload Id</dt>
<dd>&lt;Define the type
                and format of the Repair FEC Payload ID&gt;
</dd>
<dt>2.3 FEC Framework Configuration Information</dt>
<dd>&lt;Define
                the type and format of the FEC Scheme-specific FEC Framework
                configuration information&gt;
</dd>
</dl></blockquote>
</dd>
<dt>3. Procedures</dt>
<dd>&lt;describe any procedures which are
            specific to this FEC scheme, in particular derivation and
            interpretation of the fields in the FEC Payload ID and FEC
            Scheme-specific FEC Framework configuration information.&gt;
</dd>
<dt>4. FEC code specification</dt>
<dd>&lt;provide a complete
            specification of the FEC Code&gt;
</dd>
</dl></blockquote>

<p>Specifications MAY include additional sections, for example,
        examples.
</p>
<p>Each FEC scheme MUST be specified independently of all other FEC
        schemes; for example, in a separate specification or a completely
        independent section of larger specification (except, of course, a
        specification of one FEC Scheme may include portions of another by
        reference).
</p>
<a name="TransportProtocols"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Transport Protocols</h3>

<p>The following transport protocols are supported: </p>
<ul class="text">
<li>User Datagram Protocol (UDP)
</li>
<li>Datagram Congestion Control Protocol (DCCP)
</li>
</ul><p> </p>
<blockquote class="text">
<p>Editor's note: This section will contain transport-specific
          considerations, if any.
</p>
</blockquote>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Congestion Control</h3>

<p>This section starts with a informative section on the motivation of
      the normative requirements for congestion control, which are spelled out
      in <a class='info' href='#normativecongestion'>Section&nbsp;8.1<span> (</span><span class='info'>Normative requirements</span><span>)</span></a>. </p>
<blockquote class="text">
<p>Informative Note: The enforcement of Congestion Control (CC)
          principles has gained a lot of momentum in the IETF over the recent
          years. While the need of CC over the open Internet is unquestioned,
          and the goal of TCP friendliness is generally agreed for most (but
          not all) applications, the subject of congestion detection and
          measurement in heterogenous networks can hardly be considered as
          solved. Most congestion control algorithms detect and measure
          congestion by taking (primarily or exclusively) the packet loss rate
          into account. This appears to be inappropriate in environments where
          a large percentage of the packet losses are the result link-layer
          errors and independent of the network load. Note that such
          environments exist in the "open Internet", as well as in "closed" IP
          based networks. An example for the former would be the use of
          IP/UDP/RTP based streaming from an Internet-connected streaming
          server to a device attached to the Internet using cellular
          technology.
</p>
<p>The authors of this draft are primarily interested in
          applications where the application reliability requirements and
          end-to-end reliability of the network differ, such that it warrants
          higher layer protection of the packet stream - for example due to
          the presence of unreliable links in the end-to-end path - and where
          real-time, scalability or other constraints prohibit the use of
          higher layer (transport or application) feedback. A typical example
          for such applications is multicast and broadcast streaming or
          multimedia transmission over heterogenous networks. In other cases,
          application reliability requirements may be so high that the
          required end-to-end reliability is difficult to achieve even over
          wired networks. Furthermore the end-to-end network reliability may
          not be known in advance.
</p>
<p>This FEC framework is not proposed, nor intended, as a QoS
          enhancement tool to combat losses resulting from highly congested
          networks. It should not be used for such purposes.
</p>
<p>In order to prevent such mis-use, one approach would be to leave
          standardisation to bodies most concerned with the problem described
          above. However, the IETF defines base standards used by several
          bodies, including DVB, 3GPP, 3GPP2, all of which appear to share the
          environment and the problem described.
</p>
<p>Another approach would be to write a clear applicability
          statement - for example restricting use of the framework to networks
          with wireless links. However, there may be applications where the
          use of FEC may be justified to combat congestion-induced packet
          losses - particularly in lightly loaded networks, where congestion
          is the result of relatively rare random peaks in instantaneous
          traffic load - thereby intentionally violating congestion control
          principles. One possible example for such an application could be a
          no-matter-what, brute-force FEC protection of traffic generated as
          an emergency signal.
</p>
<p>We propose a third approach, which is to require at a minimum
          that the use of this framework with any given application, in any
          given environment, does not cause congestion issues which the
          application alone would not itself cause i.e. the use of this
          framework must not make things worse.
</p>
<p>Taking above considerations into account, the normative text of
          this section implements a small set of constraints for the FEC,
          which are mandatory for all senders compliant with this FEC
          framework. Further restrictions may be imposed for certain Content
          Delivery Protocols. In this it follows the spirit of the congestion
          control section of RTP and its Audio-Visual Profile (RFC3550/STD64
          and RFC3551/STD65).
</p>
<p>One of the constraints effectively limits the bandwidth for the
          FEC protected packet stream to be no more than roughly twice as high
          as the original, non-FEC protected packet stream. This disallows the
          (static or dynamic) use of excessively strong FEC to combat high
          packet loss rates, which may otherwise be chosen by naively
          implemented dynamic FEC-strength selection mechanisms. We
          acknowledge that there may be a few exotic applications, e.g. IP
          traffic from space-based senders, or senders in certain hardened
          military devices, which would warrant a higher FEC strength.
          However, in this specification we give preference to the overall
          stability and network friendliness of the average application, and
          for those a factor of 2 appears to be appropriate.
</p>
<p>A second constraint requires that the FEC protected packet stream
          be in compliance with the congestion control in use for the
          application and network in question.
</p>
</blockquote>

<a name="normativecongestion"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Normative requirements</h3>

<p>The bandwidth of FEC Repair packet flows MUST NOT exceed the
        bandwidth of the source packet flows being protected. In addition,
        whenever the source packet flow bandwidth is adapted due to the
        operation of congestion control mechanisms, the FEC repair packet flow
        bandwidth MUST be similarly adapted.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The application of FEC protection to a stream does not provide any
      kind of security protection.
</p>
<p>If security services are required for the stream, then they MUST
      either be applied to the original source transport payload before FEC
      protection is applied, or to both the source and repair data, after FEC
      protection has been applied.
</p>
<p>If integrity protection is applied to source packets before FEC
      protection is applied, and no further integrity protection is applied to
      repair packets, then a denial of service attack is possible if an
      attacker is in a position to inject fake repair transport payloads. If
      received by a receiver, such fake repair transport payloads could cause
      incorrect FEC decoding resulting in incorrect source transport payloads
      being passed up to the application protocol. Such incorrect packets
      would then be detected by the source integrity protection and discarded,
      resulting in partial or complete denial of service. Therefore, in such
      environments, integrity protection MUST also be applied to the FEC
      repair transport payloads, for example using IPsec. Receivers MUST also
      verify the integrity of source transport payloads before including the
      source transport payload into the source block for FEC purposes.
</p>
<p>It is possible that multiple streams with different confidentiality
      requirements (for example, the streams may be visible to different sets
      of users) can be FEC protected by a single repair stream. This scenario
      is not recommended, since resources will be used to distribute and
      decode data which cannot then be decrypted by at least some receivers.
      However, in this scenario, confidentiality protection MUST be applied
      before FEC encoding of the streams, otherwise repair transport payload
      may be used by a receiver to decode unencrypted versions of source
      streams which they do not have permissionions to view.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>tbd
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgments</h3>

<p>This document is based in large part on <a class='info' href='#I-D.watson-tsvwg-fec-sf'>[I&#8209;D.watson&#8209;tsvwg&#8209;fec&#8209;sf]<span> (</span><span class='info'>Watson, M., &ldquo;Forward Error Correction (FEC) Streaming Framework,&rdquo; July&nbsp;2005.</span><span>)</span></a> and so thanks are due to the
      additional authors of that document, Mike Luby, Magnus Westerlund and
      Stephan Wenger. That document was in turn based on the FEC streaming
      protocol defined by 3GPP in <a class='info' href='#MBMSTS'>[MBMSTS]<span> (</span><span class='info'>3GPP, &ldquo;Multimedia Broadcast/Multicast Service (MBMS); Protocols and           codecs,&rdquo; April&nbsp;2005.</span><span>)</span></a> and thus
      thanks are also due to the participants in 3GPP TSG SA working group
      4.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3095">[RFC3095]</a></td>
<td class="author-text">Bormann, C., Burmeister, C., Degermark, M., Fukushima, H., Hannu, H., Jonsson, L-E., Hakenberg, R., Koren, T., Le, K., Liu, Z., Martensson, A., Miyazaki, A., Svanbro, K., Wiebke, T., Yoshimura, T., and H. Zheng, &ldquo;<a href="http://tools.ietf.org/html/rfc3095">RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed</a>,&rdquo; RFC&nbsp;3095, July&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3095.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5052">[RFC5052]</a></td>
<td class="author-text">Watson, M., Luby, M., and L. Vicisano, &ldquo;<a href="http://tools.ietf.org/html/rfc5052">Forward Error Correction (FEC) Building Block</a>,&rdquo; RFC&nbsp;5052, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5052.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.watson-tsvwg-fec-sf">[I-D.watson-tsvwg-fec-sf]</a></td>
<td class="author-text">Watson, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-watson-tsvwg-fec-sf-00.txt">Forward Error Correction (FEC) Streaming Framework</a>,&rdquo; draft-watson-tsvwg-fec-sf-00 (work in progress), July&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-watson-tsvwg-fec-sf-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MBMSTS">[MBMSTS]</a></td>
<td class="author-text">3GPP, &ldquo;<a href="http://www.3gpp.org/ftp/Specs/html-info/26346.htm">Multimedia Broadcast/Multicast Service (MBMS); Protocols and
          codecs</a>,&rdquo; 3GPP TS&nbsp;26.346, April&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark Watson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Digital Fountain</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">39141 Civic Center Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 300</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fremont, CA  94538</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">U.S.A.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mark@digitalfountain.com">mark@digitalfountain.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
