<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DNS Blacklists and Whitelists</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DNS Blacklists and Whitelists">
<meta name="keywords" content="mail, electronic mail, DNS, spam, blacklist, whitelist">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Anti-Spam Research Group</td><td class="header">J. Levine</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Taughannock Networks</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">November 17, 2008</td></tr>
<tr><td class="header">Expires: May 21, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />DNS Blacklists and Whitelists<br />draft-irtf-asrg-dnsbl-08</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 21, 2009.</p>

<h3>Abstract</h3>

<p>The rise of spam and other anti-social behavior on the Internet has led
	to the creation of shared blacklists and whitelists of IP addresses
	or domains.
	The DNS has become the de-facto standard method of distributing these
	blacklists and whitelists.
	This memo documents the structure and usage of DNS based blacklists and
	whitelists, and the protocol used to query them.
      
</p>
<h3>IRTF Notice</h3>

<p>This document is a product of the Anti-Spam Research Group (ASRG)
	of the Internet Research Task Force.
	It represents the consensus of the ASRG with respect to practices to
	improve interoperability of DNS based blacklists and whitelists,
	but does not constitute an IETF or Internet standard.
</p>
<p>[NOTE TO RFC EDITOR: Please remove this paragraph in publication.]
	Comments and discussion may be directed to the ASRG mailing list,
	asrg@irtf.org.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Structure of an IP address DNSBL or DNSWL<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
IP address DNSxL<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
IP address DNSWL<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Combined">2.3.</a>&nbsp;
Combined IP address DNSxL<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.4.</a>&nbsp;
IPv6 DNSxLs<br />
<a href="#anchor6">3.</a>&nbsp;
Domain name DNSxLs<br />
<a href="#anchor7">4.</a>&nbsp;
DNSxL cache behavior<br />
<a href="#testentry">5.</a>&nbsp;
Test and contact addresses<br />
<a href="#anchor8">6.</a>&nbsp;
Typical usage of DNSBLs and DNSWLs<br />
<a href="#anchor9">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#anchor12">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">A.1.</a>&nbsp;
Changes since -asrg-dnsbl-07<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">A.2.</a>&nbsp;
Changes since -asrg-dnsbl-06<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">A.3.</a>&nbsp;
Changes since -asrg-dnsbl-05<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In 1997, Dave Rand and Paul Vixie,
       well known Internet software engineers, started
       keeping a list of IP addresses that had sent them spam or engaged in
       other behavior that they found objectionable.
       Word of the list quickly spread, and they started distributing it as a
       BGP feed for people who wanted to block all traffic from listed IP
       addresses at their routers.
       The list became known as the Real-time Blackhole List (RBL).
</p>
<p>Many network managers wanted to use the RBL to block unwanted e-mail,
       but weren't prepared to use a BGP feed.
       Rand and Vixie created a DNS-based distribution scheme that quickly became
       more popular than the original BGP distribution.
       Other people created other DNS-based blacklists either to compete
       with the RBL or to complement it by listing different categories of
       IP addresses.
       Although some people refer to all DNS-based blacklists as ``RBLs'',
       the term properly is used for the MAPS RBL, the descendant of the
       original list.
       (In the United States, the term RBL is a registered service mark of Trend
       Micro<a class='info' href='#MAPSRBL'>[MAPSRBL]<span> (</span><span class='info'>, &ldquo;MAPS RBL+,&rdquo; .</span><span>)</span></a>.)
</p>
<p>The conventional term is now DNS Blacklist or Blocklist, or DNSBL.
       Some people also publish DNS-based whitelists or DNSWLs.
       Network managers typically use DNSBLs to block traffic and
       DNSWLs to preferentially accept traffic.
       The structure of a DNSBL and DNSWL are the same,
       so in the subsequent discussion
       we use the abbreviation DNSxL to mean either.
</p>
<p>This document defines the structure of DNSBLs and DNSWLs.
       It describes the structure, operation, and use of DNSBLs and
       DNSWLs but does not describe or recommend policies for adding or
       removing addresses to and from DNSBLs and DNSWLs, nor does it recommend policies
       for using them.
       We anticipate that management policies will be addressed in a companion
       document.
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Requirements Notation:  </dt>
<dd> The key words "MUST", "MUST
            NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
            "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
            interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>, with respect
	    to recommendations for improving technical interoperability of DNSxLs.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Structure of an IP address DNSBL or DNSWL</h3>

<p>A DNSxL is a zone in the
       DNS<a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a><a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>.
       The zone containing
       resource records identifies hosts present in a blacklist or whitelist.
       Hosts were originally encoded into DNSxL zones
       using a transformation of their IP addresses,
       but now host names are sometimes encoded as well.
       Most DNSxLs still use IP addresses.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
IP address DNSxL</h3>

<p>An IPv4 address DNSxL has a structure adapted from that of the rDNS.
       (The rDNS, reverse DNS, is the IN-ADDR.ARPA<a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> 
       and IP6.ARPA<a class='info' href='#RFC3596'>[RFC3596]<span> (</span><span class='info'>Thomson, S., Huitema, C., Ksinant, V., and M. Souissi, &ldquo;DNS Extensions to Support IP Version 6,&rdquo; October&nbsp;2003.</span><span>)</span></a> domains
       used to map IP addresses to domain names.)
       Each IPv4 address listed in the DNSxL has a corresponding DNS entry.
       The entry's name is
       created by reversing the order of the octets of the text representation
       of the IP address, and appending the domain name of the DNSxL.
</p>
<p>If, for example, the DNSxL is called bad.example.com, and the IPv4
       address to be listed is 192.0.2.99, the name of the DNS entry would
       be 99.2.0.192.bad.example.com.
       Each entry in the DNSxL MUST have an A record.
       DNSBLs SHOULD have a TXT record that describes the reason for
       the entry.
       DNSWLs MAY have a TXT record that describes the reason for
       the entry.
       The contents of the A record MUST NOT be used as an IP address.
       The A record contents conventionally has the value 127.0.0.2, but MAY have
       other values as described below in <a class='info' href='#Combined'>Section&nbsp;2.3<span> (</span><span class='info'>Combined IP address DNSxL</span><span>)</span></a>.
       The TXT record describes the reason that the IP address
       is listed in the DNSxL,
       and is often used as the text of an SMTP error response when an SMTP
       client attempts to send mail to a server using the list as a DNSBL,
       or as explanatory text when the DNSBL is used in a scoring spam filter.
       The DNS records for this entry might be:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
99.2.0.192.bad.example.com    A      127.0.0.2
99.2.0.192.bad.example.com    TXT
         "Dynamic address, see http://bad.example.com?192.0.2.99"
</pre></div>
<p>Some DNSxLs use the same TXT record for all entries,
       while others provide a different TXT record for each entry or range
       of entries that describes the reason that entry or range is listed.
       The reason often includes the URL of a web page where more information
       is available.
       Client software MUST check the A record and MAY check the TXT record.
</p>
<p>If a range of addresses is listed in the DNSxL, 
       the DNSxL MUST contain an A record
       (or a pair of A and TXT records) for every address in the DNSxL.
       Conversely,
       if an IP address is not listed in the DNSxL, there MUST NOT be any records for
       the address.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
IP address DNSWL</h3>

<p>Since SMTP has no way for a server to advise a client why a request
       was accepted, TXT records in DNSWLs are not very useful.
       Some DNSWLs contain TXT records anyway to document the
       reasons that entries are present.
</p>
<p>It is possible and occasionally useful for a DNSxL to be used as a DNSBL in one
       context and a DNSWL in another.
       For example, a DNSxL that lists the IP addresses assigned to dynamically
       assigned addresses on a particular network might be used as a DNSWL on that network's
       outgoing mail server or intranet web server, and used as a DNSBL for mail servers
       on other networks.
</p>
<a name="Combined"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Combined IP address DNSxL</h3>

<p>In many cases, an organization maintains a DNSxL that contains
       multiple entry types, with the entries of each type constituting a sublist.
       For example, an organization that publishes a DNSBL listing
       sources of unwanted e-mail might wish to indicate why various addresses are
       included in the list, with one sublist for addresses listed due to sender
       policy, a second list for addresses of open relays, a third list for hosts
       compromised by malware, and so forth.
       (At this point all of the DNSxLs with sublists of which we are aware are
       intended for use as DNSBLs, but the sublist techniques are equally usable
       for DNSWLs.)
</p>
<p>There are three common methods of representing a DNSxL with multiple sublists:
       subdomains, multiple A
       records, and bit encoded entries.
       DNSxLs with sublists SHOULD use both subdomains and one of the other methods.
</p>
<p>Sublist subdomains are merely subdomains of the main DNSxL domain.
       If for example, bad.example.com had two sublists relay and malware,
       entries for 
       192.0.2.99 would be 99.2.0.192.relay.bad.example.com
       or 99.2.0.192.malware.bad.example.com.
       If a DNSxL contains both entries for a main domain and for sublists,
       sublist names MUST be at least two characters and
       contain non-digits, so there is no problem of name collisions with
       entries in the main domain, where the IP addresses consist of digits or single
       hex characters.
</p>
<p>To minimize the number of DNS lookups, multiple sublists can also be encoded as bit masks or multiple
       A records.
       With bit masks, the A record entry for each IP address is the logical OR of the bit masks for all of the lists on
       which the IP address appears.
       For example, the bit masks for the two sublists might be 127.0.0.2 and 127.0.0.4, in which case
       an entry for an IP address on both lists would be 127.0.0.6:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
99.2.0.192.bad.example.com    A      127.0.0.6
</pre></div>
<p>With multiple A records, each sublist has a different assigned value
       such as 127.0.1.1, 127.0.1.2, and so forth,
       with an A record for each sublist on which the IP address appears:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
99.2.0.192.bad.example.com    A      127.0.1.1
99.2.0.192.bad.example.com    A      127.0.1.2
</pre></div>
<p>There is no widely used convention for mapping sublist names to bits
       or values, beyond the convention that all A values SHOULD be in the
       127.0.0.0/8 range to prevent unwanted network traffic if the value is
       erroneously used as an IP address.
</p>
<p>DNSxLs that return multiple A records sometimes return multiple TXT
       records as well, although the lack of any way to match the TXT records
       to the A records limits the usefulness of those TXT records.  Other
       combined DNSxLs return a single TXT record.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
IPv6 DNSxLs</h3>

<p>The structure of DNSxLs based on IPv6 addresses is adapted from
       that of the IP6.ARPA domain defined in <a class='info' href='#RFC3596'>[RFC3596]<span> (</span><span class='info'>Thomson, S., Huitema, C., Ksinant, V., and M. Souissi, &ldquo;DNS Extensions to Support IP Version 6,&rdquo; October&nbsp;2003.</span><span>)</span></a>.
       Each entry's name MUST be a 32-component hex nibble-reversed IPv6
       address suffixed by the DNSxL domain.
       The entries contain A and TXT records, interpreted the same way as
       they are in IPv4 DNSxLs.
</p>
<p>For example, to represent the address:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  2001:db8:1:2:3:4:567:89ab
</pre></div>
<p>in the DNSxL ugly.example.com, the entry might be:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  b.a.9.8.7.6.5.0.4.0.0.0.3.0.0.0.2.0.0.0.1.0.0.0.8.b.d.0.1.0.0.2.
               ugly.example.com. A 127.0.0.2
                                 TXT "Spam received."
</pre></div>
<p>Combined IPv6 sublist DNSxLs are represented the same way as IPv4 DNSxLs,
       replacing the four octets of IPv4 address with the 32 nibbles of IPv6 address.
</p>
<p>A single DNSxL could in principle contain both IPv4 and IPv6 addresses,
       since the different lengths prevent any ambiguity.
       If a DNSxL is represented using traditional zone files and wildcards,
       there is no way to specify the length of the name that a wildcard matches,
       so wildcard names would indeed be ambiguous for DNSxLs served in that fashion.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Domain name DNSxLs</h3>

<p>A few DNSxLs list domain names rather than IP addresses.
       They are sometimes called RHSBLs, for right hand side blacklists.
       The names of their entries MUST contain the listed domain name followed by the name of the DNSxL.
       The entries contain A and TXT records, interpreted the same way as
       they are in IPv4 DNSxLs.
</p>
<p>If the DNSxL were called doms.example.net, and the domain invalid.edu were to be listed, the
       entry would be named invalid.edu.doms.example.net:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
invalid.edu.doms.example.net    A      127.0.0.2
invalid.edu.doms.example.net    TXT    "Host name used in phish"
</pre></div>
<p>Name-based DNSBLs are far less common than IP address based DNSBLs.
       There is no agreed convention for wildcards.
</p>
<p>Name-based DNSWLs can be created in the same manner as DNSBLs,
and have been used as simple reputation systems with the values of octets
       in the A record representing reputation scores and confidence values,
       typically on a 0-100 or 0-255 scale.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
DNSxL cache behavior</h3>

<p>The per-record time-to-live and zone refresh intervals of
       DNSBLs and DNSWLs vary greatly depending on the management policy of
       the list.  The TTL and refresh times SHOULD be chosen to reflect the
       expected rate of change of the DNSxL.
       A list of IP addresses assigned to dynamically allocated
       dialup and DHCP users could be expected to change slowly, so the TTL
       might be several days and the zone refreshed once a day.  On the other
       hand, a list of IP addresses that had been observed sending spam might
       change every few minutes, with comparably short TTL and refresh
       intervals.
</p>
<a name="testentry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Test and contact addresses</h3>

<p>IPv4 based DNSxLs MUST contain an entry for 127.0.0.2 for testing purposes.
       IPv4 based DNSxLs MUST NOT contain an entry for 127.0.0.1.
</p>
<p>DNSBLs that return multiple values SHOULD have multiple test addresses so that,
       for example, a DNSBL that can return 127.0.0.5 would have a test
       record for 127.0.0.5 that returns an A record
       with the value 127.0.0.5, and a corresponding TXT record.
</p>
<p>IPv6 based DNSxLs MUST contain an entry for ::FFFF:7F00:2
       (::FFFF:127.0.0.2), and MUST NOT contain
       an entry for ::FFFF:7F00:1 (::FFFF:127.0.0.1), the
       <a class='info' href='#RFC4291'>IPv4-Mapped IPv6 Address<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> [RFC4291]
       equivalents of the IPv4 test addresses.
</p>
<p>Domain name based DNSxLs MUST contain an entry for the
       <a class='info' href='#RFC2606'>[RFC2606]<span> (</span><span class='info'>Eastlake, D. and A. Panitz, &ldquo;Reserved Top Level DNS Names,&rdquo; June&nbsp;1999.</span><span>)</span></a> reserved domain name
       "TEST" and MUST NOT contain an entry for the reserved
       domain name "INVALID".
</p>
<p>DNSxLs also MAY contain A and/or AAAA records at the apex of the DNSxL zone
       that point to a web server, so that
       anyone wishing to learn about the bad.example.net DNSBL can check http://bad.example.net.
</p>
<p>The combination of a test address that MUST exist and an address that
       MUST NOT exist allows a client system to check that a domain still contains
       DNSxL data, and to defend against DNSxLs which deliberately
       or by accident install a wildcard that returns an A record for all
       queries.
       DNSxL clients SHOULD periodically check appropriate test entries to
       ensure that the DNSxLs they are using are still operating.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Typical usage of DNSBLs and DNSWLs</h3>

<p>DNSxLs can be served either from standard DNS servers, or from specialized
servers like <a class='info' href='#RBLDNS'>rbldns<span> (</span><span class='info'>Bernstein, D., &ldquo;rbldns, in 'djbdns',&rdquo; .</span><span>)</span></a> [RBLDNS]
and <a class='info' href='#RBLDNSD'>rbldnsd<span> (</span><span class='info'>Tokarev, M., &ldquo;rbldnsd: Small Daemon for DNSBLs,&rdquo; .</span><span>)</span></a> [RBLDNSD]
that accept lists of IP addresses and CIDR ranges
and synthesize the appropriate DNS records on the fly.
Organizations that make heavy use of a DNSxL usually arrange for a private
mirror of the DNSxL, either using the standard AXFR and IXFR or by fetching
a file containing addresses and CIDR ranges for the specialized servers.
If a /24 or larger range of addresses is listed, and the
zone's server uses traditional zone files to represent the DNSxL, the DNSxL
MAY use wildcards to limit the size of the zone file.  If for example,
the entire range of 192.0.2.0/24 were listed, the DNSxL's zone could
contain a single wildcard for *.2.0.192.bad.example.com.
</p>
<p>DNSBL clients are most often mail servers or spam filters called from mail servers.
There's no requirement that DNSBLs be used only for mail, and other services such as IRC use
them to check client hosts that attempt to connect to a server.
</p>
<p>A client MUST interpret any returned A record as meaning that an address
     or domain is listed in a DNSxL.
Mail servers that test combined lists most often handle them the same as single lists
and treat any A record as meaning that an IP address is listed without distinguishing among the
various reasons it might have been listed.
   DNSxL clients SHOULD be able to use bit masks and value range tests on
   returned A record values in order to select particular sublists of a combined list.
</p>
<p>Mail servers typically check a list of DNSxLs on every incoming SMTP connection, with the
names of the DNSxLs set in the server's configuration.
A common usage pattern is for
the server to check each list in turn until it finds one with a DNSBL entry, in which case it
rejects the connection, or a DNSWL entry in which case it accepts the connection.
If the address appears on no list at all (the usual case for legitimate mail),
the mail server accepts the connection.
In another approach, DNSxL entries are used as inputs to a weighting function
that computes an overall score for each message.
</p>
<p>The mail server uses its normal local DNS cache to limit traffic to the DNSxL servers and
to speed up retests of IP addresses recently seen.
Long-running mail servers MAY cache DNSxL data internally,
but MUST respect the TTL values and discard expired records.
</p>
<p>An alternate approach is to check DNSxLs in a spam filtering package after a message
has been received.
In that case, the IP(s) to test are usually extracted from "Received:" header fields
or URIs in the body of the message.  The DNSxL
results can be used to make a binary accept/reject decision, or in a scoring system.
</p>
<p>Packages that test multiple header fields MUST be able to distinguish among values in lists with sublists
since, for example, an entry indicating that an IP address is assigned to dialup users might be treated
as a strong indication that a message would be rejected if the IP address sends mail directly to the recipient
system, but not if the message were relayed through an ISP's mail server.
</p>
<p>Name-based DNSBLs have been used both to check domain names of e-mail addresses
and host names found in mail headers, and to check the domains found in URLs
in message bodies.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Any system manager that uses DNSxLs is entrusting part of his or
       her server management to the parties that run the lists, and SHOULD
       ensure that the management policies for the lists are consistent with
       the policies the system manager intends to use. Poorly chosen DNSBLs
       might block addresses that send mail that the system manager and the system's
       users wish to receive.  The management of DNSBLs can change over time; in
       some cases when the operator of a DNSBL has wished to shut it down, he has
       either removed all entries from the DNSBL or installed a wildcard to list 0/0,
       which would produce unexpected and unwanted results for anyone using the DNSBL.
       
</p>
<p>The A records in a DNSxL zone (other than the ones at the apex of the zone)
    represent blacklist and/or whitelist entries rather than IP addresses.
    Should a client attempt to use the A records as IP addresses, e.g., attempting
    to use a DNSxL entry name as a web or FTP server, peculiar results
    would ensue. If the operator of the DNSxL were to disregard the advice in
    <a class='info' href='#Combined'>Section&nbsp;2.3<span> (</span><span class='info'>Combined IP address DNSxL</span><span>)</span></a> and put values in the A records outside of the
    127/8 range, the peculiar results might not be limited to the host misusing
    the records.
    Conversely, if a system attempts to use a zone that is not a DNSxL as a blacklist
    or whitelist, yet more peculiar results will ensue.
    This situation has been observed in practice when an abandoned DNSBL domain was
    re-registered and the new owner installed a wildcard with an A record pointing
    to a web server.
    To avoid this situation,
    systems that use DNSxLs SHOULD check for the test entries described in
    <a class='info' href='#testentry'>Section&nbsp;5<span> (</span><span class='info'>Test and contact addresses</span><span>)</span></a> to ensure that a domain actually has the structure
    of a DNSxL, and SHOULD NOT use any DNSxL domain that does not have correct
    test entries.
</p>
<p>Since DNSxL users usually make a query for every incoming e-mail message,
the operator of a DNSxL can extract approximate mail volume statistics
from the DNS server logs.
This has been used in a few instances to estimate the amount of mail
individual IP addresses or IP blocks send<a class='info' href='#SENDERBASE'>[SENDERBASE]<span> (</span><span class='info'>Ironport Systems, &ldquo;Senderbase,&rdquo; .</span><span>)</span></a>
<a class='info' href='#KSN'>[KSN]<span> (</span><span class='info'>Levine, J., &ldquo;The South Korean Network Blocking List,&rdquo; .</span><span>)</span></a>.
</p>
<p>As with any other DNS based services, DNSBLs and DNSWLs are subject to 
various types of DNS attacks which are described in <a class='info' href='#RFC3833'>[RFC3833]<span> (</span><span class='info'>Atkins, D. and R. Austein, &ldquo;Threat Analysis of the Domain Name System (DNS),&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2606">[RFC2606]</a></td>
<td class="author-text"><a href="mailto:dee3@us.ibm.com">Eastlake, D.</a> and <a href="mailto:buglady@fuschia.net">A. Panitz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2606">Reserved Top Level DNS Names</a>,&rdquo; BCP&nbsp;32, RFC&nbsp;2606, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2606.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3596">[RFC3596]</a></td>
<td class="author-text">Thomson, S., Huitema, C., Ksinant, V., and M. Souissi, &ldquo;<a href="http://tools.ietf.org/html/rfc3596">DNS Extensions to Support IP Version 6</a>,&rdquo; RFC&nbsp;3596, October&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3596.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4291.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3833">[RFC3833]</a></td>
<td class="author-text">Atkins, D. and R. Austein, &ldquo;<a href="http://tools.ietf.org/html/rfc3833">Threat Analysis of the Domain Name System (DNS)</a>,&rdquo; RFC&nbsp;3833, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3833.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RBLDNS">[RBLDNS]</a></td>
<td class="author-text">Bernstein, D., &ldquo;<a href="http://cr.yp.to/djbdns.html">rbldns, in 'djbdns'</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="MAPSRBL">[MAPSRBL]</a></td>
<td class="author-text">&ldquo;<a href="http://mail-abuse.com/">MAPS RBL+</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RBLDNSD">[RBLDNSD]</a></td>
<td class="author-text">Tokarev, M., &ldquo;<a href="http://www.corpit.ru/mjt/rbldnsd.html">rbldnsd: Small Daemon for DNSBLs</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="SENDERBASE">[SENDERBASE]</a></td>
<td class="author-text">Ironport Systems, &ldquo;<a href="http://www.senderbase.org">Senderbase</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="KSN">[KSN]</a></td>
<td class="author-text">Levine, J., &ldquo;<a href="http://korea.services.net">The South Korean Network Blocking List</a>.&rdquo;</td></tr>
</table>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<p>
        <strong>NOTE TO RFC EDITOR: This section may be removed
          upon publication of this document as an RFC.</strong>
      
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Changes since -asrg-dnsbl-07</h3>

<p>Minor boilerplate and typo changes to clarify that this is not
	  a standard. Clarify that the A
	record does not contain an address.
</p>
<p>Rewrite security section to list failure scenarios, and point out
	  the risks of A records that aren't IP addresses.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Changes since -asrg-dnsbl-06</h3>

<p>Change forbidden example from EXAMPLE to INVALID.
</p>
<p>Remove SOA encoded email addresses.
</p>
<p>Change IPv6 test addresses.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Changes since -asrg-dnsbl-05</h3>

<p>Pervasive edits to standard language, including RFC2119 terms.
</p>
<p>Test entries clarified for IPv4, invented for IPv6 and domains.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Levine</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Taughannock Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box 727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trumansburg, NY  14886</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 607 330 5711</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:standards@taugh.com">standards@taugh.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.taugh.com">http://www.taugh.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
