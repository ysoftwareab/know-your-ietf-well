<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="robots" content="index,follow" />

        <link rel="icon" href="./css/images/rfc.png" type="image/png" />
        <link rel="shortcut icon" href="./css/images/rfc.png" type="image/png" />
        <title>rfc7872</title>
    
        <link rel="stylesheet" type="text/css" href="./css/errata-base.css"/>
        <link rel="stylesheet" type="text/css" href="./css/errata-color.css" title="Default: Basic Colors"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-monochrome.css" title="Monochrome"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-printer.css" title="Printer"/>

        <script src="./css/errata.js"></script>
    </head>
    <body>
        <div class='Verified-headnote-styling'>
<span style="font-weight: bold;">This is a purely informative rendering of an RFC that includes verified errata.  This rendering may not be used as a reference.</span>
<br/>
<br/>
The following 'Verified' errata have been incorporated in this document:
 <a href='#btn_4729'>EID 4729</a>
</div>

        <pre>
Internet Engineering Task Force (IETF)                           F. Gont
Request for Comments: 7872                        SI6 Networks / UTN-FRH
Category: Informational                                       J. Linkova
ISSN: 2070-1721                                                   Google
                                                                T. Chown
                                                                    Jisc
                                                                  W. Liu
                                                     Huawei Technologies
                                                               June 2016


                Observations on the Dropping of Packets
             with IPv6 Extension Headers in the Real World

Abstract

   This document presents real-world data regarding the extent to which
   packets with IPv6 Extension Headers (EHs) are dropped in the Internet
   (as originally measured in August 2014 and later in June 2015, with
   similar results) and where in the network such dropping occurs.  The
   aforementioned results serve as a problem statement that is expected
   to trigger operational advice on the filtering of IPv6 packets
   carrying IPv6 EHs so that the situation improves over time.  This
   document also explains how the results were obtained, such that the
   corresponding measurements can be reproduced by other members of the
   community and repeated over time to observe changes in the handling
   of packets with IPv6 EHs.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see Section 2 of RFC 7841.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   http://www.rfc-editor.org/info/rfc7872.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Support of IPv6 Extension Headers in the Internet . . . . . .   3
   3.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   4.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     4.1.  Normative References  . . . . . . . . . . . . . . . . . .   6
     4.2.  Informative References  . . . . . . . . . . . . . . . . .   6
   Appendix A.  Reproducing Our Experiment . . . . . . . . . . . . .   8
     A.1.  Obtaining the List of Domain Names  . . . . . . . . . . .   8
     A.2.  Obtaining AAAA Resource Records . . . . . . . . . . . . .   8
     A.3.  Filtering the IPv6 Address Datasets . . . . . . . . . . .   9
     A.4.  Performing Measurements with Each IPv6 Address Dataset  .   9
     A.5.  Obtaining Statistics from Our Measurements  . . . . . . .  10
   Appendix B.  Measurements Caveats . . . . . . . . . . . . . . . .  12
     B.1.  Isolating the Dropping Node . . . . . . . . . . . . . . .  12
     B.2.  Obtaining the Responsible Organization for the Packet
           Drops . . . . . . . . . . . . . . . . . . . . . . . . . .  13
   Appendix C.  Troubleshooting Packet Drops Due to IPv6 Extension
                Headers  . . . . . . . . . . . . . . . . . . . . . .  14
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  14
   Authors&#x27; Addresses  . . . . . . . . . . . . . . . . . . . . . . .  15

1.  Introduction

   IPv6 Extension Headers (EHs) allow for the extension of the IPv6
   protocol and provide support for core functionality such as IPv6
   fragmentation.  While packets employing IPv6 EHs have been suspected
   to be dropped in some IPv6 deployments, there was not much concrete
   data on the topic.  Some preliminary measurements have been presented
   in [PMTUD-Blackholes], [Gont-IEPG88], and [Gont-Chown-IEPG89],
   whereas [Linkova-Gont-IEPG90] presents more comprehensive results on
   which this document is based.

   This document presents real-world data regarding the extent to which
   packets containing IPv6 EHs are dropped in the Internet, as measured
   in August 2014 and later in June 2015 with similar results (pending
   operational advice in this area).  The results presented in this
   document indicate that in the scenarios where the corresponding
   measurements were performed, the use of IPv6 EHs can lead to packet
   drops.  We note that, in particular, packet drops occurring at
   transit networks are undesirable, and it is hoped and expected that
   this situation will improve over time.

2.  Support of IPv6 Extension Headers in the Internet

   This section summarizes the results obtained when measuring the
   support of IPv6 EHs on the path towards different types of public
   IPv6 servers.  Two sources of information were employed for the list
   of public IPv6 servers: the &quot;World IPv6 Launch&quot; site
   &lt;http://www.worldipv6launch.org&gt; and Alexa&#x27;s list of the Top
   1-Million Web Sites &lt;http://www.alexa.com&gt;.  For each list of domain
   names, the following datasets were obtained:

   o  Web servers (AAAA records of the aforementioned list)

   o  Mail servers (MX -&gt; AAAA records of the aforementioned list)

   o  Name servers (NS -&gt; AAAA records of the aforementioned list)

   Duplicate addresses and IPv6 addresses other than global unicast
   addresses were eliminated from each of those lists prior to obtaining
   the results included in this document.  Additionally, addresses that
   were found to be unreachable were discarded from the dataset (please
   see Appendix B for further details).

   For each of the aforementioned address sets, three different types of
   probes were employed:

   o  IPv6 packets with a Destination Options header of 8 bytes;

   o  IPv6 packets resulting in two IPv6 fragments of 512 bytes each
      (approximately); and

   o  IPv6 packets with a Hop-by-Hop Options header of 8 bytes.

   In the case of packets with a Destination Options header and the case
   of packets with a Hop-by-Hop Options header, the desired EH size was
   achieved by means of PadN options [RFC2460].  The upper-layer
   protocol of the probe packets was, in all cases, TCP [RFC793] with
   the Destination Port set to the service port [IANA-PORT-NUMBERS] of
   the corresponding dataset.  For example, the probe packets for all
   the measurements involving web servers were TCP segments with the
   Destination Port set to 80.

   Besides obtaining the packet drop rate when employing the
   aforementioned IPv6 EHs, we tried to identify whether the Autonomous
   System (AS) dropping the packets was the same as the AS of the
   destination/target address.  This is of particular interest since it
   essentially reveals whether the packet drops are under the control of
   the intended destination of the packets.  Packets dropped by the
   destination AS are less of a concern since the device dropping the
   packets is under the control of the same organization as that to
   which the packets are destined (hence, it is probably easier to
   update the filtering policy if deemed necessary).  On the other hand,
   packets dropped by transit ASes are more of a concern since they
   affect the deployability and usability of IPv6 EHs (including IPv6
   fragmentation) by a third party (the destination AS).  In any case,
   we note that it is impossible to tell whether, in those cases where
   IPv6 packets with EHs get dropped, the packet drops are the result of
   an explicit and intended policy or the result of improper device
   configuration defaults, buggy devices, etc.  Thus, packet drops that
   occur at the destination AS might still prove to be problematic.

   Since there is some ambiguity when identifying the AS to which a
   specific router belongs (see Appendix B.2), each of our measurements
   results in two different values: one corresponding to the &quot;best-case
   scenario&quot; and one corresponding to the &quot;worst-case scenario&quot;.  The
   &quot;best-case scenario&quot; is that in which, when in doubt, the packets are
   assumed to be dropped by the destination AS, whereas the &quot;worst-case
   scenario&quot; is that in which, when in doubt, the packets are assumed to
   be dropped by a transit AS (please see Appendix B.2 for details).  In
   the following tables, the values shown within parentheses represent
   the possibility that, when a packet is dropped, the packet drop
   occurs in an AS other than the destination AS (considering both the
   best-case scenario and the worst-case scenario).

   +----------+------------------+------------------+------------------+
   | Dataset  |       DO8        |       HBH8       |      FH512       |
   +----------+------------------+------------------+------------------+
   |   Web    |      11.88%      |      40.70%      |      30.51%      |
   | servers  | (17.60%/20.80%)  | (31.43%/40.00%)  |  (5.08%/6.78%)   |
   +----------+------------------+------------------+------------------+
   |   Mail   |      17.07%      |      48.86%      |      39.17%      |
   | servers  |  (6.35%/26.98%)  | (40.50%/65.42%)  |  (2.91%/12.73%)  |
   +----------+------------------+------------------+------------------+
   |   Name   |      15.37%      |      43.25%      |      38.55%      |
   | servers  | (14.29%/33.46%)  | (42.49%/72.07%)  |  (3.90%/13.96%)  |
   +----------+------------------+------------------+------------------+

   Table 1: WIPv6LD Dataset: Packet Drop Rate for Different Destination
    Types, and Estimated (Best-Case / Worst-Case) Percentage of Packets
                    That Were Dropped in a Different AS

      NOTE: In the tables above and below, &quot;HBH8&quot; stands for &quot;packets
      with a Hop-By-Hop Options extension header of 8 bytes&quot;, &quot;DO8&quot;
      stands for &quot;packets with a Destination Options extension header of
      8 bytes&quot;, and &quot;FH512&quot; stands for &quot;IPv6 packets with a Fragment
      Header of 512 bytes&quot;.

      NOTE: As an example, we note that the cell describing the support
      of IPv6 packets with DO8 for web servers (containing the value
      &quot;11.88% (17.60%/20.80%)&quot;) should be read as: &quot;when sending IPv6
      packets with DO8 to public web servers, 11.88% of such packets get
      dropped.  Among those packets that get dropped, 17.60%/20.80%
      (best case / worst case) of them get dropped at an AS other than
      the destination AS&quot;.

   +----------+------------------+------------------+------------------+
   | Dataset  |       DO8        |       HBH8       |      FH512       |
   +----------+------------------+------------------+------------------+
   |   Web    |      10.91%      |      39.03%      |      28.26%      |
   | servers  | (46.52%/53.23%)  | (36.90%/46.35%)  | (53.64%/61.43%)  |
   +----------+------------------+------------------+------------------+
   |   Mail   |      11.54%      |      45.45%      |      35.68%      |
   | servers  |  (2.41%/21.08%)  | (41.27%/61.13%)  |  (3.15%/10.92%)  |
   +----------+------------------+------------------+------------------+
   |   Name   |      21.33%      |      54.12%      |      55.23%      |
   | servers  | (10.27%/56.80%)  | (50.64%/81.00%)  |  (5.66%/32.23%)  |
   +----------+------------------+------------------+------------------+

   Table 2: Alexa&#x27;s Top 1M Sites Dataset: Packet Drop Rate for Different
   Destination Types, and Estimated (Best-Case / Worst-Case) Percentage
              of Packets That Were Dropped in a Different AS

   There are a number of observations to be made based on the results
   presented above.  Firstly, while it has been generally assumed that
   it is IPv6 fragments that are dropped by operators, our results
   indicate that it is IPv6 EHs in general that result in packet drops.
   Secondly, our results indicate that a significant percentage of such
   packet drops occurs in transit ASes; that is, the packet drops are
   not under the control of the same organization as the final
   destination.

3.  Security Considerations

   This document presents real-world data regarding the extent to which
   IPv6 packets employing EHs are dropped in the Internet.  As such,
   this document does not introduce any new security issues.

4.  References

4.1.  Normative References

   [RFC793]   Postel, J., &quot;Transmission Control Protocol&quot;, STD 7,
              RFC 793, DOI 10.17487/RFC0793, September 1981,
              &lt;http://www.rfc-editor.org/info/rfc793&gt;.

   [RFC2460]  Deering, S. and R. Hinden, &quot;Internet Protocol, Version 6
              (IPv6) Specification&quot;, RFC 2460, DOI 10.17487/RFC2460,
              December 1998, &lt;http://www.rfc-editor.org/info/rfc2460&gt;.

4.2.  Informative References

   [Gont-Chown-IEPG89]
              Gont, F. and T. Chown, &quot;A Small Update on the Use of IPv6
              Extension Headers&quot;, IEPG meeting before IETF 89, March
              2014, &lt;http://www.iepg.org/2014-03-02-ietf89/
              fgont-iepg-ietf89-eh-update.pdf&gt;.

   [Gont-IEPG88]
              Gont, F., &quot;Fragmentation and Extension Header Support in
              the IPv6 Internet&quot;, IEPG meeting before IETF 88, November
              2013, &lt;http://www.iepg.org/2013-11-ietf88/
              fgont-iepg-ietf88-ipv6-frag-and-eh.pdf&gt;.

   [IANA-PORT-NUMBERS]
              IANA, &quot;Service Name and Transport Protocol Port Number
              Registry&quot;, &lt;http://www.iana.org/assignments/
              service-names-port-numbers&gt;.

   [IPv6-Toolkit]
              SI6 Networks, &quot;SI6 Networks&#x27; IPv6 Toolkit v2.0 (Guille)&quot;,
              &lt;http://www.si6networks.com/tools/ipv6toolkit&gt;.

   [Linkova-Gont-IEPG90]
              Linkova, J. and F. Gont, &quot;IPv6 Extension Headers in the
              Real World v2.0&quot;, IEPG Meeting before IETF 90, July 2014,
              &lt;http://www.iepg.org/2014-07-20-ietf90/
              iepg-ietf90-ipv6-ehs-in-the-real-world-v2.0.pdf&gt;.

   [PMTUD-Blackholes]
              De Boer, M. and J. Bosma, &quot;Discovering Path MTU black
              holes on the Internet using RIPE Atlas&quot;, July 2012,
              &lt;http://www.nlnetlabs.nl/downloads/publications/
              pmtu-black-holes-msc-thesis.pdf&gt;.

Appendix A.  Reproducing Our Experiment

   This section describes, step by step, how to reproduce the experiment
   with which we obtained the results presented in this document.  Each
   subsection represents one step in the experiment.  The tools employed
   for the experiment are traditional UNIX-like tools (such as gunzip)
   and the SI6 Networks&#x27; IPv6 Toolkit v2.0 (Guille) [IPv6-Toolkit].

   Throughout this appendix, &quot;#&quot; denotes the command-line prompt for
   commands that require superuser privileges, whereas &quot;$&quot; denotes the
   prompt for commands that do not require superuser privileges.

A.1.  Obtaining the List of Domain Names

   The primary data source employed was Alexa&#x27;s Top 1M web sites,
   available at: &lt;http://s3.amazonaws.com/alexa-static/top-1m.csv.zip&gt;.
   The file is a zipped file containing the list of the most popular web
   sites, in Comma-Separated Value (CSV) format.  The aforementioned
   file can be extracted with

   $ gunzip &lt; top-1m.csv.zip &gt; top-1m.csv

   A list of domain names (i.e., with other data stripped) can be
   obtained with the following command [IPv6-Toolkit]:

   $ cat top-1m.csv | script6 get-alexa-domains &gt; top-1m.txt

   This command will create a &quot;top-1m.txt&quot; file containing one domain
   name per line.

      NOTE: <span class="Verified-inline-styling" id='inline-4729'>given that this was a set of names used for a one time test  <button id="btn_4729" target="expand_4729" onclick='hideFunction("expand_4729")'>Expand</button>
it would not be expected to change.

a stable reference to it would be:

&quot;https://web.archive.org/web/20150313063829/
http://www.si6networks.com/datasets/wipv6day-domains.txt&quot;

note line truncated due to 72 char limit</span id__locate=4729>  Since
<div class="nodeCloseClass" id='expand_4729'><div class='Verified-endnote-styling' id='eid4729'>
<pre>
<b><i><a href='https://www.rfc-editor.org/errata/eid4729'>EID 4729</a> (Verified) is as follows:</i></b>

<b>Section:</b> A.1

<b>Original Text:</b>

The domain names corresponding to the WIPv6LD dataset is
      available at
      &lt;http://www.si6networks.com/datasets/wipv6day-domains.txt&gt;.

<b>Corrected Text:</b>

given that this was a set of names used for a one time test 
it would not be expected to change.

a stable reference to it would be:

&quot;https://web.archive.org/web/20150313063829/
http://www.si6networks.com/datasets/wipv6day-domains.txt&quot;

note line truncated due to 72 char limit
</pre>
<b>Notes:</b><br/>
% wget http://www.si6networks.com/datasets/wipv6day-domains.txt<br/>--2016-07-05 11:56:27--  http://www.si6networks.com/datasets/wipv6day-domains.txt<br/>Resolving www.si6networks.com (www.si6networks.com)... 2001:67c:27e4::14, 91.239.96.14<br/>Connecting to www.si6networks.com (www.si6networks.com)|2001:67c:27e4::14|:80... connected.<br/>HTTP request sent, awaiting response... 301 Moved Permanently<br/>Location: https://www.si6networks.com/datasets/wipv6day-domains.txt [following]<br/>--2016-07-05 11:56:28--  https://www.si6networks.com/datasets/wipv6day-domains.txt<br/>Connecting to www.si6networks.com (www.si6networks.com)|2001:67c:27e4::14|:443... connected.<br/>HTTP request sent, awaiting response... 404 Not Found<br/>2016-07-05 11:56:28 ERROR 404: Not Found.
</div>
</div>      the corresponding file is a text file containing one domain name
      per line, the steps produced in this subsection need not be
      performed.  The WIPv6LD dataset should be processed in the same
      way as the Alexa dataset, starting from Appendix A.2.

A.2.  Obtaining AAAA Resource Records

   The file obtained in the previous subsection contains a list of
   domain names that correspond to web sites.  The AAAA records for such
   domain names can be obtained with:

   $ cat top-1m.txt | script6 get-aaaa &gt; top-1m-web-aaaa.txt

   The AAAA records corresponding to the mail servers of each of the
   aforementioned domain names can be obtained with:

   $ cat top-1m.txt | script6 get-mx | script6 get-aaaa &gt;
   top-1m-mail-aaaa.txt

   The AAAA records corresponding to the name servers of each of the
   aforementioned domain names can be obtained with:

   $ cat top-1m.txt | script6 get-ns | script6 get-aaaa &gt;
   top-1m-dns-aaaa.txt

A.3.  Filtering the IPv6 Address Datasets

   The lists of IPv6 addresses obtained in the previous step could
   possibly contain undesired addresses (e.g., non-global unicast
   addresses) and/or duplicate addresses.  In order to remove both
   undesired and duplicate addresses, each of the three files from the
   previous section should be filtered accordingly:

   $ cat top-1m-web-aaaa.txt | addr6 -i -q -B multicast -B unspec -k
   global &gt; top-1m-web-aaaa-unique.txt

   $ cat top-1m-mail-aaaa.txt | addr6 -i -q -B multicast -B unspec -k
   global &gt; top-1m-mail-aaaa-unique.txt

   $ cat top-1m-dns-aaaa.txt | addr6 -i -q -B multicast -B unspec -k
   global &gt; top-1m-dns-aaaa-unique.txt

A.4.  Performing Measurements with Each IPv6 Address Dataset

A.4.1.  Measurements with Web Servers

   In order to measure DO8 with the list of web servers:

   # cat top-1m-web-aaaa-unique.txt | script6 trace6 do8 tcp 80 &gt;
   top-1m-web-aaaa-do8-m.txt

   In order to measure HBH8 with the list of web servers:

   # cat top-1m-web-aaaa-unique.txt | script6 trace6 hbh8 tcp 80 &gt;
   top-1m-web-aaaa-hbh8-m.txt

   In order to measure FH512 with the list of web servers:

   # cat top-1m-web-aaaa-unique.txt | script6 trace6 fh512 tcp 80 &gt;
   top-1m-web-aaaa-fh512-m.txt

A.4.2.  Measurements with Mail Servers

   In order to measure DO8 with the list of mail servers:

   # cat top-1m-mail-aaaa-unique.txt | script6 trace6 do8 tcp 25 &gt;
   top-1m-mail-aaaa-do8-m.txt

   In order to measure HBH8 with the list of mail servers:

   # cat top-1m-mail-aaaa-unique.txt | script6 trace6 hbh8 tcp 25 &gt;
   top-1m-mail-aaaa-hbh8-m.txt

   In order to measure FH512 with the list of mail servers:

   # cat top-1m-mail-aaaa-unique.txt | script6 trace6 fh512 tcp 25 &gt;
   top-1m-mail-aaaa-fh512-m.txt

A.4.3.  Measurements with Name Servers

   In order to measure DO8 with the list of name servers:

   # cat top-1m-dns-aaaa-unique.txt | script6 trace6 do8 tcp 53 &gt;
   top-1m-dns-aaaa-do8-m.txt

   In order to measure HBH8 with the list of name servers:

   # cat top-1m-dns-aaaa-unique.txt | script6 trace6 hbh8 tcp 53 &gt;
   top-1m-dns-aaaa-hbh8-m.txt

   In order to measure FH512 with the list of name servers:

   # cat top-1m-dns-aaaa-unique.txt | script6 trace6 fh512 tcp 53 &gt;
   top-1m-dns-aaaa-fh512-m.txt

A.5.  Obtaining Statistics from Our Measurements

A.5.1.  Statistics for Web Servers

   In order to compute the statistics corresponding to our measurements
   of DO8 with the list of web servers:

   $ cat top-1m-web-aaaa-do8-m.txt | script6 get-trace6-stats &gt;
   top-1m-web-aaaa-do8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of HBH8 with the list of web servers:

   $ cat top-1m-web-aaaa-hbh8-m.txt | script6 get-trace6-stats &gt;
   top-1m-web-aaaa-hbh8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of FH512 with the list of web servers:

   $ cat top-1m-web-aaaa-fh512-m.txt | script6 get-trace6-stats &gt;
   top-1m-web-aaaa-fh512-stats.txt

A.5.2.  Statistics for Mail Servers

   In order to compute the statistics corresponding to our measurements
   of DO8 with the list of mail servers:

   $ cat top-1m-mail-aaaa-do8-m.txt | script6 get-trace6-stats &gt;
   top-1m-mail-aaaa-do8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of HBH8 with the list of mail servers:

   $ cat top-1m-mail-aaaa-hbh8-m.txt | script6 get-trace6-stats &gt;
   top-1m-mail-aaaa-hbh8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of FH512 with the list of mail servers:

   $ cat top-1m-mail-aaaa-fh512-m.txt | script6 get-trace6-stats &gt;
   top-1m-mail-aaaa-fh512-stats.txt

A.5.3.  Statistics for Name Servers

   In order to compute the statistics corresponding to our measurements
   of DO8 with the list of name servers:

   $ cat top-1m-dns-aaaa-do8-m.txt | script6 get-trace6-stats &gt;
   top-1m-dns-aaaa-do8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of HBH8 with the list of mail servers:

   $ cat top-1m-dns-aaaa-hbh8-m.txt | script6 get-trace6-stats &gt;
   top-1m-dns-aaaa-hbh8-stats.txt

   In order to compute the statistics corresponding to our measurements
   of FH512 with the list of mail servers:

   $ cat top-1m-dns-aaaa-fh512-m.txt | script6 get-trace6-stats &gt;
   top-1m-dns-aaaa-fh512-stats.txt

Appendix B.  Measurements Caveats

   A number of issues have needed some consideration when producing the
   results presented in this document.  These same issues should be
   considered when troubleshooting connectivity problems resulting from
   the use of IPv6 EHs.

B.1.  Isolating the Dropping Node

   Let us assume that we find that IPv6 packets with EHs are being
   dropped on their way to the destination system 2001:db8:d::1 and that
   the output of running traceroute towards such destination is:

      1. 2001:db8:1:1000::1
      2. 2001:db8:2:4000::1
      3. 2001:db8:3:4000::1
      4. 2001:db8:3:1000::1
      5. 2001:db8:4:4000::1
      6. 2001:db8:4:1000::1
      7. 2001:db8:5:5000::1
      8. 2001:db8:5:6000::1
      9. 2001:db8:d::1

   Additionally, let us assume that the output of EH-enabled traceroute
   to the same destination is:

      1. 2001:db8:1:1000::1
      2. 2001:db8:2:4000::1
      3. 2001:db8:3:4000::1
      4. 2001:db8:3:1000::1
      5. 2001:db8:4:4000::1

   For the sake of brevity, let us refer to the last-responding node in
   the EH-enabled traceroute (&quot;2001:db8:4:4000::1&quot; in this case) as &quot;M&quot;.
   Assuming that packets in both traceroutes employ the same path, we&#x27;ll
   refer to &quot;the node following the last responding node in the
   EH-enabled traceroute&quot; (&quot;2001:db8:4:1000::1&quot; in our case), as &quot;M+1&quot;,
   etc.

   Based on traceroute information above, which node is the one actually
   dropping the EH-enabled packets will depend on whether the dropping
   node filters packets before making the forwarding decision or after

   making the forwarding decision.  If the former, the dropping node
   will be M+1.  If the latter, the dropping node will be &quot;M&quot;.

   Throughout this document (and our measurements), we assume that those
   nodes dropping packets that carry IPv6 EHs apply their filtering
   policy, and only then, if necessary, forward the packets.  Thus, in
   our example above, the last responding node to the EH-enabled
   traceroute (&quot;M&quot;) is &quot;2001:db8:4:4000::1&quot;, and we assume the dropping
   node to be &quot;2001:db8:4:1000::1&quot; (&quot;M+1&quot;).

   Additionally, we note that when isolating the dropping node we assume
   that both the EH-enabled and the EH-free traceroutes result in the
   same paths.  However, this might not be the case.

B.2.  Obtaining the Responsible Organization for the Packet Drops

   In order to identify the organization operating the dropping node,
   one would be tempted to lookup the Autonomous System Numbers (ASNs)
   corresponding to the dropping node.  However, assuming that M and M+1
   are two peering routers, any of these two organizations could be
   providing the address space employed for such peering.  Or, in the
   case of an Internet Exchange Point (IXP), the address space could
   correspond to the IXP AS rather than to any of the participating
   ASes.  Thus, the organization operating the dropping node (M+1) could
   be the AS for M+1, but it might as well be the AS for M+2.  Only when
   the ASN for M+1 is the same as the ASN for M+2 do we have certainty
   about who the responsible organization for the packet drops is (see
   slides 21-23 of [Linkova-Gont-IEPG90]).

   In the measurement results presented in Section 2, the aforementioned
   ambiguity results in a &quot;best-case&quot; and a &quot;worst-case&quot; scenario
   (rather than a single value): the lowest percentage value means that,
   when in doubt, we assume the packet drops occur in the same AS as the
   destination; on the other hand, the highest percentage value means
   that, when in doubt, we assume the packet drops occur at a different
   AS than the destination AS.

   We note that the aforementioned ambiguity should also be considered
   when troubleshooting and reporting IPv6 packet drops since
   identifying the organization responsible for the packet drops might
   prove to be a non-trivial task.

   Finally, we note that a specific organization might be operating more
   than one AS.  However, our measurements assume that different ASNs
   imply different organizations.

Appendix C.  Troubleshooting Packet Drops Due to IPv6 Extension Headers

   Isolating IPv6 blackholes essentially involves performing IPv6
   traceroute for a destination system with and without IPv6 EHs.  The
   EH-free traceroute would provide the full working path towards a
   destination while the EH-enabled traceroute would provide the address
   of the last-responding node for EH-enabled packets (say, &quot;M&quot;).  In
   principle, one could isolate the dropping node by looking-up &quot;M&quot; in
   the EH-free traceroute with the dropping node being &quot;M+1&quot; (see
   Appendix B.1 for caveats).

   At the time of this writing, most traceroute implementations do not
   support IPv6 EHs.  However, the path6 tool of [IPv6-Toolkit] provides
   such support.  Additionally, the blackhole6 tool of [IPv6-Toolkit]
   automates the troubleshooting process and can readily provide
   information such as: dropping node&#x27;s IPv6 address, dropping node&#x27;s
   AS, etc.

Acknowledgements

   The authors would like to thank (in alphabetical order) Mikael
   Abrahamsson, Mark Andrews, Fred Baker, Brian Carpenter, Gert Doering,
   C.  M.  Heard, Nick Hilliard, Joel Jaeggli, Tatuya Jinmei, Merike
   Kaeo, Warren Kumari, Ted Lemon, Mark Smith, Ole Troan, and Eric
   Vyncke for providing valuable comments on draft versions of this
   document.  Additionally, the authors would like to thank participants
   of the V6OPS and OPSEC working groups for their valuable input on the
   topics discussed in this document.

   The authors would like to thank Fred Baker for his guidance in
   improving this document.

   Fernando Gont would like to thank Jan Zorz of Go6 Lab
   &lt;http://go6lab.si/&gt; and Jared Mauch of NTT America for providing
   access to systems and networks that were employed to produce some of
   the measurement results presented in this document.  Additionally, he
   would like to thank SixXS &lt;https://www.sixxs.net&gt; for providing IPv6
   connectivity.

   Fernando Gont would like to thank Nelida Garcia and Guillermo Gont
   for their love and support.

Authors&#x27; Addresses

   Fernando Gont
   SI6 Networks / UTN-FRH
   Evaristo Carriego 2644
   Haedo, Provincia de Buenos Aires  1706
   Argentina

   Phone: +54 11 4650 8472
   Email: fgont@si6networks.com
   URI:   http://www.si6networks.com


   J. Linkova
   Google
   1600 Amphitheatre Parkway
   Mountain View, CA 94043
   United States

   Email: furry@google.com


   Tim Chown
   Jisc
   Lumen House, Library Avenue
   Harwell Oxford, Didcot  OX11 0SG
   United Kingdom

   Email: tim.chown@jisc.ac.uk


   Will (Shucheng) Liu
   Huawei Technologies
   Bantian, Longgang District
   Shenzhen  518129
   China

   Email: liushucheng@huawei.com


        </re>
        
    </body>
</html>
