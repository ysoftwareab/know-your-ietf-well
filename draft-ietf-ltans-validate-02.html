<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Validation and long term verification data for Evidence Records and signed documents</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Validation and long term verification data for Evidence Records and signed documents">
<meta name="keywords" content="long term archive, security, timestamp, validate, verify, verification, policy">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">LTANS</td><td class="header">T. Gondrom</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">S. Fischer-Dieskau</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">November 16, 2007</td></tr>
<tr><td class="header">Expires: May 19, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Validation and long term verification data for Evidence Records and signed documents<br />draft-ietf-ltans-validate-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 19, 2008.</p>

<h3>Abstract</h3>

<p>Digitally signed documents and data in a LTANS service receive the
   signature renwal procedures and non-repudiation services.  As
   documents can be stored for very long (theoretically inifinite)
   times, it is very important to understand which data is and will be
   necessary for the verification of the contained digital signatures
   and the applied timestamps and the evidence records.  This document
   shall describe various pieces of information which SHOULD and MUST be
   provided to effectively verify evidence records and their protected
   data and signatures.
</p>
<h3>Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
General Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Basic assessment of environment of verification data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Types of trust centers (fully trusted – partially trusted)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.1.</a>&nbsp;
Fully trusted trust center<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.2.</a>&nbsp;
Partially trusted Trust Center<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.3.</a>&nbsp;
Layer model versus chain model<br />
<a href="#anchor9">4.</a>&nbsp;
Verification data for Evidence Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.</a>&nbsp;
List of verification data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.</a>&nbsp;
Location to store verification data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.3.</a>&nbsp;
Verification Data retrieved from an SCVP server<br />
<a href="#anchor13">5.</a>&nbsp;
Verification data for the signed documents secured by the Evidence Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.1.</a>&nbsp;
List of required verification data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.2.</a>&nbsp;
Location / structure to store verification data<br />
<a href="#anchor16">6.</a>&nbsp;
Validation policy<br />
<a href="#Security">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
   Data and documents stored in a Long term archiving services may contain
   digitally signed or encrypted data and their integrity may be assured
   with the use of timestamps and archivetimestamps as specified in
   ERS.  As such data and it's proof of existence and non-repudiation
   may be verified at a point in time very far in the future, it is 
   important to analyse and understand what information may be needed
   for this verification and what controls need to be implemented to
   ensure the availability and integrity of this data.
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<blockquote class="text">
<p>
        Archived data object: Data unit that is archived and has to be
        preserved for a long time by the Long-term Archive Service.            
        
</p>
<p>
        Archived data object group: A multitude of data objects, which for
        some reason belong together.  E.g. a document file and a signature
        file could be a archived data object group, which represent signed
        data.            
        
</p>
<p>
        Archive Timestamp: Is a timestamp and lists of hash values, which
        allows to verify the existence of several data objects at a
        certain time.    
        
</p>
<p>
        Evidence: Information that may be used to resolve a dispute about
        various aspects of authenticity of archived data objects.            
        
</p>
<p>
        Evidence record: Collection of evidence compiled for one or more
        given archived data objects over time.  An evidence record
        includes all Archive Timestamps (within structures of Archive
        Timestamp Chains and Archive Timestamp Sequences) and additional
        verification data, like certificates, revocation information,
        trust anchors, policy details, role information, etc.            
        
</p>
<p>
        Long-term Archive Service(LTA): A service responsible for
        preserving data for long periods of time, including generation and
        collection of evidence, storage of archived data objects and
        evidence, etc.           
        
</p>
<p>
        hash-tree: a hash tree as decribed by Merkle in [MER1980] 
        is a list of sorted hash values ordered in a tree where the child nodes 
        are combined and hashed to generate the father nodes up to one top node. 
        This hash-tree can also be reduced to a list as decribed in ERS.             
        
</p>
<p>
        Timestamp: A cryptographically secure confirmation generated by a
        Time Stamping Authority (TSA) [RFC3161] specifies a structure for
        timestamps and a protocol for communicating with a Time-stamp
        Authority (TSA).  Besides this, other data structures and
        protocols may also be appropriate, e.q., such as defined in
        [ISO-18014-1.2002], [ISO-18014-2.2002], [ISO-18014-3.2004], and
        [ANSI.X9-95.2005].           
        
</p>
<p>
        Trust Center: A Trust Center may be operated as a Trusted Third Party (TTP) 
        service (as also specified in RFC 3161), though other operational models may be 
        appropriate. Depending on local laws and criteria the services of a trust center 
        may include to provide certificates, OCSP responses and CRL for a guarantted period 
        of time. The Trust center can also function as the Trusted Third party connecting 
        (and guaranteeing the identity of the owner of a certificate with a certain person.              
        
</p>
</blockquote>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
General Considerations</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Basic assessment of environment of verification data</h3>

<p>Due to the lack of a common, international wide applicable understanding 
         of terms used in respect of digital signature related objects some basic 
         assessments have to be presumed and are discussed in this section.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Types of trust centers (fully trusted – partially trusted)</h3>

<p>
          Depending on local laws and authorities trust centers can be of different 
          levels of trust which can have impact on the verification data needed for 
          a later verification of the digital signatures, time stamps and ERS. <br />

          Typically two types of trust centers can be envisioned:     
          
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Fully trusted trust center</h3>

<p>
           A trust center that has been accredited by a local government authority or 
           a private office declared as competent from such, the accreditation saying 
           that all relevant requirements to ensure a certain security level are fulfilled 
           (as typically done in most of the European countries) can be classified as a 
           fully trusted at least in the national context. In case of multinational mutual 
           acceptance agreements this trust can be extended to regions or globally. 
           Based on the accreditation and the national interest in these trust centers it 
           can be assumed that it would be publicly known that and when a private key of 
           such a trust center was compromised. 
           
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Partially trusted Trust Center</h3>

<p>
          Partially trusted centers could e.g. be private organizations which function 
          as a kind of common notary but whose security and protection is not accredited 
          by a government authority. This usually means that the validity and availability 
          of the verification data can not be guaranteed. This implies that the LTA (Long term archive) 
          has to ensure at least the availability and usually also the integrity of the data 
          itself including all OCSP responses and or CRLs. 
          
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Layer model versus chain model</h3>

<p>
              Typically a signature depends on other instances that issue a certificate which 
              again have their certificates issued by another instance. E.g. a person could 
              get his certificate issued by a local (or company) trust center, which in turn 
              gets its own certificate issued by a government authority of fully trusted trust center. 
              So for verifiying a signature it is necessary to verify all certificates up to the root 
              which must be trusted if the signature shall be verified positively. 
              
</p>
<p>
              This raises the question if it is necessary that all certificates up to the roof have 
              to be valid at the time of signing (layer model),  or if it is sufficient that only the 
              latest signature is not yet expired at the time of signing and all signature algorithms 
              used in the chain are still considered secure (chain model). 
              
</p>
<p>
              Both models have pros and cons regarding the consequences occurring from different scenarios. 
              As the layer model is established on the international level more respected and accepted point of view. 
              
</p>
<p>
              Based on discussion in the working group the layer model is necessary for verifying a 
              chain of certificates when you verify a signature. 
              
</p>
<p>
              This would mean that all signatures in the certificates must be valid at the time of signing. 
              This means all used algorithms must still be secure and none of them must have been revoked. 
              (note: both cases would mean that the chain could have been compromised at this level and 
              below and which means the final signature can not be trusted.)                  
              
</p>
<p>
              Note: the layer model for the validity of the signatures in the certificates does not 
              imply that all certificates have not been expired. In the contrary, concerning the expiry 
              dates of certificates this means only you need to verify that the last certificate has not 
              been expired when the signature has been done. It is of no interest whether certificates in 
              the chain have already been expired as long as they have been valid at the time when they 
              were used to sign (issue) the lower certificates. 
              
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Verification data for Evidence Records</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
List of verification data</h3>

<p>
          Evidence Records contain hashtrees secured with time stamps. 
          The security and verification of the hashtrees themselves only depend on
          the used hash algorithm and its possible parameters. Despite the generally 
          available list of algorithms and their validity period (which could be documented 
          in a general policy) no further external verification data is necessary to 
          validate the integrity of the hashtrees. 
          
</p>
<p>
          The time stamps used in the Evidence Record are based on digital Signatures. 
          To validate these signatures in respect of their authenticity additional verification data 
          like certificates of all parties involved in the issuance of the time stamp certificate, 
          Certificate Revocation Lists (CRLs) and/or OCSP responses are needed.          
          
</p>
<p>
          To correctly verify the time stamps in the Evidence Record an expert needs to verify that 
          the used private key has not been compromised when it has been used. The time 
          information provided by a trusted time stamp authority allows to determine the 
          reference date to which the used private key had to be valid.     
          
</p>
<p>
          Additionally to fully evaluate the certificate used in respect of the time stamp signature 
          the correct chain of issuers of all certificates up to the root need to be checked.    
          
</p>
<p>
          Knowing the reference date the verifier needs an OCSP response or a CRL to verify 
          that the used certificate has not been revoked at the moment of signature creation. 
          Note: OSCP responses are not needed when a misuse of the certificate can be excluded 
          before its owner has obtained it, as could be the case with accredited time stamp authorities.    
          
</p>
<p>
         In cases where a specially accredited authority is the trusted time stamp authority 
         (refer to 2.1.1 a) fully trusted trust center), it could be assumed that the compromise 
         of used keys would have so much impact that it would be publicly known even without directly 
         checking the CRL or OCSP status of the used certificate. This situation can justify that it is only
         necessary to store all certificates but no CRL or OCSP response with the time stamp used in the 
         Evidence Record. Additionally based on the accreditation criteria it can also be the case that 
         certain availability of verification data is guaranteed by the local government. (E.g. in Germany for 30 years).     
          
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Location to store verification data</h3>

<p>
          All verification data necessary for the verification of the time stamp has to be stored 
          in a non-repudiation system as long as a later verification may be needed. And as this 
          verification data contain electronic signatures which used algorithms may expire further 
          renewals of these electronic signatures may be necessary[S2]. E.g. in RFC3161 time stamps 
          the verification data can be directly integrated into the time stamp, and is by this integrated, 
          protected and automatically renewed with the ERS using the time stamp. 
          
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Verification Data retrieved from an SCVP server</h3>

<p>
          The necessary verification data can also be stored separately in an SCVP server an be retrived 
          from there. This relieves the archiving party from integrating all evidence right at the time of archival 
          right into the document. The system can only store the data and some subset of the verification data, 
          e.g. only the end entity certificates into the documents and their signatures and leave it to an 
          SCVP server to store and protect the remaining required verification data. The SCVP server can provide 
          this data and their according protecting evidence recprds via ERS/SCVP <a class='info' href='#LTANS-ERS-SCVP'>[LTANS&#8209;ERS&#8209;SCVP]<span> (</span><span class='info'>IETF, &ldquo;Using SCVP to Convey Long-term Evidence Records,&rdquo; November&nbsp;2007.</span><span>)</span></a>. 
          
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Verification data for the signed documents secured by the Evidence Records</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
List of required verification data</h3>

<p>
         In respect of the verification data needed to secure a long term validation of the electronic 
         signature all the above mentioned requirements are applicable. The only differences refer to 
         the fact that the signature is not issued by a time stamp authority as owner of the certificate but a person. 
         
</p>
<p>
         Therefore a special reference time regarding the validity of the certificate at the time of signature 
         creation is needed to verify that the used private key has not been compromised before it has been used. 
         
</p>
<p>
         With reference to the above the correct chain of issuers of all certificates up to the root need 
         to be verified to fully evaluate the certificate used in respect of the signature. A CRL is needed 
         to verify that the used certificate has not been revoked at the moment of signature creation. 
         To verify the authenticity of the CRL the issuer of it has to be checked by verifying the 
         signature of the CRL. Therefore the correct chain of issuers of all certificates up to the root needs to be verified.
         
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Location / structure to store verification data</h3>

<p>
         All verification data necessary for the verification of the time stamp have to be stored in a 
         non-repudiation system as long as a later verification may be needed. As these verification data 
         contain electronic signatures which algorithms may expire further renewals of these electronic 
         signatures may be necessary. 
         
</p>
<p>
         This explicitly includes OCSP or CRL data and all certificates (including the complete chains for the used signatures.
         
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Validation policy</h3>

<p>
          To validate signatures, time stamps and evidence records it is useful for a validation authority 
          to define and apply a verification policy. In this policy the verifier defines which algorithms 
          are considered valid and secure in which time frames.
          A policy is defined in "Data Structure for Security Suitabilities of Cryptographic Algorithms" 
          <a class='info' href='#LTANS-DSSC'>[LTANS&#8209;DSSC]<span> (</span><span class='info'>IETF, &ldquo;Data Structure for Security Suitabilities of Cryptographic Algorithms (DSSC),&rdquo; October&nbsp;2007.</span><span>)</span></a>
          
</p>
<p>
          Basically the policy simply contains the algorithm identifier and the two dates valid from and 
          expires. With this information the verifier can check that all algorithms have only been used 
          at the time when they have been considered secure. Any deviation from this in the historic 
          time line of an Evidence Record or a signature SHOULD lead to the failure of the verification.    
          
</p>
<p>
          Following examples should lead to a failure of the verification:
              </p>
<ol class="text">
<li>
              a signature of time stamp used an algorithm which has been secure at the time of application 
              but is no longer considered secure (i.e. expired in the policy) and has not been protected 
              by more secure time stamps in an applied ERS SHOULD fail to be verified
              
</li>
<li>
              an ERS with a timestamp in the latest structure that is not considered secure SHOULD fail to verify.
              
</li>
<li>
              Whenever in the structure of an ERS a later ArchiveTimestamp is applied after the algorithm in the 
              timestamp of the preceding ArchiveTimeStamp is expired (as defined per policy) the verification MUST fail.
              
</li>
<li>
              Whenever in the structure of an ERS a ArchiveTimeStampChain is applied after the hash algorithm 
              of the preceding ArchiveTimeStampChain is no longer secure (as defined in the verification policy) 
              the verification MUST fail.
              
</li>
</ol><p>
          
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Long term availability and integrity of verification data
</p>
<p>The verification data has to be stored and available including non-repudiation for all verification data.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ANSX995">[ANSX995]</a></td>
<td class="author-text">American National Standard for Financial Services, &ldquo;Trusted Timestamp Management and Security,&rdquo; ANSX&nbsp;X9.95-2005, June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="I180141">[I180141]</a></td>
<td class="author-text">ISO/IEC JTC 1/SC 27, &ldquo;Time stamping services – Part 1: Framework,&rdquo; ISO&nbsp;ISO-18014-1, February&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I180142">[I180142]</a></td>
<td class="author-text">ISO/IEC JTC 1/SC 27, &ldquo;Time stamping services – Part 2: Mechanisms producing independent tokens,&rdquo; ISO&nbsp;ISO-18014-2, December&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I180143">[I180143]</a></td>
<td class="author-text">ISO/IEC JTC 1/SC 27, &ldquo;Time stamping services – Part 3: Mechanisms producing linked tokens,&rdquo; ISO&nbsp;ISO-18014-3, February&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2026">[RFC2026]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2026">The Internet Standards Process -- Revision 3</a>,&rdquo; RFC&nbsp;2026, 1996 (<a href="http://www.ietf.org/rfc/rfc2026.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key Words for Use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, 1997 (<a href="http://www.ietf.org/rfc/rfc2119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3126">[RFC3126]</a></td>
<td class="author-text">Adams, C., Pinkas, D., Ross, J., and N. Pope, &ldquo;<a href="http://tools.ietf.org/html/rfc3126">Electronic Signature Formats for long term electronic signatures</a>,&rdquo; RFC&nbsp;3126, 2001 (<a href="http://www.ietf.org/rfc/rfc3126.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3161">[RFC3161]</a></td>
<td class="author-text">Adams, C., Cain, P., Pinkas, D., and R. Zuccherato, &ldquo;<a href="http://tools.ietf.org/html/rfc3161">Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)</a>,&rdquo; RFC&nbsp;3161, August&nbsp;2001 (<a href="http://www.ietf.org/rfc/rfc3161.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, August&nbsp;2001 (<a href="http://www.ietf.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="http://www.ietf.org/rfc/rfc3852.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ETSI2003">[ETSI2003]</a></td>
<td class="author-text">European Telecommunication Standards Institute (ETSI),
Electronic Signatures and Infrastructures (ESI);, &ldquo;Algorithms and Parameters for Secure Electronic Signatures,&rdquo; ETSI&nbsp;SR 002 176 V1.1.1, March&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="LTANS-DSSC">[LTANS-DSSC]</a></td>
<td class="author-text">IETF, &ldquo;Data Structure for Security Suitabilities of Cryptographic Algorithms (DSSC),&rdquo; October&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="LTANS-ERS-SCVP">[LTANS-ERS-SCVP]</a></td>
<td class="author-text">IETF, &ldquo;Using SCVP to Convey Long-term Evidence Records,&rdquo; November&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="MER1980">[MER1980]</a></td>
<td class="author-text">Merkle, R., &ldquo;Protocols for Public Key Cryptosystems,
             Proceedings of the 1980 IEEE Symposium on Security and 
             Privacy (Oakland, CA, USA),&rdquo; pages&nbsp;122-134, April&nbsp;1980.</td></tr>
<tr><td class="author-text" valign="top"><a name="REQ2004">[REQ2004]</a></td>
<td class="author-text">Wallace, C., Brandner, R., and U. Pordesch, &ldquo;Long-term Archive Service Requirements,&rdquo; I-D&nbsp;???, 2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tobias Gondrom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Werner-von-Siemens-Ring 20</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Grasbrunn, Munich  D-85630</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 89 4629-1816</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+49 (0) 89 4629-33-1816</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tobias.gondrom@opentext.com">tobias.gondrom@opentext.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stefanie Fischer-Dieskau</td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
