
PKIX Working Group                                             J. Schaad
Internet-Draft                                   Soaring Hawk Consulting
Expires: April 25, 2006                                         M. Myers
                                               TraceRoute Security, Inc.
                                                        October 22, 2005


       Certificate Management over CMS (CMC) Transport Protocols
                    draft-ietf-pkix-cmc-trans-04.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 25, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document defines a number of transport mechanisms that are used
   to move CMC (Certificate Managment over CMS (Cryptographic Message
   Syntax)) messages.  The transport mechanisms described in this
   document are: HTTP, file, mail and TCP.






Schaad & Myers           Expires April 25, 2006                 [Page 1]

Internet-Draft          CMC: Transport Protocols            October 2005


1.  Overview

   This document defines a number of transport methods that are used to
   move CMC messages (defined in [CMC-STRUCT]).  The transport
   mechanisms described in this document are: HTTP, file, mail and TCP.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].


2.  File based protocol

   Enrollment messages and responses may be transferred between clients
   and servers using file system-based mechanisms, such as when
   enrollment is performed for an off-line client.  When files are used
   to transport binary, BER-encoded Full Enrollment Request and Response
   messages, there MUST be only one instance of a request or response
   message in a single file.  The following file type extensions SHOULD
   be used:

                  +-------------------+----------------+
                  | Message Type      | File Extension |
                  +-------------------+----------------+
                  | Full PKI Request  | .crq           |
                  | Full PKI Response | .crp           |
                  +-------------------+----------------+


3.  Mail based protocol

   MIME wrapping is defined for those environments that are MIME native.

   The basic mime wrapping in this section is taken from [SMIMEV2] and
   [SMIMEV3].  Simple enrollment requests are encoded using the
   "application/pkcs10" content type.  A file name MUST be included
   either in a content type or a content disposition statement.  The
   extension for the file MUST be ".p10".

   Simple enrollment response messages MUST be encoded as content-type
   "application/pkcs7-mime".  An smime-type parameter MUST be on the
   content-type statement with a value of "certs-only."  A file name
   with the ".p7c" extension MUST be specified as part of the content-
   type or content-disposition statement.

   Full enrollment request messages MUST be encoded as content-type
   "application/pkcs7-mime".  The smime-type parameter MUST be included
   with a value of "CMC-enroll".  A file name with the ".p7m" extension



Schaad & Myers           Expires April 25, 2006                 [Page 2]

Internet-Draft          CMC: Transport Protocols            October 2005


   MUST be specified as part of the content-type or content-disposition
   statement.

   Full enrollment response messages MUST be encoded as content-type
   "application/pkcs7-mime".  The smime-type parameter MUST be included
   with a value of "CMC-response."  A file name with the ".p7m"
   extensions MUST be specified as part of the content-type or content-
   disposition statement.

   +-------------+------------------------+-------------+--------------+
   | Item        | MIME TYPE              | File        | SMIME-TYPE   |
   |             |                        | Extension   |              |
   +-------------+------------------------+-------------+--------------+
   | simple      | application/pkcs10     | .p10        | N/A          |
   | request     |                        |             |              |
   | full        | applicaiton/pkcs7-mime | .p7m        | CMC-request  |
   | request     |                        |             |              |
   | simple      | application/pkcs7-mime | .p7c        | certs-only   |
   | response    |                        |             |              |
   | full        | application/pkcs7-mime | .p7m        | CMC-response |
   | response    |                        |             |              |
   +-------------+------------------------+-------------+--------------+


4.  HTTP/HTTPS based protocol

   HTTP messages are wrapped with by a mime object as specified above.


5.  TCP based protocol

   When CMC messages are sent over a TCP-Based connection, no wrapping
   is required of the message.  Messages are sent in their binary
   encoded form.

   The connection is closed by the server after generating a response
   for the client.  (All CMC request messages from client to server
   generate a response message.)  If a second set of messages from the
   client to the server is required to complete the transaction, the
   client generates a new TCP-Based connection for this purpose; it
   cannot reuse an existing one.

   Out of band setup can be used to keep a TCP-Based connection open for
   more than one message pair.  A situation where this can occur is an
   RA talking to a CA over a specially setup TCP connection.






Schaad & Myers           Expires April 25, 2006                 [Page 3]

Internet-Draft          CMC: Transport Protocols            October 2005


6.   Socket-Based Transport

   When enrollment messages and responses are sent over sockets, no
   wrapping is required.  Messages MUST be sent in their binary, BER-
   encoded form.


7.   Security Considerations

   Mechanisms for thwarting replay attacks may be required in particular
   implementations of this protocol depending on the operational
   environment.  In cases where the CA maintains significant state
   information, replay attacks may be detectable without the inclusion
   of the optional nonce mechanisms.  Implementers of this protocol need
   to carefully consider environmental conditions before choosing
   whether or not to implement the senderNonce and recipientNonce
   attributes described in section 5.6.  Developers of state-constrained
   PKI clients are strongly encouraged to incorporate the use of these
   attributes.


8.  Acknowledgments

   The authors and the Working Group are greatful for the participation
   of Xiaoui Lui and Jeff Weinstein in helping to author the original
   versions of this document.

   The authors would like to thank Brian LaMacchia for his work in
   developing and writing up many of the concepts presented in this
   document.  The authors would also like to thank Alex Deacon and Barb
   Fox for their contributions.


9.  References

9.1.  Normative References

   [CMC-STRUCT]
              Schaad, J. and M. Myers, "Certificate Management Messages
              over CMS", Work in Progress , September 2005.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", RFC 2119, BCP 14, March 1997.

   [SMIMEV3]  Ramsdell, B., "S/MIME Version 3 Message Specification",
              RFC 2633, June 1999.





Schaad & Myers           Expires April 25, 2006                 [Page 4]

Internet-Draft          CMC: Transport Protocols            October 2005


9.2.  Informative References

   [SMIMEV2]  Dusse, S., Hoffman, P., Ramsdell, B., Lundblade, L., and
              L. Repka, "S/MIME Version 2 Message Specification",
              RFC 2311, March 1998.














































Schaad & Myers           Expires April 25, 2006                 [Page 5]

Internet-Draft          CMC: Transport Protocols            October 2005


Authors' Addresses

   Jim Schaad
   Soaring Hawk Consulting
   PO Box 675
   Gold Bar, WA  98251

   Phone: (425) 785-1031
   Email: jimsch@exmsft.com


   Michael Myers
   TraceRoute Security, Inc.

   Email: myers@coastside.inc




































Schaad & Myers           Expires April 25, 2006                 [Page 6]

Internet-Draft          CMC: Transport Protocols            October 2005


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2005).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Schaad & Myers           Expires April 25, 2006                 [Page 7]





