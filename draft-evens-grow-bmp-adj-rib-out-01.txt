 



Global Routing Operations                                       T. Evens
Internet-Draft                                              S. Bayraktar
Updates: 7854 (if approved)                                Cisco Systems
Intended Status: Standards Track                              P. Lucente
Expires: October 1, 2017                              NTT Communications
                                                                   P. Mi
                                                                 Tencent
                                                               S. Zhuang
                                                                  Huawei
                                                          March 30, 2017


       Support for Adj-RIB-Out in BGP Monitoring Protocol (BMP) 
                  draft-evens-grow-bmp-adj-rib-out-01


Abstract

   The BGP Monitoring Protocol (BMP) defines access to only the Adj-RIB-
   In Routing Information Bases (RIBs).  This document updates the BGP
   Monitoring Protocol (BMP) RFC 7854 by adding access to the Adj-RIB-
   Out RIBs. It adds a new flag to the peer header to distinguish Adj-
   RIB-In and Adj-RIB-Out.


Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on October 1, 2017.

 


Evens, et al.           Expires October 1, 2017                 [Page 1]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


Copyright and License Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document. Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Per-Peer Header  . . . . . . . . . . . . . . . . . . . . . . .  4
   4.  Adj-RIB-Out  . . . . . . . . . . . . . . . . . . . . . . . . .  4
     4.1.  Post-Policy  . . . . . . . . . . . . . . . . . . . . . . .  4
     4.2.  Pre-Policy . . . . . . . . . . . . . . . . . . . . . . . .  4
   5.  BMP Messages . . . . . . . . . . . . . . . . . . . . . . . . .  5
     5.1.  Route Monitoring and Route Mirroring . . . . . . . . . . .  5
     5.2.  Statistics Report  . . . . . . . . . . . . . . . . . . . .  5
     5.3.  Peer Down and Up Notifications . . . . . . . . . . . . . .  5
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . .  6
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  6
     7.1.  BMP Peer Flags . . . . . . . . . . . . . . . . . . . . . .  6
     7.2.  BMP Statistics Types . . . . . . . . . . . . . . . . . . .  6
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  6
     8.1. URIs  . . . . . . . . . . . . . . . . . . . . . . . . . . .  6
     8.2.  Normative References . . . . . . . . . . . . . . . . . . .  6
   Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . . .  8
   Contributors . . . . . . . . . . . . . . . . . . . . . . . . . . .  8
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . .  9








 


Evens, et al.           Expires October 1, 2017                 [Page 2]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


1.  Introduction

   BGP Monitoring Protocol (BMP) defines monitoring of the received
   (e.g. Adj-RIB-In) Routing Information Bases (RIBs) per peer.  The
   Adj-RIB-In pre-policy conveys to a BMP receiver all RIB data before
   any policy has been applied.  The Adj-RIB-In post-policy conveys to a
   BMP receiver all RIB data after policy filters and/or modifications
   have been applied.  An example of pre-policy verses post-policy is
   when an inbound policy applies attribute modification or filters.
   Pre-policy would contain information prior to the inbound policy
   changes or filters of data. Post policy would convey the changed data
   or would not contain the filtered data.

   Monitoring the received updates that the router received before any
   policy has been applied is the primary level of monitoring for most
   use-cases.  Inbound policy validation and auditing is the primary
   use-case for enabling post-policy monitoring.  

   In order for a BMP receiver to receive any BGP data, the BMP sender
   (e.g. router) needs to have an established BGP peering session and
   actively be receiving updates for an Adj-RIB-In. 

   Being able to only monitor the Adj-RIB-In puts a restriction on what
   data is available to BMP receivers via BMP senders (e.g. routers). 
   This is an issue when the receiving end of the BGP peer is not
   enabled for BMP or when it is not accessible for administrative
   reasons.  For example, a service provider advertises prefixes to a
   customer, but the service provider cannot see what it advertises via
   BMP. Asking the customer to enable BMP and monitoring of the Adj-RIB-
   In is not feasible. 

   This document updates BGP Monitoring Protocol (BMP) RFC 7854
   [RFC7854] peer header by adding a new flag to distinguish Adj-RIB-In
   verses Adj-RIB-Out. 

   Adding Adj-RIB-Out enables the ability for a BMP sender to send to a
   BMP receiver what it advertises to BGP peers, which can be used for
   outbound policy validation and to monitor RIBs that were advertised.


1.1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].



 


Evens, et al.           Expires October 1, 2017                 [Page 3]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


2.  Definitions


   o  Adj-RIB-Out: As defined in [RFC4271], "The Adj-RIBs-Out contains
      the routes for advertisement to specific peers by means of the
      local speaker's UPDATE messages."

   o  Pre-Policy Adj-RIB-Out: The result before applying the outbound
      policy to an Adj-RIB-Out. This normally would match what is in the
      local RIB.

   o  Post-Policy Adj-RIB-Out: The result of applying outbound policy to
      an Adj-RIB-Out. This MUST be what is actually sent to the peer.


3.  Per-Peer Header

   The per-peer header has the same structure and flags as defined in
   section 4.2 [RFC7854] with the following O flag addition: 

                                 0 1 2 3 4 5 6 7
                                +-+-+-+-+-+-+-+-+
                                |V|L|A|O| Resv  |
                                +-+-+-+-+-+-+-+-+

      o  The O flag indicates Adj-RIB-In if set to 0 and Adj-RIB-Out if
         set to 1. 

      The remaining bits are reserved for future use. They MUST be
      transmitted as 0 and their values MUST be ignored on receipt. 


4.  Adj-RIB-Out 

4.1.  Post-Policy

   The primary use-case in monitoring Adj-RIB-Out is to monitor the
   updates transmitted to the BGP peer after outbound policy has been
   applied. These updates reflect the result after modifications and
   filters have been applied (e.g. Adj-RIB-Out Post-Policy).  The L flag
   MUST be set to 1 in this case to indicate post-policy. 

4.2.  Pre-Policy

   As with Adj-RIB-In policy validation, there are use-cases that pre-
   policy Adj-RIB-Out is used to validate and audit outbound policies. 
   For example, a comparison between pre-policy and post-policy can be
   used to validate the outbound policy.  The L flag MUST be set to 0 in
 


Evens, et al.           Expires October 1, 2017                 [Page 4]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


   this case to indicate pre-policy. 

5.  BMP Messages

   Many BMP messages have a per-peer header but some are not applicable
   to Adj-RIB-In or Adj-RIB-Out monitoring.  Unless otherwise defined,
   the O flag should be set to 0 in the per-peer header in BMP
   messages.


5.1.  Route Monitoring and Route Mirroring

   The O flag MUST be set accordingly to indicate if the route monitor
   or route mirroring message conveys Adj-RIB-In or Adj-RIB-Out.  

5.2.  Statistics Report

   Statistics report message has Stat Type field to indicate the
   statistic carried in the Stat Data field. Statistics report messages
   are not specific to Adj-RIB-In or Adj-RIB-Out and MUST have the O
   flag set to zero. The O flag SHOULD be ignored by the BMP receiver.
   The following new statistic types are added: 

   o  Stat Type = TBD: (64-bit Gauge) Number of routes in Adj-RIBs-Out
      Pre-Policy.

   o  Stat Type = TBD: (64-bit Gauge) Number of routes in Adj-RIBs-Out
      Post-Policy.

   o  Stat Type = TBD: Number of routes in per-AFI/SAFI Adj-RIB-Out Pre-
      Policy.  The value is structured as: 2-byte Address Family
      Identifier (AFI), 1-byte Subsequent Address Family Identifier
      (SAFI), followed by a 64-bit Gauge.

   o  Stat Type = TBD: Number of routes in per-AFI/SAFI Adj-RIB-Out
      Post-Policy.  The value is structured as: 2-byte Address Family
      Identifier (AFI), 1-byte Subsequent Address Family Identifier
      (SAFI), followed by a 64-bit Gauge.


5.3.  Peer Down and Up Notifications

   PEER UP and DOWN notifications convey BGP peering session state to
   BMP receivers.  The state is independent of whether or not route
   monitoring or route mirroring messages will be sent for Adj-RIB-In,
   Adj-RIB-Out, or both.  BMP receiver implementations SHOULD ignore the
   O flag in PEER UP and DOWN notifications.

 


Evens, et al.           Expires October 1, 2017                 [Page 5]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


6.  Security Considerations

   It is not believed that this document adds any additional security
   considerations.


7.  IANA Considerations

   This document requests that IANA assign the following BMP new
   parameters to the BMP parameters name space [1].

7.1.  BMP Peer Flags

   This document defines a new flag (Section 3):

   o  Flag 3 as O flag

7.2.  BMP Statistics Types

      This document defines four new statistic types for statistics
      reporting (Section 4.2):

   o  Stat Type = TBD: (64-bit Gauge) Number of routes in Adj-RIBs-Out
      Pre-Policy.

   o  Stat Type = TBD: (64-bit Gauge) Number of routes in Adj-RIBs-Out
      Post-Policy.

   o  Stat Type = TBD: Number of routes in per-AFI/SAFI Adj-RIB-Out Pre-
      Policy.  The value is structured as: 2-byte Address Family
      Identifier (AFI), 1-byte Subsequent Address Family Identifier
      (SAFI), followed by a 64-bit Gauge.

   o  Stat Type = TBD: Number of routes in per-AFI/SAFI Adj-RIB-Out
      Post-Policy.  The value is structured as: 2-byte Address Family
      Identifier (AFI), 1-byte Subsequent Address Family Identifier
      (SAFI), followed by a 64-bit Gauge.


8.  References

8.1. URIs

   [1]  https://www.iana.org/assignments/bmp-parameters/bmp-
              parameters.xhtml


8.2.  Normative References
 


Evens, et al.           Expires October 1, 2017                 [Page 6]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI
              10.17487/RFC2119, March 1997, <http://www.rfc-
              editor.org/info/rfc2119>.

   [RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", RFC 4271, DOI
              10.17487/RFC4271, January 2006, <http://www.rfc-
              editor.org/info/rfc4271>.

   [RFC7854]  Scudder, J., Ed., Fernando, R., and S. Stuart, "BGP
              Monitoring Protocol (BMP)", RFC 7854, DOI
              10.17487/RFC7854, June 2016, <http://www.rfc-
              editor.org/info/rfc7854>.


































 


Evens, et al.           Expires October 1, 2017                 [Page 7]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


Acknowledgments

   The authors would like to thank John Scudder for his valuable input.

Contributors


   Manish Bhardwaj
   Cisco Systems
   3700 Cisco Way
   San Jose, CA 95134
   USA
   	
   Email: manbhard@cisco.com



   Xianyuzheng
   Tencent
   Tencent Building, Kejizhongyi Avenue,
   Hi-techPark, Nanshan District,Shenzhen 518057, P.R.China




   Weiguo
   Tencent
   Tencent Building, Kejizhongyi Avenue,
   Hi-techPark, Nanshan District,Shenzhen 518057, P.R.China



   Shugang cheng
   H3C














 


Evens, et al.           Expires October 1, 2017                 [Page 8]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


Authors' Addresses


   Tim Evens
   Cisco Systems
   2901 Third Avenue, Suite 600
   Seattle, WA 98121
   USA
   	
   Email: tievens@cisco.com



   Serpil Bayraktar
   Cisco Systems
   3700 Cisco Way
   San Jose, CA 95134
   USA
   	
   Email: serpil@cisco.com



   Paolo Lucente
   NTT Communications
   Siriusdreef 70-72
   Hoofddorp  2132 WT
   NL

   Email: paolo@ntt.net



   Penghui Mi
   Tencent
   Tengyun Building,Tower A ,No. 397 Tianlin Road
   Shanghai  200233
   China

   Email: kevinmi@tencent.com



   Shunwan Zhuang
   Huawei
   Huawei Bld., No.156 Beiqing Rd.
   Beijing  100095
   China
 


Evens, et al.           Expires October 1, 2017                 [Page 9]

Internet-Draft              BMP Adj-RIB-Out                  March, 2017


   Email: zhuangshunwan@huawei.com


















































Evens, et al.           Expires October 1, 2017                [Page 10]
