IETF conneg working group                                 Graham Klyne
Internet draft                                    Content Technologies
Category: Work-in-progress                            30 November 1999
                                                     Expires: May 2000


              Indicating media features for MIME content
             <draft-ietf-conneg-content-features-02.txt>


Status of this memo

  This document is an Internet-Draft and is in full conformance with
  all provisions of Section 10 of RFC 2026.

  Internet-Drafts are working documents of the Internet Engineering
  Task Force (IETF), its areas, and its working groups.  Note that
  other groups may also distribute working documents as Internet-
  Drafts.

  Internet-Drafts are draft documents valid for a maximum of six
  months and may be updated, replaced, or obsoleted by other
  documents at any time.  It is inappropriate to use Internet- Drafts
  as reference material or to cite them other than as "work in
  progress."

     The list of current Internet-Drafts can be accessed at
     http://www.ietf.org/ietf/1id-abstracts.txt

     The list of Internet-Draft Shadow Directories can be accessed at
     http://www.ietf.org/shadow.html.

Copyright Notice

  Copyright (C) The Internet Society 1999.  All Rights Reserved.

Abstract

  In "A syntax for describing media feature sets", an expression
  format is presented for describing media feature capabilities using
  simple media feature tags.

  This memo defines a MIME 'Content-features:' header that can be
  used to annotate a MIME message part using this expression format,
  and indicates some ways it might be used.










Klyne                      Work-in-progress                   [Page 1]

Internet draft              Indicating media features for MIME content
30 November 1999



Table of contents

  1. Introduction ............................................2
     1.1 Terminology and document conventions                 3
     1.2 Discussion of this document                          3
  2. Motivation and goals ....................................4
  3. The 'Content-features:' MIME header .....................4
     3.1 Usage considerations                                 4
       3.1.1 Simple message parts                             4
       3.1.2 Multipart and other composites                   5
       3.1.3 Reference to external data                       5
  4. Examples ................................................5
     4.1 Simple message                                       5
     4.2 Fax message                                          6
     4.3 Multipart/alternative data                           6
     4.4 Reference to external message data                   7
     4.5 Compressed data                                      8
     4.6 Multipart/related data                               8
  5. Security considerations .................................9
  6. Acknowledgements ........................................9
  7. References ..............................................9
  8. Author's address ........................................10
  Full copyright statement ...................................11
  Revision history ...........................................11


1. Introduction

  In "A syntax for describing media feature sets" [1], an expression
  format is presented for describing media feature capabilities as a
  combination of simple media feature tags, registered according to
  "Media Feature Tag Registration Procedure" [2].  This provides a
  format for message handling agents to describe the media feature
  content of messages that they can handle.

  This memo defines a MIME 'Content-features:' header that can be
  used to annotate a MIME message part using these feature
  expressions.  This header provides a means to indicate media-
  related features of message content that go beyond the MIME content
  type.

  Along with the new MIME header definition, consideration is also
  given to how it may be used to present message media content
  information that is problematic to express within the basic MIME
  framework.






Klyne                      Work-in-progress                   [Page 2]

Internet draft              Indicating media features for MIME content
30 November 1999


1.1 Terminology and document conventions

  This section defines a number of terms and other document
  conventions, which are used with specific meaning in this memo.

  media feature
            information that indicates facilities assumed to be
            available for the message content to be properly rendered
            or otherwise presented.  Media features are not intended
            to include information that affects message transmission.

  feature set
            some set of media features described by a media feature
            assertion, as described in "A syntax for describing media
            feature sets" [1].  (See that memo for a more formal
            definition of this term.)

  feature set expression
            a string that describes some feature set, formulated
            according to the rules in "A syntax for describing media
            feature sets" [1] (and possibly extended by other
            specifications).

  This specification uses syntax notation and conventions described
  in RFC 2234 "Augmented BNF for Syntax Specifications: ABNF" [3].

       NOTE:  Comments like this provide additional nonessential
       information about the rationale behind this document.
       Such information is not needed for building a conformant
       implementation, but may help those who wish to understand
       the design in greater depth.

1.2 Discussion of this document

  Discussion of this document should take place on the content
  negotiation and media feature registration mailing list hosted by
  the Internet Mail Consortium (IMC):

  Please send comments regarding this document to:

      ietf-medfree@imc.org

  To subscribe to this list, send a message with the body 'subscribe'
  to "ietf-medfree-request@imc.org".

  To see what has gone on before you subscribed, please see the
  mailing list archive at:

      http://www.imc.org/ietf-medfree/



Klyne                      Work-in-progress                   [Page 3]

Internet draft              Indicating media features for MIME content
30 November 1999


2. Motivation and goals

  It is envisaged that media feature labelling of message parts may
  be used in the following ways:

  o  to supply more detailed media feature information about a message
     content than can be provided by the 'Content-type:' header.

  o  to provide summary media feature information (possibly including
     MIME content types) about the content of a composite MIME message
     part (e.g. 'multipart' or 'message'), without having to open up
     the inner content of the message.

  o  to supply media feature information about external data
     referenced by a message part (e.g. 'message/external-body' MIME
     type).  This information would not be available by examination of
     the message content.

  o  to describe the content of a message that is encrypted or encoded
     using some application-specific file structure that hides the
     content from a MIME processor.  This information also would not
     be generally available by examination of the message content.

3. The 'Content-features:' MIME header

  A new header field is defined that extends the allowable formats
  for 'optional-field' [4] with the following syntax:

     optional-field =/ "Content-features" ":" Feature-expr
     Feature-expr   =  filter      ; See [1], section 4.1

  where 'filter' is the media feature expression format defined by "A
  syntax for describing media feature sets" [1].

  This header provides additional information about the message
  content directly contained or indirectly referenced in the
  corresponding MIME message part.

3.1 Usage considerations

3.1.1 Simple message parts

  When applied to a simple MIME message part, the header should
  appear just once and is used to convey additional information about
  the message part content that goes beyond that provided by the MIME
  'Content-type:' header field.  The 'Content-features:' header may
  indicate a content type that is different than that given by the
  MIME 'Content-type:' header.  This is possible but not recommended
  when applied to a non-composite body part:  in any case, MIME



Klyne                      Work-in-progress                   [Page 4]

Internet draft              Indicating media features for MIME content
30 November 1999


  content type processing must be performed in accordance with the
  'Content-type:' header.

       NOTE:  Once the message content has been delivered to an
       application, it is possible that subsequent processing
       may be affected by content type information indicated by
       the media feature expression.

3.1.2 Multipart and other composites

  'Content-features:' headers may be applied to a MIME multipart
  indicating information about the inner content of the multipart.
  No one-to-one relationship between headers and contained body parts
  is assumed.

  If it is important to relate specific media features to specific
  MIME body parts, then the 'Content-features:' header should be
  applied directly to the body part concerned, rather than the
  surrounding composite.

       NOTE:  The intent here is to allow summary media feature
       information to be provided without having to open up and
       examine the inner content of the MIME message.

  Similar usage may apply when the message format is a non-MIME or
  opaque composite;  e.g. 'application/zip', or an encrypted message.
  In these cases, the option of examining the message content to
  discover media feature information is not available.

3.1.3 Reference to external data

  Media feature information about data indirectly referenced by a
  MIME body part rather than contained within message can be conveyed
  using one or more 'Content-features:' headers.

  For example, media information --including contained MIME content
  type(s)-- about the data referenced by a MIME 'Message/external-
  body' may be conveyed.

4. Examples

4.1 Simple message

     Mime-Version: 1.0
     Content-type: text/plain;charset=US-ASCII
     Content-features: (& (paper-size=A4) (ua-media=stationery) )

      :
     (data)
      :


Klyne                      Work-in-progress                   [Page 5]

Internet draft              Indicating media features for MIME content
30 November 1999


4.2 Fax message

     Mime-Version: 1.0
     Content-Type: multipart/mixed; boundary="break"
     Content-features:
       (& (Type="image/tiff")
          (color=Binary)
          (image-file-structure=TIFF-S)
          (dpi=200)
          (dpi-xyratio=200/100)
          (paper-size=A4)
          (image-coding=MH) (MRC-mode=0)
          (ua-media=stationery) )

     --break
     Content-Type: image/tiff; name="coverpage.tiff"
     Content-Transfer-Encoding: base64
     Content-Description: This part is a coverpage
     Content-Disposition: attachment; filename="coverpage.tiff"

     0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAA
     AAAAAAAAEAAAZAAAAAEAAAD+////AAAAAAAAAAD////////////////////
      :
     (more data)
      :
     --break
     Content-Type: image/tiff; name="document.tiff"
     Content-Transfer-Encoding: base64
     Content-Disposition: attachment; filename="document.tiff"

     AAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABg
     GgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACQAAAA
      :
     (more data)
      :
     --break--

4.3 Multipart/alternative data

  This example illustrates two points:

  o  Information about the various parts in a multipart/alternative
     can be made available before the alternative body parts are
     processed.  This may facilitiate optimum one-pass processing of
     multipart/alternative data.

  o  There may be alternatives having the same basic MIME content-
     type, but differing in the content features that they use.




Klyne                      Work-in-progress                   [Page 6]

Internet draft              Indicating media features for MIME content
30 November 1999


     Mime-Version: 1.0
     Content-Type: multipart/alternative; boundary="break"
     Content-features: (& (Type="text/plain") (charset=US-ASCII) )
     Content-features:
       (& (Type="text/html") (charset=ISO-8859-1) (color=binary) )
     Content-features:
       (& (Type="text/html") (charset=ISO-8859-1) (color=limited) )

     --break
     Content-type: "text/plain";charset="US-ASCII"

      :
     (data)
      :
     --break
     Content-type: text/html;charset="iso-8859-1"
     Content-features: (color=binary)

      :
     (data)
      :
     --break
     Content-type: text/html;charset="iso-8859-1"
     Content-features: (color=limited)

      :
     (data)
      :
     --break--

4.4 Reference to external message data

     Mime-Version: 1.0
     Content-type: message/external-body; access-type=URL;
                   URL="http://www.foo.com/file1.html"

     Content-type: Multipart/mixed
     Content-features: (& (Type="text/plain") (charset=US-ASCII) )
     Content-features: (& (Type="image/tiff") (color=limited) )

     <end>











Klyne                      Work-in-progress                   [Page 7]

Internet draft              Indicating media features for MIME content
30 November 1999


4.5 Compressed data

  This example shows how the "Content-features" header can be used to
  overcome the problem noted in the MIME registration for
  "Application/zip" regarding information about the data content.

     Mime-Version: 1.0
     Content-type: application/zip
     Content-features: (& (Type="text/plain") (charset=US-ASCII) )
     Content-features: (& (Type="image/tiff") (color=limited) )
     Content-transfer-encoding: base64

      :
     (data)
      :
     <end>

4.6 Multipart/related data

  (See also: RFC 2387, "The MIME Multipart/Related Content-type" [8])

     Mime-Version: 1.0
     Content-Type: multipart/related; boundary="boundary-example";
                   type="text/html"; start="<foo3@foo1@bar.net>"
     Content-features: (& (type="text/html") (charset=US-ASCII) )
     Content-features: (type="image/gif")

     --boundary-example
     Content-Type: text/html;charset="US-ASCII"
     Content-ID: <foo3@foo1@bar.net>

     ... text of the HTML document, which might contain a URI
     referencing a resource in another body part, for example
     through a statement such as:
     <IMG SRC="http://www.ietf.cnri.reston.va.us/images/ietflogo.gif"
      ALT="IETF logo">

     --boundary-example
     Content-Location:
        http://www.ietf.cnri.reston.va.us/images/ietflogo.gif
     Content-Type: IMAGE/GIF
     Content-Transfer-Encoding: BASE64

     R0lGODlhGAGgAPEAAP/////ZRaCgoAAAACH+PUNvcHlyaWdodCAoQykgMTk5
     NSBJRVRGLiBVbmF1dGhvcml6ZWQgZHVwbGljYXRpb24gcHJvaGliaXRlZC4A
     etc...

     --boundary-example--




Klyne                      Work-in-progress                   [Page 8]

Internet draft              Indicating media features for MIME content
30 November 1999


5. Security considerations

  When applied to simple or multipart MIME formatted data, a media
  feature expression provides summary information about the message
  data, which in many cases can be determined by examination of the
  message content.  Under these circumstances, no additional security
  considerations appear to be raised.

  When applied to other message composites, especially encrypted
  message content, feature expressions may disclose information that
  is otherwise unavailable.  In these cases, some security
  considerations associated with media content negotiation [1,2] may
  have greater relevance.

  It is suggested here that media feature descriptions may be
  usefully employed with encrypted message content.  In doing this,
  take care to ensure that the purpose of encryption is not
  compromised  (e.g. encryption might be intended to conceal the fact
  that a particular application data format is being used, which fact
  might be disclosed by an injudiciously applied Content-features
  header).

6. Acknowledgements

  This proposal draws from discussions with Dan Wing.  The fax
  message example was taken from a proposal by Mike Ruhl.  The
  multipart/related example is developed from RFC 2557.

  The author would like to thank the following people who offered
  comments that led to significant improvements:  Mr Hiroshi Tamura,
  Ted Hardie, Maurizio Codogno, Jacob Palme.

7. References

[1]  RFC 2533, "A syntax for describing media feature sets"
     Graham Klyne, 5GM/Content Technologies
     March 1999.

[2]  RFC 2506, "Media Feature Tag Registration Procedure"
     Koen Holtman, TUE
     Andrew Mutz, Hewlett-Packard
     Ted Hardie, NASA
     March 1999.

[3]  RFC 2234, "Augmented BNF for Syntax Specifications: ABNF"
     D. Crocker (editor), Internet Mail Consortium
     P. Overell, Demon Internet Ltd.
     November 1997.




Klyne                      Work-in-progress                   [Page 9]

Internet draft              Indicating media features for MIME content
30 November 1999


[4]  RFC 822, "Standard for the format of ARPA Internet text messages"
     D. Crocker, Department of Electrical Engineering, University of
     Delaware
     August 1982.

     To be replaced by:
     "Internet Message Format Standard"
     P. Resnick (editor), QUALCOMM Incorporated
     Internet draft: <draft-ietf-drums-msg-fmt-07.txt>
     Work in progress, January 1999.

[5]  RFC 2045, "Multipurpose Internet Mail Extensions (MIME)
     Part 1: Format of Internet message bodies"
     N. Freed, Innosoft
     N. Borenstein, First Virtual
     November 1996.

[6]  RFC 2046, "Multipurpose Internet Mail Extensions (MIME)
     Part 2: Media types"
     N. Freed, Innosoft
     N. Borenstein, First Virtual
     November 1996.

[7]  RFC 2017, "Definition of the URL MIME External-Body Access-Type"
     N. Freed, Innosoft
     K. Moore, University of Tennessee
     A. Cargille, WG Chair
     October 1996

[8]  RFC 2387, "The MIME Multipart/Related Content-type"
     E. Levinson
     August 1998

[9]  "Registration of Charset and Languages Media Features Tags"
     Paul Hoffman, IMC
     Internet draft: <draft-hoffman-char-lang-media-01.txt>
     Work in progress, July 1999.

8. Author's address

  Graham Klyne
  Content Technologies Ltd.
  1220 Parkview,
  Arlington Business Park
  Theale
  Reading, RG7 4SA
  United Kingdom.
  Telephone: +44 118 930 1300
  Facsimile: +44 118 930 1301
  E-mail:    GK@ACM.ORG


Klyne                      Work-in-progress                  [Page 10]

Internet draft              Indicating media features for MIME content
30 November 1999


Full copyright statement

  Copyright (C) The Internet Society 1999.  All Rights Reserved.

  This document and translations of it may be copied and furnished to
  others, and derivative works that comment on or otherwise explain
  it or assist in its implementation may be prepared, copied,
  published and distributed, in whole or in part, without restriction
  of any kind, provided that the above copyright notice and this
  paragraph are included on all such copies and derivative works.
  However, this document itself may not be modified in any way, such
  as by removing the copyright notice or references to the Internet
  Society or other Internet organizations, except as needed for the
  purpose of developing Internet standards in which case the
  procedures for copyrights defined in the Internet Standards process
  must be followed, or as required to translate it into languages
  other than English.

  The limited permissions granted above are perpetual and will not be
  revoked by the Internet Society or its successors or assigns.

  This document and the information contained herein is provided on
  an "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET
  ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
  THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
  WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Revision history

  [[[RFC editor:  please remove this section on publication]]]

  00a  10-Feb-1999  Initial draft.

  01a  16-Feb-1999  Added pointers to mailing list for discussion.

  01b  04-Mar-1999  Various editorial changes.  Added placeholder for
                    multipart/related example.

  01c  13-Apr-1999  Separated multipart/alternative and
                    message/external-body into separate examples.
                    Added example for compressed data.  Added example
                    for multipart/related data.  Updated references.

  02a  20-Jul-1999  Incorporated review comments -- editorial changes.

  02b  29-Nov-1999  Added (charset=...) to (type=text/*) examples.
                    Added citation to charset and language feature
                    registration document.



Klyne                      Work-in-progress                  [Page 11]

Internet draft              Indicating media features for MIME content
30 November 1999


  02c  29-Nov-1999  Indicated motivation for multipart/alternative
                    example.  Moved copyright section to end of text.


















































Klyne                      Work-in-progress                  [Page 12]
