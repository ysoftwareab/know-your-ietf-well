<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>AES-GCM Cipher Suites for TLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="AES-GCM Cipher Suites for TLS">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">TLS Working Group</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Choudhury</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Expires: October 17, 2008</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 15, 2008</td></tr>
</table></td></tr></table>
<h1><br />AES-GCM Cipher Suites for TLS<br />draft-ietf-tls-rsa-aes-gcm-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 17, 2008.</p>

<h3>Abstract</h3>

<p> This memo describes the use of the Advanced Encryption Standard
(AES)
    in Galois/Counter Mode (GCM) as a Transport Layer Security (TLS)
    authenticated encryption operation.  GCM provides both confidentiality
    and data origin authentication, can be efficiently implemented in
    hardware for speeds of 10 gigabits per second and above, and is also
    well-suited to software implementations.  This memo defines TLS
    cipher suites that use AES-GCM with RSA, DSS and Diffie-Hellman based key exchange mechanisms.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used In This Document<br />
<br />
<a href="#rsasuite">3.</a>&nbsp;
AES-GCM Cipher Suites<br />
<br />
<a href="#anchor3">4.</a>&nbsp;
TLS Versions<br />
<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">6.1.</a>&nbsp;
Counter Reuse<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">6.2.</a>&nbsp;
Recommendations for Multiple Encryption Processors<br />
<br />
<a href="#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br />
<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes the use of AES <a class='info' href='#AES'>[AES]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a> in Galois Counter Mode (GCM) <a class='info' href='#GCM'>[GCM]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation:               Galois/Counter Mode (GCM) and GMAC,&rdquo; November&nbsp;2007.</span><span>)</span></a> (AES-GCM) with various key exchange mechanisms as a cipher suite for TLS.  AES-GCM is an authenticated encryption with associated data (AEAD) cipher (as defined in TLS 1.2 <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a>) providing both confidentiality and data origin authentication.  The following sections define cipher suites based on RSA, DSS and Diffie-Hellman key exchanges; ECC based cipher suites are defined in a separate document <a class='info' href='#I-D.ietf-tls-ecc-new-mac'>[I&#8209;D.ietf&#8209;tls&#8209;ecc&#8209;new&#8209;mac]<span> (</span><span class='info'>Rescorla, E., &ldquo;TLS Elliptic Curve Cipher Suites with SHA-256/384 and AES Galois Counter  Mode,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  
</p>
<p>AES-GCM is not only efficient and secure, but hardware implementations can achieve high speeds with low cost and low latency, because the mode can be pipelined. Applications that require high data throughput can benefit from these high-speed implementations. AES-GCM has been specified as a mode that can be used with IPsec ESP <a class='info' href='#RFC4106'>[RFC4106]<span> (</span><span class='info'>Viega, J. and D. McGrew, &ldquo;The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP),&rdquo; June&nbsp;2005.</span><span>)</span></a> and 802.1AE MAC Security <a class='info' href='#IEEE8021AE'>[IEEE8021AE]<span> (</span><span class='info'>Institute of Electrical and Electronics Engineers, &ldquo;Media Access Control Security,&rdquo; August&nbsp;2006.</span><span>)</span></a>.  
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used In This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="rsasuite"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
AES-GCM Cipher Suites</h3>

<p> The following cipher suites use the new authenticated encryption
   modes defined in TLS 1.2 with AES in Galois Counter Mode (GCM) <a class='info' href='#GCM'>[GCM]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation:               Galois/Counter Mode (GCM) and GMAC,&rdquo; November&nbsp;2007.</span><span>)</span></a>:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}
					CipherSuite TLS_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

					CipherSuite TLS_DH_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DHE_DSS_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_DSS_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DH_DSS_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_DSS_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DH_anon_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_anon_WITH_AES_256_GCM_SHA384 = {TBD,TBD}
				
</dd>
</dl></blockquote>

<p>These cipher suites use the AES-GCM authenticated encryption with associated data (AEAD) algorithms AEAD_AES_128_GCM and AEAD_AES_256_GCM described in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>.  Note that each of these AEAD algorithms uses a 128-bit authentication tag with GCM. 

The "nonce" SHALL be 12 bytes long consisting of two parts as follows: (this is an example of a "partially explicit" nonce; see section 3.2.1 in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>).  

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          struct{
             opaque salt[4];
             opaque nonce_explicit[8];
          } GCMNonce;</pre></div>
<p>    The salt is the "implicit" part of the nonce and is not sent in the packet.  Instead the salt is generated as part of the handshake process: it is either the client_write_IV (when the client is sending) or the server_write_IV (when the server is sending).   The salt length (SecurityParameters.fixed_iv_length) is 4 octets.

</p>
<p>    The nonce_explicit is the "explicit" part of the nonce.  It is chosen by the sender and is carried in each TLS record in the GenericAEADCipher.nonce_explicit field. The nonce_explicit length (SecurityParameters.record_iv_length) is 8 octets. 
</p>
<p>Each value of the nonce_explicit MUST be distinct for each distinct invocation of GCM encrypt function for any fixed key.  Failure to meet this uniqueness
    requirement can significantly degrade security. The nonce_explicit MAY be the 64-bit sequence number.
</p>
<p>The RSA, DHE_RSA, DH_RSA, DHE_DSS, DH_DSS, and DH_anon  key exchanges are performed as defined in <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The PRF algorithms SHALL be as follows:
</p>
<blockquote class="text">
<p><br />
For cipher suites ending with _SHA256, the PRF is the TLS PRF <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a> with SHA-256 as the hash function.
</p>
<p><br />
For cipher suites ending with _SHA384, the PRF is the TLS PRF <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a> with SHA-384 as the hash function.
</p>
</blockquote>
<p>Implementations MUST send TLS Alert bad_record_mac for all types of failures encountered in processing the AES-GCM algorithm. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
TLS Versions</h3>

<p>These cipher suites make use of the authenticated encryption with additional data defined in TLS 1.2 <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a>.  They MUST NOT be negotiated in older versions of TLS.
   Clients MUST NOT offer these cipher suites if they do not offer TLS
   1.2 or later.  Servers which select an earlier version of TLS MUST
   NOT select one of these cipher suites.  Because TLS has no way for
   the client to indicate that it supports TLS 1.2 but not earlier, a
   non-compliant server might potentially negotiate TLS 1.1 or earlier
   and select one of the cipher suites in this document.  Clients MUST
   check the TLS version and generate a fatal "illegal_parameter" alert
   if they detect an incorrect version.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>IANA has assigned the following values for the cipher suites defined in this draft:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}
					CipherSuite TLS_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

					CipherSuite TLS_DH_RSA_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_RSA_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DHE_DSS_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DHE_DSS_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DH_DSS_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_DSS_WITH_AES_256_GCM_SHA384 = {TBD,TBD}<br />

	                                CipherSuite TLS_DH_anon_WITH_AES_128_GCM_SHA256 = {TBD,TBD}<br />

					CipherSuite TLS_DH_anon_WITH_AES_256_GCM_SHA384 = {TBD,TBD}
				      
</dd>
</dl></blockquote>

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p> The security considerations in <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a>  apply to this
   document as well.  The remainder of this section describes security
   considerations specific to the cipher suites described in this
   document.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Counter Reuse</h3>

<p>AES-GCM security requires that the counter is never reused.  The IV construction in <a class='info' href='#rsasuite'>Section&nbsp;3<span> (</span><span class='info'>AES-GCM Cipher Suites</span><span>)</span></a> is designed to prevent counter reuse. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Recommendations for Multiple Encryption Processors</h3>

<p>If multiple cryptographic processors are in use by the sender, then
    the sender MUST ensure that, for a particular key, each value of the nonce_explicit used with that key is distinct.  In this case each
    encryption processor SHOULD include in the nonce_explicit
    a fixed value that is distinct for each processor.  The recommended
    format is
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     nonce_explicit = FixedDistinct || Variable
</pre></div>
<p>    where the FixedDistinct field is distinct for each encryption
    processor, but is fixed for a given processor, and the Variable
    field is distinct for each distinct nonce used by a particular
    encryption processor.  When this method is used, the FixedDistinct
    fields used by the different processors MUST have the same length.
</p>
<p> In the terms of Figure 2 in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>, the Salt is the Fixed-Common
    part of the nonce (it is fixed, and it is common across all
    encryption processors), the FixedDistinct field exactly corresponds
    to the Fixed-Distinct field, and the Variable field corresponds to the Counter field, and the explicit part exactly corresponds to the nonce_explicit.
</p>
<p> For clarity, we provide an example for TLS in which there are two distinct
    encryption processors, each of which uses a one-byte FixedDistinct
    field:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Salt          = eedc68dc
       FixedDistinct = 01       (for the first encryption processor)
       FixedDistinct = 02       (for the second encryption processor)
</pre></div>
<p>    The GCMnonces generated by the first encryption processor, and their
    corresponding nonce_explicit, are:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       GCMNonce                    nonce_explicit
       ------------------------    ----------------------------
       eedc68dc0100000000000000    0100000000000000
       eedc68dc0100000000000001    0100000000000001
       eedc68dc0100000000000002    0100000000000002
       ...
</pre></div>
<p>    The GCMnonces generated by the second encryption processor, and their
    corresponding nonce_explicit, are
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       GCMNonce                    nonce_explicit
       ------------------------    ----------------------------
       eedc68dc0200000000000000    0200000000000000
       eedc68dc0200000000000001    0200000000000001
       eedc68dc0200000000000002    0200000000000002
       ...

</pre></div>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>This draft borrows heavily from <a class='info' href='#I-D.ietf-tls-ecc-new-mac'>[I&#8209;D.ietf&#8209;tls&#8209;ecc&#8209;new&#8209;mac]<span> (</span><span class='info'>Rescorla, E., &ldquo;TLS Elliptic Curve Cipher Suites with SHA-256/384 and AES Galois Counter  Mode,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  The authors would like to thank Alex Lam, Simon Josefsson  and Pasi Eronen for providing useful comments during the review of this draft.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AES">[AES]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Advanced Encryption Standard (AES),&rdquo; FIPS&nbsp;197, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="GCM">[GCM]</a></td>
<td class="author-text">Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation:
              Galois/Counter Mode (GCM) and GMAC,&rdquo; National Institute of Standards and Technology SP&nbsp;800-38D, November&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4346-bis">[I-D.ietf-tls-rfc4346-bis]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; draft-ietf-tls-rfc4346-bis-10 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5116">[RFC5116]</a></td>
<td class="author-text">McGrew, D., &ldquo;<a href="http://tools.ietf.org/html/rfc5116">An Interface and Algorithms for Authenticated Encryption</a>,&rdquo; RFC&nbsp;5116, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5116.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-ecc-new-mac">[I-D.ietf-tls-ecc-new-mac]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-ecc-new-mac-07.txt">TLS Elliptic Curve Cipher Suites with SHA-256/384 and AES Galois Counter  Mode</a>,&rdquo; draft-ietf-tls-ecc-new-mac-07 (work in progress), May&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-ecc-new-mac-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE8021AE">[IEEE8021AE]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;Media Access Control Security,&rdquo; IEEE Standard&nbsp;802.1AE, August&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4106">[RFC4106]</a></td>
<td class="author-text">Viega, J. and D. McGrew, &ldquo;<a href="http://tools.ietf.org/html/rfc4106">The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4106, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4106.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Abhijit Choudhury</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3625 Cisco Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:abhijitc@cisco.com">abhijitc@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
