<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="robots" content="index,follow" />

        <link rel="icon" href="./css/images/rfc.png" type="image/png" />
        <link rel="shortcut icon" href="./css/images/rfc.png" type="image/png" />
        <title>rfc6022</title>
    
        <link rel="stylesheet" type="text/css" href="./css/errata-base.css"/>
        <link rel="stylesheet" type="text/css" href="./css/errata-color.css" title="Default: Basic Colors"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-monochrome.css" title="Monochrome"/>
        <link rel="alternative stylesheet" type="text/css" href="./css/errata-printer.css" title="Printer"/>

        <script src="./css/errata.js"></script>
    </head>
    <body>
        <div class='Verified-headnote-styling'>
<span style="font-weight: bold;">This is a purely informative rendering of an RFC that includes verified errata.  This rendering may not be used as a reference.</span>
<br/>
<br/>
The following 'Verified' errata have been incorporated in this document:
 <a href='#eid4950'>EID 4950</a>
</div>

        <pre>
Internet Engineering Task Force (IETF)                          M. Scott
Request for Comments: 6022                                      Ericsson
Category: Standards Track                                   M. Bjorklund
ISSN: 2070-1721                                           Tail-f Systems
                                                            October 2010


                   YANG Module for NETCONF Monitoring

Abstract

   This document defines a Network Configuration Protocol (NETCONF) data
   model to be used to monitor the NETCONF protocol.  The monitoring
   data model includes information about NETCONF datastores, sessions,
   locks, and statistics.  This data facilitates the management of a
   NETCONF server.  This document also defines methods for NETCONF
   clients to discover data models supported by a NETCONF server and
   defines a new NETCONF &lt;get-schema&gt; operation to retrieve them.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in Section 2 of RFC 5741.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   http://www.rfc-editor.org/info/rfc6022.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   1. Introduction ....................................................3
      1.1. Definition of Terms ........................................3
   2. Data Model to Monitor NETCONF ...................................3
      2.1. The /netconf-state Subtree .................................3
           2.1.1. The /netconf-state/capabilities Subtree .............4
           2.1.2. The /netconf-state/datastores Subtree ...............4
           2.1.3. The /netconf-state/schemas Subtree ..................5
           2.1.4. The /netconf-state/sessions Subtree .................6
           2.1.5. The /netconf-state/statistics Subtree ...............7
   3. Schema Specific Operations ......................................8
      3.1. The &lt;get-schema&gt; Operation .................................8
   4. Examples ........................................................9
      4.1. Retrieving Schema List via &lt;get&gt; Operation .................9
      4.2. Retrieving Schema Instances ...............................11
   5. NETCONF Monitoring Data Model ..................................13
   6. Security Considerations ........................................25
   7. Acknowledgements ...............................................26
   8. IANA Considerations ............................................26
   9. References .....................................................26
      9.1. Normative References ......................................26
      9.2. Informative References ....................................27

1.  Introduction

   This document defines a YANG [RFC6020] model to be used to monitor
   the NETCONF protocol.  It provides information about NETCONF sessions
   and supported schema as defined in [RFC4741].

   Considerations such as different schema formats, feature optionality,
   and access controls can all impact the applicability and level of
   detail the NETCONF server sends to a client during session setup.
   The methods defined in this document address the need for further
   means to query and retrieve schema and NETCONF state information from
   a NETCONF server.  These are provided to complement existing base
   NETCONF capabilities and operations and in no way affect existing
   behaviour.

   A new &lt;get-schema&gt; operation is also defined to support explicit
   schema retrieval via NETCONF.

1.1.  Definition of Terms

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in BCP
   14 [RFC2119].

2.  Data Model to Monitor NETCONF

   The NETCONF monitoring data model defined in this document provides
   operational information on the NETCONF server.  This includes details
   specific to the NETCONF protocol (e.g., protocol-specific counters
   such as &#x27;in-sessions&#x27;) as well as data related to schema retrieval
   (e.g., schema list).

   A server that implements the data model defined in this document
   (&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;) MUST
   advertise the capability URI as described in [RFC6020].

   This section presents an overview of the monitoring data model.  For
   detailed descriptions, refer to the normative YANG module provided in
   this document (see Section 5).

2.1.  The /netconf-state Subtree

   The netconf-state container is the root of the monitoring data model.

   netconf-state
       /capabilities
       /datastores
       /schemas
       /sessions
       /statistics

   capabilities
      List of NETCONF capabilities supported by the server.

   datastores
      List of NETCONF configuration datastores (e.g., running, startup,
      candidate) supported on this device and related information.

   schemas
      List of schemas supported on the server.  Includes all the
      information required to identify the schemas and to support their
      retrieval.

   sessions
      List of all active NETCONF sessions on the device.  Includes per-
      session counters for all NETCONF sessions.

   statistics
      Includes global counters for the NETCONF server.

2.1.1.  The /netconf-state/capabilities Subtree

   The /netconf-state/capabilities subtree contains the capabilities
   supported by the NETCONF server.  The list MUST include all
   capabilities exchanged during session setup still applicable at the
   time of the request.

2.1.2.  The /netconf-state/datastores Subtree

   The /netconf-state/datastores subtree contains the list of available
   datastores for the NETCONF server and includes information on their
   lock state.

   datastore
       /name
       /locks

   name (leaf, netconf-datastore-type)
      Enumeration of supported datastores; candidate, running, startup.

   locks (grouping, lock-info)
      List of locks for the datastore.  Information is provided for both
      global and partial locks [RFC5717].  For partial locks, the list
      of locked nodes and the select expressions originally used to
      request the lock are returned.

2.1.3.  The /netconf-state/schemas Subtree

   The list of supported schema for the NETCONF server.

   schema
       /identifier   (key)
       /version      (key)
       /format       (key)
       /namespace
       /location

   The elements identifier, version, and format are used as a key in the
   schema list.  These are used in the &lt;get-schema&gt; operation.

   identifier (string)
      Identifier for the schema list entry.  The identifier is used in
      the &lt;get-schema&gt; operation and may be used for other means such as
      file retrieval.

   version (string)
      Version of the schema supported.  Multiple versions MAY be
      supported simultaneously by a NETCONF server.  Each version MUST
      be reported individually in the schema list, i.e., with same
      identifier, possibly different location, but different version.

      For YANG data models, version is the value of the most recent YANG
      &#x27;revision&#x27; statement in the module or submodule, or the empty
      string if no &#x27;revision&#x27; statement is present.

   format (identifyref, schema-format)
      The data modeling language the schema is written in.  The data
      modeling language is represented as a YANG identity.  This
      document defines the identities &quot;xsd&quot;, &quot;yang&quot;, &quot;yin&quot;, &quot;rng&quot;, and
      &quot;rnc&quot; (see Section 5).

   namespace (inet:uri)
      The Extensible Markup Language (XML) namespace [XML-NAMES] defined
      by the schema.

   location (union: enum, inet:uri)
      One or more locations from which this specific schema can be
      retrieved.  The list SHOULD contain at least one entry per schema.

2.1.4.  The /netconf-state/sessions Subtree

   Includes session-specific data for NETCONF management sessions.  The
   session list MUST include all currently active NETCONF sessions.

   session
       /session-id (key)
       /transport
       /username
       /source-host
       /login-time
       /in-rpcs
       /in-bad-rpcs
       /out-rpc-errors
       /out-notifications

   session-id (uint32, 1..max)
      Unique identifier for the session.  This value is the NETCONF
      session identifier, as defined in [RFC4741].

   transport (identityref, transport)
      Identifies the transport for each session.  The transport is
      represented as a YANG identity.  This document defines the
      identities &quot;netconf-ssh&quot;, &quot;netconf-soap-over-beep&quot;, &quot;netconf-soap-
      over-https&quot;, &quot;netconf-beep&quot;, and &quot;netconf-tls&quot; (see Section 5).

   username (string)
      The username is the client identity that was authenticated by the
      NETCONF transport protocol.  The algorithm used to derive the
      username is NETCONF transport protocol specific and in addition
      specific to the authentication mechanism used by the NETCONF
      transport protocol.

   source-host (inet:host)
      Host identifier (IP address or name) of the NETCONF client.

   login-time (yang:date-and-time)
      Time at the server at which the session was established.

   in-rpcs (yang:zero-based-counter32)
      Number of correct &lt;rpc&gt; messages received.

   in-bad-rpcs (yang:zero-based-counter32)
      Number of messages received when an &lt;rpc&gt; message was expected,
      that were not correct &lt;rpc&gt; messages.  This includes XML parse
      errors and errors on the rpc layer.

   out-rpc-errors (yang:zero-based-counter32)
      Number of &lt;rpc-reply&gt; messages sent that contained an &lt;rpc-error&gt;
      element.

   out-notifications (yang:zero-based-counter32)
      Number of &lt;notification&gt; messages sent.

2.1.5.  The /netconf-state/statistics Subtree

   Statistical data pertaining to the NETCONF server.

   statistics
       /netconf-start-time
       /in-bad-hellos
       /in-sessions
       /dropped-sessions
       /in-rpcs
       /in-bad-rpcs
       /out-rpc-errors
       /out-notifications

   statistics:
      Contains management-session-related performance data for the
      NETCONF server.

   netconf-start-time (yang:date-and-time)
      Date and time at which the management subsystem was started.

   in-bad-hellos (yang:zero-based-counter32)
      Number of sessions silently dropped because an invalid &lt;hello&gt;
      message was received.

   in-sessions (yang:zero-based-counter32)
      Number of sessions started.

   dropped-sessions (yang:zero-based-counter32)
      Number of sessions that were abnormally terminated, e.g., due to
      idle timeout or transport close.

   in-rpcs (yang:zero-based-counter32)
      Number of correct &lt;rpc&gt; messages received.

   in-bad-rpcs (yang:zero-based-counter32)
      Number of messages received when an &lt;rpc&gt; message was expected,
      which were not correct &lt;rpc&gt; messages.

   out-rpc-errors (yang:zero-based-counter32)
      Number of &lt;rpc-reply&gt; messages sent that contained an &lt;rpc-error&gt;
      element.

   out-notifications (yang:zero-based-counter32)
      Number of &lt;notification&gt; messages sent.

3.  Schema Specific Operations

3.1.  The &lt;get-schema&gt; Operation

   Description:

      This operation is used to retrieve a schema from the NETCONF
      server.

   Parameters:


      identifier (string):
         Identifier for the schema list entry.
         Mandatory parameter.

      version (string):
         Version of the schema requested.
         Optional parameter.

      format (identityref, schema-format):
         The data modeling language of the schema.
         Default value is &#x27;yang&#x27; when not specified.
         Optional parameter.

   Positive Response:

      The NETCONF server returns the requested schema.

   Negative Response:

      If the requested schema does not exist, the &lt;error-tag&gt; is
      &#x27;invalid-value&#x27;.

      If more than one schema matches the requested parameters, the
      &lt;error-tag&gt; is &#x27;operation-failed&#x27;, and &lt;error-app-tag&gt; is
      &#x27;data-not-unique&#x27;.

4.  Examples

4.1.  Retrieving Schema List via &lt;get&gt; Operation

   A NETCONF client retrieves the list of supported schema from a
   NETCONF server by retrieving the /netconf-state/schemas subtree via a
   &lt;get&gt; operation.

   Available schema for the requesting session are returned in the reply
   containing the &lt;identifier&gt;, &lt;version&gt;, &lt;format&gt;, and &lt;location&gt;
   elements.

   The response data can be used to determine the available schema and
   their versions.  The schema itself (i.e., schema content) is not
   returned in the response.  The optional &lt;location&gt; element contains a
   URI, which can be used to retrieve the schema by another protocol
   such as ftp [RFC0959] or http(s) [RFC2616] [RFC2818], or the special
   value &#x27;NETCONF&#x27;, which means that the schema can be retrieved from
   the device via the &lt;get-schema&gt; operation.

   Example:

&lt;rpc message-id=&quot;101&quot;
     xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
  &lt;get&gt;
    &lt;filter type=&quot;subtree&quot;&gt;
      &lt;netconf-state xmlns=
      &quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
        &lt;schemas/&gt;
      &lt;/netconf-state&gt;
    &lt;/filter&gt;
  &lt;/get&gt;
&lt;/rpc&gt;

   The NETCONF server returns a list of schema available for
   retrieval.

&lt;rpc-reply message-id=&quot;101&quot;
           xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
  &lt;data&gt;
    &lt;netconf-state
    xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
      &lt;schemas&gt;
        &lt;schema&gt;
          &lt;identifier&gt;foo&lt;/identifier&gt;
          &lt;version&gt;1.0&lt;/version&gt;
          &lt;format&gt;xsd&lt;/format&gt;
          &lt;namespace&gt;http://example.com/foo&lt;/namespace&gt;
          &lt;location&gt;ftp://ftp.example.com/schemas/foo_1.0.xsd&lt;/location&gt;
          &lt;location&gt;http://www.example.com/schema/foo_1.0.xsd&lt;/location&gt;
          &lt;location&gt;NETCONF&lt;/location&gt;
        &lt;/schema&gt;
        &lt;schema&gt;
          &lt;identifier&gt;foo&lt;/identifier&gt;
          &lt;version&gt;1.1&lt;/version&gt;
          &lt;format&gt;xsd&lt;/format&gt;
          &lt;namespace&gt;http://example.com/foo&lt;/namespace&gt;
          &lt;location&gt;ftp://ftp.example.com/schemas/foo_1.1.xsd&lt;/location&gt;
          &lt;location&gt;http://www.example.com/schema/foo_1.1.xsd&lt;/location&gt;
          &lt;location&gt;NETCONF&lt;/location&gt;
        &lt;/schema&gt;
        &lt;schema&gt;
          &lt;identifier&gt;bar&lt;/identifier&gt;
          &lt;version&gt;2008-06-01&lt;/version&gt;
          &lt;format&gt;yang&lt;/format&gt;
          &lt;namespace&gt;http://example.com/bar&lt;/namespace&gt;
          &lt;location&gt;
            http://example.com/schema/bar@2008-06-01.yang
          &lt;/location&gt;
          &lt;location&gt;NETCONF&lt;/location&gt;
        &lt;/schema&gt;
        &lt;schema&gt;
          &lt;identifier&gt;bar-types&lt;/identifier&gt;
          &lt;version&gt;2008-06-01&lt;/version&gt;
          &lt;format&gt;yang&lt;/format&gt;
          &lt;namespace&gt;http://example.com/bar&lt;/namespace&gt;
          &lt;location&gt;
            http://example.com/schema/bar-types@2008-06-01.yang
          &lt;/location&gt;
          &lt;location&gt;NETCONF&lt;/location&gt;
        &lt;/schema&gt;
      &lt;/schemas&gt;
    &lt;/netconf-state&gt;
  &lt;/data&gt;
&lt;/rpc-reply&gt;

4.2.  Retrieving Schema Instances

<div class='Verified-endnote-styling' id='eid4950'>
<pre>
<b><i><a href='https://www.rfc-editor.org/errata/eid4950'>EID 4950</a> (Verified) is as follows:</i></b>

<b>Section:</b> 4.2 (2,3)

<b>Original Text:</b>

&lt;get-schema
           xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
             &lt;identifer&gt;bar&lt;/identifer&gt;
             &lt;version&gt;2008-06-01&lt;/version&gt;
           &lt;/get-schema&gt;

a. Via &lt;get-schema&gt; using identifer parameter:

 &lt;get-schema
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           &lt;identifer&gt;bar-types&lt;/identifer&gt;
         &lt;/get-schema&gt;

<b>Corrected Text:</b>

&lt;get-schema
           xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
             &lt;identifier&gt;bar&lt;/identifier&gt;
             &lt;version&gt;2008-06-01&lt;/version&gt;
           &lt;/get-schema&gt;

a. Via &lt;get-schema&gt; using identifier parameter:

 &lt;get-schema
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           &lt;identifier&gt;bar-types&lt;/identifier&gt;
         &lt;/get-schema&gt;
</pre>
<b>Notes:</b><br/>
None
</div>
   Given the reply in the previous section, the following examples
   illustrate the retrieval of &#x27;foo&#x27;, &#x27;bar&#x27;, and &#x27;bar-types&#x27; schema at
   multiple locations, with multiple formats, and in multiple locations.

     1.  foo,  version 1.0 in xsd format:

       a.  Via FTP using location
           ftp://ftp.example.com/schemas/foo_1.0.xsd

       b.  Via HTTP using location
           http://www.example.com/schema/foo_1.0.xsd

       c.  Via &lt;get-schema&gt; using identifier, version, and
           format parameters.

       &lt;rpc message-id=&quot;101&quot;
         xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
         &lt;get-schema
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           &lt;identifier&gt;foo&lt;/identifier&gt;
           &lt;version&gt;1.0&lt;/version&gt;
           &lt;format&gt;xsd&lt;/format&gt;
         &lt;/get-schema&gt;
       &lt;/rpc&gt;

       &lt;rpc-reply message-id=&quot;101&quot;
         xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
         &lt;data
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           &lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
             &lt;!-- foo 1.0 xsd schema contents here --&gt;
           &lt;/xs:schema&gt;
         &lt;/data&gt;
       &lt;/rpc-reply&gt;

     2. bar, version 2008-06-01 in YANG format:

       a.  Via HTTP using location
           http://example.com/schema/bar@2008-06-01.yang

       b.  Via &lt;get-schema&gt; using identifier and version
           parameters:

         &lt;rpc message-id=&quot;102&quot;
           xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
           &lt;get-schema
           xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
             &lt;identifer&gt;bar&lt;/identifer&gt;
             &lt;version&gt;2008-06-01&lt;/version&gt;
           &lt;/get-schema&gt;
         &lt;/rpc&gt;

         &lt;rpc-reply message-id=&quot;102&quot;
           xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
           &lt;data
           xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
             module bar {
               //default format (yang) returned
               //bar version 2008-06-01 yang module
               //contents here ...
             }
           &lt;/data&gt;
         &lt;/rpc-reply&gt;

     3. bar-types, version 2008-06-01 in default YANG format:

       a. Via &lt;get-schema&gt; using identifer parameter:

       &lt;rpc message-id=&quot;103&quot;
         xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
         &lt;get-schema
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           &lt;identifer&gt;bar-types&lt;/identifer&gt;
         &lt;/get-schema&gt;
       &lt;/rpc&gt;

       &lt;rpc-reply message-id=&quot;103&quot;
         xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
         &lt;data
         xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;&gt;
           module bar-types {
             //default format (yang) returned
             //latest revision returned
             //is version 2008-06-01 yang module
             //contents here ...
           }
         &lt;/data&gt;
       &lt;/rpc-reply&gt;

5.  NETCONF Monitoring Data Model

   The data model described in this memo is defined in the following
   YANG module.

   This YANG module imports typedefs from [RFC6021] and references
   [RFC4741], [RFC4742], [RFC4743], [RFC4744], [RFC5539], [xmlschema-1],
   [RFC6020], [ISO/IEC19757-2:2008], and [RFC5717].

&lt;CODE BEGINS&gt; file &quot;ietf-netconf-monitoring@2010-10-04.yang&quot;

module ietf-netconf-monitoring {

  namespace &quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;;
  prefix &quot;ncm&quot;;

  import ietf-yang-types { prefix yang; }
  import ietf-inet-types { prefix inet; }

  organization
    &quot;IETF NETCONF (Network Configuration) Working Group&quot;;

  contact
    &quot;WG Web:   &lt;http://tools.ietf.org/wg/netconf/&gt;
     WG List:  &lt;mailto:netconf@ietf.org&gt;

     WG Chair: Mehmet Ersue
               &lt;mailto:mehmet.ersue@nsn.com&gt;

     WG Chair: Bert Wijnen
               &lt;mailto:bertietf@bwijnen.net&gt;

     Editor:   Mark Scott
               &lt;mailto:mark.scott@ericsson.com&gt;

     Editor:   Martin Bjorklund
               &lt;mailto:mbj@tail-f.com&gt;&quot;;

  description
    &quot;NETCONF Monitoring Module.
     All elements in this module are read-only.

     Copyright (c) 2010 IETF Trust and the persons identified as
     authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD

     License set forth in Section 4.c of the IETF Trust&#x27;s
     Legal Provisions Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 6022; see
     the RFC itself for full legal notices.&quot;;

  revision 2010-10-04 {
    description
      &quot;Initial revision.&quot;;
    reference
      &quot;RFC 6022: YANG Module for NETCONF Monitoring&quot;;
  }

  typedef netconf-datastore-type {
    type enumeration {
      enum running;
      enum candidate;
      enum startup;
    }
    description
      &quot;Enumeration of possible NETCONF datastore types.&quot;;
    reference
      &quot;RFC 4741: NETCONF Configuration Protocol&quot;;
  }

  identity transport {
    description
      &quot;Base identity for NETCONF transport types.&quot;;
  }

  identity netconf-ssh {
    base transport;
    description
      &quot;NETCONF over Secure Shell (SSH).&quot;;
    reference
      &quot;RFC 4742: Using the NETCONF Configuration Protocol
                 over Secure SHell (SSH)&quot;;
  }

  identity netconf-soap-over-beep {
    base transport;
    description
      &quot;NETCONF over Simple Object Access Protocol (SOAP) over
       Blocks Extensible Exchange Protocol (BEEP).&quot;;

    reference
      &quot;RFC 4743: Using NETCONF over the Simple Object
                 Access Protocol (SOAP)&quot;;
  }

  identity netconf-soap-over-https {
    base transport;
    description
      &quot;NETCONF over Simple Object Access Protocol (SOAP)
      over Hypertext Transfer Protocol Secure (HTTPS).&quot;;
    reference
      &quot;RFC 4743: Using NETCONF over the Simple Object
                 Access Protocol (SOAP)&quot;;
  }

  identity netconf-beep {
    base transport;
    description
      &quot;NETCONF over Blocks Extensible Exchange Protocol (BEEP).&quot;;
    reference
      &quot;RFC 4744: Using the NETCONF Protocol over the
                 Blocks Extensible Exchange Protocol (BEEP)&quot;;
  }

  identity netconf-tls {
    base transport;
    description
      &quot;NETCONF over Transport Layer Security (TLS).&quot;;
    reference
      &quot;RFC 5539: NETCONF over Transport Layer Security (TLS)&quot;;
  }

  identity schema-format {
    description
      &quot;Base identity for data model schema languages.&quot;;
  }

  identity xsd {
    base schema-format;
    description
      &quot;W3C XML Schema Definition.&quot;;
    reference
      &quot;W3C REC REC-xmlschema-1-20041028:
         XML Schema Part 1: Structures&quot;;
  }

  identity yang {
    base schema-format;
    description
      &quot;The YANG data modeling language for NETCONF.&quot;;
    reference
      &quot;RFC 6020:  YANG - A Data Modeling Language for the
                  Network Configuration Protocol (NETCONF)&quot;;
  }

  identity yin {
    base schema-format;
    description
      &quot;The YIN syntax for YANG.&quot;;
    reference
      &quot;RFC 6020:  YANG - A Data Modeling Language for the
                  Network Configuration Protocol (NETCONF)&quot;;
  }

  identity rng {
    base schema-format;
    description
      &quot;Regular Language for XML Next Generation (RELAX NG).&quot;;
    reference
      &quot;ISO/IEC 19757-2:2008: RELAX NG&quot;;
  }

  identity rnc {
    base schema-format;
    description
      &quot;Relax NG Compact Syntax&quot;;
    reference
      &quot;ISO/IEC 19757-2:2008: RELAX NG&quot;;
  }

  grouping common-counters {
    description
      &quot;Counters that exist both per session, and also globally,
       accumulated from all sessions.&quot;;

    leaf in-rpcs {
      type yang:zero-based-counter32;
      description
        &quot;Number of correct &lt;rpc&gt; messages received.&quot;;
    }
    leaf in-bad-rpcs {
      type yang:zero-based-counter32;

      description
        &quot;Number of messages received when an &lt;rpc&gt; message was expected,
         that were not correct &lt;rpc&gt; messages.  This includes XML parse
         errors and errors on the rpc layer.&quot;;
    }
    leaf out-rpc-errors {
      type yang:zero-based-counter32;
      description
        &quot;Number of &lt;rpc-reply&gt; messages sent that contained an
         &lt;rpc-error&gt; element.&quot;;
    }
    leaf out-notifications {
      type yang:zero-based-counter32;
      description
        &quot;Number of &lt;notification&gt; messages sent.&quot;;
    }
  }

  container netconf-state {
    config false;
    description
      &quot;The netconf-state container is the root of the monitoring
       data model.&quot;;

    container capabilities {
      description
        &quot;Contains the list of NETCONF capabilities supported by the
         server.&quot;;

      leaf-list capability {
        type inet:uri;
        description
          &quot;List of NETCONF capabilities supported by the server.&quot;;
      }
    }

    container datastores {
      description
        &quot;Contains the list of NETCONF configuration datastores.&quot;;

      list datastore {
        key name;
        description
          &quot;List of NETCONF configuration datastores supported by
           the NETCONF server and related information.&quot;;

        leaf name {
          type netconf-datastore-type;

          description
            &quot;Name of the datastore associated with this list entry.&quot;;
        }
        container locks {
          presence
            &quot;This container is present only if the datastore
             is locked.&quot;;
          description
            &quot;The NETCONF &lt;lock&gt; and &lt;partial-lock&gt; operations allow
             a client to lock specific resources in a datastore.  The
             NETCONF server will prevent changes to the locked
             resources by all sessions except the one that acquired
             the lock(s).

             Monitoring information is provided for each datastore
             entry including details such as the session that acquired
             the lock, the type of lock (global or partial) and the
             list of locked resources.  Multiple locks per datastore
             are supported.&quot;;

          grouping lock-info {
            description
              &quot;Lock related parameters, common to both global and
               partial locks.&quot;;

            leaf locked-by-session {
              type uint32;
              mandatory true;
              description
                &quot;The session ID of the session that has locked
                 this resource.  Both a global lock and a partial
                 lock MUST contain the NETCONF session-id.

                 If the lock is held by a session that is not managed
                 by the NETCONF server (e.g., a CLI session), a session
                 id of 0 (zero) is reported.&quot;;
              reference
                &quot;RFC 4741: NETCONF Configuration Protocol&quot;;
            }
            leaf locked-time {
              type yang:date-and-time;
              mandatory true;
              description
                &quot;The date and time of when the resource was
                 locked.&quot;;
            }
          }

          choice lock-type {
            description
              &quot;Indicates if a global lock or a set of partial locks
               are set.&quot;;

            container global-lock {
              description
                &quot;Present if the global lock is set.&quot;;
              uses lock-info;
            }

            list partial-lock {
              key lock-id;
              description
                &quot;List of partial locks.&quot;;
              reference
                &quot;RFC 5717: Partial Lock Remote Procedure Call (RPC) for
                           NETCONF&quot;;

              leaf lock-id {
                type uint32;
                description
                  &quot;This is the lock id returned in the &lt;partial-lock&gt;
                   response.&quot;;
              }
              uses lock-info;
              leaf-list select {
                type yang:xpath1.0;
                min-elements 1;
                description
                  &quot;The xpath expression that was used to request
                   the lock.  The select expression indicates the
                   original intended scope of the lock.&quot;;
              }
              leaf-list locked-node {
                type instance-identifier;
                description
                  &quot;The list of instance-identifiers (i.e., the
                   locked nodes).

                   The scope of the partial lock is defined by the list
                   of locked nodes.&quot;;
              }
            }
          }
        }
      }
    }

    container schemas {
      description
        &quot;Contains the list of data model schemas supported by the
         server.&quot;;

      list schema {
        key &quot;identifier version format&quot;;

        description
          &quot;List of data model schemas supported by the server.&quot;;

        leaf identifier {
          type string;
          description
            &quot;Identifier to uniquely reference the schema.  The
             identifier is used in the &lt;get-schema&gt; operation and may
             be used for other purposes such as file retrieval.

             For modeling languages that support or require a data
             model name (e.g., YANG module name) the identifier MUST
             match that name.  For YANG data models, the identifier is
             the name of the module or submodule.  In other cases, an
             identifier such as a filename MAY be used instead.&quot;;
        }
        leaf version {
          type string;
          description
            &quot;Version of the schema supported.  Multiple versions MAY be
             supported simultaneously by a NETCONF server.  Each
             version MUST be reported individually in the schema list,
             i.e., with same identifier, possibly different location,
             but different version.

             For YANG data models, version is the value of the most
             recent YANG &#x27;revision&#x27; statement in the module or
             submodule, or the empty string if no &#x27;revision&#x27; statement
             is present.&quot;;
        }
        leaf format {
          type identityref {
            base schema-format;
          }
          description
            &quot;The data modeling language the schema is written
             in (currently xsd, yang, yin, rng, or rnc).

             For YANG data models, &#x27;yang&#x27; format MUST be supported and
             &#x27;yin&#x27; format MAY also be provided.&quot;;
        }
        leaf namespace {
          type inet:uri;
          mandatory true;
          description
            &quot;The XML namespace defined by the data model.

             For YANG data models, this is the module&#x27;s namespace.
             If the list entry describes a submodule, this field
             contains the namespace of the module to which the
             submodule belongs.&quot;;
        }
        leaf-list location {
          type union {
            type enumeration {
              enum &quot;NETCONF&quot;;
            }
            type inet:uri;
          }
          description
            &quot;One or more locations from which the schema can be
             retrieved.  This list SHOULD contain at least one
             entry per schema.

             A schema entry may be located on a remote file system
             (e.g., reference to file system for ftp retrieval) or
             retrieved directly from a server supporting the
             &lt;get-schema&gt; operation (denoted by the value &#x27;NETCONF&#x27;).&quot;;
        }
      }
    }

    container sessions {
      description
        &quot;The sessions container includes session-specific data for
         NETCONF management sessions.  The session list MUST include
         all currently active NETCONF sessions.&quot;;

      list session {
        key session-id;
        description
          &quot;All NETCONF sessions managed by the NETCONF server
           MUST be reported in this list.&quot;;

        leaf session-id {
          type uint32 {
            range &quot;1..max&quot;;
          }
          description
            &quot;Unique identifier for the session.  This value is the
             NETCONF session identifier, as defined in RFC 4741.&quot;;
          reference
            &quot;RFC 4741: NETCONF Configuration Protocol&quot;;
        }
        leaf transport {
          type identityref {
            base transport;
          }
          mandatory true;
          description
            &quot;Identifies the transport for each session, e.g.,
            &#x27;netconf-ssh&#x27;, &#x27;netconf-soap&#x27;, etc.&quot;;
        }
        leaf username  {
          type string;
          mandatory true;
          description
            &quot;The username is the client identity that was authenticated
            by the NETCONF transport protocol.  The algorithm used to
            derive the username is NETCONF transport protocol specific
            and in addition specific to the authentication mechanism
            used by the NETCONF transport protocol.&quot;;
        }
        leaf source-host {
          type inet:host;
          description
            &quot;Host identifier of the NETCONF client.  The value
             returned is implementation specific (e.g., hostname,
             IPv4 address, IPv6 address)&quot;;
        }

        leaf login-time {
          type yang:date-and-time;
          mandatory true;
          description
            &quot;Time at the server at which the session was established.&quot;;
        }
        uses common-counters {
          description
            &quot;Per-session counters.  Zero based with following reset
             behaviour:
               - at start of a session
               - when max value is reached&quot;;
        }
      }
    }

    container statistics {
      description
        &quot;Statistical data pertaining to the NETCONF server.&quot;;

      leaf netconf-start-time {
        type yang:date-and-time;
        description
          &quot;Date and time at which the management subsystem was
           started.&quot;;
      }
      leaf in-bad-hellos {
        type yang:zero-based-counter32;
        description
          &quot;Number of sessions silently dropped because an
          invalid &lt;hello&gt; message was received.  This includes &lt;hello&gt;
          messages with a &#x27;session-id&#x27; attribute, bad namespace, and
          bad capability declarations.&quot;;
      }
      leaf in-sessions {
        type yang:zero-based-counter32;
        description
          &quot;Number of sessions started.  This counter is incremented
           when a &lt;hello&gt; message with a &lt;session-id&gt; is sent.

          &#x27;in-sessions&#x27; - &#x27;in-bad-hellos&#x27; =
              &#x27;number of correctly started netconf sessions&#x27;&quot;;
      }
      leaf dropped-sessions {
        type yang:zero-based-counter32;

        description
          &quot;Number of sessions that were abnormally terminated, e.g.,
           due to idle timeout or transport close.  This counter is not
           incremented when a session is properly closed by a
           &lt;close-session&gt; operation, or killed by a &lt;kill-session&gt;
           operation.&quot;;
      }
      uses common-counters {
        description
          &quot;Global counters, accumulated from all sessions.
           Zero based with following reset behaviour:
             - re-initialization of NETCONF server
             - when max value is reached&quot;;
      }
    }
  }

  rpc get-schema {
    description
      &quot;This operation is used to retrieve a schema from the
       NETCONF server.

       Positive Response:
         The NETCONF server returns the requested schema.

       Negative Response:
         If requested schema does not exist, the &lt;error-tag&gt; is
         &#x27;invalid-value&#x27;.

         If more than one schema matches the requested parameters, the
         &lt;error-tag&gt; is &#x27;operation-failed&#x27;, and &lt;error-app-tag&gt; is
         &#x27;data-not-unique&#x27;.&quot;;

    input {
      leaf identifier {
        type string;
        mandatory true;
        description
          &quot;Identifier for the schema list entry.&quot;;
      }
      leaf version {
        type string;
        description
          &quot;Version of the schema requested.  If this parameter is not
           present, and more than one version of the schema exists on
           the server, a &#x27;data-not-unique&#x27; error is returned, as
           described above.&quot;;
      }

      leaf format {
        type identityref {
          base schema-format;
        }
        description
           &quot;The data modeling language of the schema.  If this
            parameter is not present, and more than one formats of
            the schema exists on the server, a &#x27;data-not-unique&#x27; error
            is returned, as described above.&quot;;
      }
    }
    output {
        anyxml data {
          description
            &quot;Contains the schema content.&quot;;
      }
    }
  }
}

&lt;CODE ENDS&gt;

6.  Security Considerations

   The YANG module defined in this memo is designed to be accessed via
   the NETCONF protocol [RFC4741].  The lowest NETCONF layer is the
   secure transport layer and the mandatory to implement secure
   transport is SSH [RFC4742].

   Some of the readable data nodes in this YANG module may be considered
   sensitive or vulnerable in some network environments.  It is thus
   important to control read access (e.g., via get, get-config, or
   notification) to these data nodes.

   These are the containers, list nodes, and data nodes with their
   specific sensitivity/vulnerability:

   /netconf-state/sessions/session/username:  Contains identity
      information that could be used in an attempt to authenticate with
      the server.

      This username is only meant for monitoring, and SHOULD NOT be used
      for other purposes, such as access control, without a detailed
      discussion of the limitations of this reported username.  For
      example, it is possible that server A and server B might report
      the same username, but these might be for different persons.

7.  Acknowledgements

   The authors would like to thank Andy Bierman, Mehmet Ersue, Washam
   Fan, David Harrington, Balazs Lengyel, Hideki Okita, Juergen
   Schoenwaelder, Bert Wijnen, and many other members of the NETCONF WG
   for providing important input to this document.  The authors would
   also like to specifically acknowledge Sharon Chisholm&#x27;s work on
   &quot;NETCONF Monitoring Schema&quot; [NETCONF] and contribution to this
   document.

8.  IANA Considerations

   This document registers one URI in &quot;The IETF XML Registry&quot;.
   Following the format in [RFC3688], the following has been registered.


     URI: urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring
     Registrant Contact: The IESG.
     XML: N/A, the requested URI is an XML namespace.

   This document registers one module in the &quot;YANG Module Names&quot;
   registry.  Following the format in [RFC6020], the following has been
   registered.


     name: ietf-netconf-monitoring
     namespace: urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring
     prefix: ncm
     reference: RFC 6022

9.  References

9.1.  Normative References

   [ISO/IEC19757-2:2008]
              ISO/IEC, &quot;Document Schema Definition Language (DSDL) --
              Part 2: Regular-grammar-based validation -- RELAX NG&quot;,
              December 2008, &lt;http://www.iso.org/iso/
              catalogue_detail.htm?csnumber=37605&gt;.

   [RFC2119]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, BCP 14, RFC 2119, March 1997.

   [RFC4741]  Enns, R., &quot;NETCONF Configuration Protocol&quot;, RFC 4741,
              December 2006.

   [RFC4742]  Wasserman, M. and T. Goddard, &quot;Using the NETCONF
              Configuration Protocol over Secure SHell (SSH)&quot;, RFC 4742,
              December 2006.

   [RFC4743]  Goddard, T., &quot;Using NETCONF over the Simple Object Access
              Protocol (SOAP)&quot;, RFC 4743, December 2006.

   [RFC4744]  Lear, E. and K. Crozier, &quot;Using the NETCONF Protocol over
              the Blocks Extensible Exchange Protocol (BEEP)&quot;, RFC 4744,
              December 2006.

   [RFC5539]  Badra, M., &quot;NETCONF over Transport Layer Security (TLS)&quot;,
              RFC 5539, May 2009.

   [RFC5717]  Lengyel, B. and M. Bjorklund, &quot;Partial Lock Remote
              Procedure Call (RPC) for NETCONF&quot;, RFC 5717,
              December 2009.

   [RFC6020]  Bjorklund, M., Ed., &quot;YANG - A Data Modeling Language for
              the Network Configuration Protocol (NETCONF)&quot;,
              October 2010.

   [RFC6021]  Schoenwaelder, J., Ed., &quot;Common YANG Data Types&quot;,
              October 2010.

   [XML-NAMES]
              Hollander, D., Tobin, R., Thompson, H., Bray, T., and A.
              Layman, &quot;Namespaces in XML 1.0 (Third Edition)&quot;, World
              Wide Web Consortium Recommendation REC-xml-names-20091208,
              December 2009,
              &lt;http://www.w3.org/TR/2009/REC-xml-names-20091208&gt;.

   [xmlschema-1]
              Biron, Paul V. and Ashok. Malhotra, &quot;XML Schema Part 1:
              Structures Second Edition W3C Recommendation 28 October
              2004&quot;, October 2004, &lt;http://www.w3.org/TR/xmlschema-1&gt;.

9.2.  Informative References

              [NETCONF]  Chisholm, S. and H. Trevino, &quot;NETCONF
              Monitoring Schema&quot;, Work in Progress, February 2007.

   [RFC0959]  Postel, J. and J. Reynolds, &quot;File Transfer Protocol&quot;,
              STD 9, RFC 959, October 1985.

   [RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, &quot;Hypertext
              Transfer Protocol -- HTTP/1.1&quot;, RFC 2616, June 1999.

   [RFC2818]  Rescorla, E., &quot;HTTP Over TLS&quot;, RFC 2818, May 2000.

   [RFC3688]  Mealling, M., &quot;The IETF XML Registry&quot;, BCP 81, RFC 3688,
              January 2004.

Authors&#x27; Addresses

   Mark Scott
   Ericsson
   3500 Carling Ave
   Nepean, Ontario  K2H 8E9
   Canada

   EMail: mark.scott@ericsson.com


   Martin Bjorklund
   Tail-f Systems
   Klara Norra Kyrkogata 31
   SE-111 22 Stockholm,
   Sweden

   EMail: mbj@tail-f.com


        </re>
        
    </body>
</html>
