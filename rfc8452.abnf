message_authentication_key =
         AES(key = key_generating_key,
block = little_endian_uint32(0) ++ nonce)[:8] ++
block = little_endian_uint32(1) ++ nonce)[:8]
message_encryption_key =
         AES(key = key_generating_key,
block = little_endian_uint32(2) ++ nonce)[:8] ++
block = little_endian_uint32(3) ++ nonce)[:8]

block = little_endian_uint32(4) ++ nonce)[:8] ++
block = little_endian_uint32(5) ++ nonce)[:8]
input = input ++ "\x00"
block = initial_counter_block

output = ""
keystream_block = AES(key = key, block = block)
todo = min(bytelen(in), bytelen(keystream_block)
output = output ++ (keystream_block[j] ^ in[j])
in = in[todo:]
length_block =
         little_endian_uint64(bytelen(additional_data) * 8) ++
         little_endian_uint64(bytelen(plaintext) * 8)
padded_plaintext = right_pad_to_multiple_of_16_bytes(plaintext)
padded_ad = right_pad_to_multiple_of_16_bytes(additional_data)
S_s = POLYVAL(key = message_authentication_key,
input = padded_ad ++ padded_plaintext ++
                           length_block)
tag = AES(key = message_encryption_key, block = S_s)

counter_block = tag
initial_counter_block = counter_block,
in = plaintext) ++
S_s = POLYVAL(message-authentication-key, X_1, X_2, ...)
tag = ciphertext[bytelen(ciphertext)-16:]

counter_block = tag
plaintext = AES_CTR(key = message_encryption_key,
initial_counter_block = counter_block,
in = ciphertext[:bytelen(ciphertext)-16])

length_block =
         little_endian_uint64(bytelen(additional_data) * 8) ++
         little_endian_uint64(bytelen(plaintext) * 8)
padded_plaintext = right_pad_to_multiple_of_16_bytes(plaintext)
padded_ad = right_pad_to_multiple_of_16_bytes(additional_data)
S_s = POLYVAL(key = message_authentication_key,
input = padded_ad ++ padded_plaintext ++
                           length_block)
expected_tag = AES(key = message_encryption_key, block = S_s)

xor_sum = 0
b = ff000000000000000000000000000000,
X_1 = 4f4f95668c83dfb6401762bb2d01a262, and
X_2 = d1a24ddd2721d006bbe45f20d3c9f362.
p = (bytelen(plaintext) + 15) / 16.

Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       dc20e2d83f25705bb49e439eca56de25
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       578782fff6013b815b287c22493a364c
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       a4978db357391a0bc4fdec8b0d106639
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       303aaf90f6fe21199c6068577437a0c4
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       1a8e45dcd4578c667cd86847bf6155ff
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       5e6e311dbf395d35b0fe39c2714388f8
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       8a263dd317aa88d56bdf3936dba75bb8
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       3b0a1a2560969cdf790d99759abd1508
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       08299c5102745aaa3a0c469fad9e075a
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       8f8936ec039e4e4bb97ebd8c4457441f
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       e6af6a7f87287da059a71684ed3498e1
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       6a8cc3865f76897c2e4b245cf31c51f2
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       cdc46ae475563de037001ef84ae21744
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       07eb1f84fb28f8cb73de8e99e2f48a14
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       24afc9805e976f451e6d87f6fe106514
Key =                       01000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       bff9b2ef00fb47920cc72a0c0f13b9fd
Key =                       e66021d5eb8e4f4066d4adb9c33560e4
Nonce =                     f46e44bb3da0015c94f70887
Tag =                       a4194b79071b01a87d65f706e3949578
Key =                       36864200e0eaf5284d884a0e77d31646
Nonce =                     bae8e37fc83441b16034566b
Tag =                       711bd85bc1e4d3e0a462e074eea428a8
Key =                       aedb64a6c590bc84d1a5e269e4b47801
Nonce =                     afc0577e34699b9e671fdd4f
Tag =                       d6a9c45545cfc11f03ad743dba20f966
Key =                       d5cc1fd161320b6920ce07787f86743b
Nonce =                     275d1ab32f6d1f0434d8848c
Tag =                       1d02fd0cd174c84fc5dae2f60f52fd2b
Key =                       b3fed1473c528b8426a582995929a149
Nonce =                     9e9ad8780c8d63d0ab4149c0
Tag =                       c1dc2f871fb7561da1286e655e24b7b0
Key =                       2d4ed87da44102952ef94b02b805249b
Nonce =                     ac80e6f61455bfac8308a2d4
Tag =                       83b3449b9f39552de99dc214a1190b0b
Key =                       bde3b2f204d1e9f8b06bc47f9745b3d1
Nonce =                     ae06556fb6aa7890bebc18fe
Tag =                       3e377094f04709f64d7b985310a4db84
Key =                       f901cfe8a69615a93fdf7a98cad48179
Nonce =                     6245709fb18853f68d833640
Tag =                       2d15506c84a9edd65e13e9d24a2a6e70
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       07f5f4169bbf55a8400cd47ea6fd400f
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       843122130f7364b761e0b97427e3df28
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       8ca50da9ae6559e48fd10f6e5c9ca17e
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       c9eac6fa700942702e90862383c6c366
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       e819e63abcd020b006a976397632eb5d
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       790bc96880a99ba804bd12c0e6a22cc4
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       112864c269fc0d9d88c61fa47e39aa08
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       91213f267e3b452f02d01ae33e4ec854
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       c1a4a19ae800941ccdc57cc8413c277f
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       b292d28ff61189e8e49f3875ef91aff7
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       aea1bad12702e1965604374aab96dbbc
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       03332742b228c647173616cfd44c54eb
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       5bde0285037c5de81e5b570a049b62a0
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       1835e517741dfddccfa07fa4661b74cf
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       b879ad976d8242acc188ab59cabfe307
Key =                       01000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     030000000000000000000000
Tag =                       cfcdf5042112aa29685c912fc2056543
Key =                       e66021d5eb8e4f4066d4adb9c33560e4
                               f46e44bb3da0015c94f7088736864200
Nonce =                     e0eaf5284d884a0e77d31646
Tag =                       169fbb2fbf389a995f6390af22228a62
Key =                       bae8e37fc83441b16034566b7a806c46
                               bb91c3c5aedb64a6c590bc84d1a5e269
Nonce =                     e4b47801afc0577e34699b9e
Tag =                       93da9bb81333aee0c785b240d319719d
Key =                       6545fc880c94a95198874296d5cc1fd1
                               61320b6920ce07787f86743b275d1ab3
Nonce =                     2f6d1f0434d8848c1177441f
Tag =                       6b62b84dc40c84636a5ec12020ec8c2c
Key =                       d1894728b3fed1473c528b8426a58299
                               5929a1499e9ad8780c8d63d0ab4149c0
Nonce =                     9f572c614b4745914474e7c7
Tag =                       c0fd3dc6628dfe55ebb0b9fb2295c8c2
Key =                       a44102952ef94b02b805249bac80e6f6
                               1455bfac8308a2d40d8c845117808235
Nonce =                     5c9e940fea2f582950a70d5a
Tag =                       404099c2587f64979f21826706d497d5
Key =                       9745b3d1ae06556fb6aa7890bebc18fe
                               6b3db4da3d57aa94842b9803a96e07fb
Nonce =                     6de71860f762ebfbd08284e4
Tag =                       b3080d28f6ebb5d3648ce97bd5ba67fd
Key =                       b18853f68d833640e42a3c02c25b6486
                               9e146d7b233987bddfc240871d7576f7
Nonce =                     028ec6eb5ea7e298342a94d4
Tag =                       454fc2a154fea91f8363a39fec7d0a49
Key =                       3c535de192eaed3822a2fbbe2ca9dfc8
                               8255e14a661b8aa82cc54236093bbc23
Nonce =                     688089e55540db1872504e1c
Tag =                       9d6c7029675b89eaf4ba1ded1a286594
Key =                       00000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     000000000000000000000000
Tag =                       ffffffff000000000000000000000000
Key =                       00000000000000000000000000000000
                               00000000000000000000000000000000
Nonce =                     000000000000000000000000
Tag =                       ffffffff000000000000000000000000
