Network Working Group                            Yunqing.Zeng
Internet Engineering Task Force                           MCM
INTERNET-DRAFT                               19 September 2002
Expires March 2003


Enhanced Internet Protocol Specification
<draft-zeng-rfc791bis-00.txt>


Status of this Memo

This document is an Internet-Draft and is subject to all provisions of
Section 10 of RFC2026 except that the right to produce derivative works
is not granted. Internet-Drafts are working documents of the Internet
Engineering Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts. Internet-Drafts are draft documents valid for a
Maximum of six months and may be updated, replaced, or obsoleted by
other documents at any time. It is inappropriate to use Internet-Drafts
as reference material or to cite them other than as "work in progress."
Distribution of this memo is unlimited.


     The list of current Internet-Drafts can be accessed at
     http://www.ietf.org/1id-abstracts.html

     The list of Internet-Draft Shadow Directories can be accessed at
     http://www.ietf.org/shadow.html


Abstract

This document describes aspects of "multi-tier" architecture,
"Grid-net", addressing architecture, "address plane", "address swapping",
"address option", and revises aspects of the security, precedence of the
Standard Internet Protocol to suit newly development trend of Internet,
Municipal Area Network, and "Home-net". This new addressing architecture
provides much more capacious address space by attached 32-bit "Grid" IP
address for transmitting datagram from sources to destinations, where
hosts identified by twin 32-bit IP addresses, i.e. to provide "non-
private" 32-bit IP address for transmission in adding "Grid" tier, and
scalable service for data, voice, signaling, and multimedia. The
proposed protocol provides of seamless integration with existing
Internet, tier Boundary address swapping for transmission throughout
public Internet tier, IP address planes inside Grid-net for data, IP
phone, mobile phone, wireless PAD, video and other multimedia
applications, and IP address personality for personal computer, IP
phone, mobile phone, wireless PAD, home control/monitoring, and
multimedia equipments.
The goal of this document is to discusses the semantics of Enhanced 
Internet protocol for improvements, to provide a compatible mechanisms 
for less influence on most existing network equipments, to create new 
Internet Multimedia Environment, and to protect worldwide investment on
network resources.


Copyright Notice

   Copyright (C) The Internet Society (2002).  All Rights Reserved.





Expires March 2003                                           [Page 1]
Draft           Revised Internet Protocol             September 2002

Table of Contents

1.	INTRODUCTION  ------------------------------------------- 4
1.1.	Motivation    ------------------------------------------- 4
1.2.	Scope         ------------------------------------------- 4
1.3.	Network Architecture ------------------------------------ 4
1.4.	Addressing Architecture --------------------------------- 6
1.5.	Operation     ------------------------------------------- 8

2.	OVERVIEW      ------------------------------------------- 8
2.1.	Relation to Other Protocols ----------------------------- 8
2.2.	Model of Operation -------------------------------------- 9
2.3.	Enhanced Function Description --------------------------- 10
2.3.1.  Names and Addressing ------------------------------------ 10
2.3.2.  Fragmentation ------------------------------------------- 12
2.4.	Gateways	 ---------------------------------------- 14

3.	SPECIFICATION	  --------------------------------------- 14
3.1.	Enhanced Internet Header Format	------------------------- 14
3.1.1.  Version:  4 bits  --------------------------------------- 16
3.1.2.  IHL:  4 bits  ------------------------------------------- 16
3.1.3.  Type of Service: 8 bit ---------------------------------- 16
3.1.4.  Total Length: 16 bits  ---------------------------------- 17
3.1.5.  Identification: 16 bits  -------------------------------- 17
3.1.6.  Flags: 3 bits  ------------------------------------------ 17
3.1.7.  Fragment Offset:  13 bits  ------------------------------ 17
3.1.8.  Time to Live: 8 bits  ----------------------------------- 17
3.1.9.  Protocol: 8 bits  --------------------------------------- 18
3.1.10.  Header Checksum: 16 bits  ------------------------------ 18
3.1.11.  AAO Header: 8 bits  ------------------------------------ 18
3.1.12.  AAO Length: 8 bits  ------------------------------------ 19
3.1.13.  Flow Labels: 16 bits  ---------------------------------- 19
3.1.14.  Attached Source Address  ------------------------------- 19
3.1.15.  Attached Destination Address  -------------------------- 19
3.1.16.  Options: variable   ------------------------------------ 19
3.1.17.  Padding: variable  ------------------------------------- 20

3.2.  Specific Option Definitions  ------------------------------ 20
3.2.1.  End of Option List  ------------------------------------- 20
3.2.2.  No Operation  ------------------------------------------- 21
3.2.3.  Security  ----------------------------------------------- 22
3.2.4.  Loose Source and Record Route  -------------------------- 23
3.2.5.  Strict Source and Record Route  ------------------------- 23
3.2.6.  Record Route  ------------------------------------------- 24
3.2.7.  Stream Identifier  ---------------------------------------25
3.2.8.  Enhanced Internet Timestamp  -----------------------------25
 
3.3.	Discussion  --------------------------------------------- 26
3.3.1.  Addressing  --------------------------------------------- 26
3.3.2.  Example Address Swapping  ------------------------------- 27
3.3.3.  Compatibility  ------------------------------------------ 28
3.3.4.  Fragmentation and Reassembly  --------------------------- 28
3.3.5.  Example Fragmentation Procedure  ------------------------ 29


Expires March 2003                                           [Page 2]
Draft           Revised Internet Protocol             September 2002


3.3.6.  Example Reassembly Procedure ---------------------------- 30
3.3.7.  Identification   ---------------------------------------- 31
3.3.8.  Type of Service  ---------------------------------------- 32
3.3.9.  Time to Live     ---------------------------------------- 32
3.3.10.  Options         ---------------------------------------- 33
3.3.11.  Checksum    -------------------------------------------- 33
3.3.12.  Errors    ---------------------------------------------- 33

3.4.	Interfaces  --------------------------------------------- 33
3.4.1.  An Example Upper Level Interface   ---------------------- 34

4.	APPENDIX    ----------------------------------------------35
4.1.	APPENDIX A: Examples & Scenarios   -----------------------35
4.1.1.  Example 1:    --------------------------------------------35
4.1.2.  Example 2:      ------------------------------------------36
4.1.3.  Example 3:      ------------------------------------------37

4.2.	APPENDIX B: Data Transmission Order   ------------------- 37

5.  GLOSSARY        ----------------------------------------------38

6.  REFERENCES   -------------------------------------------------39

7.  Authors' Addresses  ------------------------------------------40






























Expires March 2003                                            [Page 3]
Draft           Revised Internet Protocol             September 2002

Enhanced Internet Protocol Specification 

1. INTRODUCTION

1.1. Motivation

The Internet Protocol is designed for use in interconnected systems of
packet-switched computer communication networks. Predictions of IPv4
32-bit IP address crisis date back to the early 1990s, but global
transition to the more capacious 128-bit IP Version 6 protocol, so-call
Next Generation Internet program protocol, has not begun, and found out
the hard way. Shift to a new protocol will affect 90 million routers, 
switches, computers, and excessive growth in the routing tables. The 
proposed Enhanced Internet protocol IPv4.e provides much more capacious 
address space by attached 32-bit "GRID" IP address for transmitting 
blocks of data called datagram from sources to destinations, where 
sources and destinations are hosts identified by normal 32-bit IP
addresses when transmitted in existing Internet tier, or identified by 
enhanced twin 32-bit IP addresses, i.e. to use 2'nd tier 32-bit IP
address for transmission in adding "GRID" tier. The proposed Enhanced
internet protocol provides of seamless integration with existing 
Internet, and scalable service for data, voice, signaling, multimedia
in adding tier, and provides more flexibility for security, precedence,
compartments, fragmentation and reassembly of long datagram, and
handling restriction features of the Standard Internet Protocol.
The goal of the Enhanced internet protocol is to provides flexible
Addressing Architecture, millions times more capacious address space to
overcome address crisis that Ipv4 will faced, and to implement an
perspicuous, compatible protocol to create new Internet Multimedia
Environment, which would be coexistent with existing world wide
Internet. The Enhanced internet protocol has more specification, such
as IP address planes for data, IP phone, mobile, wireless PAD,
video and multimedia application, and IP address personality for
personal computer, IP phone, mobile, wireless PAD, home
control, monitoring, and multimedia equipments. It's never too late to
mend; it would protect worldwide investment on network resources.

1.2.  Scope

The Standard internet protocol is specifically enhanced in scope to 
provide more address space, flexible addressing architecture, and 
still capitalize on the functions, mostly provided by original network 
equipments, necessary to deliver a package of bits (an internet 
datagram) from a source to a destination over an tiered interconnected 
networks. There are more mechanisms to augment end-to-end data 
reliability, flow control, sequencing, or other services commonly found
in its supporting networks to provide various types and qualities of
service. 

1.3.  Network Architecture

The core design principles and technology for large, decentralized,
open-access networks, such as the Enhanced Internet, is commonly tiered
into a hierarchical architecture. This protocol describes a new way to

Expires March 2003                                           [Page 4]
Draft           Revised Internet Protocol             September 2002

organize Internet network in three tiers, that differs from conventional
two tier architectures, by adding a new "Grid-net" tier between Internet
and Intranet. 
For example, a "Grid-net" could be a Municipal Area Network, to 
provide service for millions of small or middle scale Enterprise's 
Intranet and "Home-net", where personal computer, video-player, 
consumer electronic, building automation and wireless appliance are 
link to the "Grid-net" by gataways or "Home-net" bridge. A "Grid-net"
also could be a Campus Network, or a large Enterprise's Network.
The main contribution of this protocol is to describe the ideas behind 
our new architecture, illustrate the advantages of using the conceptual 
architecture, and demonstrate that this architecture results in 
capacious Enhanced Internet Address by less effect on current running
Internet environment and huge investment in network construction. 
This protocol is called on by host-to-host protocols in a tiered
Internet environment, and calls on local network protocols to carry
the Internet datagram to the next gateway or destination host.
Hierarchy of Enhanced Internet is as following: 

+-------------------------------------------------------------------+
|---------------------- Internet Tier ------------------------------|
+---+-------+------+--------+---------+-------+---------+-------+---+
    |  PE   |      |   PE   |         |   PE  |    ...  |   PE  |
    +-------+      +--------+         +-------+         +-------+
        |              |                  |                 |
    +-------+      +--------+         +-------+            HOST
    |   GE  |      |   GE   |         |   CE  |
    +-------+------+--------+     +---+--------+---+
    |      Grid-net Tier    |     |  Intranet Tier |
    +-------+------+--------+     +----------------+ 
    |  PE   |      |   PE   |              |
    +-------+      +--------+             HOST
        |                 |
    +-------+         +--------+
    |   CE  |         |   CE   |
+---+-------+---+   +-+--------+-+
| Intranet Tier |   |  Home-net  |
+---------------+   +------------+
          |
        HOST

             Enhanced Internet Hierarchy
                       Figure 1.

  Here, PE is Provider End gateway,
  GE is Grid End gateway
  and CE is Customer End gateway.

For example, a TCP module, which is situated in a host of a Grid-net,
would call on the Internet module to take a TCP segment (including the
TCP header and user data) as the data portion of an Internet datagram.
The suggested TCP module would provide the tiered IP addresses and other 
parameters in the TCP header to the Internet module as arguments of 
the call.

Expires March 2003                                           [Page 5]
Draft           Revised Internet Protocol             September 2002

The Internet module would then create an Internet datagram and call on 
the local network interface to transmit the Internet datagram. If the 
Internet datagram would be transmitted to the other Grid-net in the 
Internet, there should be an Internet IP address in the destination 
portion of the TCP header, and attached second Grid-net IP address in 
the option field of the TCP header. The Internet datagram would be 
transmitted across the first "GRID" border to the Internet destination, 
the source Grid-net IP address would be swapped by the "GRID" Boundary 
gateway, i.e. replaced by Internet IP address of the "GRID".
The Internet destination host might be a Boundary gateway to the second
GRID. The Internet module on the second "GRID" Boundary would then swap
the destination IP address in the TCP header of the Internet datagram,
and then call on the neighboring network interface to transmit the
Internet datagram to the Grid-net destination. The Grid-net address
would be derived from the attached Grid-net destination IP address
option by the second "GRID" Boundary gateway, and would be the address
of some host in that Grid-net. 

1.4.  Addressing Architecture

The Enhanced Internet protocol implements three basic functions: 
addressing, address swapping and fragmentation.
The Internet modules use the addresses carried in the Enhanced Internet 
header to transmit Internet datagram toward their tier's destinations 
node or their tier's edge, in between the Internet modules in the 
"GRID" Boundary gateway use the addresses carried in attached address 
option fields of the Enhanced Internet header to replace the source or 
destination address field, then to transmit Internet datagram toward 
their next tier's destination node. 
Firstly, there is no change for the Addressing Architecture in Internet 
tier, for the Grid-net itself Addressing in Internet, a C class network 
address may be used, which has 8-bits address space, and splits up to 
some Address segment, which we name as "Address Plane": Data Plane, 
Control Plane, Voice Plane, Signaling Plane, Video Plane, Wireless 
Plane, and some other multimedia and reserved Address space. That forms 
the vertical Addressing Architecture. It would be effective and 
efficient to uniquely define Address Plane and to separate their paths 
and processing for different Service Provider. 
The "GRID" Boundary gateway using relative plane's address should have 
those corresponding functions, and support from relative Service 
Provider. For example, Signaling Plane could link to Signaling 
gateways provided by local PSTN operator, and Wireless Plane could 
link to Wireless gateways provided by local GSM or CDMA operator. 
There could be several corresponsive "Network Plane" physically in 
"GRID" local network, which can use same "GRID" tier interior address, 
but in different plane.
For the Grid-net interior addressing, each Grid-net Addressing Plane 
has a reserved but now "non-private" "A" class network address. 
We suggest to use reserved address number (10.x.x.x / 28) for Data 
Plane, let the last 4-bits for Client Data Plane Addressing, and which 
splits at most up to 16 personality network address. By little trim, the 
reserved address number (10.x.x.x / 28) may also be used for Wireless 
Plane, Video Plane, and so on. For personality, same address number in 
different plane may assign to same one personnel. Even non-reserved 

Expires March 2003                                             [Page 6]
Draft             Revised Internet Protocol            September 2002

address number (2o.x.x.x / 28) or (30.x.x.x / 28) may used for plane 
address, and assign to same one person for physically interconnected 
address planes. By plane address swapping, which we name for "In-tier 
Address Swapping", a datagram can be transmitted to other plane. 
Roughly estimated, the Grid-net Addressing Architecture totally 
supports up to one million clients, and client could possess all 
services currently from different local Service Provider in digital 
mode.
The Enhanced Internet protocol increases the IP address size from 32 
bits to 64 bits, (or even up to 96 bits if needed in future), to coexist 
in a more levels of addressing hierarchy, a much greater number of 
addressable nodes, and simpler auto-configuration of addresses for 
" Grid-net" and "Home-net" client. The Enhanced Internet protocol 
supports more services in several address "Plane", and the scalability 
of multicast routing is improved by adding the address "Plane" field, 
which we name for "Plane multicast " to all personal digital appliances. 
Enhanced Ipv4 header uses 32 bits address fields for tier transmission, 
to reduce the processing cost of packet handling, to limit the 
bandwidth cost of the Internet Backbone, and to protect worldwide 
investment on Internet Backbone and other network appliances.

1.5.  Operation

The selection of a path for transmission is called routing, including 
Internet tier routing and Grid-net tier interior routing. The Internet 
modules would process routing as used be, and be allowed to use 
different route protocol in tier mode 
The Internet modules may use fields in the Enhanced Internet header to 
fragment and reassemble Internet datagram when necessary for 
transmission throughout Grid-net. 
The model of operation is that two Internet module, which reside in 
each host and if both are situated in the Internet tier, would be 
engaged in Internet communication as model of original Internet 
protocol. These modules share common rules for interpreting address 
fields and for fragmenting and assembling enhanced Internet datagram. 
In addition, those modules, which both reside in one Grid-net tier, 
would be engaged in GRID communication same as model of original 
Internet protocol. But especially for Internet communication across 
GRID Boundary, these modules, which reside in each host, have procedures 
for attaching next tier's IP address (Internet or Grid-net 32-bit 
address) of the host, for routing decisions and other functions. The 
Internet modules, which reside in GRID Boundary gateway, have procedures 
for IP address swapping between Internet and Grid-net 32-bit address 
(use the addresses carried in option fields of the Enhanced Internet 
header), and for routing decisions in next tier. It is clear, that the 
standard sequent procedure from a client in the Grid-net tier, to a 
Proxy, and to a server in the Internet, is still effective.
The Enhanced Internet protocol treats each Internet datagram as an 
independent entity unrelated to any other Internet datagram. There are 
no connections or logical circuits (virtual or otherwise). The Enhanced 
Internet protocol uses five key mechanisms in providing its service: 
Address Swapping, Type of Service, Time to Live, Options, and Header 
Checksum. 
The Address Swapping is an abstract, which characterize the network 

Expires March 2003                                           [Page 7]
Draft             Revised Internet Protocol            September 2002

tier choices and their actual unique 32-bit IP address in that network 
tier. Source and destination IP address in the Internet header are set
by the sender of the datagram, and represented as 32-bit address for 
transmission in tier mode, and combined with attached source and 
destination IP address option in the Internet header, would be 
specifically represented as 64-bit address for those host in Grid-net 
tier, (i.e. Internet IP address :: Grid-net IP address). This type of
address indication is used merely by Grid-net tier Boundary gateways to
select the adequate unique 32-bit IP address for datagram transmitting
in next tier, either the internet tier or the Grid-net tier for the 
next hop, or for the next Boundary gateway when routing an Internet
datagram to the other "GRID" networks. 
The Type of Service is used to indicate the quality of the service 
desired. The type of service is an abstract or generalized set of 
parameters, which characterize the service choices provided in the 
networks that make up the Internet. This type of service indication is 
to be used by gateways to select the actual transmission parameters for 
a particular sub-network for the next hop. 
The Time to Live is an indication of an upper bound on the lifetime of 
an Internet datagram. It is set by the sender of the datagram and 
reduced at the points along the route where it is processed. If the 
time to live reaches zero before the Internet datagram reaches its 
destination, the Internet datagram is destroyed. The time to live can 
be thought of as a self-destruct time limit. 
The Options provide for control functions used in some situations, but 
unnecessary for the most common communications. The options include 
provisions for attached address, timestamps, security, and special 
routing. 
The Header Checksum provides a verification that the information used 
in processing Internet datagram has been transmitted correctly. The 
data may contain errors. If the header checksum fails, the Internet 
datagram is discarded at once by the entity, which detects the error. 
The Enhanced Internet protocol could provide a reliable communication 
facility and flow control, and also implemented in tier Boundary
gateways during Address Swapping interval. There are no acknowledgments
either end-to-end or hop-by-hop. There is no error control for data,
only a header checksum. There are no retransmissions. Errors detected
may be reported via the Internet Control Message Protocol (ICMP), which
is implemented in all Internet protocol module, including those tier 
Boundary gateways. 


2. OVERVIEW

2.1.  Relation to Other Protocols

Internet protocol interfaces on one side to the higher-level 
host-to-host protocols and on the other side to the local network 
protocol. In this context a "local network" may be a small network in 
an office building, at a home, or in a large network such as the 
network over a district. The following diagram illustrates the place of
the Enhanced Internet protocol in the protocol hierarchy: 



Expires March 2003                                           [Page 8]
Draft                Revised Internet Protocol           September 2002

                  +-------------------------------------------------+
Application       |Telnet | FTP | TFTP| Mobile |Voice | Video| ...  |
                  +-------------------------------------------------+
Transport         | TCP | UDP |  ...                            ... |
                  +-------------------------------------------------+
Network, Gateway  |        Enhanced internet Protocol & ICMP        |
                  +-------------------------------------------------+
Link              |            Local Network Protocol               |  
                  +-------------------------------------------------+
                               Protocol Relationships
                                      Figure 2.

2.2. Model of Operation

The following scenario illustrates the model of operation for 
transmitting a datagram from one application program to another. We 
suppose that this transmission will involve some intermediate gateways.
The sending application program prepares its data and calls on its 
local internet module to send that data as a datagram and passes the 
destination address, which is an internet tier address for out-bound, 
or a GRID tier address for in-bound, and attached destination address 
if needed, which is another GRID address for out-bound, and other 
parameters as arguments of the call. 
The Internet module prepares a datagram header and attaches the data to 
it. When the Internet module determines a Grid-net destination address 
for this datagram, which is the address of an inner gateway. It sends 
this datagram to the local network interface. The local network 
interface creates a GRID local network header, and attaches the 
datagram to it, then sends the result via the GRID local network. 
The datagram arrives at a gateway host wrapped in the GRID local 
network header; the local network interface strips off this header, and 
turns the datagram over to the Internet module. The Internet module 
determines from the GRID destination address that the datagram is to be 
forwarded to another host in this GRID local network. The Internet 
module calls on the local network interface for that network to send
the datagram. This local network interface creates a local network
header and attaches the datagram sending the result to the destination
host. At this destination host the datagram is stripped of the GRID
local net header by the local network interface and handed to the
Internet module. The Internet module determines that the datagram is
for an application program in this host. It passes the data to the
application program in response to a system call, passing the source
address and other parameters as results of the call.

  Application                                             Application
    Program                                                 Program
         \                     Inner gateway                  / 
       Internet Module        Internet Module       Internet Module
             \                   /           \             / 
             LNI-1          LNI-1            LNI-2      LNI-2
                \             /                 \       / 
               GRID Local Network 1      GRID Local Network 2
                         Transmission Path in Gridnet
                                 Figure 3

Expires March 2003                                           [Page 9]
Draft            Revised Internet Protocol             September 2002

When the Internet module determines an Internet tier network address 
for the destination address, in this case it is the address of an 
Internet host. It sends this datagram to the GRID Boundary gateway.
The local network interface creates a local network header, and attaches 
the datagram to it, then sends the result via the GRID local network to 
the GRID Boundary gateway. The datagram arrives at a GRID Boundary
gateway wrapped in the local network header; the GRID Boundary gateway
interface strips off this header, and turns the datagram over to the
Internet module. The Internet module determines from the Internet IP
address that the datagram is to be forwarded to some host in Internet. 
The Internet module determines an Internet IP address for the 
destination host. It calls on the local network interface of the GRID 
Boundary gateways for that network to send the datagram. This GRID
Boundary gateways creates a Internet network header, which attaches the 
source host GRID' Internet address, and attached source host GRID 
address, and datagram, sending the result to the destination host in 
Internet. At this destination host the datagram is stripped of the 
network header by the local network interface and handed to the 
Internet module. 
The Internet module determines that the datagram is for an application 
program in this host. It passes the data to the application program in 
response to a system call, passing the source internet IP address, and 
attached source GRID IP address, and other parameters as results of the 
call. 
                                  Application Program in Internet tier
.                                                                /
.                                                       Internet Module
.                                                             /
.                                                           LNI-3
.                                                          /
  Application                                     GRID Boundary gateway
  Program in GRID tier                              Swap Address
         \                   Inner gateway             / 
       Internet Module     Internet Module       Internet Module
            \                  /      \             / 
             LNI-1          LNI-1      LNI-2       LNI-2
                \           /             \      / 
               GRID Local Network 1      GRID Local Network 2
 
            Transmission Path traversing a Grid-net to Internet
                               Figure 4

By the way, if it is impossible to process GRID IP address by the 
application program in destination Internet host, alternatively source 
host could send this datagram and the GRID local network address to 
the GRID proxy.

2.3.  Enhanced Function Description 

The function or purpose of Enhanced Internet Protocol is to move 
datagram through a tiered interconnected set of networks. This is done 
by passing the datagram from one Internet module to another until the 
destination is reached. The Internet modules reside in hosts and 
gateways in different network tier or on the tier Boundary. 

Expires March 2003                                           [Page 10]
Draft            Revised Internet Protocol             September 2002

The datagram are routed from one Internet module to another through 
individual networks or GRID tier Boundary, which are based on the 
interpretation of an Enhanced Internet address. Thus, one important 
mechanism of the Enhanced Internet protocol is the network addressing. 
In the routing of messages from one Internet module to another, 
datagram may need to traverse a network or a network tier, whose 
maximum packet size is smaller than the size of the datagram. To 
overcome this difficulty, a fragmentation mechanism is provided in the 
Enhanced Internet protocol as usually. 

2.3.1.  Names and Addressing

A distinction is made between names, addresses, and routes [4]. A name 
indicates what we seek. An address indicates where it is. A route 
indicates how to get there. The Enhanced Internet protocol deals 
primarily with tier IP addresses. It is the task of higher level (i.e., 
host-to-host or application) protocols to make the mapping from names 
to addresses. 
Name system should have unique and efficient structure correspond with 
Address tier's architecture. Due to extremely large GRID IP address
space, many names could be mapped to one Internet Network address. So
it is helpful to have a tree structure for Names. Name consists of
several portion, is separated by comma, and is arranged in sequence:
For example from left to right: <client name>, 
<application or service name>, <service type>, and <root name>.
Each GRID has its unique domain name suffix attached to the target
names. The DNS in Internet tier maps GRID domain name suffix to GRID
Boundary gateways addresses. The uniform Domain Name policy has to be
adopted by the GRID DNS for Assigned Names and Numbers, and the
administrative resolution service provide rules. 
For example, a GRID in Shenzhen of China has a GRID domain name suffix 
as ".sz.cn", so a person has his home-Web name as "xxxxxx.hom.sz.cn" 
for his house real-time information browsing and control, and has his 
personal SGM mobile-phone name as "xxxxxx.gsm.sz.cn", and 
"xxxxxx@sms.gsm.sz.cn"to receive short message from whatever node in 
the world by near future.
There are two cases for the representation of an address: 
Case 1: A single address of four octets (32 bits),
and represented as ( I. I. I. I ). 
Case 2: Two single address of four octets (total 64 bits), which 
consists of Internet address (32 bits) and Grid-net address (32 bits), 
and represented as ( I. I. I. I :: G. G. G. G). 
All 32 bits addresses begin with a network number, followed by area 
address (called the "rest" field). 
The example of the mapping from names to addresses is as following:
  Name                    Address                     Address Plane
  -------                 ----------                  ----
  "someone.hom.sz.cn"     204.16.16.0::10.35.78.96       data
  "someone.gsm.sz.cn"     204.16.16.192::10.35.78.96     mobile
There are three formats or classes of Enhanced internet addresses: in 
class A, the high order bit is zero, the next 7 bits are the network, 
and the last 24 bits are the local address; in class B, the high order 
two bits are one-zero, the next 14 bits are the network and the last 16 
bits are the local address; in class C, the high order three bits are 

Expires March 2003                                           [Page 11]
Draft           Revised Internet Protocol              September 2002

one-one-zero, the next 21 bits are the network and the last 8 bits are 
the local address. 
For a C class GRID address 204.16.16.0, the example of the division map 
of Address Plane is as following:
  Address                                   Address Plane
  ----------                                -----------------
  204.16.16.0 ~ 204.16.16.127                 data
  204.16.16.127 ~ 204.16.16.159               video
  204.16.16.160 ~ 204.16.16.191               voice
  204.16.16.192 ~ 204.16.16.224               mobile
  204.16.16.225 ~ 204.16.16.241               signaling
  204.16.16.254                               plane multicast

We suggest to use a set of A class address for GRID inner IP address. 
For example, Data Plane identification address is fixed as "10", then 
20 bits are the GRID network address, and the last 4 bits are the 
personality local address. Care must be taken in mapping Enhanced 
Internet addresses to hosts, a single GRID Boundary gateway must be able 
to act as if it were several distinct hosts to the plane extent of 
using several distinct Enhanced Internet addresses (multi-gateways). 
Some GRID Boundary gateways will also have several physical interfaces 
(multi-planes).
The example of the IP addressing is as following:

Network            Class Address                   Description
----------        -----------------------------   -------------------
Internet  A          1.0.0.0 ~ 127.255.255.255       public, exclude "F"
          B	   128.0.0.0 ~ 191.255.255.255       exclude "G" 
          C	   192.0.0.0 ~ 223.255.255.255       exclude "H" 
Grid-net "F"        10.0.0.0 ~ 10.255.255.255        non-private, 
                    20.0.0.0 ~ 20.255.255.255        used for different 
                    30.0.0.0 ~ 30.255.255.255        physical plane 
          D        232.0.0.0 ~ 232.255.255.255       inner multicast
Intranet "F"        10.0.0.0 ~ 10.255.255.255        private, 
         "G"       172.16.0.0 ~ 172.31.255.255
         "H"       192.168.0.0 ~ 192.168.255.255 
In GRID tier, it is also the task of higher level (i.e., host-to-host 
or application) protocols to make the mapping from target names to 
addresses. The GRID Domain Name Server maps names to GRID IP 
addresses. It is the task of lower level procedures (i.e. inner 
gateways in GRID) to make the mapping from GRID IP addresses to routes. 
Additionally, provision must be made for a host or a personnel to have 
several physical interfaces to the network, with each having several 
logical Enhanced Internet addresses. Here, 4 bits address space is 
suggested to provid for personality. 
There is a rule for address initiation in the Internet header: For 
source address it should be placed the current tier address, and for 
destination address it should be placed the top tier address. 
The address swapping process is as following: When the datagram is 
transmitted up to the internet tier, only the source address field is 
swapped by upper tier address (i.e. Internet tier address). Then the 
datagram is transmitted down to the destination Grid-net tier, the 
destination address field is swapped by lower Grid-net tier address. 


Expires March 2003                                           [Page 12]
Draft           Revised Internet Protocol              September 2002

2.3.2.  Fragmentation 

Fragmentation of an Enhanced internet datagram is necessary when it 
originates in a local net that allows a large packet size and must 
traverse a local net that limits packets to a smaller size to reach its 
destination. An Enhanced Internet datagram can also be marked 
"don't fragment." Any Enhanced Internet datagram so marked is not to be 
fragmented under any tier circumstances. If Enhanced Internet datagram 
marked don't fragment cannot be delivered to its destination without 
fragmenting it, it is to be discarded instead. 
Fragmentation, transmission and reassembly across a local network, 
which is invisible to the Internet protocol module, is called Intranet 
fragmentation. 

Fragmentation, transmission and reassembly across a Grid-net local 
network, which is visible to the Internet protocol module of a GRID 
Boundary gateway, is called Grid-net fragmentation, and should be 
effective for the GRID network. 
The Internet fragmentation and reassembly procedure needs to be able to 
break a datagram into an almost arbitrary number of pieces that can be 
later reassembled. The receiver of the fragments uses the 
identification field to ensure that fragments of different datagram are 
not mixed. The fragment-offset field tells the receiver the position of 
a fragment in the original datagram. 
The fragment offset and length determine the portion of the original 
datagram covered by this fragment. The more-fragments flag indicates 
(by being reset) the last fragment. These fields provide sufficient 
information to reassemble datagram. 
The identification field is used to distinguish the fragments of one 
datagram from those of another. The originating protocol module of an 
Enhanced Internet datagram sets the identification field to a value 
that must be unique for that source-destination pair and protocol for 
the time the datagram will be active in the Internet or the Grid-net 
system. The originating protocol module of a complete datagram sets the 
more-fragments flag to zero and the fragment offset to zero. 
To fragment a long Enhanced Internet datagram, an Internet or a 
Grid-net protocol module (for example, in a gateway), creates two new 
Enhanced Internet datagram and copies the contents of the Enhanced 
Internet header fields from the long datagram into both new Enhanced 
Interne headers. The data of the long datagram is divided into two 
portions on an 8 octet (64 bit) boundary (the second portion might not 
be an integral multiple of 8 octets, but the first must be). Call the 
number of 8 octet blocks in the first portion NFB (for Number of 
Fragment Blocks). The first portion of the data is placed in the first 
new Enhanced Internet datagram, the total length field is set to the 
length of the first datagram, and the more-fragments flag is set to 
one. The second portion of the data is placed in the second new 
Enhanced Internet datagram, the total length field is set to the length 
of the second datagram, and the more-fragments flag carries the same 
value as the long datagram. The fragment offset field of the second new 
Enhanced Internet datagram is set to the value of that field in the
long datagram plus NFB. 
This procedure can be generalized for n-way split, rather than the 
two-way split described. To assemble the fragments of an Enhanced 

Expires March 2003                                          [Page 13]
Draft           Revised Internet Protocol              September 2002

Internet datagram, an Internet or a Grid-net protocol module (for 
example at a destination host) combine Enhanced Internet datagram that 
all have the same value for the four to six fields: identification, 
source, destination, protocol, and attached source option, attached 
destination option if needed. The combination is done by placing the 
data portion of each fragment in the relative position indicated by the 
fragment offset in that fragment's Enhanced Internet header. The first 
fragment will have the fragment offset zero, and the last fragment will 
have the more-fragments flag reset to zero. 

2.4. Gateways

Gateways implement Enhanced Internet protocol to forward datagram 
between networks in the same or different tier. Gateways also implement 
the Gateway to Gateway Protocol (GGP) [7] to coordinate routing and 
other Internet control information. 
In a gateway the higher-level protocols need not be implemented and the 
GGP functions are added to the IP module. In a Grid Boundary gateway the 
IP address swapping function is added to the IP module.
                      +-----------------------------------+
Internet Tier         |  Internet Protocol & ICMP & GGP   |
gateway               +-----------------------------------+
                              |                  |
  +------------------------------------+   +----------+
  | Internet Protocol & IP Swapping    |   | Local Net|
  |       & ICMP & GGP                 |   +----------+
  +------------------------------------+
Grid Boundary gateway         |
                              |
              +-----------------------------------+
Grid-net Tier |  Internet Protocol & ICMP & GGP   |
gateway       +-----------------------------------+
                         |                 |         
                    +------------+    +-----------+ 
                    |  Local Net |    | Local Net | 
                    +------------+    +-----------+ 
                          Gateway Protocols
                                Figure 5.

3. SPECIFICATION

3.1. Enhanced Internet Header Format

There are two cases for the format of a Enhanced Internet Header: 
Case 1: Normal Case.
        Two 4-octet fields of Source Address and Destination Address, 
        which are the same as Ipv4 usually be. This Format is used
        for those datagram, which is transmitted only in one Tier,
        either the Internet tier or the Grid-net tier.
Case 2: Enhanced Case.
        Two 4-octet fields of Source Address and Destination Address, 
        And a Fixed attached address option, which has 12-octet length,
        including an option-type octet, an option-length octet, and the
        2-octet of Flow Labels, 4-octet of Source Address and 4-octet

Expires March 2003                                          [Page 14]
Draft           Revised Internet Protocol              September 2002

        of Destination Address. This Format is used for those datagram,
        which is transmitted through the tier boundary gateway between
        the Internet tier and the Grid-net tier at least once.
A summary of the contents of the Enhanced Internet header is as follows:

Case 1: Normal Internet Header Format.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|- IHL -|Type of Service|-------- Total Length ---------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-------- Identification -------|Flags|---- Fragment Offset ----|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-Time to Live--|-- Protocol ---|------- Header Checksum -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---------------------- Source Address -------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--------------------- Destination Address ---------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--------------------- Options -----------------|--- Padding ---|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Example Normal Internet Datagram Header
                                Figure 6.
   Note that each tick mark represents one bit position.

Case 2: Enhanced Internet Header Format.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|- IHL -|Type of Service|-------- Total Length ---------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-------- Identification -------|Flags|---- Fragment Offset ----|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-Time to Live--|-- Protocol ---|------- Header Checksum -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---------------------- Source Address -------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--------------------- Destination Address ---------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |- AAO Header --|- AAO Length --|--------- Flow Labels ---------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------ Attached Source Address --------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---------------- Attached Destination Address -----------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-------------------- other Options ------------|--- Padding ---|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Example Enhanced Internet Datagram Header
                                Figure 7.
   Note that each tick mark represents one bit position.

Expires March 2003                                          [Page 15]
Draft           Revised Internet Protocol              September 2002

3.1.1.  Version:  4 bits

The Version field indicates the format of the Enhanced Internet header.
This document describes Enhanced version 4.

3.1.2.  IHL:  4 bits

Enhanced Internet Header Length is the length of the Enhanced Internet 
header in 32 bit words, and thus points to the beginning of the data.
Note that the minimum value for a correct header is 5 for normal 
header. The example value for a Enhanced header is 8, where we add 
extra 3 of 32 bit words, including an Attached Source Address and an 
Attached Destination Address.

3.1.3.  Type of Service: 8 bits
 
The Type of Service provides an indication of the abstract parameters 
of the quality of service desired. These parameters are to be used to 
guide the selection of the actual service parameters when transmitting 
a datagram through a particular network. Several networks offer service 
precedence, which somehow treats high precedence traffic as more 
important than other traffic (generally by accepting only traffic above 
a certain precedence at time of high load). The major choice is a 
three-way tradeoff between low-delay, high-reliability, and 
high-throughput. 
  Bits 0-2: Precedence. 
  Bit 3: 0 = Normal Delay, 1 = Low Delay.
  Bit 4: 0 = Normal Throughput, 1 = High Throughput.
  Bit 5: 0 = Normal Reliability, 1 = High Reliability.
  Bit 6: reserved.
  Bit 7: reserved.
           0     1       2      3      4      5      6       7
      +-----+-----+------+-----+-----+-----+-----+-----+
      |---- PRECEDENCE --|- D -|- T -|- R -|     |     |
      +-----+-----+------+-----+-----+-----+-----+-----+
         Precedence
          111 - Network Control
          110 - Internetwork Control
          101 - CRITIC/ECP
          100 - Flash Override
          011 - Flash
          010 - Immediate
          001 - Priority
          000 - Routine
IETF Diffserv (RFC2474) may supersede The ToS, use 6 bits of 
Differentiated Services Code Point (DSCP) to assign QoS for datagram.
           0     1       2      3      4      5      6       7
      +-----+-----+------+-----+-----+-----+-----+-----+
      |------------- DSCP -----------------|     |     |
      +-----+-----+------+-----+-----+-----+-----+-----+
The type of service is used to specify the treatment of the datagram 
during its transmission through the Internet system. The use of the 
Delay, Throughput, and Reliability indications may increase the cost 
(in some sense) of the service. In many networks better performance for 

Expires March 2003                                          [Page 16]
Draft           Revised Internet Protocol              September 2002

these parameters is processed in distribution way. Example mappings of 
the Internet type of service to the actual service provided on networks 
such as the EXP(Experimental) field of the MPLS header of RFC 3032. 
The Network Control precedence designation is intended to be used 
within a network only. The actual use and control of that designation 
is up to each network. The Internetwork Control designation is intended 
for use by gateway control originators only. If the actual use of these 
precedence designations is of concern to a particular network, it is 
the responsibility of that network to control the access to, and use of, 
those precedence designations.
 
3.1.4.  Total Length: 16 bits

Total Length is the length of the datagram, measured in octets, 
including Enhanced Internet header and data. This field allows the 
length of a datagram to be up to 65,535 octets. Such long datagram are 
suit for TCP, and are impractical for most hosts and networks. All 
hosts must be prepared to accept datagram of up to 576 octets (whether 
they arrive whole or in fragments). It is recommended that hosts only 
send datagram larger than 576 octets if they have assurance that the 
destination is prepared to accept the larger datagram. 
The number 576 is selected to allow a reasonable sized data block to be 
transmitted in addition to the required header information. For example, 
this size allows a data block of 512 octets plus 64 header octets to 
fit in a datagram. The maximal Enhanced Internet header is 60 octets, 
and a typical Enhanced Internet header is 32 octets, allowing a margin 
for headers of higher-level protocols.
 
3.1.5.  Identification: 16 bits
 
An identifying value assigned by the sender to aid in assembling the 
fragments of a datagram. 

3.1.6.  Flags: 3 bits 

Various Control Flags. 
Bit 0: reserved, must be zero 
Bit 1: (DF) 0 = May Fragment, 1 = Don't Fragment.
Bit 2: (MF) 0 = Last Fragment, 1 = More Fragments.
             0       1        2
         +------+------+------+
         |  0   |  DF  |  MF  |
         +------+------+------+

3.1.7.  Fragment Offset:  13 bits

This field indicates where in the datagram this fragment belongs. The 
fragment offset is measured in units of 8 octets (64 bits). The first 
fragment has offset zero. 

3.1.8.  Time to Live: 8 bits 

This field indicates the maximum time the datagram is allowed to remain 
in the Internet system. If this field contains the value zero, then the 

Expires March 2003                                          [Page 17]
Draft           Revised Internet Protocol              September 2002

datagram must be destroyed. 
This field is modified in Enhanced Internet header processing. The time 
is measured in units of seconds, but since every module that processes 
a datagram must decrease the TTL by at least one even if it process the 
datagram in less than a second, the TTL must be thought of only as an 
upper bound on the time a datagram may exist. The intention is to cause 
undeliverable datagram to be discarded, and to bound the maximum 
datagram lifetime.
 
3.1.9.  Protocol: 8 bits 

This field indicates the next level protocol used in the data portion 
of the Enhanced Internet datagram. The values for various protocols are 
specified in "Assigned Numbers" [9]. For example, the value 51 in 
Protocol field represents Authentication.

3.1.10.  Header Checksum: 16 bits

A checksum on the header only. Since some header fields change (e.g., 
time to live), this is recomputed and verified at each point that the 
Enhanced Internet header is processed. The checksum algorithm is: The 
checksum field is the 16 bit one's complement of the one's complement 
sum of all 16-bit words in the header. For purposes of computing the 
checksum, the value of the checksum field is zero. 
This is a simple to compute checksum and experimental evidence 
indicates it is adequate, but it is provisional and may be replaced by 
a CRC procedure, depending on further experience. 

3.1.11.  AAO Header: 8 bits

The AOO options Header may appear or not in datagram. They must be
implemented by all IP modules (boundary gateways or host).
For Enhanced Internet header the attached address option may added
in all datagram, when transmitted across the Boundary between Internet
tier and Grid-net tier. In some environments the Flow Labels may
asignned in all datagram. The attached option field is fixed in length.
There may followed by no or more variable options. 
The AAO Header octet is viewed as having 3 fields: 
  1 bit   copied flag, always 1 = copied 
  2 bits  option class, always 01 = attached IP address 
  5 bits  option number.
           0     1       2      3      4      5      6       7
      +-----+-----+------+-----+-----+-----+-----+-----+
      |flg=1|op-class=01 |- - -|- AGD|- AID|- AGS|- AIS|
      +-----+-----+------+-----+-----+-----+-----+-----+
The following Internet option bits are defined: 
AIS - attached Source Address, Used to indicate there is a 4 octets
      Internet IP Address of the source host.
AGS - attached Source Address, Used to indicate there is a 4 octets
      Grid-net IP Address of the source host.
AID - attached Destination Address, Used to indicate there is a 4
      Octets Internet IP Address of the Destination host.
AGD - attached Destination Address, Used to indicate there is a
      4 octets Grid-net IP Address of the Destination host.

Expires March 2003                                          [Page 18]
Draft           Revised Internet Protocol              September 2002

For example AAO Header =161, if there is a attached Source Internet
Address. 

3.1.12.  AAO Length: 8 bits

AAO Length is always 12.

3.1.13.  Flow Labels: 16 bits

The 16-bit Flow Label field in the Enhanced Ipv4 header may be used by
a source to label sequences of packets for which it requests special
handling by the routers in Internet tier, such as non-default quality
of service or "real-time" service.  This aspect from IPv6 is still
experimental and subject to change as the requirements for flow support
in the Internet backbone.

3.1.14.  Attached Source Address

This Attached Source Address option appears at most once in a datagram.
It provides a way for host to store source next tier's IP address of
the host, and for Grid Boundary Gateway to swap the Source Address field
by this address or it's Internet address for transmission throughout the
Boundary, outbound to the Internet tier. 
This option should be copied on fragmentation.

3.1.15.  Attached Destination Address

This Attached Destination Address option appears at most once in a
datagram. It provides a way for Grid Boundary Gateway to swap the
destination address by this Address field, for transmission inbound to
destination Grid-net. 
This option should be copied on fragmentation.

3.1.16.  Options: variable
 
The options may appear or not in datagram. They must be implemented by 
all IP modules (host and gateways). What is optional is their 
transmission in any particular datagram, not their implementation. In
some environments the security option may be required in all datagram. 
The option field is variable in length. There may be zero or more
options. 

There are two cases for the format of an option: 
Case 1: A single octet of option-type. 
ase 2: An option-type octet, an option-length octet, and the actual 
option-data octets. 
The option-length octet counts the option-type octet and the 
option-length octet as well as the option-data octets. 
The option-type octet is viewed as having 3 fields: 
  1 bit 	copied flag,
  2 bits	option class,
  5 bits	option number.
The copied flag indicates that this option is copied into all fragments 
on fragmentation.

Expires March 2003                                          [Page 19]
Draft           Revised Internet Protocol              September 2002

      0 = not copied
      1 = copied

The option classes are:
      0 = control
      1 = attached IP address, for fixed format in AAO above mentioned
      2 = debugging and measurement
      3 = Reserved

The following Internet options are defined: 

Class Number Length	 Description 
----  ------ ------  -----------
0    0             - End of Option list. This option occupies only
                    1 octet; it has no length octet.
0    1             - No Operation.  This option occupies only 1
                        Octet; it has no length octet.
0    2     11      - Security. Used to carry Security, Compartmentation,
                    User Group (TCC), and Handling Restriction Code
                    compatible with DOD Requirements.
0    3    var.      - Loose Source Routing. Used to route the Enhanced
                    Internet datagram based on information supplied by
                    the source.
0    9    var.      - Strict Source Routing. Used to route the Enhanced 
                    Internet datagram based on information
                    supplied by the source.
0    7    var.      - Record Route. Used to trace the route an
                    Enhanced Internet datagram takes.
0    8     4       - Stream ID for multimedia.
                    Used to carry the stream identifier.
2    4    var.      - Internet Timestamp.

3.1.17.  Padding: variable
 
The Enhanced Internet header padding is used to ensure that the 
Enhanced Internet header ends on a 32-bit boundary. The padding is zero. 
 
3.2.  Specific Option Definitions

3.2.1.  End of Option List

         +-----------+
         | 00000000  |
         +-----------+
          Type=0

This option indicates the end of the option list. This might not 
coincide with the end of the Enhanced Internet header according to the 
Enhanced Internet header length. This is used at the end of all options, 
not the end of each option, and need only be used if the end of the 
options would not otherwise coincide with the end of the Enhanced 
Internet header. May be copied, introduced, or deleted on fragmentation, 
or for any other reason.


Expires March 2003                                          [Page 20]
Draft           Revised Internet Protocol              September 2002

3.2.2.  No Operation 

        +-----------+
        | 00000001  |
        +-----------+
          Type=1
This option may be used between options, for example, to align the 
beginning of a subsequent option on a 32-bit boundary. May be copied, 
introduced, or deleted on fragmentation, or for any other reason.

3.2.3.  Security

This option provides a way for hosts to send security, compartmentation, 
handling restrictions, and TCC (closed user group) parameters. The 
format for this option is as follows:
 
+---------+---------+---//-----+---//-----+---//------+---//----+
| 10000010| 00001011| SSS   SSS| CCC   CCC| HHH    HHH|  TCC    |
+---------+---------+---//-----+---//-----+---//------+---//----+
           Type=130  Length=11
 
Security (S field):  16 bits
Specifies one of 16 levels of security (eight of which are reserved 
for future use).
            00000000 00000000 - Unclassified
            11110001 00110101 - Confidential
            01111000 10011010 - EFTO
            10111100 01001101 - MMMM
            01011110 00100110 - PROG
            10101111 00010011 - Restricted
            11010111 10001000 - Secret
            01101011 11000101 - Top Secret
            00110101 11100010 - (Reserved for future use)
            10011010 11110001 - (Reserved for future use)
            01001101 01111000 - (Reserved for future use)
            00100100 10111101 - (Reserved for future use)
            00010011 01011110 - (Reserved for future use)
            10001001 10101111 - (Reserved for future use)
            11000100 11010110 - (Reserved for future use)
            11100010 01101011 - (Reserved for future use)

Compartments (C field): 16 bits 
An all zero value is used when the information transmitted is not 
compartmented. 

Handling Restrictions (H field): 16 bits
The values for the control and release markings are alphanumeric 
digraphs and are defined in the Defense Intelligence Agency Manual 
DIAM 65-19, "Standard Security Markings". 
Transmission Control Code (TCC field): 24 bits 
Provides a means to segregate traffic and define controlled communities 
of interest among subscribers. The TCC values are trigraphs, and are 
available from HQ DCA Code 530.Must be copied on fragmentation. 
This option appears at most once in a datagram. 

Expires March 2003                                          [Page 21]
Draft           Revised Internet Protocol              September 2002

3.2.4.  Loose Source and Record Route 

.    +--------+---------+-------+-------//-----------+
.    |10000011|  length |pointer|    route data      |
.    +--------+---------+-------+-------//-----------+
         Type=131
The loose source and record route (LSRR) option provides a means for 
the source of an Enhanced Internet datagram to supply routing 
information to be used by the gateways in forwarding the datagram to 
the destination (or destination Grid-net), and to record the route 
information.
The option begins with the option type code. The second octet is the 
option length which includes the option type code and the length octet, 
the pointer octet, and length-3 octets of route data. The third octet 
is the pointer into the route data indicating the octet, which begins 
the next source address to be processed. The pointer is relative to 
this option, and the smallest legal value for the pointer is 4.
A route data is composed of a series of Internet addresses or Grid-net 
address. Each address is 32 bits or 4 octets. If the pointer is greater 
than the length, the source route is empty (and the recorded route full) 
and the routing is to be based on the destination address field.
If the Internet address in destination address field has been reached 
and the pointer is not greater than the length, the next address in the 
source route replaces the address in the destination address field, and 
the recorded route address replaces the source address just used, and 
pointer is increased by four. The recorded route address is the 
Internet module's own Internet address as known in the environment into 
which this datagram is being forwarded. 
This procedure of replacing the source route with the recorded route 
(though it is in the reverse of the order it must be in to be used as a 
source route) means the option (and the IP header as a whole) remains a 
constant length as the datagram progresses through the Internet. 
This option is a loose source route because the gateway or host IP is 
allowed to use any route of any number of other intermediate gateways 
to reach the next address in the route. This option must be copied on 
fragmentation. Appears at most once in a datagram. 

3.2.5.  Strict Source and Record Route 

      +---------+--------+--------+------//---------+
      | 10001001| length | pointer|   route data    |
      +---------+--------+--------+--- --//---------+
         Type=137
The strict source and record route (SSRR) option provides a means for 
the source of an Internet datagram to supply routing information to be 
used by the gateways in forwarding the datagram to the destination, and 
to record the route information.
The option begins with the option type code. The second octet is the 
option length, which includes the option type code and the length octet, 
the pointer octet, and length-3 octets of route data. The third octet 
is the pointer into the route data indicating the octet, which begins 
the next source address to be processed. The pointer is relative to 
this option, and the smallest legal value for the pointer is 4. A route 
data is composed of a series of Internet or Grid-net addresses. 

Expires March 2003                                          [Page 22]
Draft           Revised Internet Protocol              September 2002

Each address is 32 bits (4 octets). If the pointer is greater than the 
length, the source route is empty (and the recorded route full) and the 
routing is to be based on the destination address field. 
If the address in destination address field has been reached and the 
pointer is not greater than the length, the next address in the source 
route replaces the address in the destination address field, and the 
recorded route address replaces the source address just used, and 
pointer is increased by four. The recorded route address is the 
Internet module's own current tier address as known in the environment 
into which this datagram is being forwarded. 
This procedure of replacing the source route with the recorded route 
(though it is in the reverse of the order it must be in to be used as a 
source route) means the option (and the IP header as a whole) remains a 
constant length as the datagram progresses through the Internet. 
This option is a strict source route because the gateway or host IP 
must send the datagram directly to the next address in the source route 
through only the directly connected network indicated in the next 
address to reach the next gateway or host specified in the route. 
Must be copied on fragmentation. Appears at most once in a datagram. 

3.2.6.  Record Route

        +--------+--------+--------+-----//--------+
        |00000111| length | pointer|  route data   |
        +--------+--------+--------+-----//--------+
          Type=7
The record route option provides a means to record the route of an 
Internet datagram. 
The option begins with the option type code. The second octet is the 
option length which includes the option type code and the length octet, 
the pointer octet, and length-3 octets of route data. The third octet 
is the pointer into the route data indicating the octet, which begins 
the next area to store a route address. The pointer is relative to this 
option, and the smallest legal value for the pointer is 4. A recorded 
route is composed of a series of Internet addresses. Each Internet 
address is 32 bits or 4 octets. If the pointer is greater than the 
length, the recorded route data area is full. The originating host must 
compose this option with a large enough route data area to hold all the 
address expected. The size of the option does not change due to adding 
addresses. The initial contents of the route data area must be zero. 
When an Internet module routes a datagram it checks to see if the 
record route option is present. If it is, it inserts its own internet 
address as known in the environment into which this datagram is being 
forwarded into the recorded route beginning at the octet indicated by 
the pointer, and increments the pointer by four. 
If the route data area is already full (the pointer exceeds the length) 
the datagram is forwarded without inserting the address into the 
recorded route. If there is some room but not enough room for a full 
address to be inserted, the original datagram is considered to be in 
error and is discarded. In either case an ICMP parameter problem 
message may be sent to the source host [3]. 
Not copied on fragmentation, goes in first fragment only. Appears at 
most once in a datagram. 


Expires March 2003                                          [Page 23]
Draft           Revised Internet Protocol              September 2002

3.2.7.  Stream Identifier 

        +--------+--------+-------+------+
        |10001000|00000100|  Stream ID   |
        +--------+--------+-------+------+
         Type=136 Length=4
This option provides a way for the 16-bit SATNET stream identifier to 
be carried through networks that do not support the stream concept. 
Must be copied on fragmentation. Appears at most once in a datagram. 

3.2.8.  Enhanced Internet Timestamp 

        +--------+--------+--------+----------+
        |01000100| length | pointer|oflw |flg |
        +--------+--------+--------+----------+
        |        current tier address         |
        +--------+--------+--------+----------+
        |             Timestamp               |
        +--------+--------+--------+----------+
          Type = 68

The Option Length is the number of octets in the option counting the 
type, length, pointer, and overflow/flag octets (maximum length 40).
The Pointer is the number of octets from the beginning of this option 
to the end of timestamps plus one (i.e., it points to the octet 
beginning the space for next timestamp). The smallest legal value is 5. 
The timestamp area is full when the pointer is greater than the length. 
The Overflow (oflw) [4 bits] is the number of IP modules that cannot 
register timestamps due to lack of space. The Flag (flg) [4 bits] 
values are 
0 -- time stamps only, stored in consecutive 32-bit words,
1 -- each timestamp is preceded with current tier address of the 
registering entity,
3 -- the Internet address fields are prespecified. 
An IP module only registers its timestamp if it matches its own address 
with the next specified Internet address.
For those IP module in Grid-net tier, the current tier address should 
be their own Grid-net address. The Timestamp is a right-justified, 
32-bit timestamp in milliseconds since midnight UT. 
If the time is not available in milliseconds or cannot be provided with 
respect to midnight UT, then Local Time may be inserted as a timestamp 
provided the high order bit of the timestamp field is set to one to 
indicate the use of a non-standard value.
The originating host must compose this option with a large enough 
timestamp data area to hold all the timestamp information expected. 
The size of the option does not change due to adding Timestamps. 
The initial contents of the timestamp data area must be zero or 
current tier address/zero pairs. If the timestamp data area is already 
full (the pointer exceeds the length) the datagram is forwarded without 
inserting the timestamp, but the overflow count is incremented by one. 
If there is some room but not enough room for a full timestamp to be 
inserted, or the overflow count itself overflows, the original datagram 
is considered to be in error and is discarded. In either case an ICMP 
parameter problem message may be sent to the source host [3]. 

Expires March 2003                                          [Page 24]
Draft           Revised Internet Protocol              September 2002

The timestamp option is not copied upon fragmentation. It is carried in 
the first fragment. Appears at most once in a datagram. 

3.3. Discussion

The implementation of Enhanced Internet protocol must be robust. Each 
implementation must expect to interoperate with others created by 
different individuals. While the goal of this specification is to be 
explicit about the protocol there is the possibility of differing 
Interpretations. In general, an implementation must be conservative in 
its sending behavior, and liberal in its receiving behavior. That is, 
it must be careful to send well-formed datagram, but must accept any 
datagram that it can interpret (e.g., not object to technical errors 
where the meaning is still clear). 
The basic internet service is datagram oriented and provides for the 
fragmentation of datagram at gateways, with reassembly taking place at 
the destination internet protocol module in the destination host. 
Of course, fragmentation and reassembly of datagram within a network or 
by private agreement between the gateways of a network is also allowed 
since this is transparent to the Enhanced Internet protocols and the 
higher-level protocols. This transparent type of fragmentation and 
reassembly is termed "network-dependent" (or Intranet) fragmentation 
and is not discussed further here. 
Enhanced Internet addresses distinguish sources and destinations to the 
host level, which is compatible with original Internet protocols, and 
provide a protocol field as well. It is assumed that each protocol will 
provide for whatever multiplexing is necessary within a host. 

3.3.1.  Addressing 

Address Formats: 
Tier     High Order Bits      Format                           Class
-----   -----------------    --------                         -------
Internet   0               7 bits of net, 24 bits of host       A
                              1.0.0.0 ~ 127.255.255.255
           10              14 bits of net, 16 bits of host      B
                            128.0.0.0 ~ 191.255.255.255
           110             21 bits of net, 8 bits of host       C
                            192.0.0.0 ~ 223.255.255.255
Grid-net   0               24 bits of host                      A
                             10.0.0.0 ~ 10.255.255.255
multicast  1110            24 bits of host                      D
(for grid-net)              232.0.0.0 ~ 232.255.255.255
Intranet   10              16 bits of host                      B
                            172.16.0.0 ~ 172.31.255.255
           110             8 bits of host                       C
                            192.168.0.0 ~ 192.168.255.255
To provide for flexibility in assigning address to networks and allow 
for the large number of small to intermediate sized networks the 
interpretation of the address field is coded to specify a small number 
of networks with a large number of host, a moderate number of networks 
with a moderate number of hosts, and a large number of networks with a 
small number of hosts. In addition there is an escape code for extended 
addressing mode. 

Expires March 2003                                          [Page 25]
Draft           Revised Internet Protocol              September 2002

A value of zero in the network field means this network. This is only 
used in certain ICMP messages. The actual values assigned for network 
addresses is given in "Assigned Numbers" [9].
The tier address, assigned by the local service provider, must allow 
for a single physical host to act as several distinct hosts. That is, 
there must be a mapping between host addresses and network/host 
interfaces that allows several Enhanced Internet addresses to 
correspond to one interface.  It must also be allowed for a host to 
have several physical interfaces and to treat the datagram from several 
of them as if they were all addressed to a single host, these are 
specifically useful for Grid-net Address Plane. 

3.3.2.  Example Address Swapping 

The Grid-net Boundary gateway processes address swapping of each
outbound datagram, which checks if the destination would be an Internet
Address, and the source would be an Grid-net Address. The fields which
may be affected by address swapping include:
(1) source field
(2) header length
(3) Attached Source option field
(4) Total Length 
(5) header checksum

Notation: 
        SO    - Source Address 
        ASO   - Attached Source Option
	GSI    - Grid-net Gateway Internet Source Address
        NIHL   - New Internet Header Length
        OO    - Option Offset 
        AAOH    - Attached Address Option Header 
        AAOL    - Attached Address Option Length 
	AISOH  - attached Option Header with Internet Source bit on 
	AGSOH  - attached Option Header with Grid-net Source bit on
        TL    - Total Length
        OSO   - Old Source
        OASO  - Old Attached Source Option
        OIHL  - Old Internet Header Length
        OTL   - Old Total Length

Procedure:
 IF Destination not in Internet Address Set THEN discard the datagram
   IF Source not in Grid-net Address Set THEN discard the datagram
   ELSE To swap the Source address:
 (1) Copy the original Enhanced Internet header;
 (2) OSO <- SO; 
 (3) IF ((AAOH && AISOH)== AISOH )
      IF Attached Source Option is Internet Address of the Grid-net 
      THEN SO <- ASO.S; ASO <- OSO; AAOH <- ((AAOH | AGS)& not AIS);
      ELSE discard the datagram 
     ELSE To insert a Source address option:
       Move the option portion from OO down 12 octets offset;
       SO <- GSI; ASO <- GSOH+ OSO;
       AAOH <- 162; AAOL <- 12;

Expires March 2003                                          [Page 26]
Draft           Revised Internet Protocol              September 2002

       NIHL <- OIHL+3; TL <- OTL+12;
 (4) Correct the header: Recompute Checksum;
 (5) Submit this datagram to the test;
  DONE. 

3.3.3.  Compatibility

The Enhanced Internet Protocol is compatible with the original 
internet protocol, so at the very beginning when the Grid-net being set 
up, not all Web server can handle the attached address option, the 
hosts inside the Grid-net can operate as if in the lower Intranet tier. 
IE Browser inside the Grid-net can access World Wide Web by local 
Proxy as usual. 

3.3.4.  Fragmentation and Reassembly.

The Internet identification field (ID) is used together with the source 
and destination address, and the protocol fields, to identify datagram 
fragments for reassembly.
The More Fragments flag bit (MF) is set if the datagram is not the last 
fragment. The Fragment Offset field identifies the fragment location, 
relative to the beginning of the original unfragmented datagram. 
Fragments are counted in units of 8 octets. The fragmentation strategy 
is designed so, then an unfragmented datagram has all zero 
fragmentation information (MF = 0, fragment offset = 0). If an Enhanced 
Internet datagram is fragmented, its data portion must be broken on 8 
octet boundaries. This format allows 2**13 = 8192 fragments of 8 octets 
each for a total of 65,536 octets. Note that this is consistent with 
the datagram total length field (of course, the header is counted in 
the total length and not in the fragments).
When fragmentation occurs, some options are copied, but others remain 
with the first fragment only. Every Internet module must be able to 
forward a datagram of 68 octets without further fragmentation. This is 
because an Enhanced Internet header may be up to 60 octets, and the 
minimum fragment is 8 octets. Every Enhanced Internet destination must 
be able to receive a datagram of 576 octets either in one piece or in 
fragments to be reassembled. The fields which may be affected by 
fragmentation include:
      (1) options field
      (2) more fragments flag
      (3) fragment offset
      (4) Enhanced internet header length field
      (5) total length field
      (6) header checksum
If the Don't Fragment flag (DF) bit is set, then fragmentation of this 
datagram is NOT permitted, although it may be discarded. This can be 
used to prohibit fragmentation in cases where the receiving host does 
not have sufficient resources to reassemble Enhanced internet fragments.
One example of use of the Don't Fragment feature is to down line load a 
small host. A small host could have a boot strap program that accepts a 
datagram stores it in memory and then executes it.
The fragmentation and reassembly procedures are most easily described 
by examples.  The following procedures are example implementations.


Expires March 2003                                          [Page 27]
Draft           Revised Internet Protocol              September 2002

General notation in the following pseudo programs: "=<" means 
"less than or equal", "#" means "not equal", "=" means "equal", "<-" 
means "is set to". Also, "x to y" includes x and excludes y; for 
example, "4 to 7" would include 4, 5, and 6 (but not 7).

3.3.5.  Example Fragmentation Procedure 

The maximum sized datagram that can be transmitted through the next 
network is called the maximum transmission unit (MTU). If the total 
length is less than or equal the maximum transmission unit then submit 
this datagram to the next step in datagram processing; otherwise cut 
the datagram into two fragments, the first fragment being the maximum 
size, and the second fragment being the rest of the datagram. 
The first fragment is submitted to the next step in datagram 
processing, while the second fragment is submitted to this procedure in 
case it is still too large. 
Notation: 

        FO    - Fragment Offset
        IHL   - Enhanced internet Header Length
        DF    - Don't Fragment flag
        MF    - More Fragments flag
        TL    - Total Length
        OFO   - Old Fragment Offset
        OIHL  - Old Internet Header Length
        OMF   - Old More Fragments flag
        OTL   - Old Total Length
        NFB   - Number of Fragment Blocks
        MTU   - Maximum Transmission Unit
 
  Procedure:
 
  IF TL =< MTU 
   THEN Submit this datagram to the next step in datagram processing 
   ELSE IF DF = 1 THEN discard the datagram
   ELSE To produce the first fragment:
     (1) Copy the original Enhanced internet header;
     (2) OIHL <- IHL; OTL <- TL; OFO <- FO; OMF <- MF;
     (3) NFB <- (MTU-IHL*4)/8;
     (4) Attach the first NFB*8 data octets;
     (5) Correct the header:
         MF <- 1;  TL <- (IHL*4)+(NFB*8);
         Recompute Checksum;
     (6) Submit this fragment to the next step in datagram processing; 
         To produce the second fragment:
     (7) Selectively copy the Enhanced internet header 
(some options are not copied, see option definitions);
     (8) Append the remaining data;
     (9) Correct the header:
         IHL <- (((OIHL*4)-(length of options not copied))+3)/4;
         TL <- OTL - NFB*8 - (OIHL-IHL)*4); 
         FO <- OFO + NFB; MF <- OMF; 
         Recompute Checksum; 
    (10) Submit this fragment to the fragmentation test;
        DONE. 
Expires March 2003                                          [Page 28]
Draft           Revised Internet Protocol              September 2002

In the above procedure each fragment (except the last) was made the 
maximum allowable size. An alternative might produce less than the 
maximum size datagrams. For example, one could implement a 
fragmentation procedure that repeatly divided large datagrams in half 
until the resulting fragments were less than the maximum transmission 
unit size. 

3.3.6.  Example Reassembly Procedure
 
For each datagram the buffer identifier is computed as the 
concatenation of the source, destination, protocol, and identification 
fields. If this is a whole datagram (that is both the fragment offset 
and the more fragments fields are zero), then any reassembly resources 
associated with this buffer identifier are released and the datagram is 
forwarded to the next step in datagram processing. 
If no other fragment with this buffer identifier is on hand then 
reassembly resources are allocated. The reassembly resources consist 
of a data buffer, a header buffer, a fragment block bit table, a total 
data length field, and a timer. The data from the fragment is placed in 
the data buffer according to its fragment offset and length, and bits 
are set in the fragment block bit table corresponding to the fragment 
blocks received. 
If this is the first fragment (that is the fragment offset is zero) 
this header is placed in the header buffer. If this is the last 
fragment ( that is the more fragments field is zero) the total data 
length is computed. If this fragment completes the datagram (tested by 
checking the bits set in the fragment block table), then the datagram 
is sent to the next step in datagram processing; otherwise the timer is 
set to the maximum of the current timer value and the value of the time 
to live field from this fragment; and the reassembly routine gives up 
control. 
If the timer runs out, the all reassembly resources for this buffer 
identifier are released. The initial setting of the timer is a lower 
bound on the reassembly waiting time. This is because the waiting time 
will be increased if the Time to Live in the arriving fragment is 
greater than the current timer value but will not be decreased if it is 
less. The maximum this timer value could reach is the maximum time to 
live (approximately 4.25 minutes). The current recommendation for the 
initial timer setting is 15 seconds. This may be changed as experience 
with this protocol accumulates. Note that the choice of this parameter 
value is related to the buffer capacity available and the data rate of 
the transmission medium; that is, data rate times timer value equals 
buffer size (e.g., 10Kb/s X 15s = 150Kb).
      Notation:
        FO    - Fragment Offset
        IHL   - Enhanced internet Header Length
        MF    - More Fragments flag
        TTL   - Time To Live
        NFB   - Number of Fragment Blocks
        TL    - Total Length
        TDL   - Total Data Length
        BUFID - Buffer Identifier
        RCVBT - Fragment Received Bit Table
        TLB   - Timer Lower Bound
 
Expires March 2003                                          [Page 29]
Draft           Revised Internet Protocol              September 2002

      Procedure:
        (1) BUFID <- source|destination|protocol|identification;
        (2) IF FO = 0 AND MF = 0
        (3)   THEN IF buffer with BUFID is allocated
        (4)             THEN flush all reassembly for this BUFID;
        (5)             Submit datagram to next step; DONE.
        (6)   ELSE IF no buffer with BUFID is allocated
        (7)         THEN allocate reassembly resources with BUFID;
                           TIMER <- TLB; TDL <- 0;
        (8) put data from fragment into data buffer with
             BUFID from octet FO*8 to octet (TL-(IHL*4))+FO*8;
        (9) set RCVBT bits from FO to FO+((TL-(IHL*4)+7)/8);
        (10) IF MF = 0 THEN TDL <- TL-(IHL*4)+(FO*8)
        (11) IF FO = 0 THEN put header in header buffer
        (12) IF TDL # 0
        (13)          AND all RCVBT bits from 0 to (TDL+7)/8 are set
        (14) THEN TL <- TDL+(IHL*4)
        (15) Submit datagram to next step;
        (16) free all reassembly resources for this BUFID; DONE.
        (17) TIMER <- MAX(TIMER,TTL);
        (18) give up until next fragment or timer expires;
        (19) timer expires: flush all reassembly with this BUFID; DONE.
 
In the case that two or more fragments contain the same data either 
identically or through a partial overlap, this procedure will use the 
more recently arrived copy in the data buffer and datagram delivered. 

3.3.7.  Identification
 
The choice of the Identifier for a datagram is based on the need to 
provide a way to uniquely identify the fragments of a particular 
datagram. The protocol module assembling fragments judges fragments to 
belong to the same datagram if they have the same source (or pair), 
destination (or pair), protocol, and Identifier. Thus, the sender must 
choose the Identifier to be unique for these source (or pair), 
destination (or pair) and protocol for the time the datagram (or any 
fragment of it) could be alive in the internet. 
It seems then that a sending Internet module needs to keep a table of 
Identifiers, one entry for each destination it has communicated with 
in the last maximum packet lifetime for the internet. However, since 
the Identifier field allows 65,536 different values, some host may be 
able to simply use unique identifiers independent of destination. 
It is appropriate for some higher level protocols to choose the 
identifier. For example, TCP protocol modules may retransmit an 
identical TCP segment, and the probability for correct reception would 
be enhanced if the retransmission carried the same identifier as the 
original transmission since fragments of either datagram could be used 
to construct a correct TCP segment.
 
3.3.8.  Type of Service 

The type of service (TOS) is for internet service quality selection. 
The type of service is specified along the abstract parameters 
precedence, delay, throughput, and reliability. These abstract 

Expires March 2003                                          [Page 30]
Draft           Revised Internet Protocol              September 2002

parameters are to be mapped into the actual service parameters of the 
particular networks the datagram traverses. 
Precedence. An independent measure of the importance of this datagram. 
Delay. Prompt delivery is important for datagram with this indication. 
Throughput. High data rate is important for datagram with this 
indication. 
Reliability. A higher level of effort to ensure delivery is important 
for datagram with this indication. 
For example, the ARPANET has a priority bit, and a choice between 
"standard" messages (type 0) and "uncontrolled" messages (type 3), 
(the choice between single packet and multipacket messages can also be 
considered a service parameter). The uncontrolled messages tend to be 
less reliably delivered and suffer less delay. Suppose an Internet 
datagram is to be sent through the ARPANET. Let the internet type of 
service be given as: 
      Precedence:    5
      Delay:         0
      Throughput:    1
      Reliability:   1
In this example, the mapping of these parameters to those available 
for the ARPANET would be  to set the ARPANET priority bit on since the 
Internet precedence is in the upper half of its range, to select 
standard messages since the throughput and reliability requirement are 
indicated and delay is not. More details are given on service mappings 
in "Service Mappings" [8].

3.3.9.  Time to Live

The time to live is set by the sender to the maximum time the datagram 
is allowed to be in the internet system. If the datagram is in the
 internet system longer than the time to live, then the datagram must 
be destroyed. This field must be decreased at each point that the 
internet header is processed to reflect the time spent processing the 
datagram. Even if no local information is available on the time 
actually spent, the field must be decremented by 1. The time is 
measured in units of seconds (i.e. the value 1 means one second). Thus, 
the maximum time to live is 255 seconds or 4.25 minutes. Since every 
module that processes a datagram must decrease the TTL by at least 
one even if it process the datagram in less than a second, the TTL 
must be thought of only as an upper bound on the time a datagram may 
exist. The intention is to cause undeliverable datagrams to be 
discarded, and to bound the maximum datagram lifetime. Some higher 
level reliable connection protocols are based on assumptions that old 
duplicate datagrams will not arrive after a certain time elapses. The 
TTL is a way for such protocols to have an assurance that their 
assumption is met.

3.3.10.  Options
 
The options are optional in each datagram, but required in 
implementations. That is, the presence or absence of an option is the 
choice of the sender, but each internet module must be able to parse 
every option. There can be several options present in the option field. 
The options might not end on a 32-bit boundary. The Internet header and 

Expires March 2003                                          [Page 31]
Draft           Revised Internet Protocol              September 2002

the Enhanced Internet header must be filled out with octets of zeros. 
The first of these would be interpreted as the end-of-options option, 
and the remainder as Internet header padding. 
Every Iinternet module must be able to act on every option. The 
attached address option is only required be processed by Grid Boundary 
Gateway. The Security Option is required if classified, restricted, or 
compartmented traffic is to be passed. 

3.3.11.  Checksum 

The internet header checksum is recomputed if the internet 
header is changed. For example, a reduction of the time to live, 
additions or changes to internet options, or due to fragmentation. 
This checksum at the internet level is intended to protect the 
internet header fields from transmission errors. For Internet address 
swapping the IP address data only change their position, so the 
internet header checksum should not be changed.
There are some applications where a few data bit errors are acceptable 
while retransmission delays are not. If the internet protocol enforced 
data correctness such applications could not be supported. 

3.3.12.  Errors 

Internet protocol errors may be reported via the ICMP messages [3].
 
3.4. Interfaces

The functional description of user interfaces to the IP is, at best, 
fictional, since every operating system will have different facilities. 
Consequently, we must warn readers that different IP implementations 
may have different user interfaces. However, all IPs must provide a 
certain minimum set of services to guarantee that all IP 
implementations can support the same protocol hierarchy. This section 
specifies the functional interfaces required of all IP implementations. 
Internet protocol interfaces on one side to the local network and on 
the other side to either a higher level protocol or an application 
program. In the following, the higher level protocol or application 
program (or even a gateway program) will be called the "user" since it 
is using the internet module. Since internet protocol is a datagram 
protocol, there is minimal memory or state maintained between 
datagram transmissions, and each call on the internet protocol 
module by the user supplies all information necessary for the IP to 
perform the service requested. 

3.4.1.  An Example Upper Level Interface 

The following example calls satisfy the requirements for the user 
to TCP protocol module, and TCP protocol module to internet protocol 
module communications ("=>" means returns): 
Calls for the user to TCP protocol module are:
  OPEN (local port, foreign socket, active/passive [, timeout] 
        [, precedence] [, security/compartment] [, options]) ,
        local connection name => result)
  SEND (local connection name, buffer address, byte count, PUSH flag, 

Expires March 2003                                          [Page 32]
Draft           Revised Internet Protocol              September 2002

        URGENT flag [,timeout])
Then the TCP protocol module create a transmission control blockTCB
where the parameters come from OPEN call. In sequence, send call for 
the TCP protocol module to internet protocol module is:
  SEND (srcc, srcu, dsti, dstg, prot, TOS, TTL, BufPTR, len, Id, DF, 
        opt => result) 
where: 
      srcc = current tier source address, nonblank
      srcu = upper tier source address, if there is
      dsth = higher tier destination address, nonblank
      dstl = lower tier destination address, if there is
      prot = protocol
      TOS = type of service
      TTL = time to live
      BufPTR = buffer pointer
      len = length of buffer
      Id  = Identifier
      DF = Don't Fragment
      opt = option data
      result = response
      OK = datagram sent ok
      Error = error in arguments or local network error
Note that the precedence is included in the TOS and the 
security/compartment is passed as an option.
A receive call for the user to TCP protocol module is:
RECEIVE (local connection name, buffer address, => byte count, 
urgent flag, push flag)
In sequence, receive call for the TCP protocol module to internet 
protocol module is:
  RECV (BufPTR, prot, => result, srcc, srcu, dsth, dstl, TOS, len, opt)
     where:
      BufPTR = buffer pointer
      prot = protocol
      result = response
      OK = datagram received ok
      Error = error in arguments
      len = length of buffer
      srcc = current tier source address, nonblank
      srcu = upper tier source address, if there is
      dsth = higher tier destination address, nonblank
      dstl = lower tier destination address, if there is
      TOS = type of service
      opt = option data
When the user sends a datagram, it executes the SEND call supplying all 
the arguments. The internet protocol module, in sequence on receiving 
this call, checks the arguments and prepares and sends the message. If 
the arguments are good and the datagram is accepted by the local 
network, the call returns successfully. If either the arguments are 
bad, or the datagram is not accepted by the local network, the call 
returns unsuccessfully. On unsuccessful returns, a reasonable report 
must be made as to the cause of the problem, but the details of such 
reports are up to individual implementations. 
When a datagram arrives at the internet protocol module from the local 
network, there are three cases: 

Expires March 2003                                          [Page 33]
Draft           Revised Internet Protocol              September 2002

firstly there is a Boundary gateway have received the datagram but there 
is not a high level call, secondly there is a pending RECV call from 
the user addressed, or thirdly there is not a pending RECV call. 
In the first case, If the next tier address does not exist, an ICMP 
error message is returned to the sender, and the data is discarded.
In the second case, the pending call is satisfied by passing the 
information from the datagram to the user. 
In the third case, the user addressed is notified of a pending 
datagram. If the user addressed does not exist, an ICMP error message 
is returned to the sender, and the data is discarded. 
The notification of a user may be via a pseudo interrupt or similar 
mechanism, as appropriate in the particular operating system 
environment of the implementation. 
A user's RECV call may then either be immediately satisfied by a 
pending datagram, or the call may be pending until a datagram arrives. 
The source address is included in the send call in case the sending 
host has several addresses (multi-tier addresses or multiple physical 
connections or logical addresses). The internet module must check to 
see that the source address is one or two of the legal address for this 
host. 
An implementation may also allow or require a call to the internet 
module to indicate interest in or reserve exclusive use of a class of 
datagrams (e.g., all those with a certain value in the protocol field). 
This section functionally characterizes a USER/IP interface. The 
notation used is similar to most procedure of function calls in high 
level languages, but this usage is not meant to rule out trap type 
service calls (e.g., SVCs, UUOs, EMTs), or any other form of 
inter-process communication. 

4. APPENDIX 

4.1. APPENDIX A: Examples & Scenarios

4.1.1.  Example 1:

This is an example of the internet datagram carrying attached Internet 
Source Address: 
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver= 4 |IHL= 7 |Type of Service|-------Total Length = 30-------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Identification = 111       |Flg=0|  Fragment Offset = 0  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---Time = 123--|-Protocol = 1--|--------header checksum--------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-----------------current tier source address-------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-----------------------destination address---------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---AAOH = 161--|--AAOL = 12 ---|-------------- 0 --------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-------------------- Attached Source Address ------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Expires March 2003                                          [Page 34]
Draft           Revised Internet Protocol              September 2002

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------ 0 ------------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             data              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                        Example Internet Datagram
                               Figure 7.
   Note that each tick mark represents one bit position.
This is an internet datagram in version 4 of Enhanced Internet 
Protocol; the internet header consists of seven 32 bit words, and the 
total length of the datagram is 30 octets. This datagram is a complete 
datagram (not a fragment).

4.1.2.  Example 2:

In this example, we show first a moderate size internet datagram (452 
data octets), then two internet fragments that might result from the 
fragmentation of this datagram if the maximum sized transmission 
allowed were 280 octets. 
    0                 1                 2                 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver= 4 |IHL= 5 |Type of Service|------Total Length = 472-------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-----Identification = 111------|Flg=0|-----Fragment Offset = 0-|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--Time = 123---|--Protocol = 6-|-------header checksum---------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------source address-------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----------------------destination address----------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------data-----------------------------|
   \------------------------------data-----------------------------\
   |------------------------------data-----------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---------data------------------|                                
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                                
                       Example Internet Datagram
                                Figure 8.
Now the first fragment that results from splitting the datagram after
256 data octets.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver= 4 |IHL= 5 |Type of Service|------Total Length = 276-------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----Identification = 111-------|Flg=1|---Fragment Offset = 0---|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--Time = 119---| Protocol = 6  |------- Header Checksum -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------ source address -----------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Expires March 2003                                          [Page 35]
Draft           Revised Internet Protocol              September 2002

  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--------------------- destination address ---------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------ data ---------------------------|
   \------------------------------ data ---------------------------\
   |------------------------------ data ---------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------ data ---------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                        Example Internet Fragment

                                   Figure 9.

  And the second fragment. 

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver= 4 |IHL= 5 |Type of Service|----- Total Length = 216 ------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----- Identification = 111 ----|Flg=0|- Fragment Offset = 32 --|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-- Time = 119 -|- Protocol = 6 |------- Header Checksum -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------ source address -----------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |--------------------- destination address ---------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------ data ---------------------------|
   \------------------------------ data ---------------------------\
   |------------------------------ data ---------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------ data -------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 
                       Example Internet Fragment
 
                                    Figure 10.

4.1.3.  Example 3:

Here, we show an example of a datagram containing attached address 
options, which has been send by a Host in Grid-net A, and now is 
transmitted throughout Internet, and will send to a destination 
in Grid-net B: 

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Ver= 4|IHL= 8 |Type of Service|----- Total Length = 576 ------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----- Identification = 111-----|Flg=0|-- Fragment Offset = 0 --|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Expires March 2003                                          [Page 36]
Draft           Revised Internet Protocol              September 2002

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |-- Time = 100 -|- Protocol = 6 |------- Header Checksum -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----------------- current tier source address -----------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |---------------  destination Internet address -----------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |AAO Header =166|-Opt.Len = 12--|              0                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 attached Internet source address              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                attached Grid-net B destination address        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |------------------------------ data ---------------------------|
   \------------------------------ data ---------------------------\
   |------------------------------ data ---------------------------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                      Example Internet Datagram
                                Figure 11

4.2. APPENDIX B: Data Transmission Order

The order of transmission of the header and data described in this 
document is resolved to the octet level. For example, in the 
following diagram the octets are transmitted in the order they are 
numbered.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----- 1 -------|----- 2 -------|----- 3 -------|----- 4 -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----- 5 -------|----- 6 -------|----- 7 -------|----- 8 -------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |----- 9 -------|----- 10 ------|----- 11 ------|----- 12 ------|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 
                      Transmission Order of Bytes
                                Figure 12.

Whenever an octet represents a numeric quantity the left most bit in 
the diagram is the high order or most significant bit. That is, the bit 
labeled 0 is the most significant bit. For example, the following 
diagram represents the value 170 (decimal).

 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+
|1 0 1 0 1 0 1 0|
+-+-+-+-+-+-+-+-+
 
 Significance of Bits
     Figure 13.
 

Expires March 2003                                          [Page 37]
Draft           Revised Internet Protocol              September 2002

Similarly, whenever a multi-octet field represents a numeric quantity 
the left most bit of the whole field is the most significant bit. 
When a multi-octet quantity is transmitted the most significant octet 
is transmitted first.

5. GLOSSARY 

Destination
The destination address, an internet header field. 
DF
The Don't Fragment bit carried in the flags field. 
Flags
An internet header field carrying various control flags. 
Fragment Offset
This internet header field indicates where in the internet datagram a 
fragment belongs. 
GGP
Gateway to Gateway Protocol, the protocol used primarily between 
gateways to control routing and other gateway functions. 
header
Control information at the beginning of a message, segment, datagram, 
packet or block of data. 
ICMP
Internet Control Message Protocol, implemented in the internet module, 
the ICMP is used from gateways to hosts and between hosts to report 
errors and make routing suggestions. 
Identification
An internet header field carrying the identifying value assigned by the 
sender to aid in assembling the fragments of a datagram. 
IHL
The internet header field Internet Header Length is the length of the 
internet header measured in 32 bit words. 
IMP
The Interface Message Processor, the packet switch of the ARPANET. 
Internet Address
A four octet (32 bit) or eight octet (64 bit) source or destination 
address consisting of a Network address field and a attached tier 
Address option field. 
internet datagram
The unit of data exchanged between a pair of internet modules 
(includes the internet header). 
internet fragment
A portion of the data of an internet datagram with an internet header. 
Local Address
The address of a host within a network. The actual mapping of an 
internet local address on to the host addresses in a network is quite 
general, allowing for many to one mappings. 
MF
The More-Fragments Flag carried in the internet header flags field. 
module
An implementation, usually in software, of a protocol or other 
procedure. 



Expires March 2003                                          [Page 38]
Draft           Revised Internet Protocol              September 2002

more-fragments flag
A flag indicating whether or not this internet datagram contains the 
end of an internet datagram, carried in the internet header Flags
field. 
NFB
The Number of Fragment Blocks in a the data portion of an internet 
fragment. That is, the length of a portion of data measured in 8 octet 
units. 
octet
An eight bit byte. 
Options
The internet header Options field may contain several options, and 
each option may be several octets in length. 
Padding
The internet header Padding field is used to ensure that the data 
begins on 32 bit word boundary. The padding is zero. 
Protocol
In this document, the next higher level protocol identifier, 
an internet header field. 
Rest
The local address portion of an Internet Address. 
Source
The source address, an internet header field. 
TCP
Transmission Control Protocol: A host-to-host protocol for reliable 
communication in internet environments. 
TCP Segment
The unit of data exchanged between TCP modules 
(including the TCP header). 
TFTP
Trivial File Transfer Protocol: A simple file transfer protocol 
built on UDP. 
Time to Live
An internet header field which indicates the upper bound on how long 
this internet datagram may exist. 
TOS
Type of Service 
Total Length
The internet header field Total Length is the length of the datagram in 
octets including internet header and data. 
TTL
Time to Live 
Type of Service
An internet header field which indicates the type (or quality) 
of service for this internet datagram. 
UDP
User Datagram Protocol: A user level protocol for transaction oriented 
applications. 
User
The user of the internet protocol. This may be a higher level protocol 
module, an application program, or a gateway program. 
Version
The Version field indicates the format of the internet header.


Expires March 2003                                          [Page 39]
Draft           Revised Internet Protocol              September 2002

6. REFERENCES 

 [1] Cerf, V., "The Catenet Model for Internetworking," Information 
Processing Techniques Office, Defense Advanced Research Projects
Agency, IEN 48, July 1978. 
 [2] Bolt Beranek and Newman, "Specification for the Interconnection of 
a Host and an IMP," BBN Technical Report 1822, Revised May 1978. 
 [3] Postel, J., "Internet Control Message Protocol - DARPA Internet 
Program Protocol Specification," RFC 792, USC/Information Sciences 
Institute, September 1981. 
 [4] Shoch, J., "Inter-Network Naming, Addressing, and Routing," 
COMPCON, IEEE Computer Society, Fall 1978. 
 [5] Postel, J., "Address Mappings," RFC 796, USC/Information Sciences 
Institute, September 1981. 
 [6] Shoch, J., "Packet Fragmentation in Inter-Network Protocols," 
Computer Networks, v. 3, n. 1, February 1979. 
 [7] Strazisar, V., "How to Build a Gateway", IEN 109, Bolt Beranek and 
Newman, August 1979. 
 [8] Postel, J., "Service Mappings," RFC 795, USC/Information Sciences 
Institute, September 1981. 
 [9] Postel, J., "Assigned Numbers," RFC 790, USC/Information Sciences 
Institute, September 1981. 
 [10] Kent, S., and R. Atkinson, "Security Architecture for the 
Internet Protocol", RFC 2401, November 1998.
 [11] Kent, S., and R. Atkinson, "IP Encapsulating Security Payload 
(ESP)", RFC 2406, November 1998.

7.  Authors' Addresses

   Yunqing Zeng
   Internet Department
   MCM/Shenzhen Modern Computer Manufacture Limited Corp.
   4 South Avenue
   High-tech Park, Shezhen 518057

   Phone: +86 755-6616888-6111
   Fax:   +86 755-6635988
   Email: zengyq@mcm.com.cn

















Expires March 2003                                          [Page 40]

