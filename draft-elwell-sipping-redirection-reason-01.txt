Internet Engineering Task Force                              J. Elwell 
Internet Draft                                                 Siemens 
                                                             R. Jesske 
                                                      Deutsche Telekom 
                                                           J. McMillen 
                                                            Avaya Inc. 
draft-elwell-sipping-redirection-reason-01.txt                         
Expires: April 2005                                       October 2004 
 
                                      
      SIP Reason header extension for indicating redirection reasons 
    
Status of this Memo  
    
   By submitting this Internet-Draft, I certify that any applicable 
   patent or other IPR claims of which I am aware have been disclosed, 
   or will be disclosed, and any of which I become aware will be 
   disclosed, in accordance with RFC 3668. 
    
   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups. Note that other 
   groups may also distribute working documents as Internet-Drafts. 
    
   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time. It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress. "  
    
   The list of current Internet-Drafts can be accessed at  
        http://www.ietf.org/ietf/1id-abstracts.txt  
   The list of Internet-Draft Shadow Directories can be accessed at  
        http://www.ietf.org/shadow.html.  
    
Copyright Notice 
    
      Copyright (C) The Internet Society (2004). All Rights Reserved. 
    
Abstract  
    
   This examines the need for signalling additional information 
   concerning the reason for redirection in SIP and proposes an 
   extension to the Reason header. 
    







 
 
Elwell                   Expires - April 2005                 [Page 1] 
                Indicating redirection reasons in SIP    October 2004 
 
 
    
Table of Contents 
    
   1 Introduction....................................................3 
   2 Overview of proposed solution...................................4 
   3 Extension to the Reason header..................................4 
   4 Examples........................................................5 
   4.1 Redirection with reason "Forward Immediate"...................5 
   4.2 Call Forwarding Unconditional.................................7 
   5 IANA considerations.............................................9 
   6 Security Considerations.........................................9 
   7 Author's Addresses..............................................9 
   8 Normative References...........................................10 
    




































 
 
Elwell                   Expires - April 2005                 [Page 2] 
                Indicating redirection reasons in SIP    October 2004 
 
 
    
1 Introduction 
    
   Central to SIP [2] is the concept of redirecting or retargeting a 
   request by a proxy, whereby the Request-URI in the original request 
   is replaced before forwarding the request on the next hop. Sometimes 
   this is due to normal rerouting behaviour of the proxy (e.g., 
   resolving an address-of-record URI to a contact URI). At other times 
   it is due to more application-related reasons, e.g., where a user has 
   made arrangements for calls to that user under certain conditions to 
   be forwarded to a different destination. Also retargeting can be 
   performed as a result of a 3xx response from a redirect server. 
   Different 3xx response codes reflect different reasons for rejecting 
   the request. A 3xx response can be accompanied by a Reason header [1] 
   giving more information. 
    
   The History-Info header [3] provides a means for conveying 
   information about a retarget to the final destination UAS and also 
   back to the UAC. In addition to providing the retargeted-from and 
   retargeted-to URIs for each recorded retarget, this header also 
   conveys a reason by means of the Reason header. The Reason header 
   accompanies the retargeted-from URI and reflects the reason why 
   attempts to reach that target failed, normally in the form of the SIP 
   response code concerned. 
    
   However, there is nothing in either a 3xx response or the History-
   Info header, including the Reason header, to indicate an explicit 
   reason for the redirection request or the retarget respectively. At 
   present the reason is implicit in the reason for failure of the 
   request to the original target. Sometimes this might give an accurate 
   picture of what is happening, but not always. Consider the following 
   cases: 
    
     1. A device acts as a redirect server because it is busy. None of 
     the 3xx response codes can reflect that the reason for retargeting 
     to the URI given in the Contact header of the 3xx response is 
     because the existing target is busy. 
      
     2. A device acts as a redirect server because it alerts the user 
     but fails to get a reply within a certain time. None of the 3xx 
     response codes can reflect that the reason for retargeting to the 
     URI given in the Contact header of the 3xx response is because the 
     existing target failed to answer. 
      
     3. A proxy is scripted to retarget requests without first 
     attempting to forward them to the original target. Retargeting may 
     be unconditional or based on certain conditions such as date, time, 
     the source of the request or caller preferences. Because it does 


 
 
Elwell                   Expires - April 2005                 [Page 3] 
                Indicating redirection reasons in SIP    October 2004 
 
 
     this without forwarding the request to the original target, no SIP 
     response code is applicable. 
      
     4. A proxy is scripted to perform hunting or distribution of calls 
     among a number of different targets. When forwarding a request to a 
     target selected from a list of candidate targets, the reason for 
     retargeting is because of hunting or distribution, rather than 
     because of any failure of the existing target. 
      
     5. In the hunting or distribution scenario above, forwarding a 
     request to one target from the list of candidate targets may fail 
     for a particular reason (e.g., busy), leading to selection of 
     another target from the list. However, the reason for retargeting 
     is because of hunting or distribution, not specifically because the 
     previous target had a certain condition. 
    
   With these considerations in mind, there is a need to provide a 
   solution for conveying a more precise reason for redirection in a 3xx 
   response or a History-Info header. 
    
   In addition, in some circumstances a proxy can generate a 181 "Call 
   Is Being Forwarded" response. In this case no History-Info header 
   would be included, since the response does not come from a UAS. At 
   present a 181 response does not convey a precise reason for 
   forwarding. Provision of a reason for forwarding might be of use to 
   the UAC, which otherwise would need to wait for a later response 
   containing a History-Info header. 
    
2 Overview of proposed solution 
    
   The proposed solution is to enhance the Reason header with new 
   values. This can be done by defining a new "protocol" value and then 
   defining specific new reason values under the umbrella of the new 
   "protocol" value. 
    
   Candidate reasons include forward unavailable, forward busy, forward 
   no reply, forward immediate, deflection, hunting, mobile not 
   reachable. 
    
   Note that selection of the new target may depend on several other 
   conditions (e.g., relating to date, time, the source of the request 
   or caller preferences), but the reasons suggested above should be 
   sufficient to convey the main circumstance leading to the retarget. 
    
3 Extension to the Reason header 
    
   This document defines the following new protocol value for the 
   protocol field of the Reason header field in [1]: 
    
 
 
Elwell                   Expires - April 2005                 [Page 4] 
                Indicating redirection reasons in SIP    October 2004 
 
 
     Redirection: The cause parameter contains a reason for redirection 
     of a request. 
    
   This document defines the following redirection cause codes: 
    
     Value  Default Text           Description 
      
     1      Normal redirection     The call has been retargeted for 
                                   normal routing reasons 
      
     2      Forward unavailable    The call has been retargeted 
                                   because the called user is 
                                   unavailable (no registered contact). 
      
     3      Forward busy           The call has been retargeted 
                                   because the called user is busy. 
      
     4      Forward no reply       The call has been retargeted 
                                   because the called user has been 
                                   alerted but has failed to reply. 
      
     5      Forward immediate      The call has been retargeted 
                                   immediately without determining 
                                   whether the called user is 
                                   unavailable or busy and without 
                                   alerting the user. 
      
     6      Deflection             The call has been retargeted as a 
                                   result of a request by the called 
                                   user in response to alerting. 
      
     7      Hunting                The call has been retargeted to an 
                                   individual member of the hunt group 
                                   at which it was previously targeted. 
      
     8      Mobile not reachable   The call has been retargeted 
                                   because the called mobile user is 
                                   not reachable 
      
   Example syntax is as follows: 
    
     Reason: redirection;cause=3 ;text="Forward busy" 
    
4 Examples 
    
4.1 Redirection with reason "Forward Immediate" 
    
           Alice            Proxy           Bob              Carol 
             |                |              |                   | 
 
 
Elwell                   Expires - April 2005                 [Page 5] 
                Indicating redirection reasons in SIP    October 2004 
 
 
             |    INVITE F1   |              |                   | 
             |--------------->|   INVITE F2  |                   | 
             |                |------------->|                   | 
             |(100 Trying) F3 |              |                   | 
             |<---------------|  302 Moved Temporarily F4        | 
             |                |<-------------|                   | 
             |                |     ACK F5   |                   | 
             |                |------------->|                   | 
             |                |              |    INVITE F6      | 
             |                |--------------------------------->| 
             |                |              | 180 Ringing F7    | 
             |                |<---------------------------------| 
             | 180 Ringing F8 |              |                   | 
             |<---------------|              |      200 OK F9    | 
             |                |<---------------------------------| 
             |    200 OK F10  |              |                   | 
             |<---------------|              |                   | 
             |     ACK F11    |              |                   | 
             |--------------->|              |     ACK F12       | 
             |                |--------------------------------->| 
    
   Assuming the entity sending the INVITE supports the History-Info 
   header, the INVITE would look like this: 
    
   F1 (INVITE) Alice -> Proxy 
      
     INVITE  sip:Bob@example.com; SIP/2.0 
     From: <sip:Alice@example.com>;tag=2 
     To: <sip:Bob@example.com > 
     Call-ID: 12345600@example.com 
     CSeq: 1 INVITE 
     History-Info: <sip:Bob@example.com>;index=1 
     ... 
    
   The call is then redirected to a contact URI <sip:carol@example.com> 
   in a 302 response. The response would be as follows: 
    
   F3 (302 Moved Temporarily) Bob -> Proxy 
      
     SIP/2.0 302 Moved temporarily 
     From: <sip:Alice @example.com>;tag=2 
     To: <sip:Bob@example.com>;tag=3 
     Call-ID: 12345600@example.com 
     CSeq: 1 INVITE 
     Contact: <sip:Carol@example.com> 
     Reason: Redirection;cause=5;text="Forward immediate" 
      
    


 
 
Elwell                   Expires - April 2005                 [Page 6] 
                Indicating redirection reasons in SIP    October 2004 
 
 
   The call would be retargeted to the contact URI. The first History-
   Info header would be augmented with the two reasons for retargeting 
   (SIP 302 and redirection 5)). A second History-Info header would be 
   added with the new retargeted-to Request-URI: 
    
   F6 (INVITE) ¡ Proxy -> Carol 
      
     INVITE  sip:Carol@example.com SIP/2.0 
     From: <sip:Alice@example.com>;tag=2 
     To: <sip:Bob@example.com> 
     Call-ID: 12345600@example.com 
     CSeq: 1 INVITE 
     History-Info: <sip:Bob@example.com?Reason: SIP;cause=302; 
     text="Moved temporarily"?Reason: Redirection; cause=5;text="Forward 
     immediate">;index=1, <sip:Carol@example.com>;index=2 
    
   The "index 1" entry indicates that the call to Bob was retargeted 
   because of SIP response code 302 and redirection reason CFI. 
    
   The "index 2" entry indicates that the call to Carol has not yet been 
   further retargeted. 
    
4.2 Call Forwarding Unconditional 
    
   This example is taken from [4], augmented to show the use of History-
   Info and Reason headers. 
    
            Alice           Proxy          Gateway 
             |                |              | 
             |    INVITE F1   |              | 
             |--------------->|              | 
             |(100 Trying) F2 |              | 
             |<---------------|              | 
             | (181 Call Is Being Forwarded) F3 
             |<---------------|   INVITE F4  | 
             |                |------------->| 
             |                |180 Ringing F5| 
             | 180 Ringing F6 |<-------------| 
             |<---------------|  200 OK F7   | 
             |    200 OK F8   |<-------------| 
             |<---------------|              | 
             |     ACK F9     |              | 
             |--------------->|    ACK F10   | 
             |                |------------->| 
             |    Both way RTP Established   | 
             |<=============================>| 
             |     BYE F11    |              | 
             |--------------->|   BYE F12    | 
             |                |------------->| 
 
 
Elwell                   Expires - April 2005                 [Page 7] 
                Indicating redirection reasons in SIP    October 2004 
 
 
             |                |   200 OK F13 | 
             |    200 OK F14  |<-------------| 
             |<---------------|              | 
             |                |              | 
    
   Bob wants all calls forwarded to a destination in the PSTN (which is 
   just another URI to the proxy server). Alice calls Bob. The proxy 
   server rewrites the Request URI, and forwards the INVITE to a 
   Gateway.  Details of messaging behind the Gateway are not shown. 
    
   Message Details 
    
     F3 (181 Call is Being Forwarded) Proxy -> Alice 
      
     SIP/2.0 181 Call is Being Forwarded 
     Via: SIP/2.0/TLS 
     client.atlanta.example.com:5061;branch=z9hG4bK74bf9 
     ;received=192.0.2.103 
     From: Alice <sips:alice@atlanta.example.com>;tag=1234567 
     To: Bob <sips:bob@biloxi.example.com> 
     Call-ID: 12345600@atlanta.example.com 
     CSeq: 1 INVITE 
     Content-Length: 0 
     Reason: Redirection;cause=5;text="Forward immediate" 
      
     F4 INVITE Proxy -> Gateway 
      
     INVITE sips:+19727293660@gw1.example.com;user=phone SIP/2.0 
     Via: SIP/2.0/TLS ss1.example.com:5061;branch=z9hG4bK83749.1 
     Via: SIP/2.0/TLS 
     client.atlanta.example.com:5061;branch=z9hG4bK74bf9 
     ;received=192.0.2.103 
     Record-Route: <sips:ss1.example.com;lr> 
     Max-Forwards: 69 
     From: Alice <sips:alice@atlanta.example.com>;tag=1234567 
     To: Bob <sips:bob@biloxi.example.com> 
     Call-ID: 12345600@atlanta.example.com 
     CSeq: 1 INVITE 
     Contact: <sips:alice@client.atlanta.example.com> 
     History-Info: <sips:bob@biloxi.example.com?Reason: Redirection;  
     cause=5;text="Forward immediate">;index=1, 
     <sips:+19727293660@gw1.example.com;user=phone>;index=2 
     Content-Type: application/sdp 
     Content-Length: ... 
      
     v=0 
     o=alice 2890844526 2890844526 IN IP4 client.atlanta.example.com 
     s=Session SDP 
     c=IN IP4 client.atlanta.example.com 
 
 
Elwell                   Expires - April 2005                 [Page 8] 
                Indicating redirection reasons in SIP    October 2004 
 
 
     t=3034423619 0 
     m=audio 49170 RTP/AVP 0 
     a=rtpmap:0 PCMU/8000 
    
5 IANA considerations 
    
   This document defines one new value for the SIP Reason header [1] 
   protocol namespace. The new value is "Redirection" and indicates the 
   use of cause value defined in this document. 
    
   This document also creates an IANA registry for cause values that 
   populate the cause field of the Reason header when protocol value 
   "Redirection" is used and corresponding default values that populate 
   the text field. The current cause and text values in this new 
   registry are as follows: 
    
     Cause value  Default text value   Reference 
     -----------  ------------------------------ 
     1            Normal redirection   This document 
     2            Forward unavailable  This document 
     3            Forward busy         This document 
     4            Forward no reply     This document 
     5            Forward immediate    This document 
     6            Deflection           This document 
     7            Hunting              This document 
     8            Mobile not reachable This document 
    
   New values for this registry can only be defined by means of a 
   published standard. 
    
6 Security Considerations 
    
   The security considerations of [1] apply. When the Reason header 
   field is embedded within a History-Info header field, the security 
   considerations of [3] apply. 
    
   Unauthorised insertion, deletion of modification of the Reason header 
   field can provide misleading information to users and applications. 
   Eavesdropping on this header field can reveal information about a 
   user. Securing of SIP connections by TLS can combat this problem. 
    
   A SIP entity that can provide a redirection reason in a Reason header 
   field SHOULD be able to suppress this in accordance with privacy 
   requirements of the user concerned. 
    
7 Author's Addresses 
    
   John Elwell 
   Siemens Communications 
 
 
Elwell                   Expires - April 2005                 [Page 9] 
                Indicating redirection reasons in SIP    October 2004 
 
 
   Technology Drive 
   Beeston 
   Nottingham, UK, NG9 1LA 
   email: john.elwell@siemens.com 
    
   Roland Jesske 
   Deutsch Telekom 
   Am Kavalleriesand 3 
   Germany-64295 Darmstadt 
   email: r.jesske@t-com.net 
    
   Joanne McMillen 
   Avaya Inc. 
   1300 W. 120th Ave. 
   Westminster, CO 80234-2726 
   email: joanne@avaya.com 
    
8 Normative References 
    
   [1] H. Schulzrinne, D. Oran, G. Camarillo, "The Reason Header for the 
   Session Initiation Protocol (SIP)", RFC 3326. 
    
   [2] J. Rosenberg, H. Schulzrinne, et al., "SIP: Session initiation 
   protocol", RFC 3261. 
    
   [3] M. Barnes, "An Extension to the Session Initiation Protocol for 
   Request History Information", draft-ietf-sipping-history-info-03 
   (work in progress). 
    
   [4] A. Johnston et alia, "Session Initiation Protocol Service 
   Examples", draft-ietf-sipping-service-examples-07 (work in progress). 
    
Intellectual Property Statement 
    
   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights. Information 
   on the IETF's procedures with respect to rights in IETF Documents can 
   be found in BCP 78 and BCP 79. 
    
   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 
 
 
Elwell                   Expires - April 2005                [Page 10] 
                Indicating redirection reasons in SIP    October 2004 
 
 
    
   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard. Please address the information to the IETF at ietf-
   ipr@ietf.org. 
    
Disclaimer of Validity 
    
   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET 
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, 
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
    
Copyright Statement 
    
   Copyright (C) The Internet Society (2004). This document is subject 
   to the rights, licenses and restrictions contained in BCP 78, and 
   except as set forth therein, the authors retain all their rights. 
    
Acknowledgement 
    
   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 
    






















 
 
Elwell                   Expires - April 2005                [Page 11] 