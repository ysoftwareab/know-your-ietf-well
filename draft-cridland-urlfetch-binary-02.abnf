section=1.2;urlauth=anonymous:internal:
section=1.2;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.3;urlauth=anonymous:internal:
section=1.4;urlauth=anonymous:internal:
section=1.4;urlauth=anonymous:internal:
section=200;urlauth=anonymous:internal:
section=200;urlauth=anonymous:internal:
capability       =/ "URLAUTH=BINARY"

      ; Command parameters; see Section 3.1

urlfetch         =  "URLFETCH" 1*(SP url-fetch-arg)

url-fetch-arg    =  url-fetch-simple / url-fetch-ext

url-fetch-simple =  url-full
      ; Unextended URLFETCH.

url-fetch-ext    =  "(" url-full *(SP url-fetch-param) ")"
      ; If no url-fetch-param present, as unextended.

url-fetch-param  =  "BODY" / "BINARY" / "BODYPARTSTRUCTURE" / atom
      ; TODO: Should this be iana-token?

      ; Response; see Section 3.2

urlfetch-data    =  "*" SP "URLFETCH"
                       1*(SP (urldata-simple / urldata-ext /
                              urldata-error))

urldata-error    =  SP url-full SP nil

urldata-simple   =  SP url-full SP nstring
      ; If client issues url-fetch-simple, server MUST respond with
      ; urldata-simple.

urldata-ext      =  SP url-full url-metadata

url-metadata     =  1*(SP "(" url-metadata-el ")")

url-metadata-el  =  url-meta-bodystruct / url-meta-body /
                       url-meta-binary

url-bodystruct   =  "BODYPARTSTRUCTURE" SP body

url-binary       =  "BINARY" SP ( nstring / literal8 )
      ; If content contains a NUL octet, literal8 MUST be used.
      ; Otherwise, content SHOULD use nstring.
      ; On decoding error NIL should be used.
url-body         =  "BODY" SP nstring



