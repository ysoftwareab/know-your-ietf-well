


BEHAVE Working Group                                             D. Wing
Internet-Draft                                                     Cisco
Intended status:  Informational                         October 23, 2008
Expires:  April 26, 2009


          Learning the Address Family Translator's IPv6 Prefix
                   draft-wing-behave-learn-prefix-00

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 26, 2009.

Abstract

   In some IPv6/IPv4 translation scenarios it is necessary for an IPv6
   host to know the IPv6 prefix used by its address family translator.
   In some of the IPv6/IPv4 translation proposals, the prefix is not
   fixed; that is, the prefix is chosen by the network operator.  This
   specification provides several methods to learn the prefix and its
   length.









Wing                     Expires April 26, 2009                 [Page 1]

Internet-Draft          Learning the AFT's Prefix           October 2008


Table of Contents

   1.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  Learning IPv6 Prefix and Length . . . . . . . . . . . . . . . . 3
     3.1.  Using DNS to Learn IPv6 Prefix and Length . . . . . . . . . 3
     3.2.  Using DHCP to Learn IPv6 Prefix and Length  . . . . . . . . 4
   4.  Security Considerations . . . . . . . . . . . . . . . . . . . . 5
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 6
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . 6
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 6
     7.1.  Normative References  . . . . . . . . . . . . . . . . . . . 6
     7.2.  Informative References  . . . . . . . . . . . . . . . . . . 6
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 6
   Intellectual Property and Copyright Statements  . . . . . . . . . . 8




































Wing                     Expires April 26, 2009                 [Page 2]

Internet-Draft          Learning the AFT's Prefix           October 2008


1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   AFT:  Address Family Translator.  A device that translates between IP
   address families.

   DNS64:  The function of synthesizing an AAAA response from an A
   record.


2.  Introduction

   Several variations of Address Family Translators (AFT) have been
   proposed for IPv6/IPv6 coexistence.  All of these operate by
   synthesizing DNS AAAA responses for hosts that do not have AAAA
   records -- this is generally called "DNS64" (also "DNS rewriting" or
   "DNS-ALG").  The DNS64 function, when used in conjunction with an
   AFT, allows a IPv6-only host to access IPv4-only hosts.  This access,
   for the most part, is transparent to the IPv6 host -- to much the
   same degree that today's widely-deployed NATs are transparent to IPv4
   hosts.  But, like with today's NATs, there are applications which do
   not work with AFT or do not work with DNS64, and require IPv6 hosts
   to implement additional functionality.

   So far, one application has been identified which requires an IPv6
   host to know the IPv6 prefix used by its address family translator
   (AFT):  A DNSSEC security-aware stub resolver needs to securly obtain
   the IPv6 prefix.  It uses this prefix to generate its own synthesized
   AAAA response from the un-translated A record [Sullivan-email], or to
   validate a synthesized AAAA response by removing the IPv6 prefix
   [Wing-email].


3.  Learning IPv6 Prefix and Length

   Both the IPv6 prefix and the prefix length need to be learned This
   can be done using DNS or DHCP, as described in the following
   sections.

3.1.  Using DNS to Learn IPv6 Prefix and Length

   In order for an IPv6 host to determine if a NAT64 is present on its
   network, it sends a DNS query.  Because a host doesn't always know
   its network's default domain name, the procedure described below
   provides a way for the host to learn it in order to authorize that



Wing                     Expires April 26, 2009                 [Page 3]

Internet-Draft          Learning the AFT's Prefix           October 2008


   network's address family translator:

   1.  Send a DNS AAAA query for "_aft_prefix", without a domain name.
       If this does not return an IPv6 address it means a address family
       translator is not present and processing MUST stop.

   2.  If validation of the returned IPv6 prefix is necessary, then:

       a.  Send a DNS PTR query for that IPv6 address.  This returns a
           fully-qualified hostname.

       b.  Verify the full-qualified hostname is on the host's
           configured list of authorized translators.

       c.  Send a DNS AAAA query for that hostname.

       d.  Verify the AAAA response matches the IPv6 address obtained in
           step 1.

       e.  Perform DNSSEC validation of the AAAA response.

       f.  Send a DNS TXT query for the fully-qualfied name to learn the
           number of bits of the prefix (e.g., a 48 bit prefix would
           return the string "48").

       g.  Perform DNSSEC validation of the TXT response.

   3.  If validation of this information is not necessary, then:

       a.  Send a DNS TXT query for "_aft_prefix", without the domain
           name, to learn the number of bits of the prefix.

      Note:  The DNS server being queried is the DNS64.  The DNS64
      performs the AAAA synthesis function, which means the DNS64 is
      already aware of the prefix of the address family translator and
      the prefix length.  Thus, is it already capable of returning
      information about the network's AFT.

      Discussion:  without a domain name, it is unavoidable that root
      nameservers will see this query.  Need to think about ways to
      reduce the effect of those queries (e.g., make them authoritative
      and return all 0's which will get cached).

3.2.  Using DHCP to Learn IPv6 Prefix and Length

   A new DHCP option, OPTION_AFT_PREFIX, is defined.  It contains the
   IPv6 prefix and its length.




Wing                     Expires April 26, 2009                 [Page 4]

Internet-Draft          Learning the AFT's Prefix           October 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       OPTION_AFT_PREFIX       |         option-length         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | prefix-length |                                               |
     +-+-+-+-+-+-+-+-+          IPv6 prefix                          |
     |                        (up to 16 octets)                      |
     |                                                               |
     |                                                               |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+

         option-code:      OPTION_AFT_PREFIX (TBD)

         option-length:    17

         prefix-length:    Length for this prefix in bits

         IPv6-prefix:      An IPv6 prefix

                        Figure 1: OPTION_AFT_PREFIX

   In order to conserve space, it is RECOMMENDED that only the
   significant bits of the IPv6 prefix be sent in the DHCP option.

   If the host implements a security-aware DNSSEC validator, it must
   validate and authorize that translator.  To do this, it issues a
   ipv6.arpa PTR query on the IPv6 address learned via DHCPv6.  This
   returns a name.  The host then issues a AAAA query using that name,
   and DNSSEC validates the response.  If the query validates, and the
   AAAA response contains an IPv6 address that matches the AFT-PREFIX
   learned from DHCPv6, and the host's administrator has authorized use
   of that AFT translator name, DNSSEC can use that prefix.  Details of
   DNSSEC operation in conjunction with AFT are in [draft to be written
   providing DNSSEC details].


4.  Security Considerations

   After learning the IPv6 prefix of its translator by following the
   procedures in this specification, the IPv6 host will utilize this
   information for subsequent actions (e.g., sending a packet to it, or
   using that information to synthesize DNS records or to perform DNSSEC
   validation).  If an attacker provides a fraudulent IPv6 to the IPv6
   host, the attacker can become on-path for traffic to/from that IPv6



Wing                     Expires April 26, 2009                 [Page 5]

Internet-Draft          Learning the AFT's Prefix           October 2008


   host and preform passive or active eavesdropping or traffic analysis.
   To protect against this attack, it is RECOMMENDED that IPv6 hosts be
   configured with the names of authorized translators and RECOMMENDED
   that IPv6 hosts uses DNSSEC to validate that name matches the IPv6
   prefix learned via DNS or DHCPv6.


5.  IANA Considerations

   A new DHCPv6 option, OPTION_AFT_PREFIX, needs to be assigned by IANA.

   The name "_aft_translator" should be reserved by IANA for this
   purpose.


6.  Acknowledgements

   This draft was fostered by discussion on the 46translation mailing
   list and at the v4v6 Interim in Montreal.  Special thanks to Iljitsch
   van Beijnum, Andrew Sullivan, Marcelo Bagnulo Braun, Fred Baker, and
   Xing Li for their comments and dialog.

   Thanks to Ralph Droms for his help with DHCPv6.  Thanks to John
   Schnizlein for improving the DNS learning algorithm.


7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

7.2.  Informative References

   [Sullivan-email]
              Sullivan, A., "DNSSEC Current Thinking", October 2008, <ht
              tps://www.employees.org/mailman/private/46translation/
              2008-October/000028.html>.

   [Wing-email]
              Wing, D., "DNSSEC, approach 2", October 2008, <https://
              www.employees.org/mailman/private/46translation/
              2008-October/000031.html>.







Wing                     Expires April 26, 2009                 [Page 6]

Internet-Draft          Learning the AFT's Prefix           October 2008


Author's Address

   Dan Wing
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   Email:  dwing@cisco.com










































Wing                     Expires April 26, 2009                 [Page 7]

Internet-Draft          Learning the AFT's Prefix           October 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   This document was produced using xml2rfc v1.33 (of
   http://xml.resource.org/) from a source in RFC-2629 XML format.





Wing                     Expires April 26, 2009                 [Page 8]

