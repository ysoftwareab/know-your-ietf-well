<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Using GSS-API Mechanisms in SASL:
	    The GS2 Mechanism Family</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Using GSS-API Mechanisms in SASL:
	    The GS2 Mechanism Family">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Josefsson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">SJD AB</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">N. Williams</td></tr>
<tr><td class="header">Expires: July 15, 2010</td><td class="header">Sun
		Microsystems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 11, 2010</td></tr>
</table></td></tr></table>
<h1><br />Using GSS-API Mechanisms in SASL:
	    The GS2 Mechanism Family<br />draft-ietf-sasl-gs2-20</h1>

<h3>Abstract</h3>

<p>This document describes how to use a Generic Security
		Service Application Program Interface (GSS-API)
		mechanism in the the Simple Authentication and Security
		Layer (SASL) framework.  This is done by defining a new
		SASL mechanism family, called GS2.  This mechanism
		family offers a number of improvements over the previous
		"SASL/GSSAPI" mechanism: it is more general, uses fewer
		messages for the authentication phase in some cases, and
		supports negotiable use of channel binding.  Only
		GSS-API mechanisms that support channel binding are
		supported.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 15, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Conventions used in this document<br />
<a href="#mechname">3.</a>&nbsp;
Mechanism name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.1.</a>&nbsp;
Generating SASL mechanism names from GSS-API OIDs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.2.</a>&nbsp;
Computing mechanism names manually<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.3.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#grandfathered-names">3.4.</a>&nbsp;
Grandfathered mechanism names<br />
<a href="#messages">4.</a>&nbsp;
SASL Authentication Exchange Message Format<br />
<a href="#cb">5.</a>&nbsp;
Channel Bindings<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cb-address">5.1.</a>&nbsp;
Content of GSS-CHANNEL-BINDINGS structure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#default-cb">5.2.</a>&nbsp;
Default Channel Binding<br />
<a href="#examples">6.</a>&nbsp;
Examples<br />
<a href="#authcond">7.</a>&nbsp;
Authentication Conditions<br />
<a href="#gssapiparams">8.</a>&nbsp;
GSS-API Parameters<br />
<a href="#naming">9.</a>&nbsp;
Naming<br />
<a href="#GSS_Inquire_SASLname_for_mech call">10.</a>&nbsp;
GSS_Inquire_SASLname_for_mech call<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gss_inquire_saslname_for_mech">10.1.</a>&nbsp;
gss_inquire_saslname_for_mech<br />
<a href="#GSS_Inquire_mech_for_SASLname call">11.</a>&nbsp;
GSS_Inquire_mech_for_SASLname call<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gss_inquire_mech_for_saslname">11.1.</a>&nbsp;
gss_inquire_mech_for_saslname<br />
<a href="#seclayers">12.</a>&nbsp;
Security Layers<br />
<a href="#gssapi">13.</a>&nbsp;
Interoperability with the SASL GSSAPI mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">13.1.</a>&nbsp;
The interoperability problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">13.2.</a>&nbsp;
Resolving the problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">13.3.</a>&nbsp;
Additional Recommendations<br />
<a href="#nego">14.</a>&nbsp;
GSS-API Mechanisms that negotiate other mechanisms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">14.1.</a>&nbsp;
The interoperability problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">14.2.</a>&nbsp;
Security problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">14.3.</a>&nbsp;
Resolving the problems<br />
<a href="#iana">15.</a>&nbsp;
IANA Considerations<br />
<a href="#security">16.</a>&nbsp;
Security Considerations<br />
<a href="#ack">17.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">18.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">18.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">18.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Generic Security Service Application Program Interface
		(GSS-API) <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> is a framework that
		provides security services to applications using a
		variety of authentication mechanisms.  Simple
		Authentication and Security Layer (SASL)
		<a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> is a framework to provide
		authentication and security layers for connection
		based protocols, also using a variety of mechanisms.
		This document describes how to use a GSS-API mechanism
		as though it were a SASL mechanism.  This facility is
		called GS2 -- a moniker that indicates that this is
		the second GSS-API-&gt;SASL mechanism bridge.  The
		original GSS-API-&gt;SASL mechanism bridge was
		specified by <a class='info' href='#RFC2222'>[RFC2222]<span> (</span><span class='info'>Myers, J., &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; October&nbsp;1997.</span><span>)</span></a>, now
		<a class='info' href='#RFC4752'>[RFC4752]<span> (</span><span class='info'>Melnikov, A., &ldquo;The Kerberos V5 (&quot;GSSAPI&quot;) Simple Authentication and Security Layer (SASL) Mechanism,&rdquo; November&nbsp;2006.</span><span>)</span></a>; we shall sometimes refer to
		the original bridge as GS1 in this document.
</p>
<p>All GSS-API mechanisms are implicitly registered for
		use within SASL by this specification.  The SASL
		mechanisms defined in this document are known as the
		GS2 family of mechanisms.
</p>
<p>The GS1 bridge failed to gain wide deployment for any
	      GSS-API mechanism other than "The Kerberos V5 GSS-API
	      mechanism" <a class='info' href='#RFC1964'>[RFC1964]<span> (</span><span class='info'>Linn, J., &ldquo;The Kerberos Version 5 GSS-API Mechanism,&rdquo; June&nbsp;1996.</span><span>)</span></a>
	      <a class='info' href='#RFC4121'>[RFC4121]<span> (</span><span class='info'>Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2,&rdquo; July&nbsp;2005.</span><span>)</span></a>, and has a number of problems
	      that led us to desire a new bridge.  Specifically: a)
	      GS1 was not round-trip optimized, b) GS1 did not support
	      channel binding <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.  These
	      problems and the opportunity to create the next SASL
	      password-based mechanism,
	      <a class='info' href='#I-D.ietf-sasl-scram'>Salted Challenge
		Response (SCRAM) SASL and GSS-API Mechanism<span> (</span><span class='info'>Newman, C., Menon-Sen, A., Melnikov, A., and N. Williams, &ldquo;Salted Challenge Response (SCRAM) SASL and GSS-API Mechanism,&rdquo; February&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sasl&#8209;scram], as
	      a GSS-API mechanism used by SASL applications via GS2,
	      provide the motivation for GS2.
</p>
<p>In particular, the current consensus of the SASL
	      community appears to be that SASL "security layers"
	      (i.e., confidentiality and integrity protection of
	      application data after authentication) are too complex
	      and redundant because SASL applications tend to have an
	      option to run over a Transport Layer Security (TLS)
	      <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> channel.  Use of SASL security
	      layers is best replaced with channel binding to a TLS
	      channel.
</p>
<p>GS2 is designed to be as simple as possible.  It adds
		to GSS-API security context token exchanges only the
		bare minimum to support SASL semantics and negotiation
		of use of channel binding.  Specifically, GS2 adds a
		small header (a few bytes plus the length of the
		client requested SASL authorization identity) to the
		initial GSS-API context token and to the application
		channel binding data.  GS2 uses SASL mechanism
		negotiation to implement channel binding negotiation.
		All GS2 plaintext is protected via the use of GSS-API
		channel binding.  Additionally, to simplify the
		implementation of GS2 mechanisms for implementors who
		will not implement a GSS-API framework, we compress
		the initial security context token header required by
		<a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> (see section 3.1).
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
		NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
		in this document are to be interpreted as described in
		<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>The document uses many terms and function names defined
	      in <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> as updated by
	      <a class='info' href='#RFC5554'>[RFC5554]<span> (</span><span class='info'>Williams, N., &ldquo;Clarifications and Extensions to the Generic Security Service Application Program Interface (GSS-API) for the Use of Channel Bindings,&rdquo; May&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="mechname"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Mechanism name</h3>

<p>There are two SASL mechanism names for any GSS-API
	    mechanism used through this facility.  One denotes that
	    the server supports channel binding.  The other denotes
	    that it does not.
</p>
<p>The SASL mechanism name for a GSS-API mechanism is that
	    which is provided by that mechanism when it was specified,
	    if one was specified.  This name denotes that the server
	    does not support channel binding.  Add the suffix "-PLUS"
	    and the resulting name denotes that the server does
	    support channel binding.  SASL implementations can use the
	    GSS_Inquire_SASLname_for_mech call (see below) to query
	    for the SASL mechanism name of a GSS-API mechanism.
</p>
<p>If the GSS_Inquire_SASLname_for_mech interface is not
	    used, the GS2 implementation needs some other mechanism to
	    map mechanism OIDs to SASL names internally.  In this
	    case, the implementation can only support the mechanisms
	    for which it knows the SASL name.  If the
	    GSS_Inquire_SASLname_for_mech call fails, and the GS2
	    implementation cannot map the OID to a SASL mechanism name
	    using some other means, it cannot use the particular
	    GSS-API mechanism since it does not know its SASL
	    mechanism name.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Generating SASL mechanism names from GSS-API OIDs</h3>

<p>For GSS-API mechanisms whose SASL names are not
		    defined together with the GSS-API mechanism or in
		    this document, the SASL mechanism name is
		    concatenation of the string "GS2-" and the <a class='info' href='#RFC4648'>Base32 encoding<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648] (with an
		    upper case alphabet) of the first 55 bits of the
		    binary <a class='info' href='#FIPS.180-1.1995'>SHA-1
			hash<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; April&nbsp;1995.</span><span>)</span></a> [FIPS.180&#8209;1.1995] string computed over the <a class='info' href='#CCITT.X690.2002'>ASN.1 DER
			encoding<span> (</span><span class='info'>International International Telephone and Telegraph Consultative Committee, &ldquo;ASN.1 encoding rules: Specification of basic encoding Rules (BER), Canonical encoding rules (CER) and Distinguished encoding rules (DER),&rdquo; July&nbsp;2002.</span><span>)</span></a> [CCITT.X690.2002], including the tag and length
		    octets, of the GSS-API mechanism's Object
		    Identifier.  The Base32 rules on padding characters
		    and characters outside of the Base32 alphabet are
		    not relevant to this use of Base32.  If any padding
		    or non-alphabet characters are encountered, the name
		    is not a GS2 family mechanism name.  This name
		    denotes that the server does not support channel
		    binding.  Add the suffix "-PLUS" and the resulting
		    name denotes that the server does support channel
		    binding.
</p>
<p>A GS2 mechanism that has a non-OID-derived SASL
		  mechanism name is said to have a "user friendly SASL
		  mechanism name".
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Computing mechanism names manually</h3>

<p>The hash-derived GS2 SASL mechanism name may be
		computed manually.  This is useful when the set of
		supported GSS-API mechanisms is known in advance.
		This eliminates the need to implement Base32, SHA-1
		and DER in the SASL mechanism.  The computed mechanism
		name can be used directly in the implementation, and
		the implementation need not be concerned if the
		mechanism is part of a mechanism family.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Examples</h3>

<p>The OID for the <a class='info' href='#RFC2025'>SPKM-1
			mechanism<span> (</span><span class='info'>Adams, C., &ldquo;The Simple Public-Key GSS-API Mechanism (SPKM),&rdquo; October&nbsp;1996.</span><span>)</span></a> [RFC2025] is 1.3.6.1.5.5.1.1.  The ASN.1
		    DER encoding of the OID, including the tag and
		    length, is (in hex) 06 07 2b 06 01 05 05 01 01.  The
		    SHA-1 hash of the ASN.1 DER encoding is (in hex) 1c
		    f8 f4 2b 5a 9f 80 fa e9 f8 31 22 6d 5d 9d 56 27 86
		    61 ad.  Convert the first 7 octets to binary, drop
		    the last bit, and re-group them in groups of 5, and
		    convert them back to decimal, which results in these
		    computations:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
hex:
1c f8 f4 2b 5a 9f 80

binary:
00011100 11111000 11110100 00101011 01011010
10011111 1000000

binary in groups of 5:
00011 10011 11100 01111 01000 01010 11010 11010
10011 11110 00000

decimal of each group:
3 19 28 15 8 10 26 26 19 30 0

base32 encoding:
D T 4 P I K 2 2 T 6 A
</pre></div>
<p>The last step translates each decimal value using
		  table 3 in <a class='info' href='#RFC4648'>Base32<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].
		  Thus the SASL mechanism name for the SPKM-1 GSSAPI
		  mechanism is "GS2-DT4PIK22T6A".
</p>
<p>The OID for the <a class='info' href='#RFC1964'>Kerberos V5
		    GSS-API mechanism<span> (</span><span class='info'>Linn, J., &ldquo;The Kerberos Version 5 GSS-API Mechanism,&rdquo; June&nbsp;1996.</span><span>)</span></a> [RFC1964] is 1.2.840.113554.1.2.2
		    and its DER encoding is (in hex) 06 09 2A 86 48 86
		    F7 12 01 02 02.  The SHA-1 hash is 82 d2 73 25 76
		    6b d6 c8 45 aa 93 25 51 6a fc ff 04 b0 43 60.
		    Convert the 7 octets to binary, drop the last bit,
		    and re-group them in groups of 5, and convert them
		    back to decimal, which results in these
		    computations:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
hex:
82 d2 73 25 76 6b d6

binary:
10000010 11010010 01110011 00100101 01110110
01101011 1101011

binary in groups of 5:
10000 01011 01001 00111 00110 01001 01011 10110
01101 01111 01011

decimal of each group:
16 11 9 7 6 9 11 22 13 15 11

base32 encoding:
Q L J H G J L W N P L
</pre></div>
<p>The last step translates each decimal value using
		  table 3 in <a class='info' href='#RFC4648'>Base32<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].
		  Thus the SASL mechanism name for the Kerberos V5
		  GSSAPI mechanism would be "GS2-QLJHGJLWNPL" and
		  (because this mechanism supports channel binding)
		  "GS2-QLJHGJLWNPL-PLUS".  Instead, the next section
		  assigns the Kerberos V5 mechanism a non-hash-derived
		  mechanism name.
</p>
<a name="grandfathered-names"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Grandfathered mechanism names</h3>

<p>Some older GSS-API mechanisms were not specified with
		a SASL GS2 mechanism name.  Using a shorter name can
		be useful nonetheless.  We specify the names
		"GS2-KRB5" and "GS2-KRB5-PLUS" for the Kerberos V5
		mechanism, to be used as if the original specification
		documented it.  See <a class='info' href='#iana'>Section&nbsp;15<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</p>
<a name="messages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
SASL Authentication Exchange Message Format</h3>

<p>During the SASL authentication exchange for GS2, a number
	    of messages following the following format is sent between
	    the client and server.  On success, this number is the
	    same as the number of context tokens that the GSS-API
	    mechanism would normally require in order to establish a
	    security context.  On failures, the exchange can be
	    terminated early by any party.
</p>
<p>When using a GS2 mechanism the SASL client is always a
	    GSS-API initiator and the SASL server is always a GSS-API
	    acceptor.  The client calls GSS_Init_sec_context and the
	    server calls GSS_Accept_sec_context.
</p>
<p>All the SASL authentication messages exchanged are
	    exactly the same as the security context tokens of the
	    GSS-API mechanism, except for the initial security context
	    token.
</p>
<p>The client and server MAY send GSS-API error tokens
	    (tokens output by GSS_Init_sec_context() or
	    GSS_Accept_sec_context() when the major status code is
	    other than GSS_S_COMPLETE or GSS_S_CONTINUE_NEEDED).  As
	    this indicates an error condition, after sending the
	    token, the sending side should fail the
	    authentication.
</p>
<p>The initial security context token is modified as
	  follows:

	    </p>
<ul class="text">
<li>The initial context token header (see section 3.1 of
		<a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>) MUST be removed if present.
		If the header is not present, the client MUST send a
		"gs2-nonstd-flag" flag (see below).  On the server
		side this header MUST be recomputed and restored prior
		to passing the token to GSS_Accept_sec_context, except
		when the "gs2-nonstd-flag" is sent.
</li>
<li>A GS2 header MUST be prefixed to the resulting
		initial context token.  This header has the form
		"gs2-header" given below in ABNF
		<a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</li>
</ul><p>

	  
</p>
<p>The figure below describes the permissible attributes,
	    their use, and the format of their values.  All attribute
	    names are single US-ASCII letters and are
	    case-sensitive.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 <dfn>UTF8-1-safe</dfn>    = <span class='val'>%x01-2B</span> / <span class='val'>%x2D-3C</span> / <span class='val'>%x3E-7F</span>
                  <em>;; As UTF8-1 in RFC 3629 except</em>
                  <em>;; NUL, "=", and ",".</em>
 <dfn>UTF8-2</dfn>         = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;
 <dfn>UTF8-3</dfn>         = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;
 <dfn>UTF8-4</dfn>         = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;
 <dfn>UTF8-char-safe</dfn> = <cite class='id'>UTF8-1-safe</cite> / <cite class='id'>UTF8-2</cite> / <cite class='id'>UTF8-3</cite> / <cite class='id'>UTF8-4</cite>

 <dfn>saslname</dfn>       = <span class='rep'>1*</span>(<cite class='id'>UTF8-char-safe</cite> / "<span class='str'>=2C</span>" / "<span class='str'>=3D</span>")
 <dfn>gs2-authzid</dfn>    = "<span class='str'>a=</span>" <cite class='id'>saslname</cite>
                   <em>;; GS2 has to transport an authzid since</em>
                   <em>;; the GSS-API has no equivalent</em>
 <dfn>gs2-nonstd-flag</dfn> = "<span class='str'>F</span>"
                   <em>;; "F" means the mechanism is not a</em>
                   <em>;; standard GSS-API mechanism in that the</em>
                   <em>;; RFC2743 section 3.1 header was missing</em>
 <dfn>cb-name</dfn>         = <span class='rep'>1*</span>(<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>.</span>" / "<span class='str'>-</span>")
                   <em>;; See RFC 5056 section 7</em>
 <dfn>gs2-cb-flag</dfn>     = ("<span class='str'>p=</span>" <cite class='id'>cb-name</cite>) / "<span class='str'>n</span>" / "<span class='str'>y</span>"
                   <em>;; GS2 channel binding (CB) flag</em>
                   <em>;; "p" -&gt; client supports and used CB</em>
                   <em>;; "n" -&gt; client does not support CB</em>
                   <em>;; "y" -&gt; client supports CB, thinks the server</em>
                   <em>;;           does not</em>
 <dfn>gs2-header</dfn> = [<cite class='id'>gs2-nonstd-flag</cite> "<span class='str'>,</span>"] <cite class='id'>gs2-cb-flag</cite> "<span class='str'>,</span>" [<cite class='id'>gs2-authzid</cite>] "<span class='str'>,</span>"
                     <em>;; The GS2 header is gs2-header.</em>
</pre></div>
<p>When the "gs2-nonstd-flag" flag is present, the client
	    did not find/remove a token header
	    (<a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> section 3.1) from the initial
	    token returned by GSS_Init_sec_context.  This signals to
	    the server that it MUST NOT re-add the data that is
	    normally removed by the client.
</p>
<p>The "gs2-cb-flag" signals the channel binding mode.  One
	    of "p", "n", or "y" is used.  A "p" means the client
	    supports and used a channel binding, and the name of the
	    channel binding type is indicated.  A "n" means that the
	    client does not support channel binding.  A "y" means the
	    client supports channel binding, but believes the server
	    does not support it, so it did not use a channel binding.
	    See the next section for more details.
</p>
<p>The "gs2-authzid" holds the SASL authorization identity.
	    It is encoded using <a class='info' href='#RFC3629'>UTF-8<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> [RFC3629]
	    with three exceptions:

	    </p>
<ul class="text">
<li>The NUL character is forbidden as required by section
		3.4.1 of <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</li>
<li>The server MUST replace any "," (comma) in the string
		with "=2C".
</li>
<li>The server MUST replace any "=" (equals) in the
		string with "=3D".
</li>
</ul><p>

	    Upon receipt of this value the server verifies its
	    correctness according to the used SASL protocol profile.
	    Failed verification results in a failed authentication
	    exchange.
	  
</p>
<a name="cb"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Channel Bindings</h3>

<p>GS2 supports channel binding to external secure channels,
	    such as TLS.  Clients and servers may or may not support
	    channel binding, therefore the use of channel binding is
	    negotiable.  GS2 does not provide security layers,
	    however, therefore it is imperative that GS2 provide
	    integrity protection for the negotiation of channel
	    binding.
</p>
<p>Use of channel binding is negotiated as follows:

	    </p>
<ul class="text">
<li>Servers SHOULD advertise both non-PLUS and the
		PLUS-variant of each GS2 mechanism name.  If the
		server cannot support channel binding, it MAY
		advertise only the non-PLUS variant.  If the server
		would never succeed authentication of the non-PLUS
		variant due to policy reasons, it MAY advertise only
		the PLUS-variant.
</li>
<li>If the client negotiates mechanisms then clients MUST
		select the PLUS-variant if offered by the server.
		Otherwise (the client does not negotiate mechanisms),
		if the client has no prior knowledge about mechanisms
		supported by the server and wasn't explicitly
		configured to use a particular variant of the GS2
		mechanism, then it MUST select only non-PLUS version
		of the GS2 mechanism.
</li>
<li>If the client does not support channel binding then
		it MUST use a "n" gs2-cb-flag.
</li>
<li>If the client supports channel binding and the server
		does not appear to (i.e., the client did not see the
		-PLUS name) then the client MUST either fail
		authentication or it MUST chose the non-PLUS mechanism
		name and use a "y" gs2-cb-flag.
</li>
<li>If the client supports channel binding and the server
		appears to support it (i.e., the client see the -PLUS
		name), or if the client wishes to use channel binding
		but the client does not negotiate mechanisms, then the
		client MUST use a "p" gs2-cb-flag to indicate the
		channel binding type it is using.
</li>
<li>The client generate the chan_bindings input parameter
		for GSS_Init_sec_context as described below.
</li>
<li>Upon receipt of the initial authentication message
		the server checks the gs2-cb-flag in the GS2 header
		and constructs a chan_bindings parameter for
		GSS_Accept_sec_context as described below.  If the
		client channel binding flag was "y" and the server did
		advertise support for channel bindings then the server
		MUST fail authentication.  If the client channel
		binding flag was "p" and the server does not support
		the indicated channel binding type then the server
		MUST fail authentication.
</li>
</ul><p>
	  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  FLAG CLIENT CB SUPPORT   SERVER CB SUPPORT DISPOSITION
  ---- -----------------   ----------------- -----------

  n    no support          N/A               If server disallows
                                             non-channel-bound
                                             authentication, then
                                             fail

  y    Yes, not required   No                Authentication may
                                             succeed; CB not used

  y    Yes, not required   Yes               Authentication must fail

  p    Yes                 Yes               Authentication may
                                             succeed, with CB used

  p    Yes                 No                Authentication will fail

  N/A  Yes, required       No                Client does not even try
</pre></div>
<p>For more discussions of channel bindings, and the syntax
	    of the channel binding data for various security
	    protocols, see <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="cb-address"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Content of GSS-CHANNEL-BINDINGS structure</h3>

<p>The calls to GSS_Init_sec_context and
	      GSS_Accept_sec_context take a chan_bindings parameter.
	      The value is a GSS-CHANNEL-BINDINGS structure
	      <a class='info' href='#RFC5554'>[RFC5554]<span> (</span><span class='info'>Williams, N., &ldquo;Clarifications and Extensions to the Generic Security Service Application Program Interface (GSS-API) for the Use of Channel Bindings,&rdquo; May&nbsp;2009.</span><span>)</span></a>.
</p>
<p>The initiator-address-type and acceptor-address-type
	      fields of the GSS-CHANNEL-BINDINGS structure MUST be set
	      to 0.  The initiator-address and acceptor-address fields
	      MUST be the empty string.
</p>
<p>The application-data field MUST be set to the
	      gs2-header concatenated with, when a gs2-cb-flag of "p"
	      is used, the application's channel binding data.
</p>
<a name="default-cb"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Default Channel Binding</h3>

<p>A default channel binding type agreement process for
	      all SASL application protocols that do not provide their
	      own channel binding type agreement is provided as
	      follows.
</p>
<p>'tls-unique' is the default channel binding type for
	      any application that doesn't specify one.
</p>
<p>Servers MUST implement the "tls-unique"
	      <a class='info' href='#tls-unique'>[tls&#8209;unique]<span> (</span><span class='info'>Zhu, L., &ldquo;Registration of TLS unique channel binding                         (generic),&rdquo; July&nbsp;2008.</span><span>)</span></a>
	      <a class='info' href='#I-D.altman-tls-channel-bindings'>[I&#8209;D.altman&#8209;tls&#8209;channel&#8209;bindings]<span> (</span><span class='info'>Altman, J., Williams, N., and L. Zhu, &ldquo;Channel Bindings for TLS,&rdquo; March&nbsp;2010.</span><span>)</span></a> channel
	      binding type, if they implement any channel binding.
	      Clients SHOULD implement the "tls-unique" channel
	      binding type, if they implement any channel binding.
	      Clients and servers SHOULD choose the
	      highest-layer/innermost end-to-end TLS channel as the
	      channel to bind to.
</p>
<p>Servers MUST choose the channel binding type indicated
	      by the client, or fail authentication if they don't
	      support it.
</p>
<a name="examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Examples</h3>

<p>Example #1: a one round-trip GSS-API context
		    token exchange, no channel binding, optional
		    authzid given.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: n,a=someuser,&lt;initial context token with standard
                         header removed&gt;
      S: Send reply context token as is
      C: Empty message
      S: Outcome of authentication exchange
</pre></div>
<p>Example #2: a one and one half round-trip
		    GSS-API context token exchange, no channel
		    binding.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: n,,&lt;initial context token with standard
                         header removed&gt;
      S: Send reply context token as is
      C: Send reply context token as is
      S: Outcome of authentication exchange
</pre></div>
<p>Example #3: a two round-trip GSS-API context
		    token exchange, no channel binding, no standard
		    token header.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: F,n,,&lt;initial context token without
                          standard header&gt;
      S: Send reply context token as is
      C: Send reply context token as is
      S: Send reply context token as is
      C: Empty message
      S: Outcome of authentication exchange
</pre></div>
<p>Example #4: using channel binding, optional
		  authzid given.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: p=tls-unique,a=someuser,&lt;initial context token with standard
                             header removed&gt;
      S: Send reply context token as is
      ...
</pre></div>
<p>Example #5: using channel binding.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: p=tls-unique,,&lt;initial context token with standard
                             header removed&gt;
      S: Send reply context token as is
      ...
</pre></div>
<p>Example #6: using non-standard channel
		  binding (requires out-of-band negotiation).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: p=tls-server-end-point,,&lt;initial context token with standard
                             header removed&gt;
      S: Send reply context token as is
      ...
</pre></div>
<p>Example #7: client supports channel bindings
		  but server does not, optional authzid
		  given.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      C: Request authentication exchange
      S: Empty Challenge
      C: y,a=someuser,&lt;initial
                        context token with standard header removed&gt;
      S: Send reply context token as is
      ...
</pre></div>
<p>GSS-API authentication is always initiated by the client.  The
		SASL framework allows either the client and server to initiate
		authentication.  In GS2 the server will send an initial empty
		challenge (zero byte string) if it has not yet received a token
		from the client.  See section 3 of <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="authcond"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Authentication Conditions</h3>

<p>Authentication MUST NOT succeed if any one of the
	    following conditions are true:
</p>
<p>
	    </p>
<ul class="text">
<li>GSS_Init/Accept_sec_context return anything other
		than GSS_S_CONTINUE_NEEDED or GSS_S_COMPLETE.
</li>
<li>If the client's initial GS2 header does not match the
		ABNF.
</li>
<li>In particular, if the initial character of the client
		message is anything except "F", "p", "n", or "y".
</li>
<li>If the client's GS2 channel binding flag was "y" and
		the server supports channel bindings.
</li>
<li>If the client's GS2 channel binding flag was "p" and
		the server does not support the indicated channel
		binding.
</li>
<li>If the client requires use of channel binding and the
		server did not advertise support for channel
		binding.
</li>
<li>Authorization of client principal (i.e., src_name in
		GSS_Accept_sec_context) to requested authzid
		failed.
</li>
<li>If the client is not authorized to the requested
		authzid or an authzid could not be derived from the
		client's initiator principal name.
</li>
</ul><p>

	  
</p>
<a name="gssapiparams"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
GSS-API Parameters</h3>

<p>GS2 does not use any GSS-API per-message tokens.
	    Therefore the per-message token ret_flags from
	    GSS_Init_sec_context() and GSS_Accept_sec_context() are
	    irrelevant; implementations SHOULD NOT set the per-message
	    req_flags.
</p>
<p>The mutual_req_flag MUST be set.  If channel binding is
	    used then the client MUST check that the corresponding
	    ret_flag is set when the context is fully establish, else
	    authentication MUST fail.
</p>
<p>Use or non-use of deleg_req_flag and anon_req_flag is an
	    implementation-specific detail.  SASL and GS2 implementors
	    are encouraged to provide programming interfaces by which
	    clients may choose to delegate credentials and by which
	    servers may receive them.  SASL and GS2 implementors are
	    encouraged to provide programming interfaces which provide
	    a good mapping of GSS-API naming options.
</p>
<a name="naming"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Naming</h3>

<p>There's no requirement that any particular GSS-API
	    name-types be used.  However, typically SASL servers will
	    have host-based acceptor principal names (see
	    <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> section 4.1) and clients will
	    typically have username initiator principal names (see
	    <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> section 4.2). When a host-based
	    acceptor principal name is used ("service@hostname"),
	    "service" is the service name specified in the protocol's
	    profile, and "hostname" is the fully qualified host name
	    of the server.
</p>
<a name="GSS_Inquire_SASLname_for_mech call"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
GSS_Inquire_SASLname_for_mech call</h3>

<p>We specify a new GSS-API utility function to allow SASL
	    implementations to more efficiently identify the GSS-API
	    mechanism that a particular SASL mechanism name refers
	    to.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Inputs:

   o desired_mech OBJECT IDENTIFIER

   Outputs:

   o sasl_mech_name UTF-8 STRING -- SASL name for this
     mechanism; caller must release with
     GSS_Release_buffer()

   o mech_name UTF-8 STRING -- name of this mechanism, possibly
     localized; caller must release with GSS_Release_buffer()

   o mech_description UTF-8 STRING -- possibly localized
     description of this mechanism; caller must release with
     GSS_Release_buffer()

   Return major_status codes:

   o  GSS_S_COMPLETE indicates successful completion, and that
      output parameters holds correct information.

   o  GSS_S_BAD_MECH indicates that a desired_mech was unsupported
      by the GSS-API implementation.

   The GSS_Inquire_SASLname_for_mech call is used to get the SASL
   mechanism name for a GSS-API mechanism.  It also returns a name
   and description of the mechanism in user friendly form.

   The output variable sasl_mech_name will hold the IANA registered
   mechanism name for the GSS-API mechanism, or if none is
   registered, a mechanism name computed from the OID as described
   in section 3.1 of this document.
</pre></div>
<p>
</p>
<a name="gss_inquire_saslname_for_mech"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
gss_inquire_saslname_for_mech</h3>

<p>The C binding for the GSS_Inquire_SASLname_for_mech
	      call is as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   OM_uint32 gss_inquire_saslname_for_mech(
     OM_uint32     *minor_status,
     const gss_OID  desired_mech,
     gss_buffer_t   sasl_mech_name,
     gss_buffer_t   mech_name,
     gss_buffer_t   mech_description
   );

   Purpose:

   Output the SASL mechanism name of a GSS-API mechanism.
   It also returns a name and description of the mechanism in a
   user friendly form.

   Parameters:

   minor_status      Integer, modify
                     Mechanism specific status code.

   Function value:   GSS status code

   GSS_S_COMPLETE    Successful completion

   GSS_S_BAD_MECH    The desired_mech OID is unsupported
</pre></div>
<a name="GSS_Inquire_mech_for_SASLname call"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
GSS_Inquire_mech_for_SASLname call</h3>

<p>To allow SASL clients to more efficiently identify which
	    GSS-API mechanism a particular SASL mechanism name refers
	    to we specify a new GSS-API utility function for this
	    purpose.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Inputs:

   o sasl_mech_name UTF-8 STRING -- SASL name of mechanism

   Outputs:

   o  mech_type OBJECT IDENTIFIER -- must be explicit mechanism,
      and not "default" specifier

   Return major_status codes:

   o  GSS_S_COMPLETE indicates successful completion, and that output
      parameters holds correct information.

   o  GSS_S_BAD_MECH indicates that no supported GSS-API mechanism
      had the indicated sasl_mech_name.

   The GSS_Inquire_mech_for_SASLname call is used to get the GSS-API
   mechanism OID associated with a SASL mechanism name.
</pre></div>
<p>
</p>
<a name="gss_inquire_mech_for_saslname"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
gss_inquire_mech_for_saslname</h3>

<p>The C binding for the GSS_Inquire_mech_for_SASLname
	      call is as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   OM_uint32 gss_inquire_mech_for_saslname(
     OM_uint32           *minor_status,
     const gss_buffer_t   sasl_mech_name,
     gss_OID             *mech_type
   );

   Purpose:

   Output GSS-API mechanism OID of mechanism associated with given
   sasl_mech_name.

   Parameters:

   minor_status      Integer, modify
                     Mechanism specific status code.

   Function value:   GSS status code

   GSS_S_COMPLETE    Successful completion

   GSS_S_BAD_MECH    The desired_mech OID is unsupported
</pre></div>
<a name="seclayers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Security Layers</h3>

<p>GS2 does not support SASL security layers.  Applications
	    that need integrity or confidentiality protection can use
	    either channel binding to a secure external channel or
	    another SASL mechanism that does provide security
	    layers.
</p>
<a name="gssapi"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Interoperability with the SASL GSSAPI mechanism</h3>

<p>The <a class='info' href='#RFC1964'>Kerberos V5 GSS-API<span> (</span><span class='info'>Linn, J., &ldquo;The Kerberos Version 5 GSS-API Mechanism,&rdquo; June&nbsp;1996.</span><span>)</span></a> [RFC1964]
		mechanism is currently used in SASL under the name
		GSSAPI, see <a class='info' href='#RFC4752'>GSSAPI
		mechanism<span> (</span><span class='info'>Melnikov, A., &ldquo;The Kerberos V5 (&quot;GSSAPI&quot;) Simple Authentication and Security Layer (SASL) Mechanism,&rdquo; November&nbsp;2006.</span><span>)</span></a> [RFC4752].  The Kerberos V5 mechanism may also
		be used with the GS2 family.  This causes an
		interoperability problem, which is discussed and
		resolved below.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
The interoperability problem</h3>

<p>The SASL "GSSAPI" mechanism is not wire-compatible
		    with the Kerberos V GSS-API mechanism used as a SASL
		    GS2 mechanism.
</p>
<p>If a client (or server) only support Kerberos V5
		    under the "GSSAPI" name and the server (or client)
		    only support Kerberos V5 under the GS2 family, the
		    mechanism negotiation will fail.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Resolving the problem</h3>

<p>If the Kerberos V5 mechanism is supported under GS2
		    in a server, the server SHOULD also support Kerberos
		    V5 through the "GSSAPI" mechanism, to avoid
		    interoperability problems with older clients.
</p>
<p>Reasons for violating this recommendation may include
		    security considerations regarding the absent
		    features in the GS2 mechanism.  The SASL "GSSAPI"
		    mechanism lacks support for channel bindings, which
		    means that using an external secure channel may not
		    be sufficient protection against active
		    attackers (see <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#mitm'>[mitm]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunneled Authentication,&rdquo; .</span><span>)</span></a>).
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
Additional Recommendations</h3>

<p>If the application requires SASL security layers then
		it MUST use the SASL "GSSAPI" mechanism
		<a class='info' href='#RFC4752'>[RFC4752]<span> (</span><span class='info'>Melnikov, A., &ldquo;The Kerberos V5 (&quot;GSSAPI&quot;) Simple Authentication and Security Layer (SASL) Mechanism,&rdquo; November&nbsp;2006.</span><span>)</span></a> instead of "GS2-KRB5" or
		"GS2-KRB5-PLUS".
</p>
<p>If the application can use channel binding to an
		    external channel then it is RECOMMENDED that it
		    select Kerberos V5 through the GS2 mechanism rather
		    than the "GSSAPI" mechanism.
</p>
<a name="nego"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
GSS-API Mechanisms that negotiate other mechanisms</h3>

<p>A GSS-API mechanism that negotiates other mechanisms will
	    interact badly with the SASL mechanism negotiation.  There
	    are two problems.  The first is an interoperability
	    problem and the second is a security concern.  The
	    problems are described and resolved below.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14.1"></a><h3>14.1.&nbsp;
The interoperability problem</h3>

<p>If a client implements GSS-API mechanism X, potentially
	      negotiated through a GSS-API mechanism Y, and the server
	      also implements GSS-API mechanism X negotiated through a
	      GSS-API mechanism Z, the authentication negotiation will
	      fail.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14.2"></a><h3>14.2.&nbsp;
Security problem</h3>

<p>If a client's policy is to first prefer GSSAPI
	      mechanism X, then non-GSSAPI mechanism Y, then GSSAPI
	      mechanism Z, and if a server supports mechanisms Y and Z
	      but not X, then if the client attempts to negotiate
	      mechanism X by using a GSS-API mechanism that negotiates
	      other mechanisms (such as SPNEGO
	      <a class='info' href='#RFC4178'>[RFC4178]<span> (</span><span class='info'>Zhu, L., Leach, P., Jaganathan, K., and W. Ingersoll, &ldquo;The Simple and Protected Generic Security Service Application Program Interface (GSS-API) Negotiation Mechanism,&rdquo; October&nbsp;2005.</span><span>)</span></a>), it may end up using mechanism
	      Z when it ideally should have used mechanism Y.  For
	      this reason, the use of GSS-API mechanisms that
	      negotiate other mechanisms is disallowed under GS2.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14.3"></a><h3>14.3.&nbsp;
Resolving the problems</h3>

<p>GSS-API mechanisms that negotiate other mechanisms MUST
	      NOT be used with the GS2 SASL mechanism.  Specifically
	      SPNEGO <a class='info' href='#RFC4178'>[RFC4178]<span> (</span><span class='info'>Zhu, L., Leach, P., Jaganathan, K., and W. Ingersoll, &ldquo;The Simple and Protected Generic Security Service Application Program Interface (GSS-API) Negotiation Mechanism,&rdquo; October&nbsp;2005.</span><span>)</span></a> MUST NOT be used as a
	      GS2 mechanism.  To make this easier for SASL
	      implementations we assign a symbolic SASL mechanism name
	      to the SPNEGO GSS-API mechanism: "SPNEGO".  SASL client
	      implementations MUST NOT choose the SPNEGO mechanism
	      under any circumstances.
</p>
<p>The <a class='info' href='#RFC5587'>GSS_C_MA_MECH_NEGO attribute
		of GSS_Inquire_attrs_for_mech<span> (</span><span class='info'>Williams, N., &ldquo;Extended Generic Security Service Mechanism Inquiry APIs,&rdquo; July&nbsp;2009.</span><span>)</span></a> [RFC5587] can be used to
	      identify such mechanisms.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
IANA Considerations</h3>

<p>The IANA is advised to register a SASL mechanism family
	    as per <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> using the following
	    information.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Subject: Registration of SASL mechanism family GS2-*
  SASL mechanism prefix: GS2-
  Security considerations: RFC [THIS-DOC]
  Published specification: RFC [THIS-DOC]
  Person &amp; email address to contact for further information:
    Simon Josefsson &lt;simon@josefsson.org&gt;
  Intended usage: COMMON
  Owner/Change controller: iesg@ietf.org
  Note: Compare with the GSSAPI and GSS-SPNEGO mechanisms.
</pre></div>
<p>The IANA is advised that SASL mechanism names starting
	    with "GS2-" are reserved for SASL mechanisms which conform
	    to this document.  The IANA is directed to place a
	    statement to that effect in the sasl-mechanisms
	    registry.
</p>
<p>The IANA is further advised that GS2 SASL mechanism names
	    MUST NOT end in "-PLUS" except as a version of another
	    mechanism name simply suffixed with "-PLUS".
</p>
<p>The SASL names for the Kerberos V5 GSS-API mechanism
	    <a class='info' href='#RFC4121'>[RFC4121]<span> (</span><span class='info'>Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2,&rdquo; July&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC1964'>[RFC1964]<span> (</span><span class='info'>Linn, J., &ldquo;The Kerberos Version 5 GSS-API Mechanism,&rdquo; June&nbsp;1996.</span><span>)</span></a> used via
	    GS2 SHALL be "GS2-KRB5" and "GS2-KRB5-PLUS".
</p>
<p>The SASL names for the SPNEGO GSS-API mechanism used via
	    GS2 SHALL be "SPNEGO" and "SPNEGO-PLUS".  As described in
	    <a class='info' href='#nego'>Section&nbsp;14<span> (</span><span class='info'>GSS-API Mechanisms that negotiate other mechanisms</span><span>)</span></a> the SASL "SPNEGO" and "SPNEGO-PLUS"
	    MUST NOT be used.  These names are provided as a
	    convenience for SASL library implementors.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
Security Considerations</h3>

<p>Security issues are also discussed throughout this
		memo.
</p>
<p>The security provided by a GS2 mechanism depends on the
		security of the GSS-API mechanism.  The GS2 mechanism
		family depends on channel binding support, so GSS-API
		mechanisms that do not support channel binding cannot be
		successfully used as SASL mechanisms via the GS2
		bridge.
</p>
<p>Because GS2 does not support security layers it is
		strongly RECOMMENDED that channel binding to a secure
		external channel be used.  Successful channel binding
		eliminates the possibility of man-in-the-middle (MITM)
		attacks, provided that the external channel and its
		channel binding data are secure and provided that the
		GSS-API mechanism used is secure.  Authentication
		failure because of channel binding failure may indicate
		that an MITM attack was attempted, but note that a real
		MITM attacker would likely attempt to close the
		connection to the client or simulate network partition ,
		thus MITM attack detection is heuristic.
</p>
<p>Use of channel binding will also protect the SASL
		mechanism negotiation -- if there is no MITM then the
		external secure channel will have protected the SASL
		mechanism negotiation.
</p>
<p>The channel binding data MAY be sent (but the actual
		GSS-API mechanism used) without confidentiality
		protection and knowledge of it is assumed to provide
		no advantage to an MITM (who can, in any case, compute
		the channel binding data independently).  If the
		external channel does not provide confidentiality
		protection and the GSS-API mechanism does not provide
		confidentiality protection for the channel binding
		data, then passive attackers (eavesdroppers) can
		recover the channel binding data.  See
		<a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>When constructing the input_name_string for
		GSS_Import_name with the GSS_C_NT_HOSTBASED_SERVICE
		name type, the client SHOULD NOT canonicalize the
		server's fully qualified domain name using an insecure
		or untrusted directory service, such as the <a class='info' href='#RFC1034'>Domain Name System<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1034] without
		<a class='info' href='#RFC4033'>DNSSEC<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033].
</p>
<p>SHA-1 is used to derive SASL mechanism names, but no
	      traditional cryptographic properties are required -- the
	      required property is that the truncated output for
	      distinct inputs are different for practical input
	      values.  GS2 does not use any other cryptographic
	      algorithm.  Therefor GS2 is "algorithm agile", or, as
	      agile as the GSS-API mechanisms that are available for
	      use in SASL applications via GS2.
</p>
<p>GS2 does not protect against downgrade attacks of
	      channel binding types.  The complexities of negotiation
	      a channel binding type, and handling down-grade attacks
	      in that negotiation, was intentionally left out of scope
	      for this document.
</p>
<p>The security considerations of SASL
	      <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>, the GSS-API
	      <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>, channel binding
	      <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>, any external channels (such as
	      TLS, <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, channel binding types
	      (see the IANA channel binding type registry), and
	      GSS-API mechanisms (such as the Kerberos V5 mechanism
	      <a class='info' href='#RFC4121'>[RFC4121]<span> (</span><span class='info'>Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2,&rdquo; July&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC1964'>[RFC1964]<span> (</span><span class='info'>Linn, J., &ldquo;The Kerberos Version 5 GSS-API Mechanism,&rdquo; June&nbsp;1996.</span><span>)</span></a>), also
	      apply.
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
Acknowledgements</h3>

<p>The history of GS2 can be traced to the "GSSAPI"
		mechanism originally specified by RFC2222.  This
		document was derived from draft-ietf-sasl-gssapi-02
		which was prepared by Alexey Melnikov with significant
		contributions from John G.  Myers, although the majority
		of this document has been rewritten by the current
		authors.
</p>
<p>Contributions of many members of the SASL mailing list
	      are gratefully acknowledged.  In particular, ideas and
	      feedback from Pasi Eronen, Sam Hartman, Jeffrey
	      Hutzelman, Alexey Melnikov, and Tom Yu improved the
	      document and the protocol.  Other suggestions to the
	      documents were made by Spencer Dawkins, Ralph Droms,
	      Adrian Farrel, Robert Sparks, and Glen Zorn.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18"></a><h3>18.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>18.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.180-1.1995">[FIPS.180-1.1995]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;PUB 180-1, April&nbsp;1995.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4422">[RFC4422]</a></td>
<td class="author-text">Melnikov, A. and K. Zeilenga, &ldquo;<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>,&rdquo; RFC&nbsp;4422, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5554">[RFC5554]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5554">Clarifications and Extensions to the Generic Security Service Application Program Interface (GSS-API) for the Use of Channel Bindings</a>,&rdquo; RFC&nbsp;5554, May&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5554.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X690.2002">[CCITT.X690.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
Consultative Committee, &ldquo;ASN.1 encoding rules: Specification of basic encoding Rules (BER), Canonical encoding rules (CER) and Distinguished encoding rules (DER),&rdquo; CCITT&nbsp;Recommendation X.690, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="tls-unique">[tls-unique]</a></td>
<td class="author-text">Zhu, L., &ldquo;Registration of TLS unique channel binding
                        (generic),&rdquo; IANA&nbsp;http://www.iana.org/assignments/channel-binding-types/tls-unique, July&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>18.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1964">[RFC1964]</a></td>
<td class="author-text"><a href="mailto:John.Linn@ov.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1964">The Kerberos Version 5 GSS-API Mechanism</a>,&rdquo; RFC&nbsp;1964, June&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1964.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2025">[RFC2025]</a></td>
<td class="author-text"><a href="mailto:cadams@bnr.ca">Adams, C.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2025">The Simple Public-Key GSS-API Mechanism (SPKM)</a>,&rdquo; RFC&nbsp;2025, October&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2025.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2222">[RFC2222]</a></td>
<td class="author-text"><a href="mailto:jgmyers@netscape.com">Myers, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2222">Simple Authentication and Security Layer (SASL)</a>,&rdquo; RFC&nbsp;2222, October&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2222.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2222.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2222.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4121">[RFC4121]</a></td>
<td class="author-text">Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;<a href="http://tools.ietf.org/html/rfc4121">The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2</a>,&rdquo; RFC&nbsp;4121, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4121.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4178">[RFC4178]</a></td>
<td class="author-text">Zhu, L., Leach, P., Jaganathan, K., and W. Ingersoll, &ldquo;<a href="http://tools.ietf.org/html/rfc4178">The Simple and Protected Generic Security Service Application Program Interface (GSS-API) Negotiation Mechanism</a>,&rdquo; RFC&nbsp;4178, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4178.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4752">[RFC4752]</a></td>
<td class="author-text">Melnikov, A., &ldquo;<a href="http://tools.ietf.org/html/rfc4752">The Kerberos V5 ("GSSAPI") Simple Authentication and Security Layer (SASL) Mechanism</a>,&rdquo; RFC&nbsp;4752, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4752.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5587">[RFC5587]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5587">Extended Generic Security Service Mechanism Inquiry APIs</a>,&rdquo; RFC&nbsp;5587, July&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5587.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sasl-scram">[I-D.ietf-sasl-scram]</a></td>
<td class="author-text">Newman, C., Menon-Sen, A., Melnikov, A., and N. Williams, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-scram-11.txt">Salted Challenge Response (SCRAM) SASL and GSS-API Mechanism</a>,&rdquo; draft-ietf-sasl-scram-11 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-scram-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a></td>
<td class="author-text">Altman, J., Williams, N., and L. Zhu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-altman-tls-channel-bindings-10.txt">Channel Bindings for TLS</a>,&rdquo; draft-altman-tls-channel-bindings-10 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-altman-tls-channel-bindings-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="mitm">[mitm]</a></td>
<td class="author-text">Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunneled Authentication,&rdquo; WWW&nbsp;http://www.saunalahti.fi/~asokan/research/mitm.html.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Simon Josefsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SJD AB</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hagagatan 24</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm  113 47</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SE</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:simon@josefsson.org">simon@josefsson.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://josefsson.org/">http://josefsson.org/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas
	    Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun
		Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5300
			Riata
			Trace
			Ct</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austin, TX  78727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
</table>
</body></html>
