<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Use of SHA-2 algorithms with RSA in DNSKEY and RRSIG Resource Records for DNSSEC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Use of SHA-2 algorithms with RSA in DNSKEY and RRSIG Resource Records for DNSSEC">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, DNSSEC, RSA, SHA-256, SHA-512">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DNS Extensions working group</td><td class="header">J. Jansen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NLnet Labs</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">April 24, 2009</td></tr>
<tr><td class="header">Expires: October 26, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Use of SHA-2 algorithms with RSA in DNSKEY and RRSIG Resource Records for DNSSEC<br />draft-ietf-dnsext-dnssec-rsasha256-13</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 26, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
                 This document describes how to produce RSA/SHA-256
                 and RSA/SHA-512 DNSKEY and RRSIG resource records for
                 use in the Domain Name System Security Extensions
                 (DNSSEC, RFC 4033, RFC 4034, and RFC 4035).
             
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#dnskey">2.</a>&nbsp;
DNSKEY Resource Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnskey-rsasha256">2.1.</a>&nbsp;
RSA/SHA-256 DNSKEY Resource Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnskey-rsasha512">2.2.</a>&nbsp;
RSA/SHA-512 DNSKEY Resource Records<br />
<a href="#rrsig">3.</a>&nbsp;
RRSIG Resource Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rrsig-sha256">3.1.</a>&nbsp;
RSA/SHA-256 RRSIG
             Resource Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rrsig-sha512">3.2.</a>&nbsp;
RSA/SHA-512
             RRSIG Resource Records<br />
<a href="#deployment">4.</a>&nbsp;
Deployment
           Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keysizes">4.1.</a>&nbsp;
Key Sizes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigsizes">4.2.</a>&nbsp;
Signature
             Sizes<br />
<a href="#implementation">5.</a>&nbsp;
Implementation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">5.1.</a>&nbsp;
Support for SHA-2 signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">5.2.</a>&nbsp;
Support for NSEC3 Denial of Existence<br />
<a href="#Example">6.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#example_256">6.1.</a>&nbsp;
RSA/SHA-256 Key and Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#example_512">6.2.</a>&nbsp;
RSA/SHA-512 Key and Signature<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
<a href="#security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security_sha1_vs_sha2">8.1.</a>&nbsp;
SHA-1
                versus SHA-2 Considerations for RRSIG Resource Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#downgrade_attacks">8.2.</a>&nbsp;
Signature Type Downgrade Attacks<br />
<a href="#acknowledgments">9.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
                   The Domain Name System (DNS) is the global hierarchical
                   distributed database for Internet Naming. The
                   DNS has been extended to use cryptographic keys
                   and digital signatures for the verification of the
                   authenticity and integrity of its data.  RFC 4033 <a class='info' href='#RFC4033'>[RFC4033]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, RFC 4034 <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>,
                   and RFC 4035 <a class='info' href='#RFC4035'>[RFC4035]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> describe these
                   DNS Security Extensions, called DNSSEC.
               
</p>
<p>
                   RFC 4034 describes how to store DNSKEY and RRSIG
                   resource records, and specifies a list of cryptographic
                   algorithms to use. This document extends that list
                   with the algorithms RSA/SHA-256 and RSA/SHA-512, and
                   specifies how to store DNSKEY data and how to produce
                   RRSIG resource records with these hash algorithms.
               
</p>
<p>
                   Familiarity with DNSSEC, RSA and the SHA-2 <a class='info' href='#FIPS.180-3.2008'>[FIPS.180&#8209;3.2008]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a> family of algorithms is
                   assumed in this document.
               
</p>
<p>
                   To refer to both SHA-256 and SHA-512, this document
                   will use the name SHA-2. This is done to improve
                   readability. When a part of text is specific for
                   either SHA-256 or SHA-512, their specific names are
                   used. The same goes for RSA/SHA-256 and RSA/SHA-512,
                   which will be grouped using the name RSA/SHA-2.
                   
</p>
<p>
                   The term "SHA-2" is not officially defined, but is usually
                   used to refer to the collection of the algorithms SHA-224,
                   SHA-256, SHA-384 and SHA-512. Since SHA-224 and SHA-384 are not
                   used in DNSSEC, SHA-2 will only refer to 
                   SHA-256 and SHA-512 in this document.
               
</p>
<p>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
                document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
               
</p>
<a name="dnskey"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
DNSKEY Resource Records</h3>

<p>
               The format of the DNSKEY RR can be found in RFC 4034 <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>. RFC 3110 <a class='info' href='#RFC3110'>[RFC3110]<span> (</span><span class='info'>Eastlake, D., &ldquo;RSA/SHA-1 SIGs and RSA KEYs in the Domain Name System (DNS),&rdquo; May&nbsp;2001.</span><span>)</span></a>
               describes the use of RSA/SHA-1 for DNSSEC signatures.
             
</p>
<a name="dnskey-rsasha256"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
RSA/SHA-256 DNSKEY Resource Records</h3>

<p>
                   RSA public keys for use with RSA/SHA-256 are stored
                   in DNSKEY resource records (RRs) with the algorithm
                   number {TBA1}.
               
</p>
<p>
                 For interoperability, as in RFC 3110
                 <a class='info' href='#RFC3110'>[RFC3110]<span> (</span><span class='info'>Eastlake, D., &ldquo;RSA/SHA-1 SIGs and RSA KEYs in the Domain Name System (DNS),&rdquo; May&nbsp;2001.</span><span>)</span></a>, the key size of RSA/SHA-256
                 keys MUST NOT be less than 512 bits, and MUST NOT be
                 more than 4096 bits.
               
</p>
<a name="dnskey-rsasha512"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
RSA/SHA-512 DNSKEY Resource Records</h3>

<p>
                   RSA public keys for use with RSA/SHA-512 are stored
                   in DNSKEY resource records (RRs) with the algorithm
                   number {TBA2}.
               
</p>
<p>
                 The key size of RSA/SHA-512
                 keys MUST NOT be less than 1024 bits, and MUST NOT be
                 more than 4096 bits.
               
</p>
<a name="rrsig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
RRSIG Resource Records</h3>

<p>
                   The value of the signature field in the RRSIG RR
                   follows the RSASSA-PKCS1-v1_5 signature scheme, and
                   is calculated as follows. The values for the RDATA
                   fields that precede the signature data are
                   specified in RFC 4034 <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
               
</p>
<p>
                   hash = SHA-XXX(data)
               
</p>
<p>
                   Here XXX is either 256 or 512, depending on the
                   algorithm used, as specified in FIPS PUB 180-3
                   <a class='info' href='#FIPS.180-3.2008'>[FIPS.180&#8209;3.2008]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a>, and "data" is
                   the wire format data of the resource record set
                   that is signed, as specified in RFC 4034 <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
               
</p>
<p>
                   signature = ( 00 | 01 | FF* | 00 | prefix | hash )
                   ** e (mod n)
               
</p>
<p>
                   Here "|" is concatenation, "00", "01", "FF" and "00"
                   are fixed octets of corresponding hexadecimal value,
                   "e" is the private exponent of the signing RSA key,
                   and "n" is the public modulus of the signing key. The
                   FF octet MUST be repeated the exact number of times
                   so that the total length of the concatenated term in
                   parentheses equals the length of the modulus of the
                   signer's public key ("n").
               
</p>
<p>
                   The "prefix" is intended to make the use of standard
                   cryptographic libraries easier. These specifications
                   are taken directly from the specifications of
                   RSASSA-PKCS1-v1_5 in PKCS #1 v2.1 section 8.2 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>, and EMSA-PKCS1-v1_5 encoding in
                   PKCS #1 v2.1 section 9.2 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>. The
                   prefixes for the different algorithms are specified
                   below.
               
</p>
<a name="rrsig-sha256"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
RSA/SHA-256 RRSIG
             Resource Records</h3>

<p>
                   RSA/SHA-256 signatures are stored in the DNS using
                   RRSIG resource records (RRs) with algorithm number
                   {TBA1}.
               
</p>
<p>
                   The prefix is the ASN.1 DER SHA-256 algorithm
                   designator prefix as specified in PKCS #1 v2.1 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>:
               
</p>
<p>
                   hex 30 31 30 0d 06 09 60 86 48 01 65 03 04 02 01 05
                   00 04 20
               
</p>
<a name="rrsig-sha512"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
RSA/SHA-512
             RRSIG Resource Records</h3>

<p>
                   RSA/SHA-512 signatures are stored in the DNS using
                   RRSIG resource records (RRs) with algorithm number
                   {TBA2}.
               
</p>
<p>
                   The prefix is the ASN.1 DER SHA-512 algorithm
                   designator prefix as specified in PKCS #1 v2.1 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>:
               
</p>
<p>
                   hex 30 51 30 0d 06 09 60 86 48 01 65 03 04 02 03 05
                   00 04 40
               
</p>
<a name="deployment"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Deployment
           Considerations</h3>

<a name="keysizes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Key Sizes</h3>

<p>
                 Apart from the restrictions in section 2,
                 this document will not specify what size of keys to
                 use. That is an operational issue and depends largely
                 on the environment and intended use. A good starting
                 point for more information would be NIST SP 800-57
                 <a class='info' href='#NIST800-57'>[NIST800&#8209;57]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendations for Key Management,&rdquo; March&nbsp;2007.</span><span>)</span></a>.
               
</p>
<a name="sigsizes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Signature
             Sizes</h3>

<p>
                 In this family of signing algorithms, the size of
                 signatures is related to the size of the key, and not the
                 hashing algorithm used in the signing process. Therefore,
                 RRSIG resource records produced with RSA/SHA-256 or
                 RSA/SHA-512 will have the same size as those produced
                 with RSA/SHA-1, if the keys have the same length.
               
</p>
<a name="implementation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Implementation Considerations</h3>

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Support for SHA-2 signatures</h3>

<p>
                 DNSSEC aware implementations SHOULD be able to support
                 RRSIG and DNSKEY resource records created with the RSA/SHA-2
                 algorithms as defined in this document.
               
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Support for NSEC3 Denial of Existence</h3>

<p>
   RFC 5155 <a class='info' href='#RFC5155'>[RFC5155]<span> (</span><span class='info'>Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;DNS Security (DNSSEC) Hashed Authenticated Denial of Existence,&rdquo; March&nbsp;2008.</span><span>)</span></a> defines new algorithm identifiers for  
   existing
   signing algorithms, to indicate that zones signed with these
   algorithm identifiers can use NSEC3 as well as NSEC records to
   provide denial of existence.  That mechanism was chosen to protect
   implementations predating RFC5155 from encountering resource records
   they could not know about.  This document does not define such
   algorithm aliases.
		
</p>
<p>
   A DNSSEC validator that implements RSA/SHA-2 MUST be able to
   validate both NSEC and NSEC3 <a class='info' href='#RFC5155'>[RFC5155]<span> (</span><span class='info'>Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;DNS Security (DNSSEC) Hashed Authenticated Denial of Existence,&rdquo; March&nbsp;2008.</span><span>)</span></a> negative answers.  An
   authoritative server that does not implement NSEC3 MAY still serve
   zones that use RSA/SHA-2 with NSEC denial of existence.
                 
</p>
<a name="Example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Examples</h3>

<a name="example_256"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
RSA/SHA-256 Key and Signature</h3>

<p>
                 Given a private key with the following values (in Base64):
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Private-key-format: v1.2
Algorithm:       8 (RSASHA256)
Modulus:         wVwaxrHF2CK64aYKRUibLiH30KpPuPBjel7E8ZydQW1HYWHfoGm
                 idzC2RnhwCC293hCzw+TFR2nqn8OVSY5t2Q==
PublicExponent:  AQAB
PrivateExponent: UR44xX6zB3eaeyvTRzmskHADrPCmPWnr8dxsNwiDGHzrMKLN+i/
                 HAam+97HxIKVWNDH2ba9Mf1SA8xu9dcHZAQ==
Prime1:          4c8IvFu1AVXGWeFLLFh5vs7fbdzdC6U82fduE6KkSWk=
Prime2:          2zZpBE8ZXVnL74QjG4zINlDfH+EOEtjJJ3RtaYDugvE=
Exponent1:       G2xAPFfK0KGxGANDVNxd1K1c9wOmmJ51mGbzKFFNMFk=
Exponent2:       GYxP1Pa7CAwtHm8SAGX594qZVofOMhgd6YFCNyeVpKE=
Coefficient:     icQdNRjlZGPmuJm2TIadubcO8X7V4y07aVhX464tx8Q=
</pre></div><p>

               
</p>
<p>
                 The DNSKEY record for this key would be:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
example.net.     3600  IN  DNSKEY  (256 3 8 AwEAAcFcGsaxxdgiuuGmCkVI
                 my4h99CqT7jwY3pexPGcnUFtR2Fh36BponcwtkZ4cAgtvd4Qs8P
                 kxUdp6p/DlUmObdk= );{id = 9033 (zsk), size = 512b}
</pre></div><p>

               
</p>
<p>
                 With this key, sign the following RRSet, consisting
                 of 1 A record:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
www.example.net. 3600  IN  A  123.123.123.123
</pre></div><p>

               
</p>
<p>
                 If the inception date is set at 00:00 hours on January 1st, 2000, and the expiration date at 00:00 hours on January 1st, 2030, the following signature should be created:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
www.example.net. 3600  IN  RRSIG  (A 8 3 3600 20300101000000
                 20000101000000 9033 example.net. KWgSIg3khRfyrHmtJU
                 5pzpsANyy27+HOZ6waMQ5kV690ljVmbHmGc8ULOfXw3aWmP0wJB
                 ND/TQhjCvrb3T9ffQ== );{id = 9033}
</pre></div><p>

               
</p>
<a name="example_512"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
RSA/SHA-512 Key and Signature</h3>

<p>
                 Given a private key with the following values (in Base64):
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Private-key-format: v1.2
Algorithm:       9 (RSASHA512)
Modulus:         8Du9YHEwFNjO5iG9jrrNyKwRs5mAzJgXBrjbA49R/ESWJKw6eHH
                 XfZaxnP+gVhZBDmqwND/SFwrEkN5LyH3HZ+/d/ECW+vT8Lxprqf
                 haTfxQkV4OFjw/ikuTcBMoUIYfhO1NVPBcH1mWh34DWmu6eedzH
                 IbdeNZnIkWSv4muchs=
PublicExponent:  AQAB
PrivateExponent: sRm5YLHQ2m2DCdDx55j7P+bqHdcaRroQr5nzi8pKjIkbjumRKV3
                 zmNhRFAa3cv9w8mnggIRUIzyC8LGQeLuRFjbv6uXDzoPX2O321j
                 PlTUOwCYMTVnbkZUem6c+7iRd2v5zNNe9uiXex6T8CDXyhQhqYb
                 8q2AajPrTlRzv6uW8E=
Prime1:          +DPVg2OlfYqcNlm67T42608gjyqWFdVc0UtDDDBo+ABWavqp+Yk
                 Fb/z/Ig+iBE901Q8RWdqVLND3PtGwWipIyw==
Prime2:          98fQbOaWH3D/WFhnu47f1qOgaob/ss3FQ12QbUdRDpgfmdryHH7
                 j1UGR2Xs0aRPwBASXYhgtamXtxLorXIFh8Q==
Exponent1:       j0UsbGlqr6sBPQZStnuBLBdCziFg/T1qFI4DJ9gR34YiXCJRV29
                 Wqiw6AalQdnh/EjVeaKWaEoKVFbfoukNKPQ==
Exponent2:       4YTy9ftVjd5p+f3UxEgBATnCatLebd6NeYfySRQM+YyJzp4RmNA
                 BC/t3BQv3IuBrpyyKoFTDGUEWjOSpTLPR8Q==
Coefficient:     BpIAEwh5rlw9M8FpGHjpF5TxSdhCjnA8NT0tB+MB/k0msceyBbx
                 avjzJXTi/QPk9PIO8Wv6eCzMQEM0QDZO53Q==
</pre></div><p>

               
</p>
<p>
                 The DNSKEY record for this key would be:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
example.net.    3600  IN  DNSKEY  (256 3 9 AwEAAfA7vWBxMBTYzuYhvY66z
                cisEbOZgMyYFwa42wOPUfxEliSsOnhx132WsZz/oFYWQQ5qsDQ/0
                hcKxJDeS8h9x2fv3fxAlvr0/C8aa6n4Wk38UJFeDhY8P4pLk3ATK
                FCGH4TtTVTwXB9Zlod+A1prunnncxyG3XjWZyJFkr+JrnIb
                );{id = 28237 (zsk), size = 1024b}
</pre></div><p>

               
</p>
<p>
                 With this key, sign the following RRSet, consisting
                 of 1 A record:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
www.example.net. 3600  IN  A  123.123.123.123
</pre></div><p>

               
</p>
<p>
                 If the inception date is set at 00:00 hours on January 1st, 2000, and the expiration date at 00:00 hours on January 1st, 2030, the following signature should be created:
                 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
www.example.net. 3600  IN  RRSIG  (A 9 3 3600 20300101000000
                 20000101000000 28237 example.net. mCanSdkQztEUOmslG
                 z7VvfkKPMp4ftz3K1PTf2jdla4vUu/tRE585xymurMB+wXhrFcK
                 dhm0egnPq8X/gmm0cmui/GQwFT5hmP5bL1ETuQsM3HOu3j9E3tq
                 4sFWIsUv3N6ohpYEbhj5jk0b/01EMUPM9y5rLzFHmYYujzKQwqu
                 M= );{id = 28237}
</pre></div><p>

               
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
                   This document updates the IANA registry "DNS SECURITY ALGORITHM
                   NUMBERS -- per <a class='info' href='#RFC4035'>[RFC4035]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> "
                   (http://www.iana.org/assignments/dns-sec-alg-numbers).
                   The following entries are added to the registry:
               
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          Zone  Trans.
 Value   Description       Mnemonic    Signing    Sec.   References
{TBA1}   RSA/SHA-256      RSASHA256          y      *   {this memo}
{TBA2}   RSA/SHA-512      RSASHA512          y      *   {this memo}

* There has been no determination of standardization of the use of this
  algorithm with Transaction Security.
</pre></div>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<a name="security_sha1_vs_sha2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
SHA-1
                versus SHA-2 Considerations for RRSIG Resource Records</h3>

<p>
                        Users of DNSSEC are encouraged to deploy SHA-2 as
                        soon as software implementations allow for it.
                        SHA-2 is widely believed to be more resilient
                        to attack than SHA-1, and confidence in SHA-1's
                        strength is being eroded by recently-announced
                        attacks.  Regardless of whether or not the attacks
                        on SHA-1 will affect DNSSEC, it is believed
                        (at the time of this writing) that SHA-2 is the
                        better choice for use in DNSSEC records.
                   
</p>
<p>
                        SHA-2 is considered sufficiently strong for the
                        immediate future, but predictions about future
                        development in cryptography and cryptanalysis
                        are beyond the scope of this document.
                   
</p>
<p>
                     The signature scheme RSASSA-PKCS1-v1_5 is chosen to
                     match the one used for RSA/SHA-1 signatures. This
                     should ease implementation of the new hashing
                     algorithms in DNSSEC software.
                   
</p>
<a name="downgrade_attacks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Signature Type Downgrade Attacks</h3>

<p>
                        Since each RRSet MUST be signed with each
                        algorithm present in the DNSKEY RRSet at the
                        zone apex (see <a class='info' href='#RFC4035'>[RFC4035]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> Section
                        2.2), a malicious party cannot filter out the
                        RSA/SHA-2 RRSIG, and force the validator to use
                        the RSA/SHA-1 signature if both are present in
                        the zone. This should provide resilience against
                        algorithm downgrade attacks, if the validator
                        supports RSA/SHA-2.
                    
</p>
<a name="acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgments</h3>

<p>
                   This document is a minor extension to RFC 4034
                   <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>. Also, we try to follow
                   the documents RFC 3110 <a class='info' href='#RFC3110'>[RFC3110]<span> (</span><span class='info'>Eastlake, D., &ldquo;RSA/SHA-1 SIGs and RSA KEYs in the Domain Name System (DNS),&rdquo; May&nbsp;2001.</span><span>)</span></a> and
                   RFC 4509 <a class='info' href='#RFC4509'>[RFC4509]<span> (</span><span class='info'>Hardaker, W., &ldquo;Use of SHA-256 in DNSSEC Delegation Signer (DS) Resource Records (RRs),&rdquo; May&nbsp;2006.</span><span>)</span></a> for consistency.
                   The authors of and contributors to these documents
                   are gratefully acknowledged for their hard work.
                
</p>
<p>
                   The following people provided additional feedback
                   and text: Jaap Akkerhuis, Mark Andrews, Roy Arends, Rob Austein,
                   Francis Dupont, Miek Gieben, Alfred Hoenes,
                   Paul Hoffman, Peter Koch, Michael St. Johns,
                   Scott Rose and Wouter Wijngaards.
                
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.180-3.2008">[FIPS.180-3.2008]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; FIPS&nbsp;PUB 180-3, October&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3110">[RFC3110]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc3110">RSA/SHA-1 SIGs and RSA KEYs in the Domain Name System (DNS)</a>,&rdquo; RFC&nbsp;3110, May&nbsp;2001 (<a href="ftp://ftp.isi.edu/in-notes/rfc3110.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4035">[RFC4035]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4035, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4035.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="NIST800-57">[NIST800-57]</a></td>
<td class="author-text">Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendations for Key Management,&rdquo; NIST SP&nbsp;800-57, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4509">[RFC4509]</a></td>
<td class="author-text">Hardaker, W., &ldquo;<a href="http://tools.ietf.org/html/rfc4509">Use of SHA-256 in DNSSEC Delegation Signer (DS) Resource Records (RRs)</a>,&rdquo; RFC&nbsp;4509, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4059.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5155">[RFC5155]</a></td>
<td class="author-text">Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;<a href="http://tools.ietf.org/html/rfc5155">DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</a>,&rdquo; RFC&nbsp;5155, March&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5155.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jelte Jansen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NLnet Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kruislaan 419</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Amsterdam  1098VA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NL</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jelte@NLnetLabs.nl">jelte@NLnetLabs.nl</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.nlnetlabs.nl/">http://www.nlnetlabs.nl/</a></td></tr>
</table>
</body></html>
