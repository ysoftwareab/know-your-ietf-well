


Internet Engineering Task Force                                 M. Menth
Internet-Draft                                              F. Lehrieder
Expires: January 5, 2009                         University of Wuerzburg
                                                            July 4, 2008


             Performance Evaluation of PCN-Based Algorithms
                     draft-menth-pcn-performance-03

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 5, 2009.

Copyright Notice

   Copyright (C) The IETF Trust (2008).














Menth & Lehrieder        Expires January 5, 2009                [Page 1]

Internet-Draft         PCN Performance Evaluation              July 2008


Abstract

   This document presents a summary of performance studies for PCN-based
   admission control and flow termination.  The numerical results were
   obtained by simulation or mathematical analysis.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  6
   3.  Comparison of Marking Algorithms for PCN-Based Admission
       Control  . . . . . . . . . . . . . . . . . . . . . . . . . . .  7
     3.1.  Definition of Simulated Entities and Simulation Setup  . .  7
       3.1.1.  Metering and Marking Mechanisms  . . . . . . . . . . .  7
       3.1.2.  Congestion Level Estimator . . . . . . . . . . . . . .  7
       3.1.3.  Simulation Setup . . . . . . . . . . . . . . . . . . .  8
     3.2.  Impact of the Marking Threshold T and the Queue Size S . .  9
     3.3.  Two Marking Strategies with Different Admission
           Control Policies . . . . . . . . . . . . . . . . . . . . .  9
       3.3.1.  Marking with Clear Decisions (MCD) . . . . . . . . . .  9
       3.3.2.  Marking with Early Warning (MEW) . . . . . . . . . . .  9
     3.4.  Impact of Ramp Marking . . . . . . . . . . . . . . . . . .  9
     3.5.  Impact of the Memory M of the Congestion Level
           Estimator  . . . . . . . . . . . . . . . . . . . . . . . . 10
     3.6.  Impact of Traffic Characteristics  . . . . . . . . . . . . 10
     3.7.  Response Time of the Marking to Sudden Overload  . . . . . 11
     3.8.  Conclusion . . . . . . . . . . . . . . . . . . . . . . . . 11
   4.  Performance Evaluation of Admission Control Methods  . . . . . 13
     4.1.  PBAC . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
     4.2.  OBAC . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
     4.3.  CLEBAC . . . . . . . . . . . . . . . . . . . . . . . . . . 14
     4.4.  Other Observations . . . . . . . . . . . . . . . . . . . . 14
   5.  Performance Evaluation of Measured Rate Termination (MRT)  . . 15
     5.1.  Two Options for MRT  . . . . . . . . . . . . . . . . . . . 15
       5.1.1.  Direct MRT . . . . . . . . . . . . . . . . . . . . . . 15
       5.1.2.  Indirect MRT . . . . . . . . . . . . . . . . . . . . . 15
     5.2.  Impact of Packet Loss  . . . . . . . . . . . . . . . . . . 16
       5.2.1.  Direct MRT under Lose & Mark . . . . . . . . . . . . . 16
       5.2.2.  Indirect MRT under Lose & Mark . . . . . . . . . . . . 16
       5.2.3.  Direct MRT under Mark & Lose . . . . . . . . . . . . . 16
       5.2.4.  Indirect MRT under Mark & Lose . . . . . . . . . . . . 17
       5.2.5.  Summary  . . . . . . . . . . . . . . . . . . . . . . . 17
     5.3.  Unintended Traffic Termination with Indirect MRT
           through Badly Aligned Measurement Intervals  . . . . . . . 17
       5.3.1.  Experiments with Almost CBR Traffic  . . . . . . . . . 18
       5.3.2.  Experiments with VBR Traffic . . . . . . . . . . . . . 18
       5.3.3.  Experiments with On/Off Traffic  . . . . . . . . . . . 18



Menth & Lehrieder        Expires January 5, 2009                [Page 2]

Internet-Draft         PCN Performance Evaluation              July 2008


       5.3.4.  Experiments with Rerouted Traffic  . . . . . . . . . . 19
       5.3.5.  Summary  . . . . . . . . . . . . . . . . . . . . . . . 19
   6.  Performance Evaluation of Marked Flow Termination  . . . . . . 20
     6.1.  CMFT . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
     6.2.  Flow-based EMFT (F-EMFT) . . . . . . . . . . . . . . . . . 21
     6.3.  Aggregate-based EMFT (A-EMFT)  . . . . . . . . . . . . . . 21
     6.4.  General Performance of MFT Methods . . . . . . . . . . . . 22
     6.5.  Comparison of CMFT, F-EMFT, and A-EMFT . . . . . . . . . . 22
       6.5.1.  Key Benefits of MFT  . . . . . . . . . . . . . . . . . 22
       6.5.2.  Unknown Traffic Characteristics  . . . . . . . . . . . 23
       6.5.3.  Implementation and Configuration Complexity  . . . . . 23
       6.5.4.  Fairness Issues  . . . . . . . . . . . . . . . . . . . 23
       6.5.5.  Termination Priorities and Policies  . . . . . . . . . 24
       6.5.6.  Marking Support from Simple ECN Nodes  . . . . . . . . 24
       6.5.7.  Compatibility with Existing Hardware . . . . . . . . . 24
   7.  Performance Evaluation of Marked Flow Termination (MFT)
       with Multiple Bottleneck Links . . . . . . . . . . . . . . . . 25
     7.1.  Several Serial Links Carrying Only a Common Aggregate  . . 25
     7.2.  Two Serial Links Carrying a Common Aggregate with
           Cross Traffic on the Second Link . . . . . . . . . . . . . 26
     7.3.  Two Serial Links Carrying a Common Aggregate with
           Cross Traffic on the First Link  . . . . . . . . . . . . . 26
     7.4.  Two Serial Links Carrying a Common Aggregate with
           Cross Traffic on Both Links  . . . . . . . . . . . . . . . 27
     7.5.  Summary  . . . . . . . . . . . . . . . . . . . . . . . . . 28
   8.  Performance Evaluation of a Marking Converter for Excess
       Marking  . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
     8.1.  Simulation Setup . . . . . . . . . . . . . . . . . . . . . 29
     8.2.  Results  . . . . . . . . . . . . . . . . . . . . . . . . . 29
   9.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 31
   10. Security Considerations  . . . . . . . . . . . . . . . . . . . 32
   11. Changes from Previous Revisions  . . . . . . . . . . . . . . . 33
     11.1. Changes from Version -00 to Version -01  . . . . . . . . . 33
     11.2. Changes from Version -01 to Version -02  . . . . . . . . . 33
     11.3. Changes from Version -02 to Version -03  . . . . . . . . . 33
   12. References . . . . . . . . . . . . . . . . . . . . . . . . . . 34
     12.1. Normative References . . . . . . . . . . . . . . . . . . . 34
     12.2. Informative References . . . . . . . . . . . . . . . . . . 34
     12.3. Other References . . . . . . . . . . . . . . . . . . . . . 34
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 36
   Intellectual Property and Copyright Statements . . . . . . . . . . 37










Menth & Lehrieder        Expires January 5, 2009                [Page 3]

Internet-Draft         PCN Performance Evaluation              July 2008


1.  Introduction

   Pre-congestion notification (PCN) is based on the idea of marking
   packets when a certain load threshold on a link is exceeded by PCN
   traffic.  Then, the marking of a packet at the PCN egress node
   provides information whether the rate threshold of at least one link
   of the path over which the packet was carried was exceeded by PCN
   traffic.  This information can be used for admission control and flow
   termination.  Several approaches such as Single-Marking (SM)
   [I-D.charny-pcn-single-marking], CL
   [I-D.briscoe-tsvwg-cl-architecture], 3SM [I-D.babiarz-pcn-3sm], EMFT
   [I-D.menth-pcn-emft] have been proposed for that purpose.  An
   overview of the basic concept is given in
   [I-D.ietf-pcn-architecture].

   The University of Wuerzburg is conducting performance studies to
   understand basic mechanisms and to compare different approaches.
   This document is intended to collect and present summaries of
   performance results documented in more detail in technical papers
   that are available online.  Currently, it covers the following
   studies.

   o  A summary of the results of [TR437] is presented in Section 3.
      [TR437] studies the impact of virtual queue (token bucket)
      parameters on marking results for threshold and ramp marking and
      gives a comparison.

   o  A summary of the results in [Menth08-AC] regarding admission
      control methods is presented in Section 4.

   o  A summary of the results in [Menth07] regarding "Performance
      Evaluation of Measured Rate Termination (MRT)" is presented in
      Section 5.

   o  A summary of the results in [Menth08-MFT] regarding "Performance
      Evaluation of Marked Flow Termination (MFT) on a Single Link" is
      presented in Section 6.

   o  A summary of the results in [Menth07] regarding "Performance
      Evaluation of Marked Flow Termination (MFT) with Multiple
      Bottleneck Links" is presented in Section 7.

   o  A summary of our simulation results regarding the marking
      converter proposed in [I-D.menth-pcn-marking-converter] is
      presented in Section 8.

   The next section clarifies some terminology issues.




Menth & Lehrieder        Expires January 5, 2009                [Page 4]

Internet-Draft         PCN Performance Evaluation              July 2008


   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].
















































Menth & Lehrieder        Expires January 5, 2009                [Page 5]

Internet-Draft         PCN Performance Evaluation              July 2008


2.  Terminology

   The terminology used in this document conforms to the topology of
   [I-D.ietf-pcn-architecture].

   We use the following exceptions for better readability and provide
   the synonyms defined in [I-D.ietf-pcn-architecture].

   o  Admissible rate: PCN-lower-rate

   o  Supportable rate: PCN-upper-rate

   o  Admission-stop marking: first encoding or PCN-lower-rate-marking

   o  Excess-traffic marking: second encoding or PCN-upper-rate-marking




































Menth & Lehrieder        Expires January 5, 2009                [Page 6]

Internet-Draft         PCN Performance Evaluation              July 2008


3.  Comparison of Marking Algorithms for PCN-Based Admission Control

   The following presents a short summary of [TR437] without the graphs
   and exact numerical results that are provided in the technical
   report.  The interested reader is referred to that document.

3.1.  Definition of Simulated Entities and Simulation Setup

   In this study, we investigate the behaviour of different metering and
   marking algorithms under different configuration and use a congestion
   level estimator to observe the packet markings.

3.1.1.  Metering and Marking Mechanisms

   PCN requires metering and marking algorithms in the interior nodes.
   [TR437] defines

   o  threshold marking and

   o  ramp marking

   based on a virtual queue (VQ), but there are equivalent descriptions
   based on token buckets.

   The parameters are

   o  the size S of the VQ,

   o  the rate R of the VQ,

   o  the marking threshold T for threshold marking, which is also the
      upper threshold for ramp marking,

   o  the marking threshold T_ramp, which is the lower threshold for
      ramp marking

3.1.2.  Congestion Level Estimator

   Furthermore, a congestion level estimator is defined that calculates
   a congestion level estimate (CLE) at the PCN egress node based on an
   exponentially weighted moving average (EWMA).  Marked packets count 1
   and unmarked packets count 0.  The CLE is computed as

   CLE = w o CLE + (1 - w) o X

   where X is the observed packet marking and w<1 is the weight
   parameter.  If w is large, CLE has a long memory M, if it is low, CLE
   has a short memory M. The time between CLE updates also influences



Menth & Lehrieder        Expires January 5, 2009                [Page 7]

Internet-Draft         PCN Performance Evaluation              July 2008


   the memory M. A formal definition of the memory M is given in 3.4.2
   of [TR437].  The CLE is used to observe the packet markings of the
   simulations.

3.1.3.  Simulation Setup

   We simulate a single link scenario.  Packets from n independent,
   homogeneous traffic sources are multiplexed onto a single link with
   infinite bandwidth and pass a meter and marker.  The markings are
   evaluated by a subsequent congestion level estimator.

   If not mentioned differently, we simulate around n = 100 homogeneous
   flows for sufficiently long time to obtain reliable results.
   However, we omit confidence intervals in all our graphs for the sake
   of clarity.  We choose a Gamma distribution to generate the inter-
   arrival times A between consecutive packets within a flow with a mean
   of E[A] = 20 ms and a coefficient of variation of cvar[A] = 0.1.  The
   packet sizes B are independent and distributed according to a
   deterministic phase of 30 bytes plus a negative binomial
   distribution.  Their overall mean is E[B] = 60 bytes and their
   coefficient of variation is cvar[B] = 0.5.  The values for E[A] and
   E[B] are motivated by typical voice connections that periodically
   send every 20 ms a packet with 20 bytes payload using a 40 bytes IP/
   UDP/RTP header.  However, our flow model is not periodic and has
   variable packet sizes.  We use it for two reasons.  The simulation of
   multiplexed, strictly periodic traffic requires special care due to
   the non-ergodicity of the system and is very time consuming.
   Therefore, we relax cvar[A] = 0.0 to cvar[A] = 0.1.  Furthermore, we
   use cvar[B] = 0.5 instead of cvar[B] = 0.0 because realtime traffic
   consists of packets from different applications with and without
   compression which leads to different packet sizes.

   However, our findings are general and do not depend on special
   parameter settings.  The rate of the virtual queue is R = 2.4 Mbit/s
   such that at most 100 flows can pass unmarked.  The congestion level
   estimator implements an exponentially weighted moving average (EWMA)
   and counts packets with admission-stop marks as 1 and those without
   as 0.  As mentioned previously, its memory M depends on the packet
   rate and the weight parameter w such that w needs to be adapted to
   the desired M and the packet frequency in the experiment for which we
   take the maximum packet rate that can pass unmarked.  Thus, we set
   the weight parameter to w = 0.998 which corresponds to a memory of
   0.1 s when 100 default flows are active.  If the packet rate changes
   due to more bursty traffic, we adapt the weight parameter w to
   achieve the same memory.






Menth & Lehrieder        Expires January 5, 2009                [Page 8]

Internet-Draft         PCN Performance Evaluation              July 2008


3.2.  Impact of the Marking Threshold T and the Queue Size S

   We measure the percentage of marked packets depending on the PCN rate
   (number of flows n) and the queue parameters size S and marking
   threshold T. The ideal marker marks

   1.  no packets if the PCN rate is below the VQ rate R and

   2.  all packets if it is above.

   We found out that

   1.  is increasingly achieved with increasing threshold T and

   2.  is increasingly achieved with increasing remaining queue size
       S-T.

3.3.  Two Marking Strategies with Different Admission Control Policies

   We construct threshold markers with two different CLE characteristics
   (=function describing the percentage of marked packets depending on
   PCN rate).

3.3.1.  Marking with Clear Decisions (MCD)

   Marking with clear decisions (MCD) means that the above objectives
   (1) and (2) are well achieved.  This can be obtained for threshold
   marking with a large marking threshold T and a large remaining queue
   size S - T. Then, hardly any fluctuations in marking are observed.

3.3.2.  Marking with Early Warning (MEW)

   Marking with early warning (MEW) means that (3) the percentage of
   marked packets already increases when the PCN rate approaches the VQ
   rate and (4) is 100% when the PCN rate is above the VQ rate.  This
   can be obtained for threshold marking with a small marking threshold
   T and a large remaining queue size S - T.

3.4.  Impact of Ramp Marking

   Ramp marking already marks packets probabilistically if the virtual
   queue length is below the marking threshold T. Therefore, it marks
   more packets than threshold marking with the same marking threshold T
   and queue size S. In our study we always set the lower marking
   threshold to T_ramp = 0.  We found out that ramp marking with this
   configuration cannot achieve MCD because it marks a small percentage
   of packets when the PCN rate is below the VQ rate, but it can well
   achieve MEW.  MEW can be achieved both with threshold and ramp



Menth & Lehrieder        Expires January 5, 2009                [Page 9]

Internet-Draft         PCN Performance Evaluation              July 2008


   marking, but threshold marking requires a smaller threshold parameter
   T to get the same marking results as with ramp marking.

3.5.  Impact of the Memory M of the Congestion Level Estimator

   The memory M of the congestion level estimator does not have an
   impact on the percentage of marked packets that were observed over
   the simulation time, but it impacts the degree to which the CLE
   fluctuates.  If the memory is long, the fluctuation of CLE is small.
   If the memory M is short, the fluctuation of CLE is large.  When we
   configure the queue for MCD, i.e., the threshold T and the remaining
   queue size S-T were chosen sufficiently large, the CLE is almost 0
   for PCN rates smaller than the VQ rate and it is 1 for PCN rates
   larger than the VQ rate.  This holds even for a very small memory M
   of the congestion level estimator.

3.6.  Impact of Traffic Characteristics

   Traffic characteristics have a significant impact on the marking
   result.

   o  Decreased variance of packet sizes: no impact on the CLE
      characteristics in case of MCD, slightly lower curves in case of
      MEW

   o  Increased variance of packet sizes: little impact on the CLE
      characteristics in case of MCD, significantly higher curves in
      case of MEW and larger fluctuation of CLE

   o  Increased aggregation level: no impact on the CLE characteristics
      in case of MCD, slightly higher curves in case of MEW and less
      fluctuation of CLE

   o  Increased variance of inter-arrival times: little impact on the
      CLE characteristics in case of MCD, slightly higher curves in case
      of MEW and larger fluctuation of CLE

   o  Increased burstiness (fewer but larger packets): little impact on
      the CLE characteristics in case of MCD, significantly higher
      curves in case of MEW and large fluctuations of CLE

   o  On/off traffic instead of continuous flows: large impact on the
      CLE characteristics in case of MCD and MEW, in particular very
      large fluctuations of the CLE







Menth & Lehrieder        Expires January 5, 2009               [Page 10]

Internet-Draft         PCN Performance Evaluation              July 2008


3.7.  Response Time of the Marking to Sudden Overload

   Large marking thresholds T and remaining queue sizes S-T lead to
   stable marking results for MCD, but large parameters slow down the
   reaction time of the marker when the PCN rate exceeds the VQ rate.

3.8.  Conclusion

   One option for pre-congestion notification (PCN) based admission
   control requires that all packets are marked if the current link rate
   exceeds a pre-configured admissible rate.  This can be achieved by
   virtual queue based marking algorithms such as simple threshold
   marking or more complex ramp marking.

   The objective of [TR437] was to study how marking algorithms can
   support admission control in order to limit the utilization of the
   links of a network.  We did not consider the use of marking
   algorithms to support admission control in order to limit the packet
   delay because we assume that PCN will be used in high-speed networks
   where packet delay caused by queuing is negligible as long as link
   utilizations are moderate.

   We investigated the influence of the parameters of the marking
   algorithms on their marking results which are translated into a
   congestion level estimate (CLE) using EWMA-based averaging.  We
   showed that two different marking strategies can be pursued: marking
   such that the CLE leads to clear decisions (MCD) and marking such
   that the CLE yields early warning (MEW) when the rate of PCN traffic
   on a link approaches its admissible rate.  We provided
   recommendations for the configuration of the marking threshold T and
   the size S of the virtual queue in both cases.  Ramp marking
   increases the level of early warning compared to threshold marking,
   but this can be approximated by smaller marking thresholds for simple
   threshold marking such that there is no obvious need for ramp
   marking.

   The CLE values for MEW fluctuate, therefore, it is difficult to infer
   the exact, current traffic rate from the CLE values which is required
   to take advantage of early warning.  A sensitivity study revealed
   that the average CLE values for MEW depend heavily on the traffic
   characteristics.  This makes the use of early warning difficult:
   either the marking parameters need to be adapted to produce similar
   warnings for different traffic types or the mechanism taking early
   warning into account requires knowledge about the traffic
   characteristics to correctly interpret the CLE level.  In contrast,
   CLE values for MCD show hardly any variation and are robust against
   different traffic types.




Menth & Lehrieder        Expires January 5, 2009               [Page 11]

Internet-Draft         PCN Performance Evaluation              July 2008


   For the sake of simplicity, we advocate for the use of MCD for PCN
   based admission control instead of MEW because the interpretation of
   early warning is difficult due to its high variation and dependency
   on traffic characteristics.  Furthermore, we think that ramp marking
   is not needed for PCN since similar markings can be obtained by
   appropriately configured threshold marking and we do not see any
   benefit that justifies the implementation complexity of ramp marking.












































Menth & Lehrieder        Expires January 5, 2009               [Page 12]

Internet-Draft         PCN Performance Evaluation              July 2008


4.  Performance Evaluation of Admission Control Methods

   Two marking methods have been proposed to support admission control:
   excess marking and exhaustive marking.  Excess marking marks only
   those packets that exceed the admissible threshold while exhaustive
   marking marks all packets when the admissible threshold is exceeded.

   Three methods have been discussed to evaluate the markings and
   translate them into admission control decisions: probe-based
   admission control (PBAC, 3sm), observation-based admission control
   (OBAC, 3sm), and CLE-based admission control (CLEBAC, 3sm, SM, CL).
   PBAC sends probe packets for a prospective flow through the network
   and admits the flow if all probe packets are received unmarked at the
   PCN egress node.  OBAC and CLEBAC use the concept of ingress-egress
   aggregates (IEAs).  OBAC stops admission of further flows for a
   specific aggregate when the PCN egress node has received a marked
   packet for the IEA while CLEBAC stops only when the fraction of
   marked packets in the IEA was high enough.

   We have investigated the combination of all marking and AC algorithms
   and provide high-level results.  The details can be found in
   [Menth08-AC].

4.1.  PBAC

   PBAC has only one configuration parameter which is the number of
   probe packets that are sent upon admission request of a flow.  In
   combination with exhaustive marking, a single probe packet is enough
   for a reliable admission decision.  In combination with excess
   marking, many probe packets (about 100) are required.  The exact
   number depends on the overload and the tolerable error probability.

4.2.  OBAC

   OBAC also has only one configuration parameter.  It is the minimum
   block duration, i.e. the minimum time the IEA stays blocking after
   its PCN egress node observed the last marked packet.  With excess
   marking OBAC starts blocking when the current rate is slightly above
   the admissible rate.  This effect becomes clearer for more bursty
   traffic.  We recommend a minimum block duration of 200 ms because
   smaller values lead to fast oscillations of the IEA between blocking
   and accepting state.  With exhaustive marking, OBAC already blocks
   when the PCN traffic rate is close to the admissible rate and the
   blocking behaviour is rather independent of the minimum block
   duration.






Menth & Lehrieder        Expires January 5, 2009               [Page 13]

Internet-Draft         PCN Performance Evaluation              July 2008


4.3.  CLEBAC

   CLEBAC measures the fraction of marked bytes over a measurement
   interval and this fraction is called the congestion level estimate
   (CLE).  CLEBAC has three configuration parameters.  The duration of
   the measurement interval over which the CLE is computed, the
   admission-continue, and the admission-stop CLE threshold.  For excess
   marking, the duration of the measurement interval should be at least
   200 ms to avoid oscillations of the block/admit state of the IEA.
   The IEA blocks when the PCN rate is above the admissible rate and
   late blocking increases with increasing admission-stop threshold.
   Also more bursty traffic increases late blocking.  An admission-
   continue threshold of 0 shows good blocking results.  With exhaustive
   marking, the blocking behaviour of CLEBAC is rather independent of
   the admission-continue and admission-stop thresholds and small
   measurement intervals of 50 ms can be used without leading to strong
   oscillations of the admit/block state of an IEA.

4.4.  Other Observations

   With normal excess marking, the marking probability of a packet
   increases with its size in case of overload.  The average packet
   marking probability decreases with increasing variance of the packet
   size.  Large packets are more likely to be marked than small packets
   and when marked packets tend to be large, excess marking marks fewer
   packets.  Therefore, it is important that CLE is based on bytes and
   not on packet numbers.
























Menth & Lehrieder        Expires January 5, 2009               [Page 14]

Internet-Draft         PCN Performance Evaluation              July 2008


5.  Performance Evaluation of Measured Rate Termination (MRT)

   Measured rate termination (MRT) assumes that PCN interior nodes mark
   packets with "excess-traffic" (ET) when they exceed the supportable
   rate (SR) of a link with some tolerance.  This marking is explained
   in [I-D.babiarz-pcn-3sm] and used in the CL architecture
   [I-D.briscoe-tsvwg-cl-architecture].  The PCN egress node measures
   the rate of marked and unmarked packets and communicates them to the
   PCN ingress node.  Based on this information, the PCN ingress node
   calculates the rate that needs to be terminated and chooses an
   appropriate set of flows for termination.  This is not a trivial task
   since the rate of the flows are possibly unknown, but we do not
   further study this issue.  There are two options for MRT: direct and
   indirect MRT.

5.1.  Two Options for MRT

5.1.1.  Direct MRT

   The PCN egress node measures the rate of ET-marked packets per
   ingress-egress aggregate.  If this excess traffic rate (ETR) is
   larger than zero, the PCN egress node communicates it to the
   corresponding PCN ingress node using a "traffic-reduction" message.
   Then, the PCN ingress node terminates sufficiently many flows to
   achieve a reduction of that rate.  A minimum interval, a so-called
   inter-termination time, is required between consecutive rate-
   reduction messages because it takes some time until the effect of the
   previous termination action becomes visible in the measured rate of
   ET-marked traffic at the PCN egress node.  Direct MRT is used as a
   non-standard option to terminate traffic in the E3Tunnel deployment
   model of 3sm [I-D.babiarz-pcn-3sm].

5.1.2.  Indirect MRT

   The marking is again the same as in the CL architecture.  In contrast
   to direct MRT, with indirect MRT the PCN egress node measures the
   rate of traffic that is not marked with ET (nETR) per ingress-egress-
   aggregate.  This is the so-called sustainable rate and the PCN egress
   node immediately sends it to the PCN ingress node.  The PCN ingress
   node measures the rate of traffic to be transmitted per ingress-
   egress aggregate, the so-called ingress rate (IR).  When the PCN
   ingress node receives the sustainable rate from the PCN egress node,
   it calculates the difference between the timely corresponding ingress
   rate and sustainable rate.  This difference is positive if traffic
   had been ET-marked because then the ingress rate is larger than the
   sustainable rate.  If the difference is positive, it is used as an
   estimate for the traffic that should be terminated.  Indirect MRT is
   used as the preferred option in [I-D.briscoe-tsvwg-cl-architecture].



Menth & Lehrieder        Expires January 5, 2009               [Page 15]

Internet-Draft         PCN Performance Evaluation              July 2008


5.2.  Impact of Packet Loss

   Packet loss has an impact on the rate of marked and unmarked packets
   received by the PCN egress node.  In addition, the fraction of marked
   and unmarked packets depends on whether packets are first lost or
   marked.  We illustrate this issue on a link with 8 Mbit/s and its
   supportable rate being set to 4 Mbit/s.  Due to a reroute or some
   other reason, the link is suddenly confronted with a traffic rate of
   16 Mbit/s.  We consider the behaviour of direct and indirect MRT
   under the conditions that traffic is first lost and then marked (L&M)
   or first marked and then lost (M&R).

5.2.1.  Direct MRT under Lose & Mark

   Under L&M, 8 Mbit/s are lost. 4 Mibt/s out of the remaining 8 Mbit/s
   are AS-marked and the remaining 4 Mbit/s are ET-marked.  As a
   consequence, 4 Mbit/s are terminated such that 12 Mbit/s will remain
   for the next round.  Then, 4 Mbit/s are lost. 4 Mibt/s out of the
   remaining 8 Mbit/s are AS-marked and the remaining 4 Mbit/s are ET-
   marked.  As a consequence, 4 Mbit/s are terminated such that 8 Mbit/s
   will remain for the next round.  Then, no traffic is lost anymore,
   but out of the 8 Mbit/s 4 Mbit/s are AS-marked and the remaining 4
   Mbit/s are ET-marked.  When these 4 Mbit/s have been terminated,
   there is no overload anymore.

5.2.2.  Indirect MRT under Lose & Mark

   Under L&M, 8 Mbit/s are lost. 4 Mibt/s out of the remaining 8 Mbit/s
   are AS-marked and the remaining 4 Mbit/s are ET-marked.  As a
   consequence, there is a sustainable rate of 4 Mbit/s such that 12
   Mbit/s are terminated.  Thus, the overload is already removed after a
   single termination step.

5.2.3.  Direct MRT under Mark & Lose

   Under M&L, 4 Mbit/s out of the initial 16 Mbit/s are AS-marked and
   the remaining 12 Mbit/s are ET-marked.  Then, 8/16 of the traffic is
   lost such that 6 Mbit/s arrive with ET-marks.  After 6 Mbit/s are
   terminated, the system is still confronted with a load of 10Mbit/s
   out of which 4Mbit/s are AS-marked and the remaining 6 Mbit/s are ET-
   marked.  Then, 2/10 of the traffic is lost such that 5.2 Mbit/s
   arrive with ET-marks.  After 5.2 Mbit/s are terminated, the system is
   confronted with a load of 4.8 Mbit/s out of which 4 Mibt/s are AS-
   marked and the remaining 0.8 Mbit/s are ET-marked.  As no loss occurs
   anymore, these 0.8 Mbit/s are terminated such that there is no
   overload anymore.





Menth & Lehrieder        Expires January 5, 2009               [Page 16]

Internet-Draft         PCN Performance Evaluation              July 2008


5.2.4.  Indirect MRT under Mark & Lose

   Under M&L, 4 Mbit/s out of the initial 16 Mbit/s are AS-marked and
   the remaining 12 Mbit/s are ET-marked.  Then, 8/16 of the traffic is
   lost such that 6 Mbit/s arrive with ET-marks.  As a consequence,
   there is a sustainable rate of 2 Mbit/s such that 14 Mbit/s are
   terminated.  Thus, the overload is already removed after a single
   termination step, but with a substantial amount of overtermination.

5.2.5.  Summary

   Table 2 summarizes the termination behavior of direct and indirectMRT
   under L&M and M&L conditions.  With indirectMRT, sudden SR-overload
   is removed after a single termination step while for direct MRT, the
   removal of SR-overload requires several termination steps.  When
   packet loss occurs before packets are marked by the meter and marker,
   indirect MRT works well.  However, when packets are metered and
   marked before they are lost, then indirectMRT can lead to substantial
   overtermination.

   Table 2: Impact of the order of packet marking and loss on the
   termination behavior with direct and indirect MRT.
   +-----------------------------------------------------------------+
   |       Time      | Lose&Mark | Lose&Mark | Mark&Lose | Mark&Lose |
   |                 | Direct MRT| Ind. MRT  | Direct MRT| Ind. MRT  |
   +-----------------------------------------------------------------+
   |Start of overload|16.0 Mbit/s|16.0 Mbit/s|16.0 Mbit/s|16.0 Mbit/s|
   |After 1st term.  |12.0 Mbit/s| 4.0 Mbit/s|10.0 Mbit/s| 2.0 Mbit/s|
   |After 2nd term.  | 8.0 Mbit/s| 4.0 Mbit/s| 5.2 Mbit/s| 2.0 Mbit/s|
   |After 3rd term.  | 4.0 Mbit/s| 4.0 Mbit/s| 4.0 Mbit/s| 2.0 Mbit/s|
   +-----------------------------------------------------------------+

5.3.  Unintended Traffic Termination with Indirect MRT through Badly
      Aligned Measurement Intervals

   Indirect MRT measures the rate of non-ET marked traffic (nETR) at the
   egress node and compares it with the rate of the PCN traffic at the
   ingress node (IR).  This implies that the same packets are measured
   in the corresponding measurement intervals which is hard to achieve.
   When the delay between PCN ingress and egress node is some fixed
   transmission delay X, the measurement interval at the PCN egress node
   needs to start X time later than the corresponding one at the PCN
   ingress node and it must have the same length to observe the same set
   of packets.  However, X is not exactly fixed due to queuing and other
   effects.  Therefore, exact alignment cannot be achieved.  This
   possibly leads to wrong rate differences when results from badly
   aligned measurement intervals are compared.  In this section, we
   investigate its impact as it can lead to unintended traffic



Menth & Lehrieder        Expires January 5, 2009               [Page 17]

Internet-Draft         PCN Performance Evaluation              July 2008


   termination.

   We use a measurement interval length of 100 ms and the misalignment
   is 50 ms such that the first packet in the measurement interval a the
   PCN egress is contained in the measurement interval at the PCN
   ingress.

5.3.1.  Experiments with Almost CBR Traffic

   First, we use exactly periodic constant bit rate (CBR) traffic and
   several variants of almost periodic or almost CBR traffic.  Those are
   CBR traffic with at most 1 ms uniformly distributed packet arrival
   delays and constant packet sizes, exactly periodic traffic with
   little variation in packet sizes (coefficient of variation cvar[B] =
   0.1), and almost periodic traffic with little variation in packet
   inter-arrival times (coefficient of variation cvar[A] = 0.1) and
   constant packet sizes.  We consider n = 200 flows and the supportable
   rate is set to infinity such that no packet is marked.  Experiments
   show that in case of exact periodicity and equal packet sizes, no
   flows are terminated.  This is different, when little variation is
   introduced where flows are continuously terminated without any packet
   being lost or ET-marked.

   To repair this, we enhance the indirect MRT method by the side
   condition, that flows are only terminated if a tolerance of Tf is
   exceeded.  This tolerance is usually given as a rate, but we think of
   it as a number of flows as we deal only with equal rate flows in this
   section.  Experiments show that a tolerance of T_f = 1 flow removes
   the unintended flow termination effect.

5.3.2.  Experiments with VBR Traffic

   We now conduct the same experiment with more variable traffic and
   study the impact of different tolerance values T_f on unintended
   traffic termination.  We performed experiments for exactly periodic
   flows having packet sizes with the same mean E[B] = 200 bytes but a
   coefficient of variation of cvar[B] = 0.5 and experiments for flows
   with constant packet sizes but inter-arrival times with the same mean
   E[A] = 20 ms but a coefficient of variation of cvar[A] = 0.5.  In
   both cases, a tolerance value of T_f = 1 flow cannot avoid unintended
   flow termination and even a tolerance of T_f = 5 flows cannot fully
   remove it.

5.3.3.  Experiments with On/Off Traffic

   We now look at on/off traffic, i.e. traffic sources have
   exponentially distributed on and off phases during which they send
   CBR traffic or are silent.  We performed experiments for mean phase



Menth & Lehrieder        Expires January 5, 2009               [Page 18]

Internet-Draft         PCN Performance Evaluation              July 2008


   durations of 0.5 s and 5 s, respectively.  Again, we see substantial
   unintended flow termination that is mitigated by an increasing
   tolerance value T_f.

5.3.4.  Experiments with Rerouted Traffic

   In the presence of network failures, large amounts of traffic are
   rerouted, i.e. shifted to other links.  The PCN ingress and egress
   nodes perform rate measurement using intervals of length of 100 ms
   starting at a global time of 0 s.  We simulate what happens in such a
   scenario at the PCN ingress node.  At time 50 ms a reroute of 8Mbit/s
   occurs at the PCN ingress node and after another 50 ms the traffic
   arrives at the PCN egress node.  At that time, the PCN egress node
   measures a sustainable rate of 0 Mbit/s for its first measurement
   interval and sends this value to the PCN ingress node.  At time 150
   ms this value arrives there and the PCN ingress node compares the
   ingress rate of 4 Mbit/s measured in the first measurement interval
   with the sustainable rate of 0 Mbit/s.  As a consequence, it
   terminates 4 Mbit/s.

5.3.5.  Summary

   The disadvantage of indirect MRT is that the measurement intervals at
   the PCN ingress and egress nodes require some timely alignment.
   Otherwise, unintended small positive differences can occur without
   any traffic being ET-marked or lost which results in unintended
   traffic termination.  Therefore, the traffic rate to be terminated
   needs to exceed a tolerance threshold $T_f$ before traffic is really
   terminated.  However, it turns out that the value of that threshold
   should increase with increasing traffic variability.  Moreover, in
   case of sudden extra traffic as it can occur with reroutes, a
   substantial fraction of the traffic can be terminated without any
   packets being ET-marked.


















Menth & Lehrieder        Expires January 5, 2009               [Page 19]

Internet-Draft         PCN Performance Evaluation              July 2008


6.  Performance Evaluation of Marked Flow Termination

   Marked flow termination (MFT) is used in 3sm [I-D.babiarz-pcn-3sm].
   In contrast to measured rate termination (MRT) it requires that the
   metering and marking algorithms in interior nodes mark only some of
   the traffic that exceeds the supportable rate.  This is done by
   adding a slowdown factor of "S" tokens to the bucket whenever a
   packet is marked with ET.  This is called marking frequency reduction
   (MFR).

6.1.  CMFT

   To work properly, CMFT should use packet size independent marking and
   proportional marking frequency reduction.  That means, the marker
   should add

   I_alpha=(2*E[DT]/E[A]-1)/alpha*B

   bytes to the token bucket of the marker to slow down the marking
   frequency.

   o  E[DT] is the average flow termination delay

   o  E[A] is the average interarrival time of packets within flows

   o  E[R] is the average flow rate

   o  B is the size of a packet

   As a result, one packet is marked for

   sigma_b= 2 *E[DT ] * E[R] / alpha

   bytes that were above the supportable rate during an overload period
   where the PCN rate exceeds the supportable rate.  The PCN edge nodes
   terminate all flows with at least one marked packet.  Performance
   studies showed the following results:

   o  alpha is the termination aggressiveness and controls the
      termination speed. alpha>1 leads to overtermination while alpha<1
      slows down the termination process.  It is a configuration
      parameter allowing to control the termination speed.

   o  The termination process is independent of packet sizes.

   o  The termination process depends on the average interarrival E[A]
      time of packets within flows.




Menth & Lehrieder        Expires January 5, 2009               [Page 20]

Internet-Draft         PCN Performance Evaluation              July 2008


   o  Flows with shorter interarrival times have a larger probability to
      be marked and terminated.

   o  The termination process also depends on the variance of
      interarrival times of different flows.

6.2.  Flow-based EMFT (F-EMFT)

   With F-EMFT, a PCN endpoint has a credit counter for each flow which
   is reduced by the size of arriving marked packets.  If a marked
   packet arrives and the credit counter is 0 or negative, the flow is
   terminated.  Performance studies showed the following results:

   o  The credit counter size should be initialized randomly according
      to an exponential distribution.  The average value should be set
      to sigma_b.

   o  The termination behaviour is independent of the packet
      interarrival time and the packet sizes of a flow.

   o  Stochastic flow termination priorities can be implemented by using
      different alpha for the initialization of the credit counters.

6.3.  Aggregate-based EMFT (A-EMFT)

   With A-EMFT, a PCN egress node has a credit counter for each IEA
   which is reduced by the size of arriving marked packets.  If a marked
   packet arrives and the credit counter is 0 or negative, the flow is
   terminated.  When a flow is terminated, an increment of sigma_b is
   added to the credit counter.  Performance studies showed the
   following results:

   o  The termination behaviour is rather independent of the number of
      flows within the IEA for 1, 10, 50, 200 tested flows.

   o  The termination behaviour is insensitive against packet
      interarrival times and packet sizes of flows.

   o  Flows with shorter packet interarrival times have larger marking
      and termination probabilities.

   o  Termination policies (e.g. "terminate all small/large flows first"
      and others) can be enforced stochastically by keeping a pool of
      flows that have recently been marked.  When a flow needs to be
      terminated, a flow of this pool can be chosen.  This works well
      when the number of flows in the IEA is large.





Menth & Lehrieder        Expires January 5, 2009               [Page 21]

Internet-Draft         PCN Performance Evaluation              July 2008


6.4.  General Performance of MFT Methods

   We consider the common performance of the 3 termination methods:
   CMFT, F-EMFT, A-EMFT.

   o  The termination process of all methods depends on the average
      termination delay E[DT] of flows.  If flows have different
      termination delays, their termination probability is still the
      same.

   o  The time to remove the overload increases with the overload
      intensity.  However, 100% more overload requires about E[DT] more
      time.  This holds for all considered methods.

   o  Statistical effects influence the termination behaviour of all
      three methods.  However, it is well predictable.  The behaviour of
      F-EMFT is more variable than the one of CMFT and A-EMFT.

   o  When a link is used by several IEA, about the same fraction of
      traffic should be terminated from each IEA.  We call this
      termination fairness among aggregates.  A-EMFT is visibly fairer
      than CMFT and F-EMFT.

   o  Impact of Traffic Characteristics: We studied the impact of
      strongly varying packet sizes and inter-arrival times, but they
      had a rather negligible impact on the termination behavior.  The
      same holds for on/off traffic with exponentially distributed on/
      off phase durations and for different average values of these
      durations.

6.5.  Comparison of CMFT, F-EMFT, and A-EMFT

   We highlight the key benefits of MFT and discuss the pros and cons of
   CMFT, F-EMFT, and A-EMFT under challenging conditions.

6.5.1.  Key Benefits of MFT

   MFT methods consecutively terminate only ET-marked flows.  This has
   several key advantages compared to measured rate termination (MRT) as
   suggested in the CL and SM proposal. (1) CMFT and F-EMFT do not
   require IEAs.  This is necessary for end-to-end PCN.  If IEAs are
   available, A-EMFT can take advantage of them. (2) MFT works well with
   multipath routing, i.e. when flows of a single IEA are carried over
   different paths.  As MFT terminates only ET-marked flows, it
   decreases in any case the load on SR-pre-congested paths which is
   different for MRT. (3) Unlike MRT, edge nodes of MFT do not need
   measurements that are error-prone due to stochastic variations in
   case of low aggregation. (4) MFT decreases the SR-overload only



Menth & Lehrieder        Expires January 5, 2009               [Page 22]

Internet-Draft         PCN Performance Evaluation              July 2008


   gradually such that wrong rate estimates of terminated flows are
   compensated by more or less frequent termination of additional flows.
   When MRT underestimates flow rates, overtermination occurs as there
   is no possibility to correct the termination result.

6.5.2.  Unknown Traffic Characteristics

   CMFT requires estimates for the average packet inter-arrival time
   within flows E[A], the average flow termination delay E[DT], for the
   configuration of the marking algorithm of PCN nodes while F/A-EMFT
   need only an estimate for E[DT] when we assume that the rates of the
   flows are known by the PCN egress nodes or endpoints.  Therefore, the
   termination behavior is harder to control for CMFT than for F/A-EMFT.

6.5.3.  Implementation and Configuration Complexity

   CMFT and F-EMFT are simple to implement in the sense that they do not
   need IEAs.  This is an advantage since IEAs need extra data
   structures and it is sometimes difficult to associate flows with
   correct IEAs because it is not a trivial to derive the PCN ingress
   and egress node for a flow.  The termination function of CMFT is very
   simple while F/A-EMFT needs initialization and maintenance of credit
   counters per flow.  With CMFT, the stretch factor ba of the marking
   algorithm requires an estimate of the mean packet inter-arrival time
   E[A] within flows and the mean flow termination delay E[DT].  The
   parameters may be different in different nodes.  In contrast, F/A-
   EMFT require only an estimate for E[DT] in their egress nodes or
   endpoints for the initialization of credit counters and the
   calculation of the increments.

   In case of end-to-end PCN, the E[DT] must be globally the same value
   for the sake of fair termination probabilities.  This is especially
   difficult for F-EMFT if many distributed endpoints are under the
   control of a user instead of an operator.  It may be more feasible
   for A-EMFT as PCN egress nodes are under the control of operators.
   The setting of the aggressiveness a raises similar security issues.

6.5.4.  Fairness Issues

   Flows with a higher packet rate than others have a higher termination
   probability with CMFT and A-EMFT even if they have the same rate.  In
   contrast, F-EMFT leads to fair termination.  A-EMFT balances the
   percentage of terminated traffic for different sets of flows when
   they are grouped by IEAs.  CMFT and F-EMFT do not operate on IEAs and
   cannot enforce equal termination among traffic aggregates in a simple
   way.





Menth & Lehrieder        Expires January 5, 2009               [Page 23]

Internet-Draft         PCN Performance Evaluation              July 2008


6.5.5.  Termination Priorities and Policies

   Both F-EMFT and A-EMFT can implement stochastic termination
   priorities by modifying the aggressiveness alpha for a set of flows.
   A-EMFT is most flexible with stochastic enforcement of general
   termination termination policies that even compensate increased flow
   termination probabilities due to short packet inter-arrival times.
   CMFT does not offer obvious termination policies.  Additional
   mechanisms can enable termination priorities.  E.g.  ET-marked flows
   with low termination priority may be terminated only with a certain
   probability smaller than 1.  However, this adds additional complexity
   to egress nodes or endpoints and raises also configuration and
   security questions.

6.5.6.  Marking Support from Simple ECN Nodes

   We cannot expect that all nodes in the Internet will upgrade to PCN.
   Therefore, it is desirable to get appropriate feedback from ECN nodes
   that are not PCN-capable.  When the PCN codepoints NP, AS, and ET are
   chosen as ECT(0), ECT(1), and CE, non-PCN-capable ECN nodes indicate
   set the markings of some packets to CE, i.e.  ET, and thereby
   terminate excess flows.  The effect of this feature is more
   aggressive with CMFT than for F/A-EMFT.  However, it is not yet clear
   whether this mechanism is helpful or counterproductive.

6.5.7.  Compatibility with Existing Hardware

   Current hardware offers simple excess marking, but not marking
   frequency reduction (MFR), proportional MFR (PMFR) or packet size
   independent marking (PSIM) as required by PCN nodes to support CMFT.
   Thus CMFT needs new metering and marking features in routers.  A/F-
   EMFT requires excess marking with PSIM, but PSIM is only required to
   achieve equal termination probabilities for flows independent of
   their packet size.  Therefore, the roll-out of A/F-EMFT could start
   without waiting for new router features to be deployed and PSIM may
   be added as an improvement by future updates.















Menth & Lehrieder        Expires January 5, 2009               [Page 24]

Internet-Draft         PCN Performance Evaluation              July 2008


7.  Performance Evaluation of Marked Flow Termination (MFT) with
    Multiple Bottleneck Links

   In the presence of several bottleneck links, flows can be ET-marked
   by different interior nodes.  As a consequence, an overloaded link
   loses flows whose packets were ET-marked by itself, but it also loses
   flows whose packets were ET-marked by another overloaded link.  This
   impacts the termination speed and possibly leads to unintended
   overtermination.  To avoid this effect, we propose to remove S bytes
   from the virtual queue for each ET-marked packet sent over the
   corresponding link (general MFR) and not only for each packet that
   has been ET-marked by that link itself (local MFR).  We illustrate
   the impact of this change to the metering algorithm.

7.1.  Several Serial Links Carrying Only a Common Aggregate

   We start with a single aggregate crossing several links as shown in
   Figure 1.  All links have a supportable rate of 4Mbit/s such that 125
   flows can be supported.  However, the observed aggregate initially
   carries 8 Mbit/s.  Simulation results show that with local MFR, the
   aggregate rate is reduced to 3.0 Mbit/s, 2.15 Mbit/s, and to 1.6
   Mbit/s in case of 2, 3, and 4 consecutive links.  In contrast, with
   global MFR, the aggregate rate decreases only to 3.9 Mbit/s in all
   studied scenarios.  Thus, we observe a significant degree of
   overtermination for local MFR while with global MFR the reduction of
   the traffic rate meets the expected value quite well and
   independently of the number of serial bottlenecks.

                    +-----------+   +-----------+   +-----------+
   Aggregate a0  ---|           |---|           |---|           |---
                    +-----------+   +-----------+   +-----------+
                       Link l0         Link l1         Link l2

   Several serial links carry only a common aggregate.

                                 Figure 1

   To reconstruct this experiment, it is important to avoid the
   synchronization of the consecutive meters which is achieved when they
   are configured with (a) the same supportable rate (SR) and (b) the
   same supportable burst size (SBS) and (c) the same slowdown factor S,
   and (d) if there is no cross traffic at all.  In our first experiment
   depicted in Figure Figure 1, we have chosen a slightly different SR
   for each link.  In the other experiments that are depicted in
   Figure 2- Figure 4, the links carry cross traffic such that
   precondition (d) for the synchronization effect is violated anyway.





Menth & Lehrieder        Expires January 5, 2009               [Page 25]

Internet-Draft         PCN Performance Evaluation              July 2008


7.2.  Two Serial Links Carrying a Common Aggregate with Cross Traffic on
      the Second Link

   We consider two serial links carrying an aggregate a0 and the second
   link carrying cross traffic from an aggregate a1 (cf. Figure 2).

       +-----------+   +-----------+
    ---|           |---|           |--- Aggregate a0
       +-----------+   |           |--- Aggregate a1
                      /+-----------+
          Link l0    /     Link l1

   Two serial links carrying a common aggregate with cross traffic on
   the second link.

                                 Figure 2

   The first link l0 has SR(l0) = 4 Mbit/s and the second link l1 has
   SR(l1) = 8Mbit/s.  Initially, there is an SR-overload of 100% since
   both aggregates carry 8 Mbit/s.  Simulation results show that the
   rate of aggregate a0 decreases from 8 Mbit/s to 2.9 Mibt/s with local
   MFR and to 3.0 Mbit/s with global MFR.  The rate of aggregate a1
   (cross traffic) is reduced from 8 Mibt/s to 4.4 Mbit/s with local MFR
   and to 4.8 Mbit/s with global MFR.  As a consequence, the remaining
   rate on the second link l1 is 7.3Mbit/s with localMFR and 7.8Mbit/s
   with globalMFR.  Thus, global MFT leads to visibly less terminated
   traffic in this experiment.

7.3.  Two Serial Links Carrying a Common Aggregate with Cross Traffic on
      the First Link

   We consider two serial links carrying an aggregate a0 and the first
   link carrying cross traffic from an aggregate a1 (cf. Figure 3).

                   +-----------+   +-----------+
   Aggregate a0 ---|           |---|           |---
                   |           |   +-----------+
                  /+-----------+\
   Aggregate a1  /    Link l0    \    Link l1

   Two serial links carrying a common aggregate with cross traffic on
   the first link.

                                 Figure 3

   We consider two serial links carrying an aggregate a0 and the first
   link carrying cross traffic from an aggregate a1 (cf. Figure 3).  The
   first link l0 has SR(l0) = 8 Mbit/s and the second link l1 has SR(l1)



Menth & Lehrieder        Expires January 5, 2009               [Page 26]

Internet-Draft         PCN Performance Evaluation              July 2008


   = 4 Mbit/s.  Initially, there is an SR-overload of 100% since both
   aggregates carry 8 Mbit/s.  Initially, there is an SR-overload of
   100% since both aggregates carry 8 Mbit/s.  Simulation results show
   that the rate of aggregate a0 decreases from 8 Mbit/s to 2.8 Mibt/s
   with local MFR and to 3.8 Mbit/s with global MFR.  The rate of
   aggregate a1 (cross traffic) is reduced from 8 Mibt/s to 4.5 Mbit/s
   with local MFR and to 4.0 Mbit/s with global MFR.  As a consequence,
   the remaining rate on the second link l0 is 7.3 Mbit/s with local MFR
   and 7.8 Mbit/s with global MFR.  Thus, global MFT leads to visibly
   less terminated traffic in this experiment and to a fairer treatment
   of flows crossing a different numbers of bottlenecks.

7.4.  Two Serial Links Carrying a Common Aggregate with Cross Traffic on
      Both Links

   We consider two serial links carrying a common aggregate with cross
   traffic on both links (cf. Figure 4).

                   +-----------+     +-----------+
   Aggregate a0 ---|           |-----|           |---
   Aggregate a1 ---|           |     |           |--- Aggregate a2
                   +-----------+\   /+-----------+
                      Link l0    \ /    Link l1

   Two serial links carrying a common aggregate with cross traffic on
   both links.

                                 Figure 4

   We consider two serial links carrying an aggregate a0.  The first
   link carries cross traffic from aggregate a1 and the second link
   carries cross traffic from aggregate a2 (cf. Figure 4).  Both links
   have a supportable rate of 8 Mbit/s.  Initially, there is an SR-
   overload of 100% since all three aggregates carry 8 Mbit/s.
   Simulation results show that the rate of aggregate a0 decreases from
   8 Mbit/s to 2.6 Mibt/s with local MFR and to 2.7 Mbit/s with global
   MFR.  The rate of aggregate a1 (cross traffic on link l0) is reduced
   from 8 Mibt/s to 4.5 Mbit/s with local MFR and to 4.3 Mbit/s with
   global MFR and the one of aggregate a2 (cross traffic on link l1) is
   reduced from 8 Mibt/s to 4.3 Mbit/s with local MFR and to 5.1 Mbit/s
   with global MFR.  As a consequence, the remaining rate on the first
   link l0 is 7.2 Mbit/s with local MFR and 7.8 Mbit/s with global MFR
   and the one on the second link l1 is 7.2 Mbit/s with local MFR and
   7.1 Mbit/s with global MFR.  Thus, global MFT leads to visibly less
   terminated cross traffic on the second link in this experiment.






Menth & Lehrieder        Expires January 5, 2009               [Page 27]

Internet-Draft         PCN Performance Evaluation              July 2008


7.5.  Summary

   Global MFR leads in all studied experiments to less terminated
   traffic than local MFR.  Especially in case of several serial links
   carrying only a single aggregate the degree of overtermination is
   tremendous with local MFR while global MFR does not lead to
   overtermination in that scenario.  In other experiments with cross
   traffic the difference between local and global MFR is still visible
   but less dramatic.  Nevertheless, global MFR is clearly better than
   localMFR.  However, multiple simultaneous bottleneck links are rather
   unlikely and, in particular, the situation with several serial
   bottleneck links where tremendous overtermination with local MFR
   occurs is rather pathologic.  Therefore, local MFR may still be used
   instead of global MFR if it reduces implementation complexity.





































Menth & Lehrieder        Expires January 5, 2009               [Page 28]

Internet-Draft         PCN Performance Evaluation              July 2008


8.  Performance Evaluation of a Marking Converter for Excess Marking

   Both F-EMFT and A-EMFT rely on the assumption that all packets
   exceeding a supportable rate SR(l) on a link l of the PCN-domain are
   ET-marked (cf. Section 6).  This means that excess marking is
   performed with the supportable rate SR as reference rate.

   In contrast, the Single-Marking (SM) draft
   ([I-D.charny-pcn-single-marking]) proposes not to use ET-marks for
   flow termination but only AS-marks.  This save one codepoint in the
   IP-header.  It proposes to AS-mark all packets exceeding the
   admissible rate AR, i.e. to perform excess marking with regard to AR
   and the AR-overlaod corresponds directly to the rate of AS-marked
   packets.  In order to estimate SR-overload, SR(l)=u*AR is set to a
   fixed multiple u of AR where u is a domain-wide constant.

   [I-D.menth-pcn-marking-converter] proposes an algorithm which
   converts marked AR-overload into marked SR-overload.  It makes flow
   termination mechanisms requiring SR-overload (e.g.  F-EMFT and
   A-EMFT) applicable in networks that mark AR-overload only.  Here, we
   evaluate the performance by simulation experiments.

8.1.  Simulation Setup

   We simulate 200 periodic real-time traffic source with a packet
   inter-arrival time of 20 ms and a packet size of 200 byte, i.e.,
   every flow has a bandwidth of 80 kbit/s and all flows together result
   in a traffic rate of 16 Mbit/s.  The traffic source are equally
   distributed among n_Agg = (1,10,50,100,200) ingress-egress-
   aggregates.  All aggregates use the bottleneck link with an
   admissible rate of AR=5 Mbit/s and u=1.6.  Hence, the supportable
   rate is SR=8 Mbit/s so that only half of the traffic can be supported
   by the bottleneck link.

   The bottleneck link marks AR-overload as proposed in the SM draft.
   At the PCN egress node, the marking converter converts AR-overload
   into SR-overload in a first step.  In a second step, it performs
   F-EMFT (for n_Agg=200) and A-EMFT (for n_Agg<200) based on the SR-
   overload with an aggressiveness alpha=1.

8.2.  Results

   We investigate the time until overload is reduced and the amount of
   overtermination.  Overtermination occurs when the traffic rate on the
   link is significantly below the supportable rate after termination.
   We analyze the impact of bucket size S of the marking converter and
   the number of aggregates sharing the bottleneck link.  In summary,
   first simulations give a proof of concept.  However, we also observed



Menth & Lehrieder        Expires January 5, 2009               [Page 29]

Internet-Draft         PCN Performance Evaluation              July 2008


   some limitations.

   For n_Agg<=10, we get fast termination and no overtermination even in
   case of small bucket sizes S. The termination behavior is very
   similar to the one described in Section 6.

   However, we observe a considerable amount of overtermination (up to
   20 % of SR) if many aggregates share a common bottleneck link.  The
   main reason of this phenomenon is that marked and unmarked packets
   are distributed randomly over all aggregates.  Consequently, one
   aggregate a1 can suffer from a rate marked packets significantly
   higher than the average while another one receives only a few marked
   packets.  Hence, flows can be terminated on aggregate one because the
   PCN egress node detected to many marked packets.

   We tried to minimize that effect be choosing larger bucket sizes S
   because a large bucket can compensate fluctuations of the rate of
   marked packets up to a certain degree.  But S cannot be increased to
   arbitrarly large values as this delays the reaction of the marking
   converter in case of sudden overload.  Our simulations showed that
   even bucket sizes which delayed the reaction several seconds could
   not prevent considerable overtermination.  As a consequence, using
   the marking converter is difficult in a scenario where many
   aggregates share a single bottleneck link.



























Menth & Lehrieder        Expires January 5, 2009               [Page 30]

Internet-Draft         PCN Performance Evaluation              July 2008


9.  IANA Considerations

   TBD
















































Menth & Lehrieder        Expires January 5, 2009               [Page 31]

Internet-Draft         PCN Performance Evaluation              July 2008


10.  Security Considerations

   TBD
















































Menth & Lehrieder        Expires January 5, 2009               [Page 32]

Internet-Draft         PCN Performance Evaluation              July 2008


11.  Changes from Previous Revisions

11.1.  Changes from Version -00 to Version -01

   o  Added section on "Performance Evaluation of Admission Control with
      Single-Marking"

   o  Added section on "Performance Evaluation of Measured Rate
      Termination (MRT)"

   o  Added section on "Performance Evaluation of Marked Flow
      Termination on a Single Link"

   o  Added section on "Performance Evaluation of Marked Flow
      Termination with Multiple Bottleneck Links"

11.2.  Changes from Version -01 to Version -02

   o  Completely updated Section 4

   o  Completely updated Section 6

11.3.  Changes from Version -02 to Version -03

   o  Added section "Performance Evaluation of a Marking Converter for
      Excess Marking"

























Menth & Lehrieder        Expires January 5, 2009               [Page 33]

Internet-Draft         PCN Performance Evaluation              July 2008


12.  References

12.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

12.2.  Informative References

   [I-D.babiarz-pcn-3sm]
              Babiarz, J., Liu, X., Chan, K., and M. Menth, "Three State
              PCN Marking", draft-babiarz-pcn-3sm-01 (work in progress),
              November 2007.

   [I-D.briscoe-tsvwg-cl-architecture]
              Briscoe, B., "An edge-to-edge Deployment Model for Pre-
              Congestion Notification: Admission  Control over a
              DiffServ Region", draft-briscoe-tsvwg-cl-architecture-04
              (work in progress), October 2006.

   [I-D.charny-pcn-single-marking]
              Charny, A., Zhang, X., Faucheur, F., and V. Liatsos, "Pre-
              Congestion Notification Using Single Marking for Admission
              and  Termination", draft-charny-pcn-single-marking-03
              (work in progress), November 2007.

   [I-D.ietf-pcn-architecture]
              Eardley, P., "Pre-Congestion Notification Architecture",
              draft-ietf-pcn-architecture-03 (work in progress),
              February 2008.

   [I-D.menth-pcn-emft]
              Menth, M., Lehrieder, F., Eardley, P., Charny, A., and J.
              Babiarz, "Edge-Assisted Marked Flow Termination",
              draft-menth-pcn-emft-00 (work in progress), February 2008.

   [I-D.menth-pcn-marking-converter]
              Menth, M. and F. Lehrieder, "Marking Converter for Excess-
              Marked Traffic", July 2008.

12.3.  Other References

   [Menth07]  Menth, M. and F. Lehrieder, "Performance Evaluation of
              PCN-Based Admission Control and  Flow Termination (work in
              progress)", November 2007, <http://
              www3.informatik.uni-wuerzburg.de/staff/menth/Publications/
              Menth07-PCN-Eval.pdf>.




Menth & Lehrieder        Expires January 5, 2009               [Page 34]

Internet-Draft         PCN Performance Evaluation              July 2008


   [Menth08-AC]
              Menth, M. and F. Lehrieder, "Performance Evaluation of
              PCN-Based Admission Control", February 2008, <http://
              www3.informatik.uni-wuerzburg.de/staff/menth/Publications/
              Menth08-PCN-AC.pdf>.

   [Menth08-MFT]
              Menth, M. and F. Lehrieder, "Termination Methods for End-
              to-End PCN-Based Flow Control", February 2008, <http://
              www3.informatik.uni-wuerzburg.de/staff/menth/Publications/
              Menth08-PCN-MFT.pdf>.

   [TR437]    Menth, M. and F. Lehrieder, "Comparison of Marking
              Algorithms for PCN-Based Admission Control, Technical
              Report No. 437", October 2007, <http://
              www-info3.informatik.uni-wuerzburg.de/TR/tr437.pdf>.



































Menth & Lehrieder        Expires January 5, 2009               [Page 35]

Internet-Draft         PCN Performance Evaluation              July 2008


Authors' Addresses

   Michael Menth
   University of Wuerzburg
   Am Hubland
   Wuerzburg  D-97074
   Germany

   Phone: +49-931-888-6644
   Email: menth@informatik.uni-wuerzburg.de


   Frank Lehrieder
   University of Wuerzburg
   Am Hubland
   Wuerzburg  D-97074
   Germany

   Phone: +49-931-888-6634
   Email: lehrieder@informatik.uni-wuerzburg.de































Menth & Lehrieder        Expires January 5, 2009               [Page 36]

Internet-Draft         PCN Performance Evaluation              July 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Menth & Lehrieder        Expires January 5, 2009               [Page 37]

