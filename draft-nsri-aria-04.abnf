W0 = KL, 
W1 = FO(W0, CK1) ^ KR, 
W2 = FE(W1, CK2) ^ W0, 
W3 = FO(W2, CK3) ^ W1. 
        
C1 =  0x517cc1b727220a94fe13abe8fa9a6ee0 
C2 =  0x6db14acc9e21c820ff28b1d5ef5de2b0 
C3 =  0xdb92371d2126e9700324977504e8c90e 
        
ek1  = W0 ^(W1 >>> 19), 
ek2  = W1 ^(W2 >>> 19), 
ek3  = W2 ^(W3 >>> 19), 
ek4  = (W0 >>> 19) ^ W3, 
ek5  = W0 ^ (W1 >>> 31), 
ek6  = W1 ^ (W2 >>> 31), 
ek7  = W2 ^ (W3 >>> 31), 
ek8  = (W0 >>> 31) ^ W3, 
ek9  = W0 ^ (W1 <<< 61), 
ek10 = W1 ^ (W2 <<< 61), 
ek11 = W2 ^ (W3 <<< 61), 
ek12 = (W0 <<< 61) ^ W3, 
ek13 = W0 ^ (W1 <<< 31), 
ek14 = W1 ^ (W2 <<< 31), 
ek15 = W2 ^ (W3 <<< 31), 
ek16 = (W0 <<< 31) ^ W3, 
     
     
        
        

ek17 = W0 ^ (W1 <<< 19). 
        
dk1 = ek{n+1}, 
dk2 = A(ek{n}), 
dk3 = A(ek{n-1}), 
P1  = FO(P  , ek1 );              // Round 1 
P2  = FE(P1 , ek2 );              // Round 2 
P3  = FO(P2 , ek3 );              // Round 3 
P4  = FE(P3 , ek4 );              // Round 4 
P5  = FO(P4 , ek5 );              // Round 5 
P6  = FE(P5 , ek6 );              // Round 6 
P7  = FO(P6 , ek7 );              // Round 7 
     
     
        
        

P8  = FE(P7 , ek8 );              // Round 8 
P9  = FO(P8 , ek9 );              // Round 9 
P10 = FE(P9 , ek10);              // Round 10 
P11 = FO(P10, ek11);              // Round 11 
C   = SL2(P11 ^ ek12) ^ ek13;     // Round 12 
        
P1  = FO(P  , ek1 );              // Round 1 
P2  = FE(P1 , ek2 );              // Round 2 
P3  = FO(P2 , ek3 );              // Round 3 
P4  = FE(P3 , ek4 );              // Round 4 
P5  = FO(P4 , ek5 );              // Round 5 
P6  = FE(P5 , ek6 );              // Round 6 
P7  = FO(P6 , ek7 );              // Round 7 
P8  = FE(P7 , ek8 );              // Round 8 
P9  = FO(P8 , ek9 );              // Round 9 
P10 = FE(P9 , ek10);              // Round 10 
P11 = FO(P10, ek11);              // Round 11 
P12 = FE(P11, ek12);              // Round 12 
P13 = FO(P12, ek13);              // Round 13 
C   = SL2(P13 ^ ek14) ^ ek15;     // Round 14 
        
P1 = FO(P  , ek1 );              // Round 1 
P2 = FE(P1 , ek2 );              // Round 2 
P3 = FO(P2 , ek3 );              // Round 3 
P4 = FE(P3 , ek4 );              // Round 4 
P5 = FO(P4 , ek5 );              // Round 5 
P6 = FE(P5 , ek6 );              // Round 6 
P7 = FO(P6 , ek7 );              // Round 7 
P8 = FE(P7 , ek8 );              // Round 8 
P9 = FO(P8 , ek9 );              // Round 9 
P10= FE(P9 , ek10);              // Round 10 
P11= FO(P10, ek11);              // Round 11 
P12= FE(P11, ek12);              // Round 12 
P13= FO(P12, ek13);              // Round 13 
P14= FE(P13, ek14);              // Round 14 
     
     
        
        

P15= FO(P14, ek15);              // Round 15 
C  = SL2(P15 ^ ek16) ^ ek17;     // Round 16 
        
y0 = SB1(x0),  y1 = SB2(x1),  y2 = SB3(x2),  y3 = SB4(x3), 
y4 = SB1(x4),  y5 = SB2(x5),  y6 = SB3(x6),  y7 = SB4(x7), 
y8 = SB1(x8),  y9 = SB2(x9),  y10= SB3(x10), y11= SB4(x11), 
y12= SB1(x12), y13= SB2(x13), y14= SB3(x14), y15= SB4(x15). 
        


     
     
        
        

y0 = SB3(x0),  y1 = SB4(x1),  y2 = SB1(x2),  y3 = SB2(x3), 
y4 = SB3(x4),  y5 = SB4(x5),  y6 = SB1(x6),  y7 = SB2(x7), 
y8 = SB3(x8),  y9 = SB4(x9),  y10= SB1(x10), y11= SB2(x11), 
y12= SB3(x12), y13= SB4(x13), y14= SB1(x14), y15= SB2(x15). 
        
y0  = x3 ^ x4 ^ x6 ^ x8  ^ x9  ^ x13 ^ x14, 
y1  = x2 ^ x5 ^ x7 ^ x8  ^ x9  ^ x12 ^ x15, 
y2  = x1 ^ x4 ^ x6 ^ x10 ^ x11 ^ x12 ^ x15, 
y3  = x0 ^ x5 ^ x7 ^ x10 ^ x11 ^ x13 ^ x14, 
y4  = x0 ^ x2 ^ x5 ^ x8  ^ x11 ^ x14 ^ x15, 
y5  = x1 ^ x3 ^ x4 ^ x9  ^ x10 ^ x14 ^ x15, 
y6  = x0 ^ x2 ^ x7 ^ x9  ^ x10 ^ x12 ^ x13, 
y7  = x1 ^ x3 ^ x6 ^ x8  ^ x11 ^ x12 ^ x13, 
y8  = x0 ^ x1 ^ x4 ^ x7  ^ x10 ^ x13 ^ x15, 
y9  = x0 ^ x1 ^ x5 ^ x6  ^ x11 ^ x12 ^ x14, 
y10 = x2 ^ x3 ^ x5 ^ x6  ^ x8  ^ x13 ^ x15, 
y11 = x2 ^ x3 ^ x4 ^ x7  ^ x9  ^ x12 ^ x14, 
y12 = x1 ^ x2 ^ x6 ^ x7  ^ x9  ^ x11 ^ x12, 
y13 = x0 ^ x3 ^ x6 ^ x7  ^ x8  ^ x10 ^ x13, 
y14 = x0 ^ x3 ^ x4 ^ x5  ^ x9  ^ x11 ^ x14, 
y15 = x1 ^ x2 ^ x4 ^ x5  ^ x8  ^ x10 ^ x15. 
        
x = A(A(x)) holds. 
        
